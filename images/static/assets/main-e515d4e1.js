(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function z(){}function hl(l){return l()}function Ot(){return Object.create(null)}function ge(l){l.forEach(hl)}function xt(l){return typeof l=="function"}function je(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let ft;function De(l,t){return ft||(ft=document.createElement("a")),ft.href=t,l===ft.href}function kl(l){return Object.keys(l).length===0}function c(l,t){l.appendChild(t)}function F(l,t,e){l.insertBefore(t,e||null)}function O(l){l.parentNode&&l.parentNode.removeChild(l)}function ye(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function p(l){return document.createElement(l)}function wl(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function K(l){return document.createTextNode(l)}function w(){return K(" ")}function He(){return K("")}function P(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function yl(l){return l===""?null:+l}function xl(l){return Array.from(l.childNodes)}function Q(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ht(l,t){l.value=t??""}function _e(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ft(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function Cl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function Sl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const n=document.createEvent("CustomEvent");return n.initCustomEvent(l,e,s,t),n}let nt;function st(l){nt=l}function Ct(){if(!nt)throw new Error("Function called outside component initialization");return nt}function Oe(l){Ct().$$.on_mount.push(l)}function rt(l){Ct().$$.on_destroy.push(l)}function mt(){const l=Ct();return(t,e,{cancelable:s=!1}={})=>{const n=l.$$.callbacks[t];if(n){const r=Sl(t,e,{cancelable:s});return n.slice().forEach(i=>{i.call(l,r)}),!r.defaultPrevented}return!0}}const $e=[],Ie=[],dt=[],Tt=[],jl=Promise.resolve();let yt=!1;function Dl(){yt||(yt=!0,jl.then(gl))}function gt(l){dt.push(l)}const kt=new Set;let Ye=0;function gl(){if(Ye!==0)return;const l=nt;do{try{for(;Ye<$e.length;){const t=$e[Ye];Ye++,st(t),Ol(t.$$)}}catch(t){throw $e.length=0,Ye=0,t}for(st(null),$e.length=0,Ye=0;Ie.length;)Ie.pop()();for(let t=0;t<dt.length;t+=1){const e=dt[t];kt.has(e)||(kt.add(e),e())}dt.length=0}while($e.length);for(;Tt.length;)Tt.pop()();yt=!1,kt.clear(),st(l)}function Ol(l){if(l.fragment!==null){l.update(),ge(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(gt)}}const pt=new Set;let Ve;function it(){Ve={r:0,c:[],p:Ve}}function ot(){Ve.r||ge(Ve.c),Ve=Ve.p}function J(l,t){l&&l.i&&(pt.delete(l),l.i(t))}function Z(l,t,e,s){if(l&&l.o){if(pt.has(l))return;pt.add(l),Ve.c.push(()=>{pt.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function de(l){l&&l.c()}function ae(l,t,e,s){const{fragment:n,after_update:r}=l.$$;n&&n.m(t,e),s||gt(()=>{const i=l.$$.on_mount.map(hl).filter(xt);l.$$.on_destroy?l.$$.on_destroy.push(...i):ge(i),l.$$.on_mount=[]}),r.forEach(gt)}function ce(l,t){const e=l.$$;e.fragment!==null&&(ge(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Fl(l,t){l.$$.dirty[0]===-1&&($e.push(l),Dl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Fe(l,t,e,s,n,r,i,o=[-1]){const a=nt;st(l);const u=l.$$={fragment:null,ctx:[],props:r,update:z,not_equal:n,bound:Ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:Ot(),dirty:o,skip_bound:!1,root:t.target||a.$$.root};i&&i(u.root);let d=!1;if(u.ctx=e?e(l,t.props||{},(_,m,...h)=>{const g=h.length?h[0]:m;return u.ctx&&n(u.ctx[_],u.ctx[_]=g)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](g),d&&Fl(l,_)),m}):[],u.update(),d=!0,ge(u.before_update),u.fragment=s?s(u.ctx):!1,t.target){if(t.hydrate){const _=xl(t.target);u.fragment&&u.fragment.l(_),_.forEach(O)}else u.fragment&&u.fragment.c();t.intro&&J(l.$$.fragment),ae(l,t.target,t.anchor,t.customElement),gl()}st(a)}class Te{$destroy(){ce(this,1),this.$destroy=z}$on(t,e){if(!xt(e))return z;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const n=s.indexOf(e);n!==-1&&s.splice(n,1)}}$set(t){this.$$set&&!kl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ze=[];function Xe(l,t=z){let e;const s=new Set;function n(o){if(je(l,o)&&(l=o,e)){const a=!Ze.length;for(const u of s)u[1](),Ze.push(u,l);if(a){for(let u=0;u<Ze.length;u+=2)Ze[u][0](Ze[u+1]);Ze.length=0}}}function r(o){n(o(l))}function i(o,a=z){const u=[o,a];return s.add(u),s.size===1&&(e=t(n)||z),o(l),()=>{s.delete(u),s.size===0&&(e(),e=null)}}return{set:n,update:r,subscribe:i}}const St=Xe(0),jt=Xe(0),Dt=Xe(0),ml=Xe(0),_t=Xe([]);let Tl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ke=Xe(Tl),bl=Xe([]);function Nt(l,t,e){const s=l.slice();return s[26]=t[e],s}function qt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Lt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Et(l,t,e){const s=l.slice();return s[34]=t[e],s}function Pt(l){let t,e=l[4][l[29]],s=[];for(let n=0;n<e.length;n+=1)s[n]=At(Et(l,e,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=w()},m(n,r){for(let i=0;i<s.length;i+=1)s[i].m(n,r);F(n,t,r)},p(n,r){if(r[0]&2576){e=n[4][n[29]];let i;for(i=0;i<e.length;i+=1){const o=Et(n,e,i);s[i]?s[i].p(o,r):(s[i]=At(o),s[i].c(),s[i].m(t.parentNode,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=e.length}},d(n){ye(s,n),n&&O(t)}}}function At(l){let t,e,s,n=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",r,i,o,a=l[34]+" ",u,d,_,m,h;function g(...v){return l[14](l[29],l[34],...v)}return{c(){t=p("div"),e=p("div"),s=p("span"),r=K(n),i=w(),o=p("span"),u=K(a),d=w(),_=p("span"),_.textContent="x",f(s,"class","text-blue-800 "),f(o,"class","ml-1 text-sm font-semibold"),f(_,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),f(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),f(t,"class","flex items-center justify-center")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,r),c(e,i),c(e,o),c(o,u),c(e,d),c(e,_),m||(h=[P(_,"click",g),P(e,"click",function(){xt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],m=!0)},p(v,b){l=v,b[0]&16&&n!==(n=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&Q(r,n),b[0]&16&&a!==(a=l[34]+" ")&&Q(u,a)},d(v){v&&O(t),m=!1,ge(h)}}}function It(l){let t,e=l[4][l[29]].length>=1&&Pt(l);return{c(){e&&e.c(),t=He()},m(s,n){e&&e.m(s,n),F(s,t,n)},p(s,n){s[4][s[29]].length>=1?e?e.p(s,n):(e=Pt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function Ht(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,n,r;return{c(){t=p("option"),s=K(e),n=w(),t.__value=r=l[29],t.value=t.__value},m(i,o){F(i,t,o),c(t,s),c(t,n)},p(i,o){o[0]&16&&e!==(e=i[29].charAt(0).toUpperCase()+i[29].slice(1)+"")&&Q(s,e),o[0]&16&&r!==(r=i[29])&&(t.__value=r,t.value=t.__value)},d(i){i&&O(t)}}}function Mt(l){let t,e,s,n,r,i,o,a,u=l[3],d=[];for(let _=0;_<u.length;_+=1)d[_]=Bt(Nt(l,u,_));return{c(){t=p("div"),e=p("ul");for(let _=0;_<d.length;_+=1)d[_].c();s=w(),n=p("div"),r=p("button"),r.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(r,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(n,"class","flex w-full justify-center items-center"),f(t,"class",i=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,m){F(_,t,m),c(t,e);for(let h=0;h<d.length;h+=1)d[h].m(e,null);c(t,s),c(t,n),c(n,r),o||(a=P(r,"click",l[22]),o=!0)},p(_,m){if(m[0]&1034){u=_[3];let h;for(h=0;h<u.length;h+=1){const g=Nt(_,u,h);d[h]?d[h].p(g,m):(d[h]=Bt(g),d[h].c(),d[h].m(e,null))}for(;h<d.length;h+=1)d[h].d(1);d.length=u.length}m[0]&32&&i!==(i=(_[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",i)},d(_){_&&O(t),ye(d,_),o=!1,a()}}}function Bt(l){let t,e=l[26]+"",s,n,r,i;function o(){return l[21](l[26])}return{c(){t=p("li"),s=K(e),n=w(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(a,u){F(a,t,u),c(t,s),c(t,n),r||(i=P(t,"click",o),r=!0)},p(a,u){l=a,u[0]&8&&e!==(e=l[26]+"")&&Q(s,e)},d(a){a&&O(t),r=!1,i()}}}function Rt(l){let t;return{c(){t=p("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,f(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Nl(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S=Object.keys(l[4]),L=[];for(let y=0;y<S.length;y+=1)L[y]=It(Lt(l,S,y));let A=Object.keys(l[4]),q=[];for(let y=0;y<A.length;y+=1)q[y]=Ht(qt(l,A,y));let C=l[3].length>0&&Mt(l),j=l[6]==!0&&Rt();return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("div");for(let y=0;y<L.length;y+=1)L[y].c();r=w(),i=p("div"),o=p("select");for(let y=0;y<q.length;y+=1)q[y].c();a=w(),u=p("div"),d=p("input"),_=w(),m=p("div"),h=p("button"),h.textContent="Search",g=w(),C&&C.c(),v=w(),j&&j.c(),f(n,"class","flex w-full items-center my-3 flex-wrap text-lg"),f(o,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(o,"name","select-option"),f(o,"id","select-option"),l[1]===void 0&&gt(()=>l[16].call(o)),f(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(d,"type","search"),f(d,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(h,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(m,"class","flex"),f(i,"class","flex space-x-2"),f(s,"class","w-full"),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(y,D){F(y,t,D),c(t,e),c(e,s),c(s,n);for(let k=0;k<L.length;k+=1)L[k].m(n,null);c(s,r),c(s,i),c(i,o);for(let k=0;k<q.length;k+=1)q[k].m(o,null);Ft(o,l[1]),c(i,a),c(i,u),c(u,d),l[17](d),c(i,_),c(i,m),c(m,h),l[20](h),c(e,g),C&&C.m(e,null),c(e,v),j&&j.m(e,null),b||(x=[P(o,"change",l[15]),P(o,"change",l[16]),P(d,"focus",l[18],{once:!0}),P(d,"focusout",l[19]),P(d,"keyup",l[8]),P(d,"keydown",l[7]),P(h,"click",l[12])],b=!0)},p(y,D){if(D[0]&2576){S=Object.keys(y[4]);let k;for(k=0;k<S.length;k+=1){const U=Lt(y,S,k);L[k]?L[k].p(U,D):(L[k]=It(U),L[k].c(),L[k].m(n,null))}for(;k<L.length;k+=1)L[k].d(1);L.length=S.length}if(D[0]&16){A=Object.keys(y[4]);let k;for(k=0;k<A.length;k+=1){const U=qt(y,A,k);q[k]?q[k].p(U,D):(q[k]=Ht(U),q[k].c(),q[k].m(o,null))}for(;k<q.length;k+=1)q[k].d(1);q.length=A.length}D[0]&18&&Ft(o,y[1]),y[3].length>0?C?C.p(y,D):(C=Mt(y),C.c(),C.m(e,v)):C&&(C.d(1),C=null),y[6]==!0?j||(j=Rt(),j.c(),j.m(e,null)):j&&(j.d(1),j=null)},i:z,o:z,d(y){y&&O(t),ye(L,y),ye(q,y),l[17](null),l[20](null),C&&C.d(),j&&j.d(),b=!1,ge(x)}}}async function ql(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let n=await fetch(e,{method:"POST",body:s});return n.ok===!0?await n.json():{}}function Ll(l,t,e){Oe(()=>{bl.subscribe(E=>{for(let H=0;H<E.length;H++)e(4,d[E[H]]=[],d)})});const s=mt();let n="query",r,i,{query_button_disabled:o=!1}=t,a="",u=[],d={query:[]},_=!1;var m={};function h(E){m[E.keyCode]=E.type=="keydown",m[13]==!0&&E.shiftKey&&(console.log("shift enter combination."),S())}async function g(E){e(6,L=!1),m[E.keyCode]=!1;let H=E.target;if(H.value.length==0){e(3,u=[]);return}if(console.log("current value: ",H.value),E.keyCode==13){let G=d[n].length;H.value.length>0&&!d[n].includes(H.value)&&e(4,d[n][G]=H.value,d),H.value="",e(3,u=[]),e(5,_=!1);return}let T=await ql(n,H.value);n in T?(e(3,u=T[n]),e(5,_=!0)):(e(3,u=[]),e(5,_=!1))}function v(E,H,T){let G=d[H].indexOf(T);G>=0&&(d[H].splice(G,1),e(4,d)),n==H&&e(3,u=[])}function b(E,H){e(5,_=!1),e(2,r.value=H,r),r.focus()}function x(E){e(1,n=E),e(3,u=d[n]),e(5,_=!0),r.focus()}function S(E){let H="&",T="?",G="=",M=d[n].length;r.value.length>0&&!d[n].includes(r.value)&&e(4,d[n][M]=r.value,d);let Y=Object.keys(d);a="";for(let ne=0;ne<Y.length;ne++){let $=Y[ne],te=d[$];a+=$+G;for(let le=0;le<te.length;le++)a+=te[le],le!=te.length-1&&(a+=T);ne!=Y.length-1&&(a+=H)}console.log("Completed: "+a),e(2,r.value="",r),i.disabled==!1?s("queryReady",{query:a,attributes:d}):console.log("chill dawg!!!")}let L=!1;const A=(E,H,T)=>v(T.currentTarget,E,H),q=E=>x(E.target.value);function C(){n=Cl(this),e(1,n),e(4,d)}function j(E){Ie[E?"unshift":"push"](()=>{r=E,e(2,r)})}const y=E=>{E.target.value.length==0&&e(6,L=!0)},D=E=>{e(6,L=!1)};function k(E){Ie[E?"unshift":"push"](()=>{i=E,e(0,i),e(13,o)})}const U=E=>b(n,E),V=()=>e(5,_=!1);return l.$$set=E=>{"query_button_disabled"in E&&e(13,o=E.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&i&&e(0,i.disabled=o,i)},[i,n,r,u,d,_,L,h,g,v,b,x,S,o,A,q,C,j,y,D,k,U,V]}class El extends Te{constructor(t){super(),Fe(this,t,Ll,Nl,je,{query_button_disabled:13},null,[-1,-1])}}function zt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function Pl(l){let t,e,s;return{c(){t=p("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(n,r){F(n,t,r),e||(s=P(t,"click",l[2]),e=!0)},p:z,d(n){n&&O(t),e=!1,s()}}}function Al(l){let t,e,s,n,r;return{c(){t=p("span"),t.textContent="Hachi",e=w(),s=p("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(s,"class","cursor-pointer px-4")},m(i,o){F(i,t,o),F(i,e,o),F(i,s,o),n||(r=P(s,"click",l[3]),n=!0)},p:z,d(i){i&&O(t),i&&O(e),i&&O(s),n=!1,r()}}}function Ut(l){let t,e,s=l[8].name+"",n,r,i,o=l[8].count+"",a;return{c(){t=p("div"),e=p("div"),n=K(s),r=w(),i=p("div"),a=K(o),f(e,"class","flex"),f(e,"data-ix",l[10]),f(i,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,d){F(u,t,d),c(t,e),c(e,n),c(t,r),c(t,i),c(i,a)},p(u,d){d&2&&s!==(s=u[8].name+"")&&Q(n,s),d&2&&o!==(o=u[8].count+"")&&Q(a,o)},d(u){u&&O(t)}}}function Gt(l){let t,e,s,n,r,i,o,a=l[0].sidebarOpen&&Ut(l);function u(){return l[6](l[10])}return{c(){t=p("div"),e=p("i"),n=w(),a&&a.c(),r=w(),f(e,"class",s="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,_){F(d,t,_),c(t,e),c(t,n),a&&a.m(t,null),c(t,r),i||(o=P(t,"click",u),i=!0)},p(d,_){l=d,_&2&&s!==(s="fa-solid fa-"+l[8].icon)&&f(e,"class",s),l[0].sidebarOpen?a?a.p(l,_):(a=Ut(l),a.c(),a.m(t,r)):a&&(a.d(1),a=null)},d(d){d&&O(t),a&&a.d(),i=!1,o()}}}function Il(l){let t,e,s,n,r,i;function o(m,h){return m[0].sidebarOpen?Al:Pl}let a=o(l),u=a(l),d=l[1],_=[];for(let m=0;m<d.length;m+=1)_[m]=Gt(zt(l,d,m));return{c(){t=p("div"),e=p("aside"),s=p("div"),u.c(),n=w(),r=p("nav");for(let m=0;m<_.length;m+=1)_[m].c();f(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(r,"class","mt-6"),f(e,"class",i=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-100 text-white")},m(m,h){F(m,t,h),c(t,e),c(e,s),u.m(s,null),c(e,n),c(e,r);for(let g=0;g<_.length;g+=1)_[g].m(r,null)},p(m,[h]){if(a===(a=o(m))&&u?u.p(m,h):(u.d(1),u=a(m),u&&(u.c(),u.m(s,null))),h&19){d=m[1];let g;for(g=0;g<d.length;g+=1){const v=zt(m,d,g);_[g]?_[g].p(v,h):(_[g]=Gt(v),_[g].c(),_[g].m(r,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=d.length}h&1&&i!==(i=(m[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",i)},i:z,o:z,d(m){m&&O(t),u.d(),ye(_,m)}}}function Hl(l,t,e){const s=mt();let{sidebarOpen:n=!1}=t;const r={sidebarOpen:n},i=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0},{icon:"folder",path:"#",name:"Local",count:0},{icon:"image",path:"#",name:"Google Photos",count:0}];Oe(()=>{St.subscribe(_=>{i&&e(1,i[0].count=_,i)}),jt.subscribe(_=>{i&&e(1,i[3].count=_,i)}),Dt.subscribe(_=>{i&&e(1,i[4].count=_,i)}),ml.subscribe(_=>{i&&e(1,i[5].count=_,i)})});function o(){e(0,r.sidebarOpen=!0,r)}function a(){e(0,r.sidebarOpen=!1,r)}function u(_){s("menuClick",{item:i[_]})}const d=_=>{u(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,n=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&r&&s("sidebarStateChange",{open:r.sidebarOpen})},[r,i,o,a,u,n,d]}class et extends Te{constructor(t){super(),Fe(this,t,Hl,Il,je,{sidebarOpen:5})}}function Ml(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S,L,A,q,C=(l[4]*100).toString().slice(0,4)+"",j,y,D,k,U,V,E,H,T,G,M,Y,ne,$,te,le,be,re,W,pe,ue,me,xe,Me,Ce,Ne,ke,Se,ve,ie,he,qe,Le,Ee,N,B,R,X,I;return{c(){t=p("div"),e=p("p"),e.textContent="Press Start button to start indexing",s=w(),n=p("div"),r=p("input"),i=w(),o=p("p"),o.textContent="OR",a=w(),u=p("div"),d=p("select"),_=p("option"),_.textContent="None selected",m=p("option"),m.textContent="google_photos",h=w(),g=p("div"),g.textContent="Choose a supported remote protocol",v=w(),b=p("div"),x=p("div"),S=p("div"),L=p("div"),A=w(),q=p("div"),j=K(C),y=K("%"),D=w(),k=p("div"),U=K("Current directory: "),V=p("span"),E=K(l[5]),H=w(),T=p("span"),T.textContent="ETA:",G=w(),M=p("span"),Y=K(l[7]),ne=w(),$=p("div"),te=K("Details: "),le=p("span"),be=K(l[6]),re=w(),W=p("div"),pe=p("div"),ue=p("input"),me=w(),xe=p("label"),xe.textContent="Complete Rescan",Me=w(),Ce=p("div"),Ce.textContent="Re-index all originals, including already indexed and unchanged files.",Ne=w(),ke=p("div"),Se=p("select"),ve=p("option"),ve.textContent="Images Only",ie=p("option"),ie.textContent="Videos Only",he=p("option"),he.textContent="Videos and Images",qe=w(),Le=p("div"),Le.textContent="Filter by content type",Ee=w(),N=p("button"),N.textContent="Cancel",B=w(),R=p("button"),R.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(r,"type","text"),f(r,"class","w-full rounded border p-1 text-sm disabled:bg-gray-200"),f(r,"placeholder","D://images (Full path to directory to index)"),r.required=!0,f(o,"class","font-semibold"),_.__value="None selected",_.value=_.__value,m.__value="google_photos",m.value=m.__value,f(d,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(g,"class","ml-2 text-sm text-gray-600"),f(u,"class","mb-3 mt-3 flex flex-wrap items-center"),f(n,"class","my-2"),f(L,"class","h-2rounded bg-blue-500"),_e(L,"width",(l[4]*100).toString()+"%"),f(S,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(q,"class","flex px-2 font-semibold"),f(x,"class","flex items-center"),f(V,"class","text-black"),f(T,"class","pl-3 text-right"),f(M,"class","text-black"),f(k,"class","pt-1 text-sm text-blue-600"),f(le,"class","text-black"),f($,"class","pt-1 text-sm text-blue-600"),f(b,"class","mb-3"),f(ue,"type","checkbox"),f(ue,"class","h-5 w-5 text-blue-500"),f(xe,"class","ml-1"),f(pe,"class","mr-2 flex items-center"),f(Ce,"class","text-sm text-gray-600"),f(W,"class","mt-4 mb-3 flex flex-wrap items-center"),ve.__value="Images Only",ve.value=ve.__value,ie.disabled=!0,ie.__value="Videos Only",ie.value=ie.__value,he.disabled=!0,he.__value="Videos and Images",he.value=he.__value,f(Se,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(Le,"class","ml-2 text-sm text-gray-600"),f(ke,"class","mb-3 mt-3 flex flex-wrap items-center"),N.disabled=!0,f(N,"type","button"),f(N,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(R,"type","button"),f(R,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(ee,oe){F(ee,t,oe),c(t,e),c(t,s),c(t,n),c(n,r),l[13](r),ht(r,l[8]),c(n,i),c(n,o),c(n,a),c(n,u),c(u,d),c(d,_),c(d,m),l[16](d),c(u,h),c(u,g),c(t,v),c(t,b),c(b,x),c(x,S),c(S,L),c(x,A),c(x,q),c(q,j),c(q,y),c(b,D),c(b,k),c(k,U),c(k,V),c(V,E),c(k,H),c(k,T),c(k,G),c(k,M),c(M,Y),c(b,ne),c(b,$),c($,te),c($,le),c(le,be),c(t,re),c(t,W),c(W,pe),c(pe,ue),ue.checked=l[9],c(pe,me),c(pe,xe),c(W,Me),c(W,Ce),c(t,Ne),c(t,ke),c(ke,Se),c(Se,ve),c(Se,ie),c(Se,he),c(ke,qe),c(ke,Le),c(t,Ee),c(t,N),l[19](N),c(t,B),c(t,R),l[20](R),X||(I=[P(r,"input",l[14]),P(r,"keydown",l[15]),P(d,"change",l[17]),P(ue,"change",l[18]),P(N,"click",l[11]),P(R,"click",l[10])],X=!0)},p(ee,[oe]){oe&256&&r.value!==ee[8]&&ht(r,ee[8]),oe&16&&_e(L,"width",(ee[4]*100).toString()+"%"),oe&16&&C!==(C=(ee[4]*100).toString().slice(0,4)+"")&&Q(j,C),oe&32&&Q(E,ee[5]),oe&128&&Q(Y,ee[7]),oe&64&&Q(be,ee[6]),oe&512&&(ue.checked=ee[9])},i:z,o:z,d(ee){ee&&O(t),l[13](null),l[16](null),l[19](null),l[20](null),X=!1,ge(I)}}}function Bl(l,t,e){let s,n,r;Oe(()=>{if(e(12,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let k="/api/getIndexStatus/"+s;e(0,n.disabled=!0,n),e(1,r.disabled=!0,r),g(k)}}),rt(()=>{h&&clearTimeout(h)});let i,o,a=0,u="",d="",_="",m="",h;async function g(k,U=0){U==0&&console.log("starting a new polll...");let E=await(await fetch(k,{method:"GET"})).json();{if(E.done==!0){let H=E.details,T=new FormData;T.append("ack","true"),(await fetch(k,{method:"POST",body:T})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert(`Indexing Completed.
Final Status: `+H);let M=await fetch("/api/getMetaStats");M=await M.json(),St.update(Y=>Number(M.image.count)),jt.update(Y=>Number(M.image.unique_people_count)),Dt.update(Y=>Number(M.image.unique_place_count)),e(1,r.disabled=!1,r),e(1,r.innerText="Start",r),e(12,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(4,a=0),e(5,u=""),e(7,_=""),e(6,d=""),e(8,m=""),e(0,n.disabled=!0,n),e(0,n.innerText="Cancel",n),e(2,i.disabled=!1,i),o&&e(3,o.value="None selected",o);return}n.innerText=="Cancel"&&e(0,n.disabled=!1,n),e(4,a=E.progress),e(7,_=E.eta),e(6,d=E.details),e(5,u=E.current_directory),h&&clearTimeout(h),h=setTimeout(function(){g(k,U+1)},1e3)}}let v=!1;async function b(){if(r&&m){e(1,r.disabled=!0,r),e(2,i.disabled=!0,i);let k=new FormData;k.append("image_directory_path",m),k.append("complete_rescan",v.toString());let E=await(await fetch("/api/indexStart",{method:"POST",body:k})).json();if(E.success===!0){e(0,n.disabled=!1,n);let T="/api/getIndexStatus/"+E.statusEndpoint;e(12,s=E.statusEndpoint),g(T)}else alert(E.reason),e(1,r.disabled=!1,r),e(2,i.disabled=!1,i)}else console.log("No index_start_button object found!!!")}async function x(){if(s){e(0,n.disabled=!0,n),e(0,n.innerText="Cancelling... Please wait.",n);let k="/api/indexCancel/"+s,U=await fetch(k,{method:"GET"});if(!U.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(U);return}else return}function S(k){Ie[k?"unshift":"push"](()=>{i=k,e(2,i)})}function L(){m=this.value,e(8,m)}const A=k=>{k.key==="Enter"&&r.click()};function q(k){Ie[k?"unshift":"push"](()=>{o=k,e(3,o)})}const C=k=>{k.target.value=="None selected"?(e(8,m=""),e(2,i.disabled=!1,i)):(e(8,m=k.target.value),e(2,i.disabled=!0,i))};function j(){v=this.checked,e(9,v)}function y(k){Ie[k?"unshift":"push"](()=>{n=k,e(0,n)})}function D(k){Ie[k?"unshift":"push"](()=>{r=k,e(1,r)})}return l.$$.update=()=>{l.$$.dirty&4096&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[n,r,i,o,a,u,d,_,m,v,b,x,s,S,L,A,q,C,j,y,D]}class Rl extends Te{constructor(t){super(),Fe(this,t,Bl,Ml,je,{})}}function Vt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=p("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Wt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),n,r,i,o=l[13]+"",a,u,d,_=s&&Xt();function m(){return l[7](l[10],l[13])}return{c(){t=p("div"),e=p("div"),_&&_.c(),r=w(),i=p("span"),a=K(o),f(e,"class",n="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(h,g){F(h,t,g),c(t,e),_&&_.m(e,null),c(t,r),c(t,i),c(i,a),u||(d=P(t,"click",m),u=!0)},p(h,g){l=h,g&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?_||(_=Xt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),g&2&&n!==(n="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",n),g&2&&o!==(o=l[13]+"")&&Q(a,o)},d(h){h&&O(t),_&&_.d(),u=!1,d()}}}function Qt(l){let t,e,s=l[10]+"",n,r,i,o,a,u,d,_,m;function h(){return l[6](l[10])}let g=l[1].selectFilters[l[10]].options,v=[];for(let b=0;b<g.length;b+=1)v[b]=Wt(Kt(l,g,b));return{c(){t=p("div"),e=p("div"),n=K(s),r=w(),i=p("i"),a=w(),u=p("div");for(let b=0;b<v.length;b+=1)v[b].c();f(i,"class",o="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(b,x){F(b,t,x),c(t,e),c(e,n),c(e,r),c(e,i),c(t,a),c(t,u);for(let S=0;S<v.length;S+=1)v[S].m(u,null);_||(m=[P(e,"click",h),P(t,"mouseup",Kl)],_=!0)},p(b,x){if(l=b,x&2&&s!==(s=l[10]+"")&&Q(n,s),x&2&&o!==(o="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(i,"class",o),x&6){g=l[1].selectFilters[l[10]].options;let S;for(S=0;S<g.length;S+=1){const L=Kt(l,g,S);v[S]?v[S].p(L,x):(v[S]=Wt(L),v[S].c(),v[S].m(u,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=g.length}x&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",d)},d(b){b&&O(t),ye(v,b),_=!1,ge(m)}}}function zl(l){let t,e,s,n,r,i,o,a,u,d,_,m,h=Object.keys(l[1].selectFilters),g=[];for(let v=0;v<h.length;v+=1)g[v]=Qt(Vt(l,h,v));return{c(){t=p("div"),e=p("div"),s=p("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',n=w(),r=p("span"),r.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w();for(let v=0;v<g.length;v+=1)g[v].c();o=w(),a=p("button"),u=K("Filter"),f(s,"class","flex items-center text-md"),f(r,"class","flex items-center text-md"),a.disabled=l[0],f(a,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(e,n),c(e,r),c(e,i);for(let x=0;x<g.length;x+=1)g[x].m(e,null);c(e,o),c(e,a),c(a,u),_||(m=P(a,"click",l[4]),_=!0)},p(v,[b]){if(b&14){h=Object.keys(v[1].selectFilters);let x;for(x=0;x<h.length;x+=1){const S=Vt(v,h,x);g[x]?g[x].p(S,b):(g[x]=Qt(S),g[x].c(),g[x].m(e,o))}for(;x<g.length;x+=1)g[x].d(1);g.length=h.length}b&1&&(a.disabled=v[0]),b&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&f(a,"class",d)},i:z,o:z,d(v){v&&O(t),ye(g,v),_=!1,m()}}}function vl(l,t,e=null,s=(n,r)=>n===r){let n=[];for(let r=0;r<l.length;r++)e?s(l[r].key,t)?n.push(1):n.push(0):s(l[r],t)?n.push(1):n.push(0);return n}function Ul(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let n=vl(l,t[s]);for(let r=0;r<e.length;r++)e[r]=Number(Boolean(e[r])||Boolean(n[r]))}return e}function Gl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let n=vl(l,t[s],null,(r,i)=>r?r.includes(i):!1);for(let r=0;r<e.length;r++)e[r]=Number(Boolean(e[r])||Boolean(n[r]))}return e}function Vl(l){let t=l[0].length,e=l[0];return l.forEach((s,n)=>{if(n>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((r,i)=>{e[i]=Number(Boolean(e[i])&&Boolean(r))})}}),e}const Kl=l=>l.stopPropagation();function Xl(l,t,e){let s=[],{filter_button_disabled:n=!0}=t;_t.subscribe(h=>{e(0,n=!1),e(5,s=h)});const r=mt(),i={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Oe(()=>{document.addEventListener("mouseup",o)});function o(h){e(1,i.selectFilterActive="",i)}function a(h,g){if(i.selectFilters[h].values.includes(g)){e(1,i.selectFilters[h].values=i.selectFilters[h].values.filter(v=>v!==g),i);return}e(1,i.selectFilters[h].values=[g,...i.selectFilters[h].values],i)}function u(h){if(i.selectFilterActive===h){e(1,i.selectFilterActive="",i);return}e(1,i.selectFilterActive=h,i)}function d(){if(s){console.log(s);let h=[],g=[];s.map((A,q)=>{h.push(A.place),g.push(A.person)});let v=i.selectFilters.place.values,b=Ul(h,v),x=i.selectFilters.people.values,S=Gl(g,x),L=Vl([b,S]);r("filterApplied",{mask:L})}}const _=h=>u(h),m=(h,g)=>a(h,g);return l.$$set=h=>{"filter_button_disabled"in h&&e(0,n=h.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){console.log("take this!!"),console.log(s);let h=s.map((x,S)=>{if(x.place)return x.place}),g=[];s.map((x,S)=>{x.person&&console.log(x.person),x.person.forEach(L=>g.push(L))});let v=[];new Set(h).forEach(x=>v.push(x));let b=[];new Set(g).forEach(x=>b.push(x)),e(1,i.selectFilters.place.values=v,i),e(1,i.selectFilters.place.options=v,i),e(1,i.selectFilters.people.values=b,i),e(1,i.selectFilters.people.options=b,i)}},[n,i,a,u,d,s,_,m]}class Wl extends Te{constructor(t){super(),Fe(this,t,Xl,zl,je,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[57]=t[e],s[56]=e,s}function Yt(l,t,e){const s=l.slice();return s[54]=t[e],s[56]=e,s}function Ql(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S,L,A,q=l[1]&&Zt(l);e=new Wl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[44]);let C=l[6],j=[];for(let D=0;D<C.length;D+=1)j[D]=el(Jt(l,C,D));let y=l[6].length>=Pe&&tl(l);return{c(){q&&q.c(),t=w(),de(e.$$.fragment),s=w(),n=p("div"),r=p("div"),i=p("div"),o=p("div"),a=p("div"),u=p("input"),d=w(),_=p("label"),m=K("Score threshold: "),h=K(l[13]),g=K("."),v=w(),b=p("div");for(let D=0;D<j.length;D+=1)j[D].c();x=w(),y&&y.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(_,"for","topk"),f(_,"class","dark:text-white"),f(a,"class","my-2"),f(i,"class","flex flex-row place-content-center mb-2 select-none mx-2"),f(b,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),f(r,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),f(n,"class","flex")},m(D,k){q&&q.m(D,k),F(D,t,k),ae(e,D,k),F(D,s,k),F(D,n,k),c(n,r),c(r,i),c(i,o),c(o,a),c(a,u),ht(u,l[13]),c(a,d),c(a,_),c(_,m),c(_,h),c(_,g),c(r,v),c(r,b);for(let U=0;U<j.length;U+=1)j[U].m(b,null);c(r,x),y&&y.m(r,null),S=!0,L||(A=[P(u,"change",l[20]),P(u,"change",l[45]),P(u,"input",l[45])],L=!0)},p(D,k){D[1]?q?q.p(D,k):(q=Zt(D),q.c(),q.m(t.parentNode,t)):q&&(q.d(1),q=null);const U={};if(k[0]&8&&(U.filter_button_disabled=D[3]),e.$set(U),k[0]&8192&&ht(u,D[13]),(!S||k[0]&8192)&&Q(h,D[13]),k[0]&67305537){C=D[6];let V;for(V=0;V<C.length;V+=1){const E=Jt(D,C,V);j[V]?j[V].p(E,k):(j[V]=el(E),j[V].c(),j[V].m(b,null))}for(;V<j.length;V+=1)j[V].d(1);j.length=C.length}D[6].length>=Pe?y?y.p(D,k):(y=tl(D),y.c(),y.m(r,null)):y&&(y.d(1),y=null)},i(D){S||(J(e.$$.fragment,D),S=!0)},o(D){Z(e.$$.fragment,D),S=!1},d(D){q&&q.d(D),D&&O(t),ce(e,D),D&&O(s),D&&O(n),ye(j,D),y&&y.d(),L=!1,ge(A)}}}function Jl(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S,L,A,q,C=l[2].image_card_edit_interface&&ll(l),j=l[5]&&sl(l);return{c(){t=p("div"),e=p("div"),s=p("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,n=w(),r=p("div"),r.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',i=w(),o=p("div"),a=p("div"),a.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=w(),d=p("div"),_=p("div"),m=p("img"),g=w(),v=p("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=w(),C&&C.c(),x=w(),S=p("div"),S.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',L=w(),j&&j.c(),f(s,"class","cursor-pointer hover:underline text-gray-200"),f(r,"title","Fullscreen"),f(r,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(a,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(m,"class","w-auto cursor-pointer h-full"),De(m.src,h="/api/getRawData/"+l[4].data_hash)||f(m,"src",h),f(m,"alt",""),f(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(_,"class","flex shrink h-full"),f(d,"class","flex h-full items-center justify-center p-2 gap-4"),f(S,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(o,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(y,D){F(y,t,D),c(t,e),c(e,s),c(e,n),c(e,r),c(t,i),c(t,o),c(o,a),c(o,u),c(o,d),c(d,_),c(_,m),c(_,g),c(_,v),c(d,b),C&&C.m(d,null),c(o,x),c(o,S),c(t,L),j&&j.m(t,null),A||(q=[P(s,"click",l[36]),P(r,"click",l[37]),P(a,"click",l[38]),P(m,"click",l[39]),P(v,"click",l[40]),P(S,"click",l[42])],A=!0)},p(y,D){D[0]&16&&!De(m.src,h="/api/getRawData/"+y[4].data_hash)&&f(m,"src",h),y[2].image_card_edit_interface?C?C.p(y,D):(C=ll(y),C.c(),C.m(d,null)):C&&(C.d(1),C=null),y[5]?j?j.p(y,D):(j=sl(y),j.c(),j.m(t,null)):j&&(j.d(1),j=null)},i:z,o:z,d(y){y&&O(t),C&&C.d(),j&&j.d(),A=!1,ge(q)}}}function Yl(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S,L,A=l[12]==!1&&nl(),q=l[10],C=[];for(let y=0;y<q.length;y+=1)C[y]=rl(Yt(l,q,y));let j=l[9].active&&il(l);return{c(){t=p("div"),e=p("div"),s=p("img"),r=w(),A&&A.c(),i=w();for(let y=0;y<C.length;y+=1)C[y].c();o=w(),j&&j.c(),a=w(),u=p("div"),d=p("div"),d.innerHTML='<i class="fa fa-arrow-left"></i>',_=w(),m=p("div"),m.innerHTML='<i class="fa fa-arrow-right"></i>',h=w(),g=p("div"),v=p("div"),v.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),x=p("div"),x.innerHTML='<i class="fa fa-arrows-alt"></i>',f(s,"id","content_full_screen"),f(s,"class","object-cover h-auto w-auto max-h-screen"),De(s.src,n="/api/getRawDataFull/"+l[4].data_hash)||f(s,"src",n),f(s,"alt",""),f(e,"class","relative flex"),f(d,"class","text-white cursor-pointer"),f(m,"class","text-white cursor-pointer"),f(u,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(v,"class","cursor-pointer hover:underline text-white"),f(x,"title","Fullscreen"),f(x,"class","cursor-pointer text-white"),f(g,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(y,D){F(y,t,D),c(t,e),c(e,s),c(e,r),A&&A.m(e,null),c(e,i);for(let k=0;k<C.length;k+=1)C[k].m(e,null);c(e,o),j&&j.m(e,null),c(t,a),c(t,u),c(u,d),c(u,_),c(u,m),F(y,h,D),F(y,g,D),c(g,v),c(g,b),c(g,x),S||(L=[P(s,"load",l[29]),P(d,"click",l[32]),P(m,"click",l[33]),P(v,"click",l[34]),P(x,"click",l[35])],S=!0)},p(y,D){if(D[0]&16&&!De(s.src,n="/api/getRawDataFull/"+y[4].data_hash)&&f(s,"src",n),y[12]==!1?A||(A=nl(),A.c(),A.m(e,i)):A&&(A.d(1),A=null),D[0]&1792){q=y[10];let k;for(k=0;k<q.length;k+=1){const U=Yt(y,q,k);C[k]?C[k].p(U,D):(C[k]=rl(U),C[k].c(),C[k].m(e,o))}for(;k<C.length;k+=1)C[k].d(1);C.length=q.length}y[9].active?j?j.p(y,D):(j=il(y),j.c(),j.m(e,null)):j&&(j.d(1),j=null)},i:z,o:z,d(y){y&&O(t),A&&A.d(),ye(C,y),j&&j.d(),y&&O(h),y&&O(g),S=!1,ge(L)}}}function Zt(l){let t,e,s,n,r;return{c(){t=p("div"),e=p("div"),s=p("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(s,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(i,o){F(i,t,o),c(t,e),c(e,s),n||(r=P(s,"click",l[43]),n=!0)},p:z,d(i){i&&O(t),n=!1,r()}}}function $t(l){let t,e,s,n,r,i;function o(){return l[46](l[56])}return{c(){t=p("div"),e=p("img"),n=w(),f(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),De(e.src,s="api/getRawData/"+l[0].list_dataHash[l[57].ix])||f(e,"src",s),f(e,"alt","image"),f(t,"class","flex justify-center bg-black")},m(a,u){F(a,t,u),c(t,e),c(t,n),r||(i=[P(e,"load",l[26]),P(t,"click",o)],r=!0)},p(a,u){l=a,u[0]&65&&!De(e.src,s="api/getRawData/"+l[0].list_dataHash[l[57].ix])&&f(e,"src",s)},d(a){a&&O(t),r=!1,ge(i)}}}function el(l){let t,e=l[57].ix>=0&&$t(l);return{c(){e&&e.c(),t=He()},m(s,n){e&&e.m(s,n),F(s,t,n)},p(s,n){s[57].ix>=0?e?e.p(s,n):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function tl(l){let t,e,s,n;return{c(){t=p("div"),e=p("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),f(t,"class","flex items-center justify-center")},m(r,i){F(r,t,i),c(t,e),s||(n=P(e,"click",l[15]),s=!0)},p:z,d(r){r&&O(t),s=!1,n()}}}function ll(l){let t,e,s,n,r,i,o,a,u,d,_,m,h,g,v,b,x,S,L,A,q,C,j,y,D,k,U,V,E,H,T,G,M,Y,ne,$,te,le,be;return{c(){t=p("div"),e=p("div"),s=p("div"),s.textContent="Info",n=w(),r=p("div"),r.textContent="X",i=w(),o=p("div"),a=p("div"),a.textContent="Description",u=w(),d=p("input"),m=w(),h=p("div"),g=p("div"),g.textContent="place",v=w(),b=p("input"),S=w(),L=p("div"),A=p("div"),A.textContent="Tags",q=w(),C=p("input"),y=w(),D=p("div"),k=p("div"),k.textContent="Taken at:",U=w(),V=p("input"),E=w(),H=p("div"),T=p("div"),T.textContent="device",G=w(),M=p("input"),ne=w(),$=p("div"),te=p("button"),te.textContent="Save",f(s,"class","grow text-xl text-gray-100 font-bold"),f(r,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(a,"class","mb-1 text-gray-100"),f(d,"name","Description"),f(d,"placeholder",""),d.value=_=l[4].description.toString(),f(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(d,"type","text"),f(g,"class","mb-1 text-gray-100"),f(b,"name","place"),b.value=x=l[4].place.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(A,"class","mb-1 text-gray-100"),f(C,"name","tags"),f(C,"placeholder","Car, chair"),C.value=j=l[4].tags.toString(),f(C,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(C,"type","text"),f(k,"class","mb-1 text-gray-100"),f(V,"name","taken_at"),V.value="",f(V,"type","date"),f(V,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(T,"class","mb-1 text-gray-100"),f(M,"name","device"),f(M,"placeholder","Canon"),M.value=Y=l[4].device.toString(),f(M,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(M,"type","text"),f(te,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(re,W){F(re,t,W),c(t,e),c(e,s),c(e,n),c(e,r),c(t,i),c(t,o),c(o,a),c(o,u),c(o,d),c(t,m),c(t,h),c(h,g),c(h,v),c(h,b),c(t,S),c(t,L),c(L,A),c(L,q),c(L,C),c(t,y),c(t,D),c(D,k),c(D,U),c(D,V),c(t,E),c(t,H),c(H,T),c(H,G),c(H,M),c(t,ne),c(t,$),c($,te),le||(be=[P(r,"click",l[41]),P(d,"change",l[23]),P(b,"change",l[23]),P(C,"change",l[23]),P(V,"change",l[23]),P(M,"change",l[23]),P(te,"click",l[24])],le=!0)},p(re,W){W[0]&16&&_!==(_=re[4].description.toString())&&d.value!==_&&(d.value=_),W[0]&16&&x!==(x=re[4].place.toString())&&b.value!==x&&(b.value=x),W[0]&16&&j!==(j=re[4].tags.toString())&&C.value!==j&&(C.value=j),W[0]&16&&Y!==(Y=re[4].device.toString())&&M.value!==Y&&(M.value=Y)},d(re){re&&O(t),le=!1,ge(be)}}}function sl(l){let t,e,s,n,r=l[4].filename+"",i,o,a,u,d,_=l[4].data_hash+"",m,h,g,v,b,x=l[4].last_modified+"",S,L,A,q,C,j,y,D,k,U=l[4].description.toString()+"",V,E,H,T,G,M,Y=l[4].taken_at.toString()+"",ne,$,te,le,be,re,W=l[4].tags.toString()+"",pe,ue,me,xe,Me,Ce,Ne=l[4].place.toString()+"",ke,Se,ve,ie,he,qe,Le,Ee,N=l[4].person_ids.toString()+"",B,R,X,I,ee,oe,We=l[4].device.toString()+"",tt,at,Be,Re,Ae,we,ze=l[4].resolution.toString()+"",Qe,ct,Ue,Je,lt,Ge,ut=l[4].absolute_path.toString()+"",vt;return{c(){t=p("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=p("div"),n=p("div"),i=K(r),o=w(),a=p("div"),u=K("UID: "),d=p("span"),m=K(_),h=w(),g=p("div"),v=K("Last Modified:  "),b=p("span"),S=K(x),L=w(),A=p("div"),q=p("div"),C=p("div"),j=p("div"),y=p("div"),y.textContent="Description",D=w(),k=p("div"),V=K(U),E=w(),H=p("div"),T=p("div"),T.textContent="Taken at",G=w(),M=p("div"),ne=K(Y),$=w(),te=p("div"),le=p("div"),le.textContent="Tags",be=w(),re=p("div"),pe=K(W),ue=w(),me=p("div"),xe=p("div"),xe.textContent="Place",Me=w(),Ce=p("div"),ke=K(Ne),Se=w(),ve=p("div"),ie=p("div"),he=p("div"),qe=p("div"),qe.textContent="people",Le=w(),Ee=p("div"),B=K(N),R=w(),X=p("div"),I=p("div"),I.textContent="Device",ee=w(),oe=p("div"),tt=K(We),at=w(),Be=p("div"),Re=p("div"),Re.textContent="Resolution",Ae=w(),we=p("div"),Qe=K(ze),ct=w(),Ue=p("div"),Je=p("div"),Je.textContent="Path",lt=w(),Ge=p("div"),vt=K(ut),f(n,"class","text-xl text-white"),f(d,"class","text-sm text-gray-400"),f(a,"class","text-white"),f(b,"class","text-sm text-gray-400"),f(g,"class","text-white"),f(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(y,"class",""),f(k,"class","text-sm text-gray-400"),f(T,"class",""),f(M,"class","text-sm text-gray-400"),f(le,"class",""),f(re,"class","text-sm text-gray-400"),f(xe,"class",""),f(Ce,"class","text-sm text-gray-400"),f(C,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(q,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(qe,"class",""),f(Ee,"class","text-sm text-gray-400"),f(I,"class",""),f(oe,"class","text-sm text-gray-400"),f(Re,"class",""),f(we,"class","text-sm text-gray-400"),f(Je,"class",""),f(Ge,"class","text-sm text-gray-400"),f(ie,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(ve,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(A,"class","flex w-full justify-center p-4")},m(se,fe){F(se,t,fe),F(se,e,fe),F(se,s,fe),c(s,n),c(n,i),c(s,o),c(s,a),c(a,u),c(a,d),c(d,m),c(s,h),c(s,g),c(g,v),c(g,b),c(b,S),F(se,L,fe),F(se,A,fe),c(A,q),c(q,C),c(C,j),c(j,y),c(j,D),c(j,k),c(k,V),c(C,E),c(C,H),c(H,T),c(H,G),c(H,M),c(M,ne),c(C,$),c(C,te),c(te,le),c(te,be),c(te,re),c(re,pe),c(C,ue),c(C,me),c(me,xe),c(me,Me),c(me,Ce),c(Ce,ke),c(A,Se),c(A,ve),c(ve,ie),c(ie,he),c(he,qe),c(he,Le),c(he,Ee),c(Ee,B),c(ie,R),c(ie,X),c(X,I),c(X,ee),c(X,oe),c(oe,tt),c(ie,at),c(ie,Be),c(Be,Re),c(Be,Ae),c(Be,we),c(we,Qe),c(ie,ct),c(ie,Ue),c(Ue,Je),c(Ue,lt),c(Ue,Ge),c(Ge,vt)},p(se,fe){fe[0]&16&&r!==(r=se[4].filename+"")&&Q(i,r),fe[0]&16&&_!==(_=se[4].data_hash+"")&&Q(m,_),fe[0]&16&&x!==(x=se[4].last_modified+"")&&Q(S,x),fe[0]&16&&U!==(U=se[4].description.toString()+"")&&Q(V,U),fe[0]&16&&Y!==(Y=se[4].taken_at.toString()+"")&&Q(ne,Y),fe[0]&16&&W!==(W=se[4].tags.toString()+"")&&Q(pe,W),fe[0]&16&&Ne!==(Ne=se[4].place.toString()+"")&&Q(ke,Ne),fe[0]&16&&N!==(N=se[4].person_ids.toString()+"")&&Q(B,N),fe[0]&16&&We!==(We=se[4].device.toString()+"")&&Q(tt,We),fe[0]&16&&ze!==(ze=se[4].resolution.toString()+"")&&Q(Qe,ze),fe[0]&16&&ut!==(ut=se[4].absolute_path.toString()+"")&&Q(vt,ut)},d(se){se&&O(t),se&&O(e),se&&O(s),se&&O(L),se&&O(A)}}}function nl(l){let t,e,s;return{c(){t=p("img"),e=w(),s=wl("svg"),f(t,"class","object-cover h-screen w-full bg-black absolute top-0 left-0"),f(t,"alt",""),f(s,"class","animate-spin h-5 w-5 mr-3 bg-indigo-500 top-10 left-50 absolute"),f(s,"viewBox","0 0 24 24")},m(n,r){F(n,t,r),F(n,e,r),F(n,s,r)},d(n){n&&O(t),n&&O(e),n&&O(s)}}}function rl(l){let t,e,s;function n(...r){return l[30](l[54],...r)}return{c(){t=p("div"),f(t,"data-ix",l[56]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),_e(t,"top",l[54].top+"px "),_e(t,"left",l[54].left+"px"),_e(t,"width",l[54].width+"px"),_e(t,"height",l[54].height+"px")},m(r,i){F(r,t,i),e||(s=P(t,"click",n),e=!0)},p(r,i){l=r,i[0]&1024&&_e(t,"top",l[54].top+"px "),i[0]&1024&&_e(t,"left",l[54].left+"px"),i[0]&1024&&_e(t,"width",l[54].width+"px"),i[0]&1024&&_e(t,"height",l[54].height+"px")},d(r){r&&O(t),e=!1,s()}}}function il(l){let t,e,s,n,r,i,o;return{c(){t=p("div"),e=p("input"),n=w(),r=p("div"),r.textContent="X",e.autofocus=!0,e.value=s=l[11][l[8]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(r,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),_e(t,"top",l[9].top+"px "),_e(t,"left",l[9].left+"px")},m(a,u){F(a,t,u),c(t,e),c(t,n),c(t,r),e.focus(),i||(o=[P(e,"keyup",l[22]),P(r,"click",l[31])],i=!0)},p(a,u){u[0]&2304&&s!==(s=a[11][a[8]])&&e.value!==s&&(e.value=s),u[0]&512&&_e(t,"top",a[9].top+"px "),u[0]&512&&_e(t,"left",a[9].left+"px")},d(a){a&&O(t),i=!1,ge(o)}}}function Zl(l){let t,e,s,n,r,i;const o=[Yl,Jl,Ql],a=[];function u(d,_){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=u(l),e=a[t]=o[t](l),{c(){e.c(),s=w(),n=p("div"),r=p("div"),f(r,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),_e(r,"width",(l[7]*100).toString()+"%"),f(n,"class","flex animate-pulse")},m(d,_){a[t].m(d,_),F(d,s,_),F(d,n,_),c(n,r),i=!0},p(d,_){let m=t;t=u(d),t===m?a[t].p(d,_):(it(),Z(a[m],1,1,()=>{a[m]=null}),ot(),e=a[t],e?e.p(d,_):(e=a[t]=o[t](d),e.c()),J(e,1),e.m(s.parentNode,s)),(!i||_[0]&128)&&_e(r,"width",(d[7]*100).toString()+"%")},i(d){i||(J(e),i=!0)},o(d){Z(e),i=!1},d(d){a[t].d(d),d&&O(s),d&&O(n)}}}let Pe=18;function wt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let n=0;n<l.length;n++){let r=n;t[n%t.length]!==1&&(r=-1),e?s.push({ix:r,score:l[n][e]}):s.push({ix:r,score:l[n]})}return s.sort((n,r)=>n.score>r.score?-1:n.score<r.score?1:0),s}function $l(l,t,e){window.onresize=function(){if(S&&S.image_card_fullscreen==!0){let N=document.getElementById("content_full_screen");te(N)}};const s=mt();let{show_exit_interface_button:n=!1}=t,{image_data:r={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,i=!0;rt(()=>{e(0,r={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),_t.update(N=>[])});let o={},a=!1,u=[],d=[],_=0,m=0,h=0,g=!1;function v(N){g!=!0&&(g=!0,m=0,e(7,h=0),e(28,_=_+Pe),e(6,u=d.slice(_,_+Pe)),_t.update(B=>b(u)))}function b(N){let B=[],R=N.length;for(let X=0;X<R;X++){let I=N[X].ix;B.push(r.list_metaData[I])}return B}Ke.subscribe(N=>{e(7,h=N.progress),N.done==!0?(x(N),e(7,h=0)):(e(28,_=0),e(6,u=[]))});function x(N){e(27,d=wt(N.list_score)),e(6,u=d.slice(0,0+Pe)),_t.update(B=>b(u))}let S={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function L(N){let B=Object.keys(S);for(let R=0;R<B.length;R++)e(2,S[B[R]]=!1,S);e(2,S[N]=!0,S)}let A,q={active:!1,top:null,left:null};function C(N){let B={sorted_ix:null,image_ix:null};for(let R=N;R<u.length;R++)if(u[R].ix!==-1){B.image_ix=u[R].ix,B.sorted_ix=R;break}return B}let j;function y(N){Y={},e(5,a=!1),e(10,U=[]),e(9,q={active:!1,top:null,left:null});let B=N,R=u.length;B<0&&(B=R-1),B>R-1&&(B=0);let X=C(B),I=X.image_ix;B=X.sorted_ix,I===null&&(X=C(0),I=X.image_ix,B=X.sorted_ix),e(4,o.ix=B,o),e(4,o.data_hash=r.list_dataHash[I],o),S.image_card_fullscreen===!0&&(j=setTimeout(()=>{e(12,E=!1),console.log("set timeout...")},400)),e(4,o.height=Number(r.list_metaData[I].height),o),e(4,o.width=Number(r.list_metaData[I].width),o),e(4,o.face_bboxes=r.list_metaData[I].face_bboxes,o),e(4,o.person_ids=r.list_metaData[I].person,o),o.person_ids===null&&e(4,o.person_ids=[],o),e(4,o.resolution=o.height.toString()+" X "+o.width.toString(),o),e(4,o.filename=r.list_metaData[I].filename,o),e(4,o.taken_at=r.list_metaData[I].taken_at,o),o.taken_at==null&&e(4,o.taken_at="Unknown",o),e(4,o.last_modified=r.list_metaData[I].modified_at,o),e(4,o.device=r.list_metaData[I].device,o),o.device==null&&e(4,o.device="",o),e(4,o.place=r.list_metaData[I].place,o),e(4,o.absolute_path=r.list_metaData[I].absolute_path,o),e(4,o.description=r.list_metaData[I].description,o),e(4,o.tags=r.list_metaData[I].tags,o),e(5,a=!0)}function D(){y(o.ix+1)}function k(){y(o.ix-1)}let U=[],V=[],E=!0,H=0;function T(){let N=u[0].score,B=u[u.length-1].score,X=r.list_score.map(I=>(I-B)/(N-B+1e-5)).map(I=>I>=H?1:0);e(6,u=wt(r.list_score,X))}function G(N){e(3,i=!0);let B=d.slice(_,_+Pe);for(let R=0;R<N.length;R++)N[R]==0?e(6,u[R].ix=-1,u):e(6,u[R].ix=B[R].ix,u);e(3,i=!1)}function M(N){let B=N.target.value,R=o.data_hash,X=V[A];if(N.key=="Enter"){let I=new FormData;I.append("new_person_id",B),I.append("old_person_id",X),I.append("data_hash",R),fetch("/api/tagPerson",{method:"POST",body:I}).then(ee=>{if(ee.ok)ee.json().then(oe=>{oe.success==!0?alert("Success"):alert(oe.reason)});else throw new Error("Error occured")})}}let Y={};function ne(N){Y[N.target.name.toLowerCase()]=N.target.value}async function $(N){N.target.disabled=!0,N.target.innerText="Saving...";let B=Object.keys(Y),R=new FormData;for(let I=0;I<B.length;I++)R.append(B[I],Y[B[I]]);R.append("data_hash",o.data_hash);let X=await fetch("/api/editMetaData",{method:"POST",body:R});X.ok?(alert("Success!"),await X.json(),e(2,S.image_card_edit_interface=!1,S)):alert("Error while saving. Contact Admin"),N.target.innerText="Save",N.target.disabled=!1}function te(N){let B="/api/getfaceBboxIdMapping/"+o.data_hash,R=new FormData,X="";for(let I=0;I<o.person_ids.length;I++)X=X+o.person_ids[I],X=X+"|";R.append("cluster_ids",X),fetch(B,{method:"POST",body:R}).then(I=>{I.ok==!0&&I.json().then(ee=>{let oe=N.getClientRects()[0],We=oe.width,tt=oe.height,at=o.width,Be=o.height,Re=[];e(11,V=[]);for(let we=0;we<ee.length;we++){let ze=Number(ee[we].x1),Qe=Number(ee[we].y1),ct=Number(ee[we].x2),Ue=Number(ee[we].y2),Je=ee[we].person_id,lt=Number(We)/(Number(at)+1e-4),Ge=Number(tt)/(Number(Be)+1e-4);var Ae={};Ae.top=Qe*Ge,Ae.height=(Ue-Qe)*Ge,Ae.left=ze*lt,Ae.width=(ct-ze)*lt,Re.push(Ae),V.push(Je)}e(10,U=Re),j&&clearTimeout(j),e(12,E=!0)})})}function le(N){g&&(m+=1,e(7,h+=1/Pe),m==Math.min(u.length,Pe)&&(e(7,h=0),g=!1))}const be=N=>te(N.target),re=(N,B)=>{e(9,q={active:!0,top:N.top-28,left:N.left}),e(8,A=Number(B.target.attributes["data-ix"].value))},W=()=>{e(9,q.active=!1,q)},pe=()=>{k()},ue=()=>{D()},me=()=>{L("parent")},xe=()=>{L("image_card")},Me=()=>{L("parent")},Ce=()=>{L("image_card_fullscreen")},Ne=()=>{k()},ke=()=>{console.log("hellll"),L("image_card_fullscreen")},Se=()=>{e(2,S.image_card_edit_interface=!0,S)},ve=()=>{e(2,S.image_card_edit_interface=!1,S)},ie=()=>{D()},he=()=>{console.log("pressed me!!!"),e(6,u=[]),s("exitButtonPressed")},qe=N=>{G(N.detail.mask)};function Le(){H=yl(this.value),e(13,H)}const Ee=N=>{y(N),L("image_card")};return l.$$set=N=>{"show_exit_interface_button"in N&&e(1,n=N.show_exit_interface_button),"image_data"in N&&e(0,r=N.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&402653185&&r&&(e(27,d=wt(r.list_score)),r.done==!1&&e(6,u=d.slice(_,_+Pe))),l.$$.dirty[0]&4&&S){let N=!1;(S.image_card==!0||S.image_card_fullscreen==!0)&&(N=!0),s("imageCardActive",{active:N})}},[r,n,S,i,o,a,u,h,A,q,U,V,E,H,s,v,L,y,D,k,T,G,M,ne,$,te,le,d,_,be,re,W,pe,ue,me,xe,Me,Ce,Ne,ke,Se,ve,ie,he,qe,Le,Ee]}class bt extends Te{constructor(t){super(),Fe(this,t,$l,Zl,je,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const es="/assets/sample_place_bg-38f3fbd4.jpg";function ol(l,t,e){const s=l.slice();return s[9]=t[e],s}function ts(l){let t,e,s,n,r,i,o,a,u,d,_,m=l[0].people,h=[];for(let g=0;g<m.length;g+=1)h[g]=al(ol(l,m,g));return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("div"),r=p("div"),r.textContent="People Album",i=w(),o=p("div"),a=p("input"),u=w();for(let g=0;g<h.length;g+=1)h[g].c();f(r,"class","flex text-lg font-semibold"),f(a,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(a,"type","text"),f(a,"placeholder","Search person"),f(o,"class","flex"),f(n,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(g,v){F(g,t,v),c(t,e),c(e,s),c(s,n),c(n,r),c(n,i),c(n,o),c(o,a),c(e,u);for(let b=0;b<h.length;b+=1)h[b].m(e,null);d||(_=P(a,"input",l[5]),d=!0)},p(g,v){if(v&17){m=g[0].people;let b;for(b=0;b<m.length;b+=1){const x=ol(g,m,b);h[b]?h[b].p(x,v):(h[b]=al(x),h[b].c(),h[b].m(e,null))}for(;b<h.length;b+=1)h[b].d(1);h.length=m.length}},i:z,o:z,d(g){g&&O(t),ye(h,g),d=!1,_()}}}function ls(l){let t,e;return t=new bt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){de(t.$$.fragment)},m(s,n){ae(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ce(t,s)}}}function ss(l){let t;return{c(){t=p("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function al(l){let t,e,s,n,r,i,o,a=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"",u,d,_,m;function h(...g){return l[7](l[9],...g)}return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("img"),i=w(),o=p("div"),u=K(a),d=w(),f(n,"loading","lazy"),De(n.src,r="/api/getPreviewPerson/"+l[9])||f(n,"src",r),f(n,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[160px] w-[160px] bg-gray-800"),f(o,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(g,v){F(g,t,v),c(t,e),c(e,s),c(s,n),c(e,i),c(e,o),c(o,u),c(t,d),_||(m=P(t,"click",h),_=!0)},p(g,v){l=g,v&1&&!De(n.src,r="/api/getPreviewPerson/"+l[9])&&f(n,"src",r),v&1&&a!==(a=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"")&&Q(u,a)},d(g){g&&O(t),_=!1,m()}}}function ns(l){let t,e,s,n;const r=[ss,ls,ts],i=[];function o(a,u){return a[3]===!1?0:a[2]?1:2}return t=o(l),e=i[t]=r[t](l),{c(){e.c(),s=He()},m(a,u){i[t].m(a,u),F(a,s,u),n=!0},p(a,[u]){let d=t;t=o(a),t===d?i[t].p(a,u):(it(),Z(i[d],1,1,()=>{i[d]=null}),ot(),e=i[t],e?e.p(a,u):(e=i[t]=r[t](a),e.c()),J(e,1),e.m(s.parentNode,s))},i(a){n||(J(e),n=!0)},o(a){Z(e),n=!1},d(a){i[t].d(a),a&&O(s)}}}function rs(l,t,e){let s={people:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,i=!0,o;Oe(()=>{e(3,i=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{e(0,s.people=h,s),o=h,e(3,i=!0)})})}),rt(()=>{console.log("destroying... people..")});function a(m){fetch("/api/getMeta/person/"+m.toString()).then(h=>{h.json().then(g=>{e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});let v=g.data_hash.length;for(let b=0;b<v;b++)n.list_metaData.push(g.meta_data[b]),n.list_dataHash.push(g.data_hash[b]),n.list_score.push(g.score[b]);e(1,n.done=!0,n),e(2,r=!0),o&&e(0,s.people=o,s),Ke.update(b=>structuredClone(n))})})}function u(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.people=o,s);return}h&&i==!0&&o&&(e(0,s.people=[],s),o.forEach(g=>{g.toLowerCase().includes(h)&&s.people.push(g)}))}return[s,n,r,i,a,u,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,h)=>{console.log("mine is: ",m),a(m)}]}class is extends Te{constructor(t){super(),Fe(this,t,rs,ns,je,{})}}function cl(l,t,e){const s=l.slice();return s[7]=t[e],s}function os(l){let t,e,s,n=l[0].places,r=[];for(let i=0;i<n.length;i+=1)r[i]=ul(cl(l,n,i));return{c(){t=p("div"),e=w(),s=p("div");for(let i=0;i<r.length;i+=1)r[i].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(i,o){F(i,t,o),F(i,e,o),F(i,s,o);for(let a=0;a<r.length;a+=1)r[a].m(s,null)},p(i,o){if(o&17){n=i[0].places;let a;for(a=0;a<n.length;a+=1){const u=cl(i,n,a);r[a]?r[a].p(u,o):(r[a]=ul(u),r[a].c(),r[a].m(s,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},i:z,o:z,d(i){i&&O(t),i&&O(e),i&&O(s),ye(r,i)}}}function as(l){let t,e;return t=new bt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){de(t.$$.fragment)},m(s,n){ae(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ce(t,s)}}}function cs(l){let t;return{c(){t=p("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function ul(l){let t,e,s,n,r,i,o,a=l[7].slice(0,1).toUpperCase()+l[7].slice(1).toLowerCase()+"",u,d,_,m;function h(...g){return l[6](l[7],...g)}return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("img"),i=w(),o=p("div"),u=K(a),d=w(),De(n.src,r=es)||f(n,"src",r),f(n,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[150px] w-[200px] bg-gray-800"),f(o,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(g,v){F(g,t,v),c(t,e),c(e,s),c(s,n),c(e,i),c(e,o),c(o,u),c(t,d),_||(m=P(t,"click",h),_=!0)},p(g,v){l=g,v&1&&a!==(a=l[7].slice(0,1).toUpperCase()+l[7].slice(1).toLowerCase()+"")&&Q(u,a)},d(g){g&&O(t),_=!1,m()}}}function us(l){let t,e,s,n;const r=[cs,as,os],i=[];function o(a,u){return a[3]===!1?0:a[2]?1:2}return t=o(l),e=i[t]=r[t](l),{c(){e.c(),s=He()},m(a,u){i[t].m(a,u),F(a,s,u),n=!0},p(a,[u]){let d=t;t=o(a),t===d?i[t].p(a,u):(it(),Z(i[d],1,1,()=>{i[d]=null}),ot(),e=i[t],e?e.p(a,u):(e=i[t]=r[t](a),e.c()),J(e,1),e.m(s.parentNode,s))},i(a){n||(J(e),n=!0)},o(a){Z(e),n=!1},d(a){i[t].d(a),a&&O(s)}}}function fs(l,t,e){let s={places:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,i=!0;Oe(()=>{fetch("/api/getGroup/place").then(d=>{d.json().then(_=>{e(0,s.places=_,s),e(3,i=!0)})})}),rt(()=>{console.log("destroying...")});function o(d){fetch("/api/getMeta/place/"+d.toString()).then(_=>{_.json().then(m=>{e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});let h=m.data_hash.length;console.log(h);for(let g=0;g<h;g++)console.log("pushing tooooooo"),n.list_metaData.push(m.meta_data[g]),n.list_dataHash.push(m.data_hash[g]),n.list_score.push(m.score[g]);e(1,n.done=!0,n),e(2,r=!0),Ke.update(g=>structuredClone(n))})})}return[s,n,r,i,o,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(d,_)=>{console.log("mine is: ",d),o(d)}]}class ds extends Te{constructor(t){super(),Fe(this,t,fs,us,je,{})}}const ps="/assets/folder-regular-1127ab6b.svg";function fl(l,t,e){const s=l.slice();return s[10]=t[e],s}function _s(l){let t,e,s,n,r,i,o,a,u,d,_,m=l[0].local_directories,h=[];for(let g=0;g<m.length;g+=1)h[g]=dl(fl(l,m,g));return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("div"),r=p("div"),r.textContent="Local Resources",i=w(),o=p("div"),a=p("input"),u=w();for(let g=0;g<h.length;g+=1)h[g].c();f(r,"class","flex text-lg font-semibold"),f(a,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(a,"type","text"),f(a,"placeholder","Search directory"),f(o,"class","flex"),f(n,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(g,v){F(g,t,v),c(t,e),c(e,s),c(s,n),c(n,r),c(n,i),c(n,o),c(o,a),c(e,u);for(let b=0;b<h.length;b+=1)h[b].m(e,null);d||(_=P(a,"input",l[5]),d=!0)},p(g,v){if(v&17){m=g[0].local_directories;let b;for(b=0;b<m.length;b+=1){const x=fl(g,m,b);h[b]?h[b].p(x,v):(h[b]=dl(x),h[b].c(),h[b].m(e,null))}for(;b<h.length;b+=1)h[b].d(1);h.length=m.length}},i:z,o:z,d(g){g&&O(t),ye(h,g),d=!1,_()}}}function hs(l){let t,e;return t=new bt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){de(t.$$.fragment)},m(s,n){ae(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ce(t,s)}}}function gs(l){let t;return{c(){t=p("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function dl(l){let t,e,s,n,r,i,o,a=l[10].slice(0,10)+"..",u,d,_,m,h;function g(...v){return l[7](l[10],...v)}return{c(){t=p("div"),e=p("div"),s=p("div"),n=p("img"),i=w(),o=p("div"),u=K(a),d=w(),De(n.src,r=ps)||f(n,"src",r),f(n,"class","object-contain hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[100px] w-[100px] bg-gray-800 p-3"),f(o,"class","flex text-sm text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer p-2"),f(t,"title",_=l[10])},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,n),c(e,i),c(e,o),c(o,u),c(t,d),m||(h=P(t,"click",g),m=!0)},p(v,b){l=v,b&1&&a!==(a=l[10].slice(0,10)+"..")&&Q(u,a),b&1&&_!==(_=l[10])&&f(t,"title",_)},d(v){v&&O(t),m=!1,h()}}}function ms(l){let t,e,s,n;const r=[gs,hs,_s],i=[];function o(a,u){return a[3]===!1?0:a[2]?1:2}return t=o(l),e=i[t]=r[t](l),{c(){e.c(),s=He()},m(a,u){i[t].m(a,u),F(a,s,u),n=!0},p(a,[u]){let d=t;t=o(a),t===d?i[t].p(a,u):(it(),Z(i[d],1,1,()=>{i[d]=null}),ot(),e=i[t],e?e.p(a,u):(e=i[t]=r[t](a),e.c()),J(e,1),e.m(s.parentNode,s))},i(a){n||(J(e),n=!0)},o(a){Z(e),n=!1},d(a){i[t].d(a),a&&O(s)}}}function bs(l,t,e){let s={local_directories:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,i=!0,o;Oe(()=>{fetch("/api/getGroup/resource_directory").then(m=>{m.json().then(h=>{e(0,s.local_directories=h,s),e(3,i=!0)})})}),rt(()=>{});function a(m){let h=m.toString().toLowerCase();h=h.replaceAll("/","|"),fetch("/api/getMeta/resource_directory/"+h).then(g=>{g.json().then(v=>{e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});let b=v.data_hash.length;console.log(b);for(let x=0;x<b;x++)n.list_metaData.push(v.meta_data[x]),n.list_dataHash.push(v.data_hash[x]),n.list_score.push(v.score[x]);e(1,n.done=!0,n),e(2,r=!0),Ke.update(x=>structuredClone(n))})})}function u(m){let h=m.target.value;h=h.toLowerCase(),h&&h&&i==!0&&o&&(e(0,s.local_directories=[],s),o.forEach(g=>{g.toLowerCase().includes(h)&&s.local_directories.push(g)}))}return[s,n,r,i,a,u,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,h)=>{console.log("mine is: ",m),a(m)}]}class vs extends Te{constructor(t){super(),Fe(this,t,bs,ms,je,{})}}function ks(l){let t,e,s,n,r,i,o,a,u,d;return{c(){t=p("div"),e=p("p"),e.innerHTML=`* Make sure you have created an OAuth credential at google Cloud-Console for this app and have enabled <b>Google Photos Api</b>. For details visit <b>https://developers.google.com/photos/library/guides/get-started</b><br/>
                * <b>App type</b> must be chosen as <b>Web app</b> and One of Redirect URIs must be set as <b>http://localhost:5000/api/OAuthCallback</b> in corresponding credential.<br/>
                * Except <b>You</b> and <b>Google</b> , <b>No-one</b> would have access to your personal data.`,s=w(),n=p("div"),r=p("label"),i=K(l[2]),o=w(),a=p("input"),f(e,"class","p-4"),f(r,"for","file"),f(a,"type","file"),f(a,"accept",".json"),f(n,"class","flex items-center justify-center text-md p-2 bg-blue-300"),f(t,"class","border-2 flex-1 justify-center items-center bg-blue-200")},m(_,m){F(_,t,m),c(t,e),c(t,s),c(t,n),c(n,r),c(r,i),c(n,o),c(n,a),u||(d=P(a,"change",l[4]),u=!0)},p(_,m){m&4&&Q(i,_[2])},d(_){_&&O(t),u=!1,d()}}}function ws(l){let t,e=l[0].client_id+"",s,n,r;function i(u,d){return u[0].is_activated?xs:ys}let o=i(l),a=o(l);return{c(){t=p("p"),s=K(e),n=w(),a.c(),r=He(),f(t,"class","bg-gray-100 p-2 border-2 border-black")},m(u,d){F(u,t,d),c(t,s),F(u,n,d),a.m(u,d),F(u,r,d)},p(u,d){d&1&&e!==(e=u[0].client_id+"")&&Q(s,e),o!==(o=i(u))&&(a.d(1),a=o(u),a&&(a.c(),a.m(r.parentNode,r)))},d(u){u&&O(t),u&&O(n),a.d(u),u&&O(r)}}}function ys(l){let t;return{c(){t=p("p"),t.textContent="Inactive",f(t,"class","bg-rose-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function xs(l){let t;return{c(){t=p("p"),t.textContent="Active",f(t,"class","bg-green-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function pl(l){let t,e,s,n;return{c(){t=p("div"),e=p("button"),e.textContent="Activate Google photos",f(e,"class","bg-blue-400 p-2 text-md disabled:bg-blue-200"),f(t,"class","flex justify-center items-center m-3")},m(r,i){F(r,t,i),c(t,e),s||(n=P(e,"click",l[3]),s=!0)},p:z,d(r){r&&O(t),s=!1,n()}}}function Cs(l){let t,e,s;function n(a,u){return a[0]?ws:ks}let r=n(l),i=r(l),o=l[1]&&pl(l);return{c(){t=p("div"),i.c(),e=w(),o&&o.c(),s=He(),f(t,"class","flex w-full justify-center items-center")},m(a,u){F(a,t,u),i.m(t,null),F(a,e,u),o&&o.m(a,u),F(a,s,u)},p(a,[u]){r===(r=n(a))&&i?i.p(a,u):(i.d(1),i=r(a),i&&(i.c(),i.m(t,null))),a[1]?o?o.p(a,u):(o=pl(a),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},i:z,o:z,d(a){a&&O(t),i.d(),a&&O(e),o&&o.d(a),a&&O(s)}}}function Ss(l,t,e){let s=null,n=!1,r="Upload Client secret json";function i(){fetch("/api/gClientInfo").then(d=>{d.json().then(_=>{_.client_id_available===!0&&(e(0,s=_),_.is_activated==!1&&e(1,n=!0))})})}Oe(()=>{i()});function o(){fetch("/api/statusGAuthFlow").then(d=>{d.json().then(_=>{_.finished==!1?setTimeout(o,2e3):(e(1,n=!1),alert("Account Activation: "+_.status.toString()),i())})})}function a(d){d.target.disabled=!0,d.target.innerText="activation in progress...",fetch("/api/beginGAuthFlow").then(_=>{_.ok==!1?(alert("Some error occured while starting authorization flow !"),d.target.disabled=!1,d.target.innerText="Activate Google Photos"):setTimeout(o,1e3)})}function u(d){let _="http://localhost:5000/api/OAuthCallback";e(2,r="upload in progress.."),d.preventDefault(),console.log(d.target),d.target.disabled=!0;var m=new FileReader;m.onload=function(){var h=JSON.parse(m.result);let v=Object.keys(h).includes("web"),b=!1;if(v&&Object.keys(h.web).includes("redirect_uris")&&(b=h.web.redirect_uris.includes(_)),v===!0&&b==!0){let x=new FormData;x.append("client_data",m.result),fetch("/api/uploadClientData",{method:"POST",body:x}).then(S=>{S.ok==!1?alert("Some error occured !!"):(e(2,r="Upload Client secret json"),i(),d.target.disabled=!1,e(1,n=!0))})}else{alert("Must be a webapp and redirect_uris must contain: "+_);return}},m.readAsText(d.target.files[0])}return[s,n,r,a,u]}class js extends Te{constructor(t){super(),Fe(this,t,Ss,Cs,je,{})}}function _l(l){let t,e,s,n,r,i;return{c(){t=p("div"),e=p("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=w(),n=p("div"),n.textContent="X",f(e,"class","flex-1"),f(n,"class","flex text-xl hover:orange-900 cursor-pointer"),f(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),f(t,"role","alert")},m(o,a){F(o,t,a),c(t,e),c(t,s),c(t,n),r||(i=P(n,"click",l[9]),r=!0)},p:z,d(o){o&&O(t),r=!1,i()}}}function Ds(l){let t,e,s,n,r,i;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[21]),e.$on("sidebarStateChange",l[22]),r=new js({}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(o,a){F(o,t,a),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),i=!0},p(o,a){const u={};a[0]&64&&(u.sidebarOpen=o[6]),e.$set(u)},i(o){i||(J(e.$$.fragment,o),J(r.$$.fragment,o),i=!0)},o(o){Z(e.$$.fragment,o),Z(r.$$.fragment,o),i=!1},d(o){o&&O(t),ce(e),ce(r)}}}function Os(l){let t,e,s,n,r,i;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[19]),e.$on("sidebarStateChange",l[20]),r=new vs({}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(o,a){F(o,t,a),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),i=!0},p(o,a){const u={};a[0]&64&&(u.sidebarOpen=o[6]),e.$set(u)},i(o){i||(J(e.$$.fragment,o),J(r.$$.fragment,o),i=!0)},o(o){Z(e.$$.fragment,o),Z(r.$$.fragment,o),i=!1},d(o){o&&O(t),ce(e),ce(r)}}}function Fs(l){let t,e,s,n,r,i;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),r=new is({}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(o,a){F(o,t,a),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),i=!0},p(o,a){const u={};a[0]&64&&(u.sidebarOpen=o[6]),e.$set(u)},i(o){i||(J(e.$$.fragment,o),J(r.$$.fragment,o),i=!0)},o(o){Z(e.$$.fragment,o),Z(r.$$.fragment,o),i=!1},d(o){o&&O(t),ce(e),ce(r)}}}function Ts(l){let t,e,s,n,r,i;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),r=new ds({}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(o,a){F(o,t,a),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),i=!0},p(o,a){const u={};a[0]&64&&(u.sidebarOpen=o[6]),e.$set(u)},i(o){i||(J(e.$$.fragment,o),J(r.$$.fragment,o),i=!0)},o(o){Z(e.$$.fragment,o),Z(r.$$.fragment,o),i=!1},d(o){o&&O(t),ce(e),ce(r)}}}function Ns(l){let t,e,s,n,r,i;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),r=new Rl({}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(o,a){F(o,t,a),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),i=!0},p(o,a){const u={};a[0]&64&&(u.sidebarOpen=o[6]),e.$set(u)},i(o){i||(J(e.$$.fragment,o),J(r.$$.fragment,o),i=!0)},o(o){Z(e.$$.fragment,o),Z(r.$$.fragment,o),i=!1},d(o){o&&O(t),ce(e),ce(r)}}}function qs(l){let t,e,s,n,r,i,o,a;return e=new et({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),r=new El({props:{query_button_disabled:l[2]}}),r.$on("queryReady",l[12]),o=new bt({props:{image_data:l[1]}}),{c(){t=p("div"),de(e.$$.fragment),s=w(),n=p("div"),de(r.$$.fragment),i=w(),de(o.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,d){F(u,t,d),ae(e,t,null),c(t,s),c(t,n),ae(r,n,null),c(n,i),ae(o,n,null),a=!0},p(u,d){const _={};d[0]&64&&(_.sidebarOpen=u[6]),e.$set(_);const m={};d[0]&4&&(m.query_button_disabled=u[2]),r.$set(m);const h={};d[0]&2&&(h.image_data=u[1]),o.$set(h)},i(u){a||(J(e.$$.fragment,u),J(r.$$.fragment,u),J(o.$$.fragment,u),a=!0)},o(u){Z(e.$$.fragment,u),Z(r.$$.fragment,u),Z(o.$$.fragment,u),a=!1},d(u){u&&O(t),ce(e),ce(r),ce(o)}}}function Ls(l){let t,e,s,n,r,i=l[0]&&_l(l);const o=[qs,Ns,Ts,Fs,Os,Ds],a=[];function u(d,_){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:d[5].local_album.status===!0?4:d[5].google_photos.status===!0?5:-1}return~(e=u(l))&&(s=a[e]=o[e](l)),{c(){i&&i.c(),t=w(),s&&s.c(),n=He()},m(d,_){i&&i.m(d,_),F(d,t,_),~e&&a[e].m(d,_),F(d,n,_),r=!0},p(d,_){d[0]?i?i.p(d,_):(i=_l(d),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null);let m=e;e=u(d),e===m?~e&&a[e].p(d,_):(s&&(it(),Z(a[m],1,1,()=>{a[m]=null}),ot()),~e?(s=a[e],s?s.p(d,_):(s=a[e]=o[e](d),s.c()),J(s,1),s.m(n.parentNode,n)):s=null)},i(d){r||(J(s),r=!0)},o(d){Z(s),r=!1},d(d){i&&i.d(d),d&&O(t),~e&&a[e].d(d),d&&O(n)}}}let Es=3;function Ps(l,t,e){let s=!1;Oe(()=>{window.onscrollend=function(){}}),Oe(()=>{fetch("/api/getMetaStats").then(T=>{T.ok?T.json().then(G=>{Number(G.image.count)==0&&e(0,s=!0),St.update(M=>Number(G.image.count)),Dt.update(M=>Number(G.image.unique_place_count)),jt.update(M=>Number(G.image.unique_people_count)),ml.update(M=>Number(G.image.unique_resource_directories_count)),bl.update(M=>G.available_resource_attributes)}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let n=[],r=[],i=[],o,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},u=!1,d="",_={};async function m(T="xxxxxxx",G=!1){console.log("handleClick count",d,G,T),e(2,u=!0);let M=Es;if(o=new FormData,d.length===0)return;o.append("query",d),o.append("topk",M.toString()),G==!1?(r=[],n=[],i=[],e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),o.append("query_start","true"),Ke.update(W=>a)):(o.append("query_start","false"),o.append("client_id",T));let ne=await fetch("/api/query",{method:"POST",body:o});if(!ne.ok)throw e(2,u=!1),new Error(ne);let $=await ne.json();console.log("data: ",$);let te=$.client_id,le=$.meta_data,be=$.data_hash,re=$.score;Number($.progress);for(let W=0;W<le.length;W++){let pe=be[W],ue=Number(re[W]),me=r.indexOf(pe);me>=0?(n[me]+=ue,e(1,a.list_score[me]+=ue,a)):(r.push(pe),n.push(ue),i.push(le[W]),a.list_dataHash.push(pe),a.list_score.push(ue),a.list_metaData.push(le[W]))}if($.query_completed==!0?(e(1,a.done=!0,a),e(1,a.progress=1e-4,a)):(e(1,a),e(1,a.progress+=.12,a),e(1,a.progress=Math.min(a.progress,.92),a)),$.query_completed==!0){e(2,u=!1),console.log("hey i am being called!!!"),Ke.update(W=>a);return}await m(te,!0)}const h={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}},local_album:{status:!1,context:{}},google_photos:{status:!1,context:{}}};function g(T){h[T].status==!1&&(e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Ke.update(M=>structuredClone(a)));let G=Object.keys(h);for(let M=0;M<G.length;M++)h[G[M]].status&&e(5,h[G[M]].status=!1,h);h[T]&&e(5,h[T].status=!0,h)}let v=!0;function b(T){let G=T.detail.item.name;G.toLowerCase().includes("google")?g("google_photos"):G.toLowerCase().includes("photo")?g("query"):G.toLowerCase().includes("index")?g("indexing"):G.toLowerCase().includes("people")?g("people_album"):G.toLowerCase().includes("place")?g("place_album"):G.toLowerCase().includes("local")&&g("local_album")}return[s,a,u,d,_,h,v,m,b,()=>e(0,s=!1),T=>{b(T)},T=>{e(6,v=T.detail.open)},T=>{e(3,d=T.detail.query),e(4,_=T.detail.attributes),m()},T=>b(T),T=>{e(6,v=T.detail.open)},T=>b(T),T=>{e(6,v=T.detail.open)},T=>b(T),T=>{e(6,v=T.detail.open)},T=>b(T),T=>{e(6,v=T.detail.open)},T=>b(T),T=>{e(6,v=T.detail.open)}]}class As extends Te{constructor(t){super(),Fe(this,t,Ps,Ls,je,{},null,[-1,-1])}}new As({target:document.getElementById("app")});
