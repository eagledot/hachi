var d=Object.defineProperty;var a=(r,e,t)=>e in r?d(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>a(r,typeof e!="symbol"?e+"":e,t);import{L as l,e as n}from"./config-Tz74n_gY.js";/* empty css              */import{h}from"./utils-cLygY5EC.js";new l({title:"Folders - Hachi",currentPage:"/folders.html",showNavbar:!0});class c{constructor(){o(this,"folders",[]);o(this,"filteredFolders",[]);o(this,"searchTerm","");o(this,"sortBy","name");o(this,"isLoading",!1);this.setupEventListeners(),this.loadFolders()}setupEventListeners(){const e=document.getElementById("folder-search");e&&e.addEventListener("input",s=>{const i=s.target.value.toLowerCase();this.setSearchTerm(i)});const t=document.getElementById("sort-filter");t&&t.addEventListener("change",s=>{const i=s.target.value;this.sortFolders(i)})}async loadFolders(){this.isLoading=!0,this.showLoading(!0),this.hideError();try{await this.loadFoldersFromAPI()}catch(e){console.error("Error loading folders:",e),this.showError(`Failed to load folders: ${e instanceof Error?e.message:"Unknown error"}`)}finally{this.isLoading=!1,this.showLoading(!1)}}async loadFoldersFromAPI(){const e=await fetch(n.GET_FOLDERS);if(!e.ok)throw new Error(`Failed to fetch folders: ${e.status}`);const t=await e.json();if(Array.isArray(t))this.folders=t.map(s=>({name:this.getDisplayName(s),fullPath:s,imageCount:0})),this.filteredFolders=[...this.folders],this.sortFolders(this.sortBy),this.renderFolders();else throw new Error("Invalid response format")}getDisplayName(e){const t=e.split(/[/\\]/);return t[t.length-1]||e}setSearchTerm(e){this.searchTerm=e,this.filterFolders(),this.renderFolders()}filterFolders(){if(!this.searchTerm){this.filteredFolders=[...this.folders];return}this.filteredFolders=this.folders.filter(e=>e.name.toLowerCase().includes(this.searchTerm)||e.fullPath.toLowerCase().includes(this.searchTerm))}sortFolders(e){this.sortBy=e,this.filteredFolders.sort((t,s)=>{switch(e){case"photos":return s.imageCount-t.imageCount;case"name":default:return t.name.localeCompare(s.name)}}),this.renderFolders()}renderFolders(){const e=document.getElementById("folders-grid"),t=document.getElementById("no-folders");if(!(!e||!t)){if(this.filteredFolders.length===0&&!this.isLoading){e.classList.add("hidden"),t.classList.remove("hidden");return}else if(this.filteredFolders.length===0&&this.isLoading){e.classList.add("hidden"),t.classList.add("hidden");return}t.classList.add("hidden"),e.classList.remove("hidden"),e.className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",e.innerHTML=this.filteredFolders.map(s=>this.renderFolderCard(s)).join(""),this.setupFolderClickHandlers()}}renderFolderCard(e){return this.renderGridViewCard(e)}renderGridViewCard(e){let s=e.fullPath;return s.length>32&&(s="â€¦"+s.slice(-32)),h`
      <div
        class="folder-list-item px-4 py-3 border-b border-gray-200 hover:bg-gray-50 cursor-pointer flex flex-col gap-1 justify-between"
        data-folder-path="${encodeURIComponent(e.fullPath)}"
      >
        <div class="flex items-center gap-3">
          <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path>
          </svg>
          <span class="font-medium text-gray-800" title="${e.name}">${e.name}</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-xs text-gray-400 truncate max-w-full" title="${e.fullPath}">${s}</span>
          <span class="text-xs text-gray-500 ml-auto">${e.imageCount} photo${e.imageCount!==1?"s":""}</span>
        </div>
      </div>
    `}setupFolderClickHandlers(){document.querySelectorAll(".folder-list-item").forEach(t=>{t.addEventListener("click",()=>{const s=t.getAttribute("data-folder-path");s&&(window.location.href=`/folder-photos.html?path=${s}`)})})}showLoading(e){const t=document.getElementById("loading-indicator");t&&(e?(t.classList.remove("hidden"),t.classList.add("flex")):(t.classList.add("hidden"),t.classList.remove("flex")))}showError(e){const t=document.getElementById("error-message"),s=document.getElementById("error-text");t&&s&&(s.textContent=e,t.classList.remove("hidden"))}hideError(){const e=document.getElementById("error-message");e&&e.classList.add("hidden")}}const m=new c;window.foldersApp=m;
