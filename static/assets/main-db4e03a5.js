(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}})();function U(){}function $t(l){return l()}function vt(){return Object.create(null)}function ue(l){l.forEach($t)}function el(l){return typeof l=="function"}function ke(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let We;function ve(l,t){return We||(We=document.createElement("a")),We.href=t,l===We.href}function sl(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function E(l,t,e){l.insertBefore(t,e||null)}function q(l){l.parentNode&&l.parentNode.removeChild(l)}function he(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function B(l){return document.createTextNode(l)}function y(){return B(" ")}function Ee(){return B("")}function L(l,t,e,n){return l.addEventListener(t,e,n),()=>l.removeEventListener(t,e,n)}function c(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function il(l){return l===""?null:+l}function rl(l){return Array.from(l.childNodes)}function K(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function qe(l,t){l.value=t??""}function ce(l,t,e,n){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,n?"important":"")}function kt(l,t){for(let e=0;e<l.options.length;e+=1){const n=l.options[e];if(n.__value===t){n.selected=!0;return}}l.selectedIndex=-1}function al(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function ol(l,t,{bubbles:e=!1,cancelable:n=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(l,e,n,t),a}let Ne;function Pe(l){Ne=l}function ft(){if(!Ne)throw new Error("Function called outside component initialization");return Ne}function Ae(l){ft().$$.on_mount.push(l)}function $e(l){ft().$$.on_destroy.push(l)}function et(){const l=ft();return(t,e,{cancelable:n=!1}={})=>{const a=l.$$.callbacks[t];if(a){const s=ol(t,e,{cancelable:n});return a.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}const je=[],De=[],Je=[],wt=[],cl=Promise.resolve();let ut=!1;function ul(){ut||(ut=!0,cl.then(tl))}function Ze(l){Je.push(l)}const ot=new Set;let Oe=0;function tl(){if(Oe!==0)return;const l=Ne;do{try{for(;Oe<je.length;){const t=je[Oe];Oe++,Pe(t),fl(t.$$)}}catch(t){throw je.length=0,Oe=0,t}for(Pe(null),je.length=0,Oe=0;De.length;)De.pop()();for(let t=0;t<Je.length;t+=1){const e=Je[t];ot.has(e)||(ot.add(e),e())}Je.length=0}while(je.length);for(;wt.length;)wt.pop()();ut=!1,ot.clear(),Pe(l)}function fl(l){if(l.fragment!==null){l.update(),ue(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(Ze)}}const Ye=new Set;let Se;function tt(){Se={r:0,c:[],p:Se}}function lt(){Se.r||ue(Se.c),Se=Se.p}function Z(l,t){l&&l.i&&(Ye.delete(l),l.i(t))}function ee(l,t,e,n){if(l&&l.o){if(Ye.has(l))return;Ye.add(l),Se.c.push(()=>{Ye.delete(l),n&&(e&&l.d(1),n())}),l.o(t)}else n&&n()}function pe(l){l&&l.c()}function fe(l,t,e,n){const{fragment:a,after_update:s}=l.$$;a&&a.m(t,e),n||Ze(()=>{const r=l.$$.on_mount.map($t).filter(el);l.$$.on_destroy?l.$$.on_destroy.push(...r):ue(r),l.$$.on_mount=[]}),s.forEach(Ze)}function de(l,t){const e=l.$$;e.fragment!==null&&(ue(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function dl(l,t){l.$$.dirty[0]===-1&&(je.push(l),ul(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function we(l,t,e,n,a,s,r,u=[-1]){const i=Ne;Pe(l);const f=l.$$={fragment:null,ctx:[],props:s,update:U,not_equal:a,bound:vt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(i?i.$$.context:[])),callbacks:vt(),dirty:u,skip_bound:!1,root:t.target||i.$$.root};r&&r(f.root);let p=!1;if(f.ctx=e?e(l,t.props||{},(_,g,...m)=>{const h=m.length?m[0]:g;return f.ctx&&a(f.ctx[_],f.ctx[_]=h)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](h),p&&dl(l,_)),g}):[],f.update(),p=!0,ue(f.before_update),f.fragment=n?n(f.ctx):!1,t.target){if(t.hydrate){const _=rl(t.target);f.fragment&&f.fragment.l(_),_.forEach(q)}else f.fragment&&f.fragment.c();t.intro&&Z(l.$$.fragment),fe(l,t.target,t.anchor,t.customElement),tl()}Pe(i)}class ye{$destroy(){de(this,1),this.$destroy=U}$on(t,e){if(!el(e))return U;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const a=n.indexOf(e);a!==-1&&n.splice(a,1)}}$set(t){this.$$set&&!sl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function yt(l,t,e){const n=l.slice();return n[25]=t[e],n}function xt(l,t,e){const n=l.slice();return n[28]=t[e],n}function Ct(l,t,e){const n=l.slice();return n[28]=t[e],n}function St(l,t,e){const n=l.slice();return n[33]=t[e],n}function Dt(l){let t,e,n,a=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",s,r,u,i,f,p,_,g=l[4][l[28]],m=[];for(let w=0;w<g.length;w+=1)m[w]=Ft(St(l,g,w));function h(){return l[14](l[28])}function x(...w){return l[15](l[28],...w)}return{c(){t=d("div"),e=d("span"),n=d("span"),s=B(a),r=y();for(let w=0;w<m.length;w+=1)m[w].c();u=y(),i=d("span"),i.textContent="x",f=y(),c(n,"class","text-blue-800 "),c(e,"class","cursor-pointer"),c(i,"class","ml-2 text-red-600 cursor-pointer hover:text-blue-500"),c(t,"class","px-4 py-2 self-center bg-blue-200 rounded-md inline-flex place-self-center items-center mr-2 mb-2 h-10")},m(w,S){E(w,t,S),o(t,e),o(e,n),o(n,s),o(e,r);for(let C=0;C<m.length;C+=1)m[C].m(e,null);o(t,u),o(t,i),o(t,f),p||(_=[L(e,"click",h),L(i,"click",x)],p=!0)},p(w,S){if(l=w,S[0]&16&&a!==(a=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"")&&K(s,a),S[0]&16){g=l[4][l[28]];let C;for(C=0;C<g.length;C+=1){const H=St(l,g,C);m[C]?m[C].p(H,S):(m[C]=Ft(H),m[C].c(),m[C].m(e,null))}for(;C<m.length;C+=1)m[C].d(1);m.length=g.length}},d(w){w&&q(t),he(m,w),p=!1,ue(_)}}}function Ft(l){let t,e=l[33]+" ",n;return{c(){t=d("span"),n=B(e),c(t,"class","ml-1")},m(a,s){E(a,t,s),o(t,n)},p(a,s){s[0]&16&&e!==(e=a[33]+" ")&&K(n,e)},d(a){a&&q(t)}}}function Ot(l){let t,e=l[4][l[28]].length>=1&&Dt(l);return{c(){e&&e.c(),t=Ee()},m(n,a){e&&e.m(n,a),E(n,t,a)},p(n,a){n[4][n[28]].length>=1?e?e.p(n,a):(e=Dt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&q(t)}}}function jt(l){let t,e=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",n,a,s;return{c(){t=d("option"),n=B(e),a=y(),t.__value=s=l[28],t.value=t.__value},m(r,u){E(r,t,u),o(t,n),o(t,a)},p(r,u){u[0]&16&&e!==(e=r[28].charAt(0).toUpperCase()+r[28].slice(1)+"")&&K(n,e),u[0]&16&&s!==(s=r[28])&&(t.__value=s,t.value=t.__value)},d(r){r&&q(t)}}}function qt(l){let t,e,n,a,s,r,u,i,f=l[3],p=[];for(let _=0;_<f.length;_+=1)p[_]=Et(yt(l,f,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<p.length;_+=1)p[_].c();n=y(),a=d("div"),s=d("button"),s.textContent="Close",c(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),c(s,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),c(a,"class","flex w-full justify-center items-center"),c(t,"class",r=(l[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,g){E(_,t,g),o(t,e);for(let m=0;m<p.length;m+=1)p[m].m(e,null);o(t,n),o(t,a),o(a,s),u||(i=L(s,"click",l[22]),u=!0)},p(_,g){if(g[0]&522){f=_[3];let m;for(m=0;m<f.length;m+=1){const h=yt(_,f,m);p[m]?p[m].p(h,g):(p[m]=Et(h),p[m].c(),p[m].m(e,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=f.length}g[0]&64&&r!==(r=(_[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&c(t,"class",r)},d(_){_&&q(t),he(p,_),u=!1,i()}}}function Et(l){let t,e=l[25]+"",n,a,s,r;function u(){return l[21](l[25])}return{c(){t=d("li"),n=B(e),a=y(),c(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(i,f){E(i,t,f),o(t,n),o(t,a),s||(r=L(t,"click",u),s=!0)},p(i,f){l=i,f[0]&8&&e!==(e=l[25]+"")&&K(n,e)},d(i){i&&q(t),s=!1,r()}}}function _l(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S=Object.keys(l[4]),C=[];for(let b=0;b<S.length;b+=1)C[b]=Ot(Ct(l,S,b));let H=Object.keys(l[4]),D=[];for(let b=0;b<H.length;b+=1)D[b]=jt(xt(l,H,b));let O=l[3].length>0&&qt(l);return{c(){t=d("div"),e=d("div"),n=d("form"),a=d("div");for(let b=0;b<C.length;b+=1)C[b].c();s=y(),r=d("div"),u=d("select");for(let b=0;b<D.length;b+=1)D[b].c();i=y(),f=d("div"),p=d("input"),_=y(),g=d("div"),m=d("button"),m.textContent="Search",h=y(),O&&O.c(),c(a,"class","flex w-full items-center my-2 flex-wrap"),c(u,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),c(u,"name","select-option"),c(u,"id","select-option"),l[1]===void 0&&Ze(()=>l[17].call(u)),c(p,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),c(p,"type","search"),c(p,"placeholder","Enter value here"),c(f,"class","bg-blue-200 rounded-md flex-grow h-10"),c(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),c(g,"class","flex"),c(r,"class","flex space-x-2"),c(n,"class","w-full"),c(n,"action",""),c(e,"class","w-full relative place-content-center"),c(t,"class","max-w-screen p-4 mx-auto")},m(b,v){E(b,t,v),o(t,e),o(e,n),o(n,a);for(let k=0;k<C.length;k+=1)C[k].m(a,null);o(n,s),o(n,r),o(r,u);for(let k=0;k<D.length;k+=1)D[k].m(u,null);kt(u,l[1]),o(r,i),o(r,f),o(f,p),l[18](p),qe(p,l[5]),o(r,_),o(r,g),o(g,m),l[20](m),o(e,h),O&&O.m(e,null),x||(w=[L(u,"change",l[16]),L(u,"change",l[17]),L(p,"input",l[19]),L(p,"input",l[7]),L(m,"click",l[12]),L(n,"submit",l[11])],x=!0)},p(b,v){if(v[0]&1296){S=Object.keys(b[4]);let k;for(k=0;k<S.length;k+=1){const F=Ct(b,S,k);C[k]?C[k].p(F,v):(C[k]=Ot(F),C[k].c(),C[k].m(a,null))}for(;k<C.length;k+=1)C[k].d(1);C.length=S.length}if(v[0]&16){H=Object.keys(b[4]);let k;for(k=0;k<H.length;k+=1){const F=xt(b,H,k);D[k]?D[k].p(F,v):(D[k]=jt(F),D[k].c(),D[k].m(u,null))}for(;k<D.length;k+=1)D[k].d(1);D.length=H.length}v[0]&18&&kt(u,b[1]),v[0]&32&&qe(p,b[5]),b[3].length>0?O?O.p(b,v):(O=qt(b),O.c(),O.m(e,null)):O&&(O.d(1),O=null)},i:U,o:U,d(b){b&&q(t),he(C,b),he(D,b),l[18](null),l[20](null),O&&O.d(),x=!1,ue(w)}}}async function pl(l,t){let e="/api/getSuggestion",n=new FormData;n.append("attribute",l),n.append("query",t);let a=await fetch(e,{method:"POST",body:n});return a.ok===!0?await a.json():{}}function hl(l,t,e){const n=et();let a="query",s,r,{query_button_disabled:u=!1}=t,i="",f=[],p={person:[],query:[],place:[],filename:[]},_="",g=!1;async function m(I){if(_.length===0)return;let V=await pl(a,_);a in V?(e(3,f=V[a]),e(6,g=!0)):(e(3,f=[]),e(6,g=!1))}function h(I,V){e(4,p[V]=[],p),a==V&&e(3,f=[])}function x(I,V){e(6,g=!1),e(5,_=V),s.focus()}function w(I){e(1,a=I),e(3,f=p[a]),e(6,g=!0),s.focus()}function S(I){I&&I.preventDefault(),e(6,g=!1);let V=p[a].length;_.length>0&&!p[a].includes(_)&&e(4,p[a][V]=_,p),e(5,_="");let A=Object.keys(p);i="";for(let Y=0;Y<A.length;Y++){let te=A[Y],G=p[te];i+=te+":";for(let X=0;X<G.length;X++)i+=G[X],X!=G.length-1&&(i+="-");Y!=A.length-1&&(i+=",")}console.log("Completed: "+i)}function C(I){S(),n("queryReady",{query:i,attributes:p})}const H=I=>w(I),D=(I,V)=>h(V.currentTarget,I),O=I=>w(I.target.value);function b(){a=al(this),e(1,a),e(4,p)}function v(I){De[I?"unshift":"push"](()=>{s=I,e(2,s)})}function k(){_=this.value,e(5,_)}function F(I){De[I?"unshift":"push"](()=>{r=I,e(0,r),e(13,u)})}const j=I=>x(a,I),z=()=>e(6,g=!1);return l.$$set=I=>{"query_button_disabled"in I&&e(13,u=I.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=u,r)},[r,a,s,f,p,_,g,m,h,x,w,S,C,u,H,D,O,b,v,k,F,j,z]}class ml extends ye{constructor(t){super(),we(this,t,hl,_l,ke,{query_button_disabled:13},null,[-1,-1])}}function It(l,t,e){const n=l.slice();return n[8]=t[e],n[10]=e,n}function gl(l){let t,e,n;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',c(t,"class","px-4")},m(a,s){E(a,t,s),e||(n=L(t,"click",l[2]),e=!0)},p:U,d(a){a&&q(t),e=!1,n()}}}function bl(l){let t,e,n,a,s;return{c(){t=d("span"),t.textContent="Hachi",e=y(),n=d("span"),n.innerHTML='<i class="fa-solid fa-arrow-left"></i>',c(t,"class","px-4"),c(n,"class","cursor-pointer px-4")},m(r,u){E(r,t,u),E(r,e,u),E(r,n,u),a||(s=L(n,"click",l[3]),a=!0)},p:U,d(r){r&&q(t),r&&q(e),r&&q(n),a=!1,s()}}}function Ht(l){let t,e,n=l[8].name+"",a,s,r,u=l[8].count+"",i;return{c(){t=d("div"),e=d("div"),a=B(n),s=y(),r=d("div"),i=B(u),c(e,"class","flex"),c(e,"data-ix",l[10]),c(r,"class","px-3 flex text-black text-md text-bold"),c(t,"class","flex w-full justify-between")},m(f,p){E(f,t,p),o(t,e),o(e,a),o(t,s),o(t,r),o(r,i)},p(f,p){p&2&&n!==(n=f[8].name+"")&&K(a,n),p&2&&u!==(u=f[8].count+"")&&K(i,u)},d(f){f&&q(t)}}}function Lt(l){let t,e,n,a,s,r,u,i=l[0].sidebarOpen&&Ht(l);function f(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),a=y(),i&&i.c(),s=y(),c(e,"class",n="fa-solid fa-"+l[8].icon),c(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(p,_){E(p,t,_),o(t,e),o(t,a),i&&i.m(t,null),o(t,s),r||(u=L(t,"click",f),r=!0)},p(p,_){l=p,_&2&&n!==(n="fa-solid fa-"+l[8].icon)&&c(e,"class",n),l[0].sidebarOpen?i?i.p(l,_):(i=Ht(l),i.c(),i.m(t,s)):i&&(i.d(1),i=null)},d(p){p&&q(t),i&&i.d(),r=!1,u()}}}function vl(l){let t,e,n,a,s,r;function u(g,m){return g[0].sidebarOpen?bl:gl}let i=u(l),f=i(l),p=l[1],_=[];for(let g=0;g<p.length;g+=1)_[g]=Lt(It(l,p,g));return{c(){t=d("div"),e=d("aside"),n=d("div"),f.c(),a=y(),s=d("nav");for(let g=0;g<_.length;g+=1)_[g].c();c(n,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),c(s,"class","mt-6"),c(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),c(t,"class","flex h-screen text-white")},m(g,m){E(g,t,m),o(t,e),o(e,n),f.m(n,null),o(e,a),o(e,s);for(let h=0;h<_.length;h+=1)_[h].m(s,null)},p(g,[m]){if(i===(i=u(g))&&f?f.p(g,m):(f.d(1),f=i(g),f&&(f.c(),f.m(n,null))),m&19){p=g[1];let h;for(h=0;h<p.length;h+=1){const x=It(g,p,h);_[h]?_[h].p(x,m):(_[h]=Lt(x),_[h].c(),_[h].m(s,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=p.length}m&1&&r!==(r=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&c(e,"class",r)},i:U,o:U,d(g){g&&q(t),f.d(),he(_,g)}}}function kl(l,t,e){const n=et();let{sidebarOpen:a=!1}=t;const s={sidebarOpen:a},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ae(()=>{localStorage.getItem("no_images_indexed")?(e(1,r[0].count=Number(localStorage.getItem("no_images_indexed")),r),e(1,r[3].count=Number(localStorage.getItem("unique_people_count")),r),e(1,r[4].count=Number(localStorage.getItem("unique_place_count")),r)):fetch("/api/getMetaStats").then(_=>{_.json().then(g=>{e(1,r[0].count=g.image.count,r),e(1,r[3].count=g.image.unique_people_count,r),e(1,r[4].count=g.image.unique_place_count,r),localStorage.setItem("no_images_indexed",r[0].count.toString()),localStorage.setItem("unique_people_count",r[3].count.toString()),localStorage.setItem("unique_place_count",r[4].count.toString())})})});function u(){e(0,s.sidebarOpen=!0,s)}function i(){e(0,s.sidebarOpen=!1,s)}function f(_){n("menuClick",{item:r[_]})}const p=_=>{f(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,a=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&s&&n("sidebarStateChange",{open:s.sidebarOpen})},[s,r,u,i,f,a,p]}class nt extends ye{constructor(t){super(),we(this,t,kl,vl,ke,{sidebarOpen:5})}}function wl(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S,C,H,D,O,b,v,k,F,j,z,I,V,A,Y,te,G,X,J,le,Q,ne,me,$,ie,oe,xe,ae,T,M;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",n=y(),a=d("div"),s=d("input"),r=y(),u=d("div"),i=d("div"),f=d("div"),p=y(),_=d("div"),g=B("Current directory: "),m=d("span"),h=B(l[4]),x=y(),w=d("span"),w.textContent="ETA:",S=y(),C=d("span"),H=B(l[6]),D=y(),O=d("div"),b=B("Details: "),v=d("span"),k=B(l[5]),F=y(),j=d("div"),z=d("div"),I=d("input"),V=y(),A=d("label"),A.textContent="Complete Rescan",Y=y(),te=d("div"),te.textContent="Re-index all originals, including already indexed and unchanged files.",G=y(),X=d("div"),J=d("select"),le=d("option"),le.textContent="Images Only",Q=d("option"),Q.textContent="Videos Only",ne=d("option"),ne.textContent="Videos and Images",me=y(),$=d("div"),$.textContent="Filter by content type",ie=y(),oe=d("button"),oe.textContent="Cancel",xe=y(),ae=d("button"),ae.textContent="Start",c(e,"class","mb-2 text-sm font-semibold"),c(s,"type","text"),c(s,"class","w-full rounded border p-1 text-sm"),c(s,"placeholder","D://images (Full path to directory to index)"),s.required=!0,c(a,"class","my-2"),c(f,"class","h-2 rounded bg-blue-500"),ce(f,"width",(l[3]*100).toString()+"%"),c(i,"class","h-2 rounded bg-gray-300"),c(m,"class","text-black"),c(w,"class","pl-3 text-right"),c(C,"class","text-black"),c(_,"class","pt-1 text-sm text-blue-600"),c(v,"class","text-black"),c(O,"class","pt-1 text-sm text-blue-600"),c(u,"class","mb-3"),c(I,"type","checkbox"),c(I,"class","h-5 w-5 text-blue-500"),c(A,"class","ml-1"),c(z,"class","mr-2 flex items-center"),c(te,"class","text-sm text-gray-600"),c(j,"class","mt-4 mb-3 flex flex-wrap items-center"),le.__value="Images Only",le.value=le.__value,Q.disabled=!0,Q.__value="Videos Only",Q.value=Q.__value,ne.disabled=!0,ne.__value="Videos and Images",ne.value=ne.__value,c(J,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),c($,"class","ml-2 text-sm text-gray-600"),c(X,"class","mb-3 mt-3 flex flex-wrap items-center"),oe.disabled=!0,c(oe,"type","button"),c(oe,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200"),c(ae,"type","button"),c(ae,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),c(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(P,R){E(P,t,R),o(t,e),o(t,n),o(t,a),o(a,s),l[12](s),qe(s,l[7]),o(t,r),o(t,u),o(u,i),o(i,f),o(u,p),o(u,_),o(_,g),o(_,m),o(m,h),o(_,x),o(_,w),o(_,S),o(_,C),o(C,H),o(u,D),o(u,O),o(O,b),o(O,v),o(v,k),o(t,F),o(t,j),o(j,z),o(z,I),I.checked=l[8],o(z,V),o(z,A),o(j,Y),o(j,te),o(t,G),o(t,X),o(X,J),o(J,le),o(J,Q),o(J,ne),o(X,me),o(X,$),o(t,ie),o(t,oe),l[16](oe),o(t,xe),o(t,ae),l[17](ae),T||(M=[L(s,"input",l[13]),L(s,"keydown",l[14]),L(I,"change",l[15]),L(oe,"click",l[10]),L(ae,"click",l[9])],T=!0)},p(P,[R]){R&128&&s.value!==P[7]&&qe(s,P[7]),R&8&&ce(f,"width",(P[3]*100).toString()+"%"),R&16&&K(h,P[4]),R&64&&K(H,P[6]),R&32&&K(k,P[5]),R&256&&(I.checked=P[8])},i:U,o:U,d(P){P&&q(t),l[12](null),l[16](null),l[17](null),T=!1,ue(M)}}}function yl(l,t,e){let n,a,s;Ae(()=>{if(e(11,n=localStorage.getItem("stored_indexing_endpoint")),n!==null){let v="/api/getIndexStatus/"+n;e(0,a.disabled=!1,a),e(1,s.disabled=!0,s),m(v)}}),$e(()=>{g&&clearTimeout(g)});let r,u=.01,i="",f="",p="",_="",g;async function m(v,k=0){k==0&&console.log("starting a new polll...");let j=await(await fetch(v,{method:"GET"})).json();if(j.is_active==!0){if(j.done==!0){let I=new FormData;I.append("ack","true"),(await fetch(v,{method:"POST",body:I})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let A=await fetch("/api/getMetaStats");A=await A.json(),localStorage.setItem("no_images_indexed",A.image.count.toString()),localStorage.setItem("unique_people_count",A.image.unique_people_count.toString()),localStorage.setItem("unique_place_count",A.image.unique_place_count.toString()),e(1,s.disabled=!1,s),e(11,n=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,u=0),e(4,i=""),e(6,p=""),e(5,f=""),e(7,_=""),e(0,a.disabled=!0,a),e(2,r.disabled=!1,r);return}e(3,u=j.progress),e(6,p=j.eta),e(5,f=j.details),e(4,i=j.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(v,k+1)},1e3)}}let h=!1;async function x(){if(s&&_){e(1,s.disabled=!0,s),e(2,r.disabled=!0,r);let v=new FormData;v.append("image_directory_path",_),v.append("complete_rescan",h.toString());let j=await(await fetch("/api/indexStart",{method:"POST",body:v})).json();if(j.success===!0){e(0,a.disabled=!1,a);let I="/api/getIndexStatus/"+j.statusEndpoint;e(11,n=j.statusEndpoint),m(I)}}else console.log("No index_start_button object found!!!")}async function w(){if(n){localStorage.removeItem("stored_indexing_endpoint"),e(0,a.disabled=!0,a);let v="/api/indexCancel/"+n,k=await fetch(v,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,n=null),!k.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(k);return}else return}function S(v){De[v?"unshift":"push"](()=>{r=v,e(2,r)})}function C(){_=this.value,e(7,_)}const H=v=>{v.key==="Enter"&&s.click()};function D(){h=this.checked,e(8,h)}function O(v){De[v?"unshift":"push"](()=>{a=v,e(0,a)})}function b(v){De[v?"unshift":"push"](()=>{s=v,e(1,s)})}return l.$$.update=()=>{l.$$.dirty&2048&&n&&localStorage.setItem("stored_indexing_endpoint",n)},[a,s,r,u,i,f,p,_,h,x,w,n,S,C,H,D,O,b]}class xl extends ye{constructor(t){super(),we(this,t,yl,wl,ke,{})}}function Tt(l,t,e){const n=l.slice();return n[10]=t[e],n}function Pt(l,t,e){const n=l.slice();return n[13]=t[e],n}function Nt(l){let t;return{c(){t=d("i"),c(t,"class","fa fa-plus text-xs text-black")},m(e,n){E(e,t,n)},d(e){e&&q(t)}}}function At(l){let t,e,n=l[1].selectFilters[l[10]].values.includes(l[13]),a,s,r,u=l[13]+"",i,f,p,_=n&&Nt();function g(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),s=y(),r=d("span"),i=B(u),c(e,"class",a="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),c(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){E(m,t,h),o(t,e),_&&_.m(e,null),o(t,s),o(t,r),o(r,i),f||(p=L(t,"click",g),f=!0)},p(m,h){l=m,h&2&&(n=l[1].selectFilters[l[10]].values.includes(l[13])),n?_||(_=Nt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),h&2&&a!==(a="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&c(e,"class",a),h&2&&u!==(u=l[13]+"")&&K(i,u)},d(m){m&&q(t),_&&_.d(),f=!1,p()}}}function Mt(l){let t,e,n=l[10]+"",a,s,r,u,i,f,p,_,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,x=[];for(let w=0;w<h.length;w+=1)x[w]=At(Pt(l,h,w));return{c(){t=d("div"),e=d("div"),a=B(n),s=y(),r=d("i"),i=y(),f=d("div");for(let w=0;w<x.length;w+=1)x[w].c();c(r,"class",u="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),c(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),c(f,"class",p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),c(t,"class","relative")},m(w,S){E(w,t,S),o(t,e),o(e,a),o(e,s),o(e,r),o(t,i),o(t,f);for(let C=0;C<x.length;C+=1)x[C].m(f,null);_||(g=[L(e,"click",m),L(t,"mouseup",Ol)],_=!0)},p(w,S){if(l=w,S&2&&n!==(n=l[10]+"")&&K(a,n),S&2&&u!==(u="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&c(r,"class",u),S&6){h=l[1].selectFilters[l[10]].options;let C;for(C=0;C<h.length;C+=1){const H=Pt(l,h,C);x[C]?x[C].p(H,S):(x[C]=At(H),x[C].c(),x[C].m(f,null))}for(;C<x.length;C+=1)x[C].d(1);x.length=h.length}S&2&&p!==(p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&c(f,"class",p)},d(w){w&&q(t),he(x,w),_=!1,ue(g)}}}function Cl(l){let t,e,n,a,s,r,u,i,f,p,_,g,m=Object.keys(l[1].selectFilters),h=[];for(let x=0;x<m.length;x+=1)h[x]=Mt(Tt(l,m,x));return{c(){t=d("div"),e=d("div"),n=d("span"),n.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',a=y(),s=d("span"),s.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=y();for(let x=0;x<h.length;x+=1)h[x].c();u=y(),i=d("button"),f=B("Filter"),c(n,"class","flex items-center text-md"),c(s,"class","flex items-center text-md"),i.disabled=l[0],c(i,"class",p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),c(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),c(t,"class","flex container mx-auto max-w-4xl")},m(x,w){E(x,t,w),o(t,e),o(e,n),o(e,a),o(e,s),o(e,r);for(let S=0;S<h.length;S+=1)h[S].m(e,null);o(e,u),o(e,i),o(i,f),_||(g=L(i,"click",l[4]),_=!0)},p(x,[w]){if(w&14){m=Object.keys(x[1].selectFilters);let S;for(S=0;S<m.length;S+=1){const C=Tt(x,m,S);h[S]?h[S].p(C,w):(h[S]=Mt(C),h[S].c(),h[S].m(e,u))}for(;S<h.length;S+=1)h[S].d(1);h.length=m.length}w&1&&(i.disabled=x[0]),w&1&&p!==(p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(x[0]===!0?"disabled":""))&&c(i,"class",p)},i:U,o:U,d(x){x&&q(t),he(h,x),_=!1,g()}}}function ll(l,t,e=null,n=(a,s)=>a===s){let a=[];for(let s=0;s<l.length;s++)e?n(l[s].key,t)?a.push(1):a.push(0):n(l[s],t)?a.push(1):a.push(0);return a}function Sl(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let a=ll(l,t[n]);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(a[s]))}return e}function Dl(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let a=ll(l,t[n],null,(s,r)=>s?s.includes(r):!1);console.log("temp: ",a);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(a[s]))}return e}function Fl(l){let t=l[0].length,e=l[0];return l.forEach((n,a)=>{if(a>0){if(n.length!==t)throw new Error("all mask must be of same length!!");n.forEach((s,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(s))})}}),e}const Ol=l=>l.stopPropagation();function jl(l,t,e){const n=et();let{filter_button_disabled:a=!0}=t,{image_data:s=null}=t;const r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ae(()=>{document.addEventListener("mouseup",u)});function u(m){e(1,r.selectFilterActive="",r)}function i(m,h){if(r.selectFilters[m].values.includes(h)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(x=>x!==h),r);return}e(1,r.selectFilters[m].values=[h,...r.selectFilters[m].values],r)}function f(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function p(){if(s){let m=[],h=[];s.list_metaData.map((D,O)=>{m.push(D.place),h.push(D.person)});let x=r.selectFilters.place.values,w=Sl(m,x),S=r.selectFilters.people.values,C=Dl(h,S),H=Fl([w,C]);n("filterApplied",{mask:H})}}const _=m=>f(m),g=(m,h)=>i(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,a=m.filter_button_disabled),"image_data"in m&&e(5,s=m.image_data)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.list_metaData.map((S,C)=>{if(S.place)return S.place}),h=[];s.list_metaData.map((S,C)=>{S.person&&S.person.forEach(H=>h.push(H))});let x=[];new Set(m).forEach(S=>x.push(S));let w=[];new Set(h).forEach(S=>w.push(S)),e(1,r.selectFilters.place.values=x,r),e(1,r.selectFilters.place.options=x,r),e(1,r.selectFilters.people.values=w,r),e(1,r.selectFilters.people.options=w,r)}},[a,r,i,f,p,s,_,g]}class ql extends ye{constructor(t){super(),we(this,t,jl,Cl,ke,{filter_button_disabled:0,image_data:5})}}function Bt(l,t,e){const n=l.slice();return n[45]=t[e],n[44]=e,n}function zt(l,t,e){const n=l.slice();return n[42]=t[e],n[44]=e,n}function El(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S,C,H,D=l[1]&&Rt(l);e=new ql({props:{filter_button_disabled:l[3],image_data:l[4]}}),e.$on("filterApplied",l[37]);let O=l[7],b=[];for(let v=0;v<O.length;v+=1)b[v]=Vt(Bt(l,O,v));return{c(){D&&D.c(),t=y(),pe(e.$$.fragment),n=y(),a=d("div"),s=d("div"),r=d("div"),u=d("div"),i=d("div"),f=d("input"),p=y(),_=d("label"),g=B("Score threshold: "),m=B(l[11]),h=B("."),x=y(),w=d("div");for(let v=0;v<b.length;v+=1)b[v].c();c(f,"type","range"),c(f,"min","0"),c(f,"max","1.0"),c(f,"step","0.01"),c(f,"class","w-full"),c(_,"for","topk"),c(_,"class","dark:text-white"),c(i,"class","my-4"),c(r,"class","flex flex-row place-content-center mb-10 select-none mx-2"),c(w,"class","flex flex-wrap gap-6 p-4 sm:p-12 px-auto justify-center"),c(s,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),c(a,"class","flex")},m(v,k){D&&D.m(v,k),E(v,t,k),fe(e,v,k),E(v,n,k),E(v,a,k),o(a,s),o(s,r),o(r,u),o(u,i),o(i,f),qe(f,l[11]),o(i,p),o(i,_),o(_,g),o(_,m),o(_,h),o(s,x),o(s,w);for(let F=0;F<b.length;F+=1)b[F].m(w,null);S=!0,C||(H=[L(f,"change",l[18]),L(f,"change",l[38]),L(f,"input",l[38])],C=!0)},p(v,k){v[1]?D?D.p(v,k):(D=Rt(v),D.c(),D.m(t.parentNode,t)):D&&(D.d(1),D=null);const F={};if(k[0]&8&&(F.filter_button_disabled=v[3]),k[0]&16&&(F.image_data=v[4]),e.$set(F),k[0]&2048&&qe(f,v[11]),(!S||k[0]&2048)&&K(m,v[11]),k[0]&24705){O=v[7];let j;for(j=0;j<O.length;j+=1){const z=Bt(v,O,j);b[j]?b[j].p(z,k):(b[j]=Vt(z),b[j].c(),b[j].m(w,null))}for(;j<b.length;j+=1)b[j].d(1);b.length=O.length}},i(v){S||(Z(e.$$.fragment,v),S=!0)},o(v){ee(e.$$.fragment,v),S=!1},d(v){D&&D.d(v),v&&q(t),de(e,v),v&&q(n),v&&q(a),he(b,v),C=!1,ue(H)}}}function Il(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S,C,H,D,O,b=l[2].image_card_edit_interface&&Gt(l),v=l[6]&&Xt(l);return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,a=y(),s=d("div"),s.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=y(),u=d("div"),i=d("div"),i.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',f=y(),p=d("div"),_=d("div"),g=d("img"),h=y(),x=d("div"),x.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',w=y(),b&&b.c(),S=y(),C=d("div"),C.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',H=y(),v&&v.c(),c(n,"class","cursor-pointer hover:underline text-gray-200"),c(s,"title","Fullscreen"),c(s,"class","cursor-pointer"),c(e,"class","flex h-6 items-center justify-between"),c(i,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),c(g,"class","w-auto cursor-pointer h-full"),ve(g.src,m="/api/getRawData/"+l[5].data_hash)||c(g,"src",m),c(g,"alt",""),c(x,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),c(_,"class","flex shrink h-full"),c(p,"class","flex h-full items-center justify-center p-2 gap-4"),c(C,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),c(u,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),c(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(k,F){E(k,t,F),o(t,e),o(e,n),o(e,a),o(e,s),o(t,r),o(t,u),o(u,i),o(u,f),o(u,p),o(p,_),o(_,g),o(_,h),o(_,x),o(p,w),b&&b.m(p,null),o(u,S),o(u,C),o(t,H),v&&v.m(t,null),D||(O=[L(n,"click",l[29]),L(s,"click",l[30]),L(i,"click",l[31]),L(g,"click",l[32]),L(x,"click",l[33]),L(C,"click",l[35])],D=!0)},p(k,F){F[0]&32&&!ve(g.src,m="/api/getRawData/"+k[5].data_hash)&&c(g,"src",m),k[2].image_card_edit_interface?b?b.p(k,F):(b=Gt(k),b.c(),b.m(p,null)):b&&(b.d(1),b=null),k[6]?v?v.p(k,F):(v=Xt(k),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},i:U,o:U,d(k){k&&q(t),b&&b.d(),v&&v.d(),D=!1,ue(O)}}}function Hl(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S,C,H=l[10],D=[];for(let b=0;b<H.length;b+=1)D[b]=Kt(zt(l,H,b));let O=l[9].active&&Qt(l);return{c(){t=d("div"),e=d("div"),n=d("img"),s=y();for(let b=0;b<D.length;b+=1)D[b].c();r=y(),O&&O.c(),u=y(),i=d("div"),f=d("div"),f.innerHTML='<i class="fa fa-arrow-left"></i>',p=y(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',g=y(),m=d("div"),h=d("div"),h.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,x=y(),w=d("div"),w.innerHTML='<i class="fa fa-arrows-alt"></i>',c(n,"class","object-cover h-screen w-auto"),ve(n.src,a="/api/getRawDataFull/"+l[5].data_hash)||c(n,"src",a),c(n,"alt",""),c(e,"class","relative flex"),c(f,"class","text-white cursor-pointer"),c(_,"class","text-white cursor-pointer"),c(i,"class","absolute flex mx-auto items-center justify-between w-screen"),c(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),c(h,"class","cursor-pointer hover:underline text-white"),c(w,"title","Fullscreen"),c(w,"class","cursor-pointer text-white"),c(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(b,v){E(b,t,v),o(t,e),o(e,n),o(e,s);for(let k=0;k<D.length;k+=1)D[k].m(e,null);o(e,r),O&&O.m(e,null),o(t,u),o(t,i),o(i,f),o(i,p),o(i,_),E(b,g,v),E(b,m,v),o(m,h),o(m,x),o(m,w),S||(C=[L(n,"load",l[17]),L(f,"click",l[25]),L(_,"click",l[26]),L(h,"click",l[27]),L(w,"click",l[28])],S=!0)},p(b,v){if(v[0]&32&&!ve(n.src,a="/api/getRawDataFull/"+b[5].data_hash)&&c(n,"src",a),v[0]&1792){H=b[10];let k;for(k=0;k<H.length;k+=1){const F=zt(b,H,k);D[k]?D[k].p(F,v):(D[k]=Kt(F),D[k].c(),D[k].m(e,r))}for(;k<D.length;k+=1)D[k].d(1);D.length=H.length}b[9].active?O?O.p(b,v):(O=Qt(b),O.c(),O.m(e,null)):O&&(O.d(1),O=null)},i:U,o:U,d(b){b&&q(t),he(D,b),O&&O.d(),b&&q(g),b&&q(m),S=!1,ue(C)}}}function Rt(l){let t,e,n,a,s;return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,c(n,"class","cursor-pointer hover:underline text-black"),c(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),c(t,"class","flex")},m(r,u){E(r,t,u),o(t,e),o(e,n),a||(s=L(n,"click",l[36]),a=!0)},p:U,d(r){r&&q(t),a=!1,s()}}}function Ut(l){let t,e,n,a,s,r;function u(){return l[39](l[44])}return{c(){t=d("div"),e=d("img"),a=y(),c(e,"class","sm:max-h-48 rounded-lg shadow-xl cursor-pointer"),ve(e.src,n="api/getRawData/"+l[0].list_dataHash[l[45].ix])||c(e,"src",n),c(e,"alt","image"),c(t,"class","relative group")},m(i,f){E(i,t,f),o(t,e),o(t,a),s||(r=L(t,"click",u),s=!0)},p(i,f){l=i,f[0]&129&&!ve(e.src,n="api/getRawData/"+l[0].list_dataHash[l[45].ix])&&c(e,"src",n)},d(i){i&&q(t),s=!1,r()}}}function Vt(l){let t,e=l[45].ix>=0&&Ut(l);return{c(){e&&e.c(),t=Ee()},m(n,a){e&&e.m(n,a),E(n,t,a)},p(n,a){n[45].ix>=0?e?e.p(n,a):(e=Ut(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&q(t)}}}function Gt(l){let t,e,n,a,s,r,u,i,f,p,_,g,m,h,x,w,S,C,H,D,O,b,v,k,F,j,z,I,V,A,Y,te,G,X,J,le,Q,ne,me;return{c(){t=d("div"),e=d("div"),n=d("div"),n.textContent="Info",a=y(),s=d("div"),s.textContent="X",r=y(),u=d("div"),i=d("div"),i.textContent="Description",f=y(),p=d("input"),g=y(),m=d("div"),h=d("div"),h.textContent="place",x=y(),w=d("input"),C=y(),H=d("div"),D=d("div"),D.textContent="Tags",O=y(),b=d("input"),k=y(),F=d("div"),j=d("div"),j.textContent="Taken at:",z=y(),I=d("input"),V=y(),A=d("div"),Y=d("div"),Y.textContent="device",te=y(),G=d("input"),J=y(),le=d("div"),Q=d("button"),Q.textContent="Save",c(n,"class","grow text-xl text-gray-100 font-bold"),c(s,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),c(e,"class","flex items-center"),c(i,"class","mb-1 text-gray-100"),c(p,"name","Description"),c(p,"placeholder",""),p.value=_=l[5].description.toString(),c(p,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(p,"type","text"),c(h,"class","mb-1 text-gray-100"),c(w,"name","place"),w.value=S=l[5].place.toString(),c(w,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(w,"type","text"),c(D,"class","mb-1 text-gray-100"),c(b,"name","tags"),c(b,"placeholder","Car, chair"),b.value=v=l[5].tags.toString(),c(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(b,"type","text"),c(j,"class","mb-1 text-gray-100"),c(I,"name","taken_at"),I.value="",c(I,"type","date"),c(I,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(Y,"class","mb-1 text-gray-100"),c(G,"name","device"),c(G,"placeholder","Canon"),G.value=X=l[5].device.toString(),c(G,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(G,"type","text"),c(Q,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400"),c(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m($,ie){E($,t,ie),o(t,e),o(e,n),o(e,a),o(e,s),o(t,r),o(t,u),o(u,i),o(u,f),o(u,p),o(t,g),o(t,m),o(m,h),o(m,x),o(m,w),o(t,C),o(t,H),o(H,D),o(H,O),o(H,b),o(t,k),o(t,F),o(F,j),o(F,z),o(F,I),o(t,V),o(t,A),o(A,Y),o(A,te),o(A,G),o(t,J),o(t,le),o(le,Q),ne||(me=[L(s,"click",l[34]),L(p,"change",l[21]),L(w,"change",l[21]),L(b,"change",l[21]),L(I,"change",l[21]),L(G,"change",l[21]),L(Q,"click",l[22])],ne=!0)},p($,ie){ie[0]&32&&_!==(_=$[5].description.toString())&&p.value!==_&&(p.value=_),ie[0]&32&&S!==(S=$[5].place.toString())&&w.value!==S&&(w.value=S),ie[0]&32&&v!==(v=$[5].tags.toString())&&b.value!==v&&(b.value=v),ie[0]&32&&X!==(X=$[5].device.toString())&&G.value!==X&&(G.value=X)},d($){$&&q(t),ne=!1,ue(me)}}}function Xt(l){let t,e,n,a,s=l[5].filename+"",r,u,i,f,p,_=l[5].data_hash+"",g,m,h,x,w,S=l[5].last_modified+"",C,H,D,O,b,v,k,F,j,z=l[5].description.toString()+"",I,V,A,Y,te,G,X=l[5].taken_at.toString()+"",J,le,Q,ne,me,$,ie=l[5].tags.toString()+"",oe,xe,ae,T,M,P,R=l[5].place.toString()+"",N,be,Fe,_e,ge,re,Ie,Ce,Me=l[5].person_ids.toString()+"",st,_t,He,Be,pt,ze,Re=l[5].device.toString()+"",it,ht,Le,Ue,mt,Ve,Ge=l[5].resolution.toString()+"",rt,gt,Te,Xe,bt,Ke,Qe=l[5].absolute_path.toString()+"",at;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=y(),n=d("div"),a=d("div"),r=B(s),u=y(),i=d("div"),f=B("UID: "),p=d("span"),g=B(_),m=y(),h=d("div"),x=B("Last Modified:  "),w=d("span"),C=B(S),H=y(),D=d("div"),O=d("div"),b=d("div"),v=d("div"),k=d("div"),k.textContent="Description",F=y(),j=d("div"),I=B(z),V=y(),A=d("div"),Y=d("div"),Y.textContent="Taken at",te=y(),G=d("div"),J=B(X),le=y(),Q=d("div"),ne=d("div"),ne.textContent="Tags",me=y(),$=d("div"),oe=B(ie),xe=y(),ae=d("div"),T=d("div"),T.textContent="Place",M=y(),P=d("div"),N=B(R),be=y(),Fe=d("div"),_e=d("div"),ge=d("div"),re=d("div"),re.textContent="people",Ie=y(),Ce=d("div"),st=B(Me),_t=y(),He=d("div"),Be=d("div"),Be.textContent="Device",pt=y(),ze=d("div"),it=B(Re),ht=y(),Le=d("div"),Ue=d("div"),Ue.textContent="Resolution",mt=y(),Ve=d("div"),rt=B(Ge),gt=y(),Te=d("div"),Xe=d("div"),Xe.textContent="Path",bt=y(),Ke=d("div"),at=B(Qe),c(a,"class","text-xl text-white"),c(p,"class","text-sm text-gray-400"),c(i,"class","text-white"),c(w,"class","text-sm text-gray-400"),c(h,"class","text-white"),c(n,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),c(k,"class",""),c(j,"class","text-sm text-gray-400"),c(Y,"class",""),c(G,"class","text-sm text-gray-400"),c(ne,"class",""),c($,"class","text-sm text-gray-400"),c(T,"class",""),c(P,"class","text-sm text-gray-400"),c(b,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),c(O,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),c(re,"class",""),c(Ce,"class","text-sm text-gray-400"),c(Be,"class",""),c(ze,"class","text-sm text-gray-400"),c(Ue,"class",""),c(Ve,"class","text-sm text-gray-400"),c(Xe,"class",""),c(Ke,"class","text-sm text-gray-400"),c(_e,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),c(Fe,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),c(D,"class","flex w-full justify-center p-4")},m(W,se){E(W,t,se),E(W,e,se),E(W,n,se),o(n,a),o(a,r),o(n,u),o(n,i),o(i,f),o(i,p),o(p,g),o(n,m),o(n,h),o(h,x),o(h,w),o(w,C),E(W,H,se),E(W,D,se),o(D,O),o(O,b),o(b,v),o(v,k),o(v,F),o(v,j),o(j,I),o(b,V),o(b,A),o(A,Y),o(A,te),o(A,G),o(G,J),o(b,le),o(b,Q),o(Q,ne),o(Q,me),o(Q,$),o($,oe),o(b,xe),o(b,ae),o(ae,T),o(ae,M),o(ae,P),o(P,N),o(D,be),o(D,Fe),o(Fe,_e),o(_e,ge),o(ge,re),o(ge,Ie),o(ge,Ce),o(Ce,st),o(_e,_t),o(_e,He),o(He,Be),o(He,pt),o(He,ze),o(ze,it),o(_e,ht),o(_e,Le),o(Le,Ue),o(Le,mt),o(Le,Ve),o(Ve,rt),o(_e,gt),o(_e,Te),o(Te,Xe),o(Te,bt),o(Te,Ke),o(Ke,at)},p(W,se){se[0]&32&&s!==(s=W[5].filename+"")&&K(r,s),se[0]&32&&_!==(_=W[5].data_hash+"")&&K(g,_),se[0]&32&&S!==(S=W[5].last_modified+"")&&K(C,S),se[0]&32&&z!==(z=W[5].description.toString()+"")&&K(I,z),se[0]&32&&X!==(X=W[5].taken_at.toString()+"")&&K(J,X),se[0]&32&&ie!==(ie=W[5].tags.toString()+"")&&K(oe,ie),se[0]&32&&R!==(R=W[5].place.toString()+"")&&K(N,R),se[0]&32&&Me!==(Me=W[5].person_ids.toString()+"")&&K(st,Me),se[0]&32&&Re!==(Re=W[5].device.toString()+"")&&K(it,Re),se[0]&32&&Ge!==(Ge=W[5].resolution.toString()+"")&&K(rt,Ge),se[0]&32&&Qe!==(Qe=W[5].absolute_path.toString()+"")&&K(at,Qe)},d(W){W&&q(t),W&&q(e),W&&q(n),W&&q(H),W&&q(D)}}}function Kt(l){let t,e,n;function a(...s){return l[23](l[42],...s)}return{c(){t=d("div"),c(t,"data-ix",l[44]),c(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ce(t,"top",l[42].top+"px "),ce(t,"left",l[42].left+"px"),ce(t,"width",l[42].width+"px"),ce(t,"height",l[42].height+"px")},m(s,r){E(s,t,r),e||(n=L(t,"click",a),e=!0)},p(s,r){l=s,r[0]&1024&&ce(t,"top",l[42].top+"px "),r[0]&1024&&ce(t,"left",l[42].left+"px"),r[0]&1024&&ce(t,"width",l[42].width+"px"),r[0]&1024&&ce(t,"height",l[42].height+"px")},d(s){s&&q(t),e=!1,n()}}}function Qt(l){let t,e,n,a,s,r,u;return{c(){t=d("div"),e=d("input"),a=y(),s=d("div"),s.textContent="X",e.autofocus=!0,e.value=n=l[5].person_ids[l[8]],c(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),c(e,"placeholder","Enter person id"),c(e,"type","text"),c(s,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),c(t,"class","absolute flex h-auto w-240 bg-blue-300"),ce(t,"top",l[9].top+"px "),ce(t,"left",l[9].left+"px")},m(i,f){E(i,t,f),o(t,e),o(t,a),o(t,s),e.focus(),r||(u=[L(e,"keyup",l[20]),L(s,"click",l[24])],r=!0)},p(i,f){f[0]&288&&n!==(n=i[5].person_ids[i[8]])&&e.value!==n&&(e.value=n),f[0]&512&&ce(t,"top",i[9].top+"px "),f[0]&512&&ce(t,"left",i[9].left+"px")},d(i){i&&q(t),r=!1,ue(u)}}}function Ll(l){let t,e,n,a;const s=[Hl,Il,El],r=[];function u(i,f){return i[2].image_card_fullscreen===!0?0:i[2].image_card===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=Ee()},m(i,f){r[t].m(i,f),E(i,n,f),a=!0},p(i,f){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),ee(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Z(e,1),e.m(n.parentNode,n))},i(i){a||(Z(e),a=!0)},o(i){ee(e),a=!1},d(i){r[t].d(i),i&&q(n)}}}function ct(l,t=[1],e=null){let n=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let a=0;a<l.length;a++){let s=a;t[a%t.length]!==1&&(s=-1),e?n.push({ix:s,score:l[a][e]}):n.push({ix:s,score:l[a]})}return n.sort((a,s)=>a.score>s.score?-1:a.score<s.score?1:0),n}function Tl(l,t,e){const n=et();let{show_exit_interface_button:a=!1}=t,{image_data:s={list_metaData:[],list_dataHash:[],list_score:[],done:!1}}=t,r=!0,u=null;$e(()=>{e(0,s={list_metaData:[],list_dataHash:[],list_score:[],done:!1})});let i={},f=!1,p=[],_={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function g(T){let M=Object.keys(_);for(let P=0;P<M.length;P++)e(2,_[M[P]]=!1,_);e(2,_[T]=!0,_)}let m,h={active:!1,top:null,left:null};function x(T){let M={sorted_ix:null,image_ix:null};for(let P=T;P<p.length;P++)if(p[P].ix!==-1){M.image_ix=p[P].ix,M.sorted_ix=P;break}return M}function w(T){F={},e(6,f=!1),e(10,H=[]),e(9,h={active:!1,top:null,left:null});let M=T,P=p.length;M<0&&(M=P-1),M>P-1&&(M=0);let R=x(M),N=R.image_ix;M=R.sorted_ix,N===null&&(R=x(0),N=R.image_ix,M=R.sorted_ix),e(5,i.ix=M,i),e(5,i.data_hash=s.list_dataHash[N],i),e(5,i.height=Number(s.list_metaData[N].height),i),e(5,i.width=Number(s.list_metaData[N].width),i),e(5,i.face_bboxes=s.list_metaData[N].face_bboxes,i),e(5,i.person_ids=s.list_metaData[N].person,i),i.person_ids===null&&e(5,i.person_ids=[],i),e(5,i.resolution=i.height.toString()+" X "+i.width.toString(),i),e(5,i.filename=s.list_metaData[N].filename,i),e(5,i.taken_at=s.list_metaData[N].taken_at,i),i.taken_at==null&&e(5,i.taken_at="Unknown",i),e(5,i.last_modified=s.list_metaData[N].modified_at,i),e(5,i.device=s.list_metaData[N].device,i),i.device==null&&e(5,i.device="",i),e(5,i.place=s.list_metaData[N].place,i),e(5,i.absolute_path=s.list_metaData[N].absolute_path,i),e(5,i.description=s.list_metaData[N].description,i),e(5,i.tags=s.list_metaData[N].tags,i),e(6,f=!0)}function S(){w(i.ix+1)}function C(){w(i.ix-1)}let H=[];function D(T){let M=T.target.getClientRects()[0],P=M.width,R=M.height,N=[],be=i.face_bboxes;if(be){let Fe=i.width,_e=i.height;for(let ge=0;ge<be.length;ge++){let re=structuredClone(be[ge]),Ie=Number(P)/(Number(Fe)+1e-4),Ce=Number(R)/(Number(_e)+1e-4);re.top=re[1]*Ce,re.height=(re[3]-re[1])*Ce,re.left=re[0]*Ie,re.width=(re[2]-re[0])*Ie,N.push(re)}}console.log(N),e(10,H=N)}let O=0;function b(){let T=p[0].score,M=p[p.length-1].score,R=s.list_score.map(N=>(N-M)/(T-M+1e-5)).map(N=>N>=O?1:0);e(7,p=ct(s.list_score,R))}function v(T){e(3,r=!0),e(7,p=ct(s.list_score,T)),e(3,r=!1)}function k(T){let M=T.target.value,P=i.data_hash,R=i.person_ids[m];if(T.key=="Enter"){let N=new FormData;N.append("new_person_id",M),N.append("old_person_id",R),N.append("data_hash",P),fetch("/api/tagPerson",{method:"POST",body:N}).then(be=>{if(be.ok)alert("Success");else throw new Error("Error occured")})}}let F={};function j(T){F[T.target.name.toLowerCase()]=T.target.value}async function z(T){T.target.disabled=!0;let M=Object.keys(F),P=new FormData;for(let N=0;N<M.length;N++)P.append(M[N],F[M[N]]);P.append("data_hash",i.data_hash);let R=await fetch("/api/editMetaData",{method:"POST",body:P});if(!R.ok)throw new Error("Error while updating meta-data !!");await R.json(),T.target.disabled=!1}const I=(T,M)=>{e(9,h={active:!0,top:T.top-28,left:T.left}),e(8,m=Number(M.target.attributes["data-ix"].value))},V=()=>{e(9,h.active=!1,h)},A=()=>{C()},Y=()=>{S()},te=()=>{g("parent")},G=()=>{g("image_card")},X=()=>{g("parent")},J=()=>{g("image_card_fullscreen")},le=()=>{C()},Q=()=>{console.log("hellll"),g("image_card_fullscreen")},ne=()=>{e(2,_.image_card_edit_interface=!0,_)},me=()=>{e(2,_.image_card_edit_interface=!1,_)},$=()=>{S()},ie=()=>{n("exitButtonPressed")},oe=T=>{v(T.detail.mask)};function xe(){O=il(this.value),e(11,O)}const ae=T=>{w(T),g("image_card")};return l.$$set=T=>{"show_exit_interface_button"in T&&e(1,a=T.show_exit_interface_button),"image_data"in T&&e(0,s=T.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&1&&s&&(e(3,r=!s.done),s.done&&e(4,u=s)),l.$$.dirty[0]&1&&s&&e(7,p=ct(s.list_score)),l.$$.dirty[0]&4&&_){let T=!1;(_.image_card==!0||_.image_card_fullscreen==!0)&&(T=!0),n("imageCardActive",{active:T})}},[s,a,_,r,u,i,f,p,m,h,H,O,n,g,w,S,C,D,b,v,k,j,z,I,V,A,Y,te,G,X,J,le,Q,ne,me,$,ie,oe,xe,ae]}class dt extends ye{constructor(t){super(),we(this,t,Tl,Ll,ke,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const nl="/assets/sample_place_bg-38f3fbd4.jpg";function Wt(l,t,e){const n=l.slice();return n[9]=t[e],n}function Pl(l){let t,e,n,a=l[0].people,s=[];for(let r=0;r<a.length;r+=1)s[r]=Jt(Wt(l,a,r));return{c(){t=d("div"),e=y(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();c(t,"class","flex w-screen h-[80px] bg-blue-100"),c(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,u){E(r,t,u),E(r,e,u),E(r,n,u);for(let i=0;i<s.length;i+=1)s[i].m(n,null)},p(r,u){if(u&17){a=r[0].people;let i;for(i=0;i<a.length;i+=1){const f=Wt(r,a,i);s[i]?s[i].p(f,u):(s[i]=Jt(f),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=a.length}},i:U,o:U,d(r){r&&q(t),r&&q(e),r&&q(n),he(s,r)}}}function Nl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){E(e,t,n)},p:U,i:U,o:U,d(e){e&&q(t)}}}function Al(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){pe(t.$$.fragment)},m(n,a){fe(t,n,a),e=!0},p(n,a){const s={};a&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){ee(t.$$.fragment,n),e=!1},d(n){de(t,n)}}}function Jt(l){let t,e,n,a,s,r,u,i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"",f,p,_,g;function m(...h){return l[6](l[9],...h)}return{c(){t=d("div"),e=d("div"),n=d("div"),a=d("img"),r=y(),u=d("div"),f=B(i),p=y(),ve(a.src,s=nl)||c(a,"src",s),c(a,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),c(n,"class","h-[150px] w-[200px] bg-gray-800"),c(u,"class","flex text-xl text-white justify-center items-center"),c(t,"class","flex-col cursor-pointer")},m(h,x){E(h,t,x),o(t,e),o(e,n),o(n,a),o(e,r),o(e,u),o(u,f),o(t,p),_||(g=L(t,"click",m),_=!0)},p(h,x){l=h,x&1&&i!==(i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"")&&K(f,i)},d(h){h&&q(t),_=!1,g()}}}function Ml(l){let t,e,n,a;const s=[Al,Nl,Pl],r=[];function u(i,f){return i[3]?0:i[2]===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=Ee()},m(i,f){r[t].m(i,f),E(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),ee(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Z(e,1),e.m(n.parentNode,n))},i(i){a||(Z(e),a=!0)},o(i){ee(e),a=!1},d(i){r[t].d(i),i&&q(n)}}}function Bl(l,t,e){let n={people:[]},a={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,u=!1;Ae(()=>{fetch("/api/getGroup/person").then(_=>{_.json().then(g=>{let m=g.meta_data.length;console.log("data length: ",m);for(let h=0;h<m;h++)a.list_dataHash.push(g.data_hash[h]),a.list_score.push(g.score[h]),a.list_metaData.push(g.meta_data[h]);e(0,n.people=g.person,n)})})}),$e(()=>{console.log("destroying...")});async function i(_){let m=0;e(3,u=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),e(2,r=!0);for(let h=0;h<a.list_dataHash.length;h++){if(r===!1){console.log("stopping...");return}a.list_metaData[h].person.includes(_)&&(s.list_metaData.push(a.list_metaData[h]),s.list_dataHash.push(a.list_dataHash[h]),s.list_score.push(a.list_score[h]),m+=1,m%10==0&&(e(1,s=s),e(3,u=!0)))}e(1,s.done=!0,s),e(3,u=!0),e(2,r=!1)}return[n,s,r,u,i,()=>{console.log("pressed the hell out of it!"),e(3,u=!1),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),i(_)}]}class zl extends ye{constructor(t){super(),we(this,t,Bl,Ml,ke,{})}}function Yt(l,t,e){const n=l.slice();return n[9]=t[e],n}function Rl(l){let t,e,n,a=l[0].places,s=[];for(let r=0;r<a.length;r+=1)s[r]=Zt(Yt(l,a,r));return{c(){t=d("div"),e=y(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();c(t,"class","flex w-screen h-[80px] bg-blue-100"),c(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,u){E(r,t,u),E(r,e,u),E(r,n,u);for(let i=0;i<s.length;i+=1)s[i].m(n,null)},p(r,u){if(u&17){a=r[0].places;let i;for(i=0;i<a.length;i+=1){const f=Yt(r,a,i);s[i]?s[i].p(f,u):(s[i]=Zt(f),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=a.length}},i:U,o:U,d(r){r&&q(t),r&&q(e),r&&q(n),he(s,r)}}}function Ul(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){E(e,t,n)},p:U,i:U,o:U,d(e){e&&q(t)}}}function Vl(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){pe(t.$$.fragment)},m(n,a){fe(t,n,a),e=!0},p(n,a){const s={};a&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){ee(t.$$.fragment,n),e=!1},d(n){de(t,n)}}}function Zt(l){let t,e,n,a,s,r,u,i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"",f,p,_,g;function m(...h){return l[6](l[9],...h)}return{c(){t=d("div"),e=d("div"),n=d("div"),a=d("img"),r=y(),u=d("div"),f=B(i),p=y(),ve(a.src,s=nl)||c(a,"src",s),c(a,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),c(n,"class","h-[150px] w-[200px] bg-gray-800"),c(u,"class","flex text-xl text-white justify-center items-center"),c(t,"class","flex-col cursor-pointer")},m(h,x){E(h,t,x),o(t,e),o(e,n),o(n,a),o(e,r),o(e,u),o(u,f),o(t,p),_||(g=L(t,"click",m),_=!0)},p(h,x){l=h,x&1&&i!==(i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"")&&K(f,i)},d(h){h&&q(t),_=!1,g()}}}function Gl(l){let t,e,n,a;const s=[Vl,Ul,Rl],r=[];function u(i,f){return i[3]?0:i[2]===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=Ee()},m(i,f){r[t].m(i,f),E(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),ee(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Z(e,1),e.m(n.parentNode,n))},i(i){a||(Z(e),a=!0)},o(i){ee(e),a=!1},d(i){r[t].d(i),i&&q(n)}}}function Xl(l,t,e){let n={places:[]},a={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,u=!1;Ae(()=>{fetch("/api/getGroup/place").then(_=>{_.json().then(g=>{let m=g.meta_data.length;console.log("data length: ",m);for(let h=0;h<m;h++)a.list_dataHash.push(g.data_hash[h]),a.list_score.push(g.score[h]),a.list_metaData.push(g.meta_data[h]);e(0,n.places=g.place,n)})})}),$e(()=>{console.log("destroying...")});async function i(_){let m=0;e(3,u=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),e(2,r=!0);for(let h=0;h<a.list_dataHash.length;h++){if(r===!1){console.log("stopping...");return}a.list_metaData[h].place.toLowerCase()===_.toLowerCase()&&(s.list_metaData.push(a.list_metaData[h]),s.list_dataHash.push(a.list_dataHash[h]),s.list_score.push(a.list_score[h]),m+=1,m%10==0&&(e(1,s=s),e(3,u=!0)))}e(1,s.done=!0,s),e(3,u=!0),e(2,r=!1)}return[n,s,r,u,i,()=>{console.log("pressed the hell out of it!"),e(3,u=!1),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),i(_)}]}class Kl extends ye{constructor(t){super(),we(this,t,Xl,Gl,ke,{})}}function Ql(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),s=new zl({}),{c(){t=d("div"),pe(e.$$.fragment),n=y(),a=d("div"),pe(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),c(t,"class","flex")},m(u,i){E(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Z(e.$$.fragment,u),Z(s.$$.fragment,u),r=!0)},o(u){ee(e.$$.fragment,u),ee(s.$$.fragment,u),r=!1},d(u){u&&q(t),de(e),de(s)}}}function Wl(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),s=new Kl({}),{c(){t=d("div"),pe(e.$$.fragment),n=y(),a=d("div"),pe(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),c(t,"class","flex")},m(u,i){E(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Z(e.$$.fragment,u),Z(s.$$.fragment,u),r=!0)},o(u){ee(e.$$.fragment,u),ee(s.$$.fragment,u),r=!1},d(u){u&&q(t),de(e),de(s)}}}function Jl(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[11]),e.$on("sidebarStateChange",l[12]),s=new xl({}),{c(){t=d("div"),pe(e.$$.fragment),n=y(),a=d("div"),pe(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),c(t,"class","flex")},m(u,i){E(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Z(e.$$.fragment,u),Z(s.$$.fragment,u),r=!0)},o(u){ee(e.$$.fragment,u),ee(s.$$.fragment,u),r=!1},d(u){u&&q(t),de(e),de(s)}}}function Yl(l){let t,e,n,a,s,r,u,i;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[8]),e.$on("sidebarStateChange",l[9]),s=new ml({props:{query_button_disabled:l[1]}}),s.$on("queryReady",l[10]),u=new dt({props:{image_data:l[0]}}),{c(){t=d("div"),pe(e.$$.fragment),n=y(),a=d("div"),pe(s.$$.fragment),r=y(),pe(u.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),c(t,"class","flex")},m(f,p){E(f,t,p),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),o(a,r),fe(u,a,null),i=!0},p(f,p){const _={};p&32&&(_.sidebarOpen=f[5]),e.$set(_);const g={};p&2&&(g.query_button_disabled=f[1]),s.$set(g);const m={};p&1&&(m.image_data=f[0]),u.$set(m)},i(f){i||(Z(e.$$.fragment,f),Z(s.$$.fragment,f),Z(u.$$.fragment,f),i=!0)},o(f){ee(e.$$.fragment,f),ee(s.$$.fragment,f),ee(u.$$.fragment,f),i=!1},d(f){f&&q(t),de(e),de(s),de(u)}}}function Zl(l){let t,e,n,a;const s=[Yl,Jl,Wl,Ql],r=[];function u(i,f){return i[4].query.status?0:i[4].indexing.status===!0?1:i[4].place_album.status===!0?2:i[4].people_album.status===!0?3:-1}return~(t=u(l))&&(e=r[t]=s[t](l)),{c(){e&&e.c(),n=Ee()},m(i,f){~t&&r[t].m(i,f),E(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?~t&&r[t].p(i,f):(e&&(tt(),ee(r[p],1,1,()=>{r[p]=null}),lt()),~t?(e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Z(e,1),e.m(n.parentNode,n)):e=null)},i(i){a||(Z(e),a=!0)},o(i){ee(e),a=!1},d(i){~t&&r[t].d(i),i&&q(n)}}}let $l=3;function en(l,t,e){let n=[],a=[],s=[],r,u={list_metaData:[],list_dataHash:[],list_score:[],done:!1},i=!1,f="",p={};async function _(F="xxxxxxx",j=!1){console.log("handleClick count",f,j,F),e(1,i=!0);let z=$l;if(r=new FormData,f.length===0)return;r.append("query",f),r.append("topk",z.toString()),j==!1?(a=[],n=[],s=[],e(0,u={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),r.append("query_start","true")):(r.append("query_start","false"),r.append("client_id",F));let V=await fetch("/api/query",{method:"POST",body:r});if(!V.ok)throw e(1,i=!1),new Error(V);let A=await V.json();console.log("data: ",A);let Y=A.client_id,te=A.meta_data,G=A.data_hash,X=A.score;for(let J=0;J<te.length;J++){let le=G[J],Q=X[J];a.push(le),n.push(Q),s.push(te[J]),u.list_dataHash.push(le),u.list_score.push(Q),u.list_metaData.push(te[J])}if(A.query_completed==!0?e(0,u.done=!0,u):e(0,u),A.query_completed==!0){e(1,i=!1);return}await _(Y,!0)}const g={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function m(F){let j=Object.keys(g);for(let z=0;z<j.length;z++)g[j[z]].status&&e(4,g[j[z]].status=!1,g);g[F]&&e(4,g[F].status=!0,g)}let h=!0;function x(F){let j=F.detail.item.name;j.toLowerCase().includes("photo")?m("query"):j.toLowerCase().includes("index")?m("indexing"):j.toLowerCase().includes("people")?m("people_album"):j.toLowerCase().includes("place")&&m("place_album")}return[u,i,f,p,g,h,_,x,F=>{x(F)},F=>{e(5,h=F.detail.open)},F=>{e(2,f=F.detail.query),e(3,p=F.detail.attributes),_()},F=>x(F),F=>{e(5,h=F.detail.open)},F=>x(F),F=>{e(5,h=F.detail.open)},F=>x(F),F=>{e(5,h=F.detail.open)}]}class tn extends ye{constructor(t){super(),we(this,t,en,Zl,ke,{})}}new tn({target:document.getElementById("app")});
