(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();function B(){}function hl(l){return l()}function Ot(){return Object.create(null)}function be(l){l.forEach(hl)}function kt(l){return typeof l=="function"}function xe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let ot;function Se(l,t){return ot||(ot=document.createElement("a")),ot.href=t,l===ot.href}function kl(l){return Object.keys(l).length===0}function c(l,t){l.appendChild(t)}function F(l,t,e){l.insertBefore(t,e||null)}function O(l){l.parentNode&&l.parentNode.removeChild(l)}function we(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function _(l){return document.createElement(l)}function wl(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function z(l){return document.createTextNode(l)}function w(){return z(" ")}function Ne(){return z("")}function H(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function yl(l){return l===""?null:+l}function xl(l){return Array.from(l.childNodes)}function W(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ft(l,t){l.value=t??""}function he(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ft(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function Cl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function Sl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(l,e,s,t),r}let Je;function Qe(l){Je=l}function wt(){if(!Je)throw new Error("Function called outside component initialization");return Je}function De(l){wt().$$.on_mount.push(l)}function Ye(l){wt().$$.on_destroy.push(l)}function _t(){const l=wt();return(t,e,{cancelable:s=!1}={})=>{const r=l.$$.callbacks[t];if(r){const n=Sl(t,e,{cancelable:s});return r.slice().forEach(i=>{i.call(l,n)}),!n.defaultPrevented}return!0}}const Ge=[],Ie=[],at=[],Lt=[],Dl=Promise.resolve();let vt=!1;function jl(){vt||(vt=!0,Dl.then(ml))}function dt(l){at.push(l)}const gt=new Set;let ze=0;function ml(){if(ze!==0)return;const l=Je;do{try{for(;ze<Ge.length;){const t=Ge[ze];ze++,Qe(t),Ol(t.$$)}}catch(t){throw Ge.length=0,ze=0,t}for(Qe(null),Ge.length=0,ze=0;Ie.length;)Ie.pop()();for(let t=0;t<at.length;t+=1){const e=at[t];gt.has(e)||(gt.add(e),e())}at.length=0}while(Ge.length);for(;Lt.length;)Lt.pop()();vt=!1,gt.clear(),Qe(l)}function Ol(l){if(l.fragment!==null){l.update(),be(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(dt)}}const ct=new Set;let Ae;function Ze(){Ae={r:0,c:[],p:Ae}}function $e(){Ae.r||be(Ae.c),Ae=Ae.p}function J(l,t){l&&l.i&&(ct.delete(l),l.i(t))}function Y(l,t,e,s){if(l&&l.o){if(ct.has(l))return;ct.add(l),Ae.c.push(()=>{ct.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function fe(l){l&&l.c()}function oe(l,t,e,s){const{fragment:r,after_update:n}=l.$$;r&&r.m(t,e),s||dt(()=>{const i=l.$$.on_mount.map(hl).filter(kt);l.$$.on_destroy?l.$$.on_destroy.push(...i):be(i),l.$$.on_mount=[]}),n.forEach(dt)}function ae(l,t){const e=l.$$;e.fragment!==null&&(be(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Fl(l,t){l.$$.dirty[0]===-1&&(Ge.push(l),jl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function je(l,t,e,s,r,n,i,a=[-1]){const o=Je;Qe(l);const u=l.$$={fragment:null,ctx:[],props:n,update:B,not_equal:r,bound:Ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:Ot(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};i&&i(u.root);let d=!1;if(u.ctx=e?e(l,t.props||{},(p,g,...m)=>{const h=m.length?m[0]:g;return u.ctx&&r(u.ctx[p],u.ctx[p]=h)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](h),d&&Fl(l,p)),g}):[],u.update(),d=!0,be(u.before_update),u.fragment=s?s(u.ctx):!1,t.target){if(t.hydrate){const p=xl(t.target);u.fragment&&u.fragment.l(p),p.forEach(O)}else u.fragment&&u.fragment.c();t.intro&&J(l.$$.fragment),oe(l,t.target,t.anchor,t.customElement),ml()}Qe(o)}class Oe{$destroy(){ae(this,1),this.$destroy=B}$on(t,e){if(!kt(e))return B;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const r=s.indexOf(e);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!kl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ue=[];function Me(l,t=B){let e;const s=new Set;function r(a){if(xe(l,a)&&(l=a,e)){const o=!Ue.length;for(const u of s)u[1](),Ue.push(u,l);if(o){for(let u=0;u<Ue.length;u+=2)Ue[u][0](Ue[u+1]);Ue.length=0}}}function n(a){r(a(l))}function i(a,o=B){const u=[a,o];return s.add(u),s.size===1&&(e=t(r)||B),a(l),()=>{s.delete(u),s.size===0&&(e(),e=null)}}return{set:r,update:n,subscribe:i}}const yt=Me(0),xt=Me(0),Ct=Me(0),gl=Me(0),ut=Me([]);let Ll={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Pe=Me(Ll),bl=Me([]);function Tt(l,t,e){const s=l.slice();return s[26]=t[e],s}function qt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Et(l,t,e){const s=l.slice();return s[34]=t[e],s}function Pt(l){let t,e=l[4][l[29]],s=[];for(let r=0;r<e.length;r+=1)s[r]=Nt(Et(l,e,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();t=w()},m(r,n){for(let i=0;i<s.length;i+=1)s[i].m(r,n);F(r,t,n)},p(r,n){if(n[0]&2576){e=r[4][r[29]];let i;for(i=0;i<e.length;i+=1){const a=Et(r,e,i);s[i]?s[i].p(a,n):(s[i]=Nt(a),s[i].c(),s[i].m(t.parentNode,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=e.length}},d(r){we(s,r),r&&O(t)}}}function Nt(l){let t,e,s,r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,i,a,o=l[34]+" ",u,d,p,g,m;function h(...v){return l[14](l[29],l[34],...v)}return{c(){t=_("div"),e=_("div"),s=_("span"),n=z(r),i=w(),a=_("span"),u=z(o),d=w(),p=_("span"),p.textContent="x",f(s,"class","text-blue-800 "),f(a,"class","ml-1 text-sm font-semibold"),f(p,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),f(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),f(t,"class","flex items-center justify-center")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,n),c(e,i),c(e,a),c(a,u),c(e,d),c(e,p),g||(m=[H(p,"click",h),H(e,"click",function(){kt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(v,b){l=v,b[0]&16&&r!==(r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&W(n,r),b[0]&16&&o!==(o=l[34]+" ")&&W(u,o)},d(v){v&&O(t),g=!1,be(m)}}}function At(l){let t,e=l[4][l[29]].length>=1&&Pt(l);return{c(){e&&e.c(),t=Ne()},m(s,r){e&&e.m(s,r),F(s,t,r)},p(s,r){s[4][s[29]].length>=1?e?e.p(s,r):(e=Pt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function It(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,r,n;return{c(){t=_("option"),s=z(e),r=w(),t.__value=n=l[29],t.value=t.__value},m(i,a){F(i,t,a),c(t,s),c(t,r)},p(i,a){a[0]&16&&e!==(e=i[29].charAt(0).toUpperCase()+i[29].slice(1)+"")&&W(s,e),a[0]&16&&n!==(n=i[29])&&(t.__value=n,t.value=t.__value)},d(i){i&&O(t)}}}function Mt(l){let t,e,s,r,n,i,a,o,u=l[3],d=[];for(let p=0;p<u.length;p+=1)d[p]=Bt(Tt(l,u,p));return{c(){t=_("div"),e=_("ul");for(let p=0;p<d.length;p+=1)d[p].c();s=w(),r=_("div"),n=_("button"),n.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(r,"class","flex w-full justify-center items-center"),f(t,"class",i=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(p,g){F(p,t,g),c(t,e);for(let m=0;m<d.length;m+=1)d[m].m(e,null);c(t,s),c(t,r),c(r,n),a||(o=H(n,"click",l[22]),a=!0)},p(p,g){if(g[0]&1034){u=p[3];let m;for(m=0;m<u.length;m+=1){const h=Tt(p,u,m);d[m]?d[m].p(h,g):(d[m]=Bt(h),d[m].c(),d[m].m(e,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=u.length}g[0]&32&&i!==(i=(p[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",i)},d(p){p&&O(t),we(d,p),a=!1,o()}}}function Bt(l){let t,e=l[26]+"",s,r,n,i;function a(){return l[21](l[26])}return{c(){t=_("li"),s=z(e),r=w(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(o,u){F(o,t,u),c(t,s),c(t,r),n||(i=H(t,"click",a),n=!0)},p(o,u){l=o,u[0]&8&&e!==(e=l[26]+"")&&W(s,e)},d(o){o&&O(t),n=!1,i()}}}function Rt(l){let t;return{c(){t=_("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,f(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Tl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,j=Object.keys(l[4]),T=[];for(let k=0;k<j.length;k+=1)T[k]=At(Ht(l,j,k));let E=Object.keys(l[4]),q=[];for(let k=0;k<E.length;k+=1)q[k]=It(qt(l,E,k));let S=l[3].length>0&&Mt(l),y=l[6]==!0&&Rt();return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div");for(let k=0;k<T.length;k+=1)T[k].c();n=w(),i=_("div"),a=_("select");for(let k=0;k<q.length;k+=1)q[k].c();o=w(),u=_("div"),d=_("input"),p=w(),g=_("div"),m=_("button"),m.textContent="Search",h=w(),S&&S.c(),v=w(),y&&y.c(),f(r,"class","flex w-full items-center my-3 flex-wrap text-lg"),f(a,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(a,"name","select-option"),f(a,"id","select-option"),l[1]===void 0&&dt(()=>l[16].call(a)),f(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(d,"type","search"),f(d,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(g,"class","flex"),f(i,"class","flex space-x-2"),f(s,"class","w-full"),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(k,D){F(k,t,D),c(t,e),c(e,s),c(s,r);for(let x=0;x<T.length;x+=1)T[x].m(r,null);c(s,n),c(s,i),c(i,a);for(let x=0;x<q.length;x+=1)q[x].m(a,null);Ft(a,l[1]),c(i,o),c(i,u),c(u,d),l[17](d),c(i,p),c(i,g),c(g,m),l[20](m),c(e,h),S&&S.m(e,null),c(e,v),y&&y.m(e,null),b||(C=[H(a,"change",l[15]),H(a,"change",l[16]),H(d,"focus",l[18],{once:!0}),H(d,"focusout",l[19]),H(d,"keyup",l[8]),H(d,"keydown",l[7]),H(m,"click",l[12])],b=!0)},p(k,D){if(D[0]&2576){j=Object.keys(k[4]);let x;for(x=0;x<j.length;x+=1){const U=Ht(k,j,x);T[x]?T[x].p(U,D):(T[x]=At(U),T[x].c(),T[x].m(r,null))}for(;x<T.length;x+=1)T[x].d(1);T.length=j.length}if(D[0]&16){E=Object.keys(k[4]);let x;for(x=0;x<E.length;x+=1){const U=qt(k,E,x);q[x]?q[x].p(U,D):(q[x]=It(U),q[x].c(),q[x].m(a,null))}for(;x<q.length;x+=1)q[x].d(1);q.length=E.length}D[0]&18&&Ft(a,k[1]),k[3].length>0?S?S.p(k,D):(S=Mt(k),S.c(),S.m(e,v)):S&&(S.d(1),S=null),k[6]==!0?y||(y=Rt(),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:B,o:B,d(k){k&&O(t),we(T,k),we(q,k),l[17](null),l[20](null),S&&S.d(),y&&y.d(),b=!1,be(C)}}}async function ql(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let r=await fetch(e,{method:"POST",body:s});return r.ok===!0?await r.json():{}}function Hl(l,t,e){De(()=>{bl.subscribe(P=>{for(let I=0;I<P.length;I++)e(4,d[P[I]]=[],d)})});const s=_t();let r="query",n,i,{query_button_disabled:a=!1}=t,o="",u=[],d={query:[]},p=!1;var g={};function m(P){g[P.keyCode]=P.type=="keydown",g[13]==!0&&P.shiftKey&&(console.log("shift enter combination."),j())}async function h(P){e(6,T=!1),g[P.keyCode]=!1;let I=P.target;if(I.value.length==0){e(3,u=[]);return}if(console.log("current value: ",I.value),P.keyCode==13){let A=d[r].length;I.value.length>0&&!d[r].includes(I.value)&&e(4,d[r][A]=I.value,d),I.value="",e(3,u=[]),e(5,p=!1);return}let L=await ql(r,I.value);r in L?(e(3,u=L[r]),e(5,p=!0)):(e(3,u=[]),e(5,p=!1))}function v(P,I,L){let A=d[I].indexOf(L);A>=0&&(d[I].splice(A,1),e(4,d)),r==I&&e(3,u=[])}function b(P,I){e(5,p=!1),e(2,n.value=I,n),n.focus()}function C(P){e(1,r=P),e(3,u=d[r]),e(5,p=!0),n.focus()}function j(P){let I="&",L="?",A="=",R=d[r].length;n.value.length>0&&!d[r].includes(n.value)&&e(4,d[r][R]=n.value,d);let Q=Object.keys(d);o="";for(let ne=0;ne<Q.length;ne++){let Z=Q[ne],le=d[Z];o+=Z+A;for(let $=0;$<le.length;$++)o+=le[$],$!=le.length-1&&(o+=L);ne!=Q.length-1&&(o+=I)}console.log("Completed: "+o),e(2,n.value="",n),i.disabled==!1?s("queryReady",{query:o,attributes:d}):console.log("chill dawg!!!")}let T=!1;const E=(P,I,L)=>v(L.currentTarget,P,I),q=P=>C(P.target.value);function S(){r=Cl(this),e(1,r),e(4,d)}function y(P){Ie[P?"unshift":"push"](()=>{n=P,e(2,n)})}const k=P=>{P.target.value.length==0&&e(6,T=!0)},D=P=>{e(6,T=!1)};function x(P){Ie[P?"unshift":"push"](()=>{i=P,e(0,i),e(13,a)})}const U=P=>b(r,P),G=()=>e(5,p=!1);return l.$$set=P=>{"query_button_disabled"in P&&e(13,a=P.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&i&&e(0,i.disabled=a,i)},[i,r,n,u,d,p,T,m,h,v,b,C,j,a,E,q,S,y,k,D,x,U,G]}class El extends Oe{constructor(t){super(),je(this,t,Hl,Tl,xe,{query_button_disabled:13},null,[-1,-1])}}function zt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function Pl(l){let t,e,s;return{c(){t=_("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(r,n){F(r,t,n),e||(s=H(t,"click",l[2]),e=!0)},p:B,d(r){r&&O(t),e=!1,s()}}}function Nl(l){let t,e,s,r,n;return{c(){t=_("span"),t.textContent="Hachi",e=w(),s=_("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(s,"class","cursor-pointer px-4")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a),r||(n=H(s,"click",l[3]),r=!0)},p:B,d(i){i&&O(t),i&&O(e),i&&O(s),r=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",r,n,i,a=l[8].count+"",o;return{c(){t=_("div"),e=_("div"),r=z(s),n=w(),i=_("div"),o=z(a),f(e,"class","flex"),f(e,"data-ix",l[10]),f(i,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,d){F(u,t,d),c(t,e),c(e,r),c(t,n),c(t,i),c(i,o)},p(u,d){d&2&&s!==(s=u[8].name+"")&&W(r,s),d&2&&a!==(a=u[8].count+"")&&W(o,a)},d(u){u&&O(t)}}}function Gt(l){let t,e,s,r,n,i,a,o=l[0].sidebarOpen&&Ut(l);function u(){return l[6](l[10])}return{c(){t=_("div"),e=_("i"),r=w(),o&&o.c(),n=w(),f(e,"class",s="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,p){F(d,t,p),c(t,e),c(t,r),o&&o.m(t,null),c(t,n),i||(a=H(t,"click",u),i=!0)},p(d,p){l=d,p&2&&s!==(s="fa-solid fa-"+l[8].icon)&&f(e,"class",s),l[0].sidebarOpen?o?o.p(l,p):(o=Ut(l),o.c(),o.m(t,n)):o&&(o.d(1),o=null)},d(d){d&&O(t),o&&o.d(),i=!1,a()}}}function Al(l){let t,e,s,r,n,i;function a(g,m){return g[0].sidebarOpen?Nl:Pl}let o=a(l),u=o(l),d=l[1],p=[];for(let g=0;g<d.length;g+=1)p[g]=Gt(zt(l,d,g));return{c(){t=_("div"),e=_("aside"),s=_("div"),u.c(),r=w(),n=_("nav");for(let g=0;g<p.length;g+=1)p[g].c();f(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(n,"class","mt-6"),f(e,"class",i=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-100 text-white")},m(g,m){F(g,t,m),c(t,e),c(e,s),u.m(s,null),c(e,r),c(e,n);for(let h=0;h<p.length;h+=1)p[h].m(n,null)},p(g,[m]){if(o===(o=a(g))&&u?u.p(g,m):(u.d(1),u=o(g),u&&(u.c(),u.m(s,null))),m&19){d=g[1];let h;for(h=0;h<d.length;h+=1){const v=zt(g,d,h);p[h]?p[h].p(v,m):(p[h]=Gt(v),p[h].c(),p[h].m(n,null))}for(;h<p.length;h+=1)p[h].d(1);p.length=d.length}m&1&&i!==(i=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",i)},i:B,o:B,d(g){g&&O(t),u.d(),we(p,g)}}}function Il(l,t,e){const s=_t();let{sidebarOpen:r=!1}=t;const n={sidebarOpen:r},i=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0},{icon:"folder",path:"#",name:"Local",count:0},{icon:"image",path:"#",name:"Google Photos",count:0}];De(()=>{yt.subscribe(p=>{i&&e(1,i[0].count=p,i)}),xt.subscribe(p=>{i&&e(1,i[3].count=p,i)}),Ct.subscribe(p=>{i&&e(1,i[4].count=p,i)}),gl.subscribe(p=>{i&&e(1,i[5].count=p,i)})});function a(){e(0,n.sidebarOpen=!0,n)}function o(){e(0,n.sidebarOpen=!1,n)}function u(p){s("menuClick",{item:i[p]})}const d=p=>{u(p)};return l.$$set=p=>{"sidebarOpen"in p&&e(5,r=p.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,i,a,o,u,r,d]}class Ve extends Oe{constructor(t){super(),je(this,t,Il,Al,xe,{sidebarOpen:5})}}function Ml(l){let t,e,s,r,n,i,a,o,u,d,p,g,m=(l[3]*100).toString().slice(0,4)+"",h,v,b,C,j,T,E,q,S,y,k,D,x,U,G,P,I,L,A,R,Q,ne,Z,le,$,ve,ee,X,de,ce,ie,Fe,Le,Te,me,He,ke,Ce,ge;return{c(){t=_("div"),e=_("p"),e.textContent="Press Start button to start indexing",s=w(),r=_("div"),n=_("input"),i=w(),a=_("div"),o=_("div"),u=_("div"),d=_("div"),p=w(),g=_("div"),h=z(m),v=z("%"),b=w(),C=_("div"),j=z("Current directory: "),T=_("span"),E=z(l[4]),q=w(),S=_("span"),S.textContent="ETA:",y=w(),k=_("span"),D=z(l[6]),x=w(),U=_("div"),G=z("Details: "),P=_("span"),I=z(l[5]),L=w(),A=_("div"),R=_("div"),Q=_("input"),ne=w(),Z=_("label"),Z.textContent="Complete Rescan",le=w(),$=_("div"),$.textContent="Re-index all originals, including already indexed and unchanged files.",ve=w(),ee=_("div"),X=_("select"),de=_("option"),de.textContent="Images Only",ce=_("option"),ce.textContent="Videos Only",ie=_("option"),ie.textContent="Videos and Images",Fe=w(),Le=_("div"),Le.textContent="Filter by content type",Te=w(),me=_("button"),me.textContent="Cancel",He=w(),ke=_("button"),ke.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(n,"type","text"),f(n,"class","w-full rounded border p-1 text-sm"),f(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,f(r,"class","my-2"),f(d,"class","h-2rounded bg-blue-500"),he(d,"width",(l[3]*100).toString()+"%"),f(u,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(g,"class","flex px-2 font-semibold"),f(o,"class","flex items-center"),f(T,"class","text-black"),f(S,"class","pl-3 text-right"),f(k,"class","text-black"),f(C,"class","pt-1 text-sm text-blue-600"),f(P,"class","text-black"),f(U,"class","pt-1 text-sm text-blue-600"),f(a,"class","mb-3"),f(Q,"type","checkbox"),f(Q,"class","h-5 w-5 text-blue-500"),f(Z,"class","ml-1"),f(R,"class","mr-2 flex items-center"),f($,"class","text-sm text-gray-600"),f(A,"class","mt-4 mb-3 flex flex-wrap items-center"),de.__value="Images Only",de.value=de.__value,ce.disabled=!0,ce.__value="Videos Only",ce.value=ce.__value,ie.disabled=!0,ie.__value="Videos and Images",ie.value=ie.__value,f(X,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(Le,"class","ml-2 text-sm text-gray-600"),f(ee,"class","mb-3 mt-3 flex flex-wrap items-center"),me.disabled=!0,f(me,"type","button"),f(me,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(ke,"type","button"),f(ke,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(re,_e){F(re,t,_e),c(t,e),c(t,s),c(t,r),c(r,n),l[12](n),ft(n,l[7]),c(t,i),c(t,a),c(a,o),c(o,u),c(u,d),c(o,p),c(o,g),c(g,h),c(g,v),c(a,b),c(a,C),c(C,j),c(C,T),c(T,E),c(C,q),c(C,S),c(C,y),c(C,k),c(k,D),c(a,x),c(a,U),c(U,G),c(U,P),c(P,I),c(t,L),c(t,A),c(A,R),c(R,Q),Q.checked=l[8],c(R,ne),c(R,Z),c(A,le),c(A,$),c(t,ve),c(t,ee),c(ee,X),c(X,de),c(X,ce),c(X,ie),c(ee,Fe),c(ee,Le),c(t,Te),c(t,me),l[16](me),c(t,He),c(t,ke),l[17](ke),Ce||(ge=[H(n,"input",l[13]),H(n,"keydown",l[14]),H(Q,"change",l[15]),H(me,"click",l[10]),H(ke,"click",l[9])],Ce=!0)},p(re,[_e]){_e&128&&n.value!==re[7]&&ft(n,re[7]),_e&8&&he(d,"width",(re[3]*100).toString()+"%"),_e&8&&m!==(m=(re[3]*100).toString().slice(0,4)+"")&&W(h,m),_e&16&&W(E,re[4]),_e&64&&W(D,re[6]),_e&32&&W(I,re[5]),_e&256&&(Q.checked=re[8])},i:B,o:B,d(re){re&&O(t),l[12](null),l[16](null),l[17](null),Ce=!1,be(ge)}}}function Bl(l,t,e){let s,r,n;De(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let y="/api/getIndexStatus/"+s;e(0,r.disabled=!1,r),e(1,n.disabled=!0,n),m(y)}}),Ye(()=>{g&&clearTimeout(g)});let i,a=.001,o="",u="",d="",p="",g;async function m(y,k=0){k==0&&console.log("starting a new polll...");let x=await(await fetch(y,{method:"GET"})).json();if(x.is_active==!0){if(x.done==!0){let G=x.details,P=new FormData;P.append("ack","true"),(await fetch(y,{method:"POST",body:P})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert(`Indexing Completed.
Final Status: `+G);let L=await fetch("/api/getMetaStats");L=await L.json(),yt.update(A=>Number(L.image.count)),xt.update(A=>Number(L.image.unique_people_count)),Ct.update(A=>Number(L.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,a=0),e(4,o=""),e(6,d=""),e(5,u=""),e(7,p=""),e(0,r.disabled=!0,r),e(0,r.innerText="Cancel",r),e(2,i.disabled=!1,i);return}e(3,a=x.progress),e(6,d=x.eta),e(5,u=x.details),e(4,o=x.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(y,k+1)},1e3)}}let h=!1;async function v(){if(n&&p){e(1,n.disabled=!0,n),e(2,i.disabled=!0,i);let y=new FormData;y.append("image_directory_path",p),y.append("complete_rescan",h.toString());let x=await(await fetch("/api/indexStart",{method:"POST",body:y})).json();if(x.success===!0){e(0,r.disabled=!1,r);let G="/api/getIndexStatus/"+x.statusEndpoint;e(11,s=x.statusEndpoint),m(G)}else alert(x.reason),e(1,n.disabled=!1,n),e(2,i.disabled=!1,i)}else console.log("No index_start_button object found!!!")}async function b(){if(s){e(0,r.disabled=!0,r),e(0,r.innerText="Cancelling... Please wait.",r);let y="/api/indexCancel/"+s,k=await fetch(y,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!k.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(k);return}else return}function C(y){Ie[y?"unshift":"push"](()=>{i=y,e(2,i)})}function j(){p=this.value,e(7,p)}const T=y=>{y.key==="Enter"&&n.click()};function E(){h=this.checked,e(8,h)}function q(y){Ie[y?"unshift":"push"](()=>{r=y,e(0,r)})}function S(y){Ie[y?"unshift":"push"](()=>{n=y,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[r,n,i,a,o,u,d,p,h,v,b,s,C,j,T,E,q,S]}class Rl extends Oe{constructor(t){super(),je(this,t,Bl,Ml,xe,{})}}function Vt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=_("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Wt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),r,n,i,a=l[13]+"",o,u,d,p=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=_("div"),e=_("div"),p&&p.c(),n=w(),i=_("span"),o=z(a),f(e,"class",r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){F(m,t,h),c(t,e),p&&p.m(e,null),c(t,n),c(t,i),c(i,o),u||(d=H(t,"click",g),u=!0)},p(m,h){l=m,h&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?p||(p=Xt(),p.c(),p.m(e,null)):p&&(p.d(1),p=null),h&2&&r!==(r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",r),h&2&&a!==(a=l[13]+"")&&W(o,a)},d(m){m&&O(t),p&&p.d(),u=!1,d()}}}function Qt(l){let t,e,s=l[10]+"",r,n,i,a,o,u,d,p,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,v=[];for(let b=0;b<h.length;b+=1)v[b]=Wt(Kt(l,h,b));return{c(){t=_("div"),e=_("div"),r=z(s),n=w(),i=_("i"),o=w(),u=_("div");for(let b=0;b<v.length;b+=1)v[b].c();f(i,"class",a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(b,C){F(b,t,C),c(t,e),c(e,r),c(e,n),c(e,i),c(t,o),c(t,u);for(let j=0;j<v.length;j+=1)v[j].m(u,null);p||(g=[H(e,"click",m),H(t,"mouseup",Kl)],p=!0)},p(b,C){if(l=b,C&2&&s!==(s=l[10]+"")&&W(r,s),C&2&&a!==(a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(i,"class",a),C&6){h=l[1].selectFilters[l[10]].options;let j;for(j=0;j<h.length;j+=1){const T=Kt(l,h,j);v[j]?v[j].p(T,C):(v[j]=Wt(T),v[j].c(),v[j].m(u,null))}for(;j<v.length;j+=1)v[j].d(1);v.length=h.length}C&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",d)},d(b){b&&O(t),we(v,b),p=!1,be(g)}}}function zl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m=Object.keys(l[1].selectFilters),h=[];for(let v=0;v<m.length;v+=1)h[v]=Qt(Vt(l,m,v));return{c(){t=_("div"),e=_("div"),s=_("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=w(),n=_("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w();for(let v=0;v<h.length;v+=1)h[v].c();a=w(),o=_("button"),u=z("Filter"),f(s,"class","flex items-center text-md"),f(n,"class","flex items-center text-md"),o.disabled=l[0],f(o,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(e,r),c(e,n),c(e,i);for(let C=0;C<h.length;C+=1)h[C].m(e,null);c(e,a),c(e,o),c(o,u),p||(g=H(o,"click",l[4]),p=!0)},p(v,[b]){if(b&14){m=Object.keys(v[1].selectFilters);let C;for(C=0;C<m.length;C+=1){const j=Vt(v,m,C);h[C]?h[C].p(j,b):(h[C]=Qt(j),h[C].c(),h[C].m(e,a))}for(;C<h.length;C+=1)h[C].d(1);h.length=m.length}b&1&&(o.disabled=v[0]),b&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&f(o,"class",d)},i:B,o:B,d(v){v&&O(t),we(h,v),p=!1,g()}}}function vl(l,t,e=null,s=(r,n)=>r===n){let r=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?r.push(1):r.push(0):s(l[n],t)?r.push(1):r.push(0);return r}function Ul(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=vl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function Gl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=vl(l,t[s],null,(n,i)=>n?n.includes(i):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function Vl(l){let t=l[0].length,e=l[0];return l.forEach((s,r)=>{if(r>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,i)=>{e[i]=Number(Boolean(e[i])&&Boolean(n))})}}),e}const Kl=l=>l.stopPropagation();function Xl(l,t,e){let s=[],{filter_button_disabled:r=!0}=t;ut.subscribe(m=>{e(0,r=!1),e(5,s=m)});const n=_t(),i={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};De(()=>{document.addEventListener("mouseup",a)});function a(m){e(1,i.selectFilterActive="",i)}function o(m,h){if(i.selectFilters[m].values.includes(h)){e(1,i.selectFilters[m].values=i.selectFilters[m].values.filter(v=>v!==h),i);return}e(1,i.selectFilters[m].values=[h,...i.selectFilters[m].values],i)}function u(m){if(i.selectFilterActive===m){e(1,i.selectFilterActive="",i);return}e(1,i.selectFilterActive=m,i)}function d(){if(s){console.log(s);let m=[],h=[];s.map((E,q)=>{m.push(E.place),h.push(E.person)});let v=i.selectFilters.place.values,b=Ul(m,v),C=i.selectFilters.people.values,j=Gl(h,C),T=Vl([b,j]);n("filterApplied",{mask:T})}}const p=m=>u(m),g=(m,h)=>o(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,r=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((C,j)=>{if(C.place)return C.place}),h=[];s.map((C,j)=>{C.person&&C.person.forEach(T=>h.push(T))});let v=[];new Set(m).forEach(C=>v.push(C));let b=[];new Set(h).forEach(C=>b.push(C)),e(1,i.selectFilters.place.values=v,i),e(1,i.selectFilters.place.options=v,i),e(1,i.selectFilters.people.values=b,i),e(1,i.selectFilters.people.options=b,i)}},[r,i,o,u,d,s,p,g]}class Wl extends Oe{constructor(t){super(),je(this,t,Xl,zl,xe,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[55]=t[e],s[54]=e,s}function Yt(l,t,e){const s=l.slice();return s[52]=t[e],s[54]=e,s}function Ql(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,j,T,E,q=l[1]&&Zt(l);e=new Wl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[42]);let S=l[6],y=[];for(let D=0;D<S.length;D+=1)y[D]=el(Jt(l,S,D));let k=l[6].length>=qe&&tl(l);return{c(){q&&q.c(),t=w(),fe(e.$$.fragment),s=w(),r=_("div"),n=_("div"),i=_("div"),a=_("div"),o=_("div"),u=_("input"),d=w(),p=_("label"),g=z("Score threshold: "),m=z(l[12]),h=z("."),v=w(),b=_("div");for(let D=0;D<y.length;D+=1)y[D].c();C=w(),k&&k.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(p,"for","topk"),f(p,"class","dark:text-white"),f(o,"class","my-2"),f(i,"class","flex flex-row place-content-center mb-2 select-none mx-2"),f(b,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),f(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),f(r,"class","flex")},m(D,x){q&&q.m(D,x),F(D,t,x),oe(e,D,x),F(D,s,x),F(D,r,x),c(r,n),c(n,i),c(i,a),c(a,o),c(o,u),ft(u,l[12]),c(o,d),c(o,p),c(p,g),c(p,m),c(p,h),c(n,v),c(n,b);for(let U=0;U<y.length;U+=1)y[U].m(b,null);c(n,C),k&&k.m(n,null),j=!0,T||(E=[H(u,"change",l[20]),H(u,"change",l[43]),H(u,"input",l[43])],T=!0)},p(D,x){D[1]?q?q.p(D,x):(q=Zt(D),q.c(),q.m(t.parentNode,t)):q&&(q.d(1),q=null);const U={};if(x[0]&8&&(U.filter_button_disabled=D[3]),e.$set(U),x[0]&4096&&ft(u,D[12]),(!j||x[0]&4096)&&W(m,D[12]),x[0]&33652801){S=D[6];let G;for(G=0;G<S.length;G+=1){const P=Jt(D,S,G);y[G]?y[G].p(P,x):(y[G]=el(P),y[G].c(),y[G].m(b,null))}for(;G<y.length;G+=1)y[G].d(1);y.length=S.length}D[6].length>=qe?k?k.p(D,x):(k=tl(D),k.c(),k.m(n,null)):k&&(k.d(1),k=null)},i(D){j||(J(e.$$.fragment,D),j=!0)},o(D){Y(e.$$.fragment,D),j=!1},d(D){q&&q.d(D),D&&O(t),ae(e,D),D&&O(s),D&&O(r),we(y,D),k&&k.d(),T=!1,be(E)}}}function Jl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,j,T,E,q,S=l[2].image_card_edit_interface&&ll(l),y=l[5]&&sl(l);return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,r=w(),n=_("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',i=w(),a=_("div"),o=_("div"),o.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=w(),d=_("div"),p=_("div"),g=_("img"),h=w(),v=_("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=w(),S&&S.c(),C=w(),j=_("div"),j.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',T=w(),y&&y.c(),f(s,"class","cursor-pointer hover:underline text-gray-200"),f(n,"title","Fullscreen"),f(n,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(o,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(g,"class","w-auto cursor-pointer h-full"),Se(g.src,m="/api/getRawData/"+l[4].data_hash)||f(g,"src",m),f(g,"alt",""),f(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(p,"class","flex shrink h-full"),f(d,"class","flex h-full items-center justify-center p-2 gap-4"),f(j,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(a,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(k,D){F(k,t,D),c(t,e),c(e,s),c(e,r),c(e,n),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(d,p),c(p,g),c(p,h),c(p,v),c(d,b),S&&S.m(d,null),c(a,C),c(a,j),c(t,T),y&&y.m(t,null),E||(q=[H(s,"click",l[34]),H(n,"click",l[35]),H(o,"click",l[36]),H(g,"click",l[37]),H(v,"click",l[38]),H(j,"click",l[40])],E=!0)},p(k,D){D[0]&16&&!Se(g.src,m="/api/getRawData/"+k[4].data_hash)&&f(g,"src",m),k[2].image_card_edit_interface?S?S.p(k,D):(S=ll(k),S.c(),S.m(d,null)):S&&(S.d(1),S=null),k[5]?y?y.p(k,D):(y=sl(k),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i:B,o:B,d(k){k&&O(t),S&&S.d(),y&&y.d(),E=!1,be(q)}}}function Yl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,j,T,E=l[11]==!1&&nl(),q=l[10],S=[];for(let k=0;k<q.length;k+=1)S[k]=rl(Yt(l,q,k));let y=l[9].active&&il(l);return{c(){t=_("div"),e=_("div"),s=_("img"),n=w(),E&&E.c(),i=w();for(let k=0;k<S.length;k+=1)S[k].c();a=w(),y&&y.c(),o=w(),u=_("div"),d=_("div"),d.innerHTML='<i class="fa fa-arrow-left"></i>',p=w(),g=_("div"),g.innerHTML='<i class="fa fa-arrow-right"></i>',m=w(),h=_("div"),v=_("div"),v.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),C=_("div"),C.innerHTML='<i class="fa fa-arrows-alt"></i>',f(s,"class","object-cover h-screen w-auto"),Se(s.src,r="/api/getRawDataFull/"+l[4].data_hash)||f(s,"src",r),f(s,"alt",""),f(e,"class","relative flex"),f(d,"class","text-white cursor-pointer"),f(g,"class","text-white cursor-pointer"),f(u,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(v,"class","cursor-pointer hover:underline text-white"),f(C,"title","Fullscreen"),f(C,"class","cursor-pointer text-white"),f(h,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(k,D){F(k,t,D),c(t,e),c(e,s),c(e,n),E&&E.m(e,null),c(e,i);for(let x=0;x<S.length;x+=1)S[x].m(e,null);c(e,a),y&&y.m(e,null),c(t,o),c(t,u),c(u,d),c(u,p),c(u,g),F(k,m,D),F(k,h,D),c(h,v),c(h,b),c(h,C),j||(T=[H(s,"load",l[19]),H(d,"click",l[30]),H(g,"click",l[31]),H(v,"click",l[32]),H(C,"click",l[33])],j=!0)},p(k,D){if(D[0]&16&&!Se(s.src,r="/api/getRawDataFull/"+k[4].data_hash)&&f(s,"src",r),k[11]==!1?E||(E=nl(),E.c(),E.m(e,i)):E&&(E.d(1),E=null),D[0]&1792){q=k[10];let x;for(x=0;x<q.length;x+=1){const U=Yt(k,q,x);S[x]?S[x].p(U,D):(S[x]=rl(U),S[x].c(),S[x].m(e,a))}for(;x<S.length;x+=1)S[x].d(1);S.length=q.length}k[9].active?y?y.p(k,D):(y=il(k),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:B,o:B,d(k){k&&O(t),E&&E.d(),we(S,k),y&&y.d(),k&&O(m),k&&O(h),j=!1,be(T)}}}function Zt(l){let t,e,s,r,n;return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(s,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(i,a){F(i,t,a),c(t,e),c(e,s),r||(n=H(s,"click",l[41]),r=!0)},p:B,d(i){i&&O(t),r=!1,n()}}}function $t(l){let t,e,s,r,n,i;function a(){return l[44](l[54])}return{c(){t=_("div"),e=_("img"),r=w(),f(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),Se(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])||f(e,"src",s),f(e,"alt","image"),f(t,"class","flex justify-center bg-black")},m(o,u){F(o,t,u),c(t,e),c(t,r),n||(i=[H(e,"load",l[25]),H(t,"click",a)],n=!0)},p(o,u){l=o,u[0]&65&&!Se(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])&&f(e,"src",s)},d(o){o&&O(t),n=!1,be(i)}}}function el(l){let t,e=l[55].ix>=0&&$t(l);return{c(){e&&e.c(),t=Ne()},m(s,r){e&&e.m(s,r),F(s,t,r)},p(s,r){s[55].ix>=0?e?e.p(s,r):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function tl(l){let t,e,s,r;return{c(){t=_("div"),e=_("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),f(t,"class","flex items-center justify-center")},m(n,i){F(n,t,i),c(t,e),s||(r=H(e,"click",l[14]),s=!0)},p:B,d(n){n&&O(t),s=!1,r()}}}function ll(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,j,T,E,q,S,y,k,D,x,U,G,P,I,L,A,R,Q,ne,Z,le,$,ve;return{c(){t=_("div"),e=_("div"),s=_("div"),s.textContent="Info",r=w(),n=_("div"),n.textContent="X",i=w(),a=_("div"),o=_("div"),o.textContent="Description",u=w(),d=_("input"),g=w(),m=_("div"),h=_("div"),h.textContent="place",v=w(),b=_("input"),j=w(),T=_("div"),E=_("div"),E.textContent="Tags",q=w(),S=_("input"),k=w(),D=_("div"),x=_("div"),x.textContent="Taken at:",U=w(),G=_("input"),P=w(),I=_("div"),L=_("div"),L.textContent="device",A=w(),R=_("input"),ne=w(),Z=_("div"),le=_("button"),le.textContent="Save",f(s,"class","grow text-xl text-gray-100 font-bold"),f(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(o,"class","mb-1 text-gray-100"),f(d,"name","Description"),f(d,"placeholder",""),d.value=p=l[4].description.toString(),f(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(d,"type","text"),f(h,"class","mb-1 text-gray-100"),f(b,"name","place"),b.value=C=l[4].place.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(E,"class","mb-1 text-gray-100"),f(S,"name","tags"),f(S,"placeholder","Car, chair"),S.value=y=l[4].tags.toString(),f(S,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(S,"type","text"),f(x,"class","mb-1 text-gray-100"),f(G,"name","taken_at"),G.value="",f(G,"type","date"),f(G,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(L,"class","mb-1 text-gray-100"),f(R,"name","device"),f(R,"placeholder","Canon"),R.value=Q=l[4].device.toString(),f(R,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(R,"type","text"),f(le,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(ee,X){F(ee,t,X),c(t,e),c(e,s),c(e,r),c(e,n),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(t,g),c(t,m),c(m,h),c(m,v),c(m,b),c(t,j),c(t,T),c(T,E),c(T,q),c(T,S),c(t,k),c(t,D),c(D,x),c(D,U),c(D,G),c(t,P),c(t,I),c(I,L),c(I,A),c(I,R),c(t,ne),c(t,Z),c(Z,le),$||(ve=[H(n,"click",l[39]),H(d,"change",l[23]),H(b,"change",l[23]),H(S,"change",l[23]),H(G,"change",l[23]),H(R,"change",l[23]),H(le,"click",l[24])],$=!0)},p(ee,X){X[0]&16&&p!==(p=ee[4].description.toString())&&d.value!==p&&(d.value=p),X[0]&16&&C!==(C=ee[4].place.toString())&&b.value!==C&&(b.value=C),X[0]&16&&y!==(y=ee[4].tags.toString())&&S.value!==y&&(S.value=y),X[0]&16&&Q!==(Q=ee[4].device.toString())&&R.value!==Q&&(R.value=Q)},d(ee){ee&&O(t),$=!1,be(ve)}}}function sl(l){let t,e,s,r,n=l[4].filename+"",i,a,o,u,d,p=l[4].data_hash+"",g,m,h,v,b,C=l[4].last_modified+"",j,T,E,q,S,y,k,D,x,U=l[4].description.toString()+"",G,P,I,L,A,R,Q=l[4].taken_at.toString()+"",ne,Z,le,$,ve,ee,X=l[4].tags.toString()+"",de,ce,ie,Fe,Le,Te,me=l[4].place.toString()+"",He,ke,Ce,ge,re,_e,N,M,K=l[4].person_ids.toString()+"",se,V,ye,Be,et,Ee,pe=l[4].device.toString()+"",Re,Ke,Xe,tt,St,lt,st=l[4].resolution.toString()+"",ht,Dt,We,nt,jt,rt,it=l[4].absolute_path.toString()+"",mt;return{c(){t=_("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=_("div"),r=_("div"),i=z(n),a=w(),o=_("div"),u=z("UID: "),d=_("span"),g=z(p),m=w(),h=_("div"),v=z("Last Modified:  "),b=_("span"),j=z(C),T=w(),E=_("div"),q=_("div"),S=_("div"),y=_("div"),k=_("div"),k.textContent="Description",D=w(),x=_("div"),G=z(U),P=w(),I=_("div"),L=_("div"),L.textContent="Taken at",A=w(),R=_("div"),ne=z(Q),Z=w(),le=_("div"),$=_("div"),$.textContent="Tags",ve=w(),ee=_("div"),de=z(X),ce=w(),ie=_("div"),Fe=_("div"),Fe.textContent="Place",Le=w(),Te=_("div"),He=z(me),ke=w(),Ce=_("div"),ge=_("div"),re=_("div"),_e=_("div"),_e.textContent="people",N=w(),M=_("div"),se=z(K),V=w(),ye=_("div"),Be=_("div"),Be.textContent="Device",et=w(),Ee=_("div"),Re=z(pe),Ke=w(),Xe=_("div"),tt=_("div"),tt.textContent="Resolution",St=w(),lt=_("div"),ht=z(st),Dt=w(),We=_("div"),nt=_("div"),nt.textContent="Path",jt=w(),rt=_("div"),mt=z(it),f(r,"class","text-xl text-white"),f(d,"class","text-sm text-gray-400"),f(o,"class","text-white"),f(b,"class","text-sm text-gray-400"),f(h,"class","text-white"),f(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(k,"class",""),f(x,"class","text-sm text-gray-400"),f(L,"class",""),f(R,"class","text-sm text-gray-400"),f($,"class",""),f(ee,"class","text-sm text-gray-400"),f(Fe,"class",""),f(Te,"class","text-sm text-gray-400"),f(S,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(q,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(_e,"class",""),f(M,"class","text-sm text-gray-400"),f(Be,"class",""),f(Ee,"class","text-sm text-gray-400"),f(tt,"class",""),f(lt,"class","text-sm text-gray-400"),f(nt,"class",""),f(rt,"class","text-sm text-gray-400"),f(ge,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(Ce,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(E,"class","flex w-full justify-center p-4")},m(te,ue){F(te,t,ue),F(te,e,ue),F(te,s,ue),c(s,r),c(r,i),c(s,a),c(s,o),c(o,u),c(o,d),c(d,g),c(s,m),c(s,h),c(h,v),c(h,b),c(b,j),F(te,T,ue),F(te,E,ue),c(E,q),c(q,S),c(S,y),c(y,k),c(y,D),c(y,x),c(x,G),c(S,P),c(S,I),c(I,L),c(I,A),c(I,R),c(R,ne),c(S,Z),c(S,le),c(le,$),c(le,ve),c(le,ee),c(ee,de),c(S,ce),c(S,ie),c(ie,Fe),c(ie,Le),c(ie,Te),c(Te,He),c(E,ke),c(E,Ce),c(Ce,ge),c(ge,re),c(re,_e),c(re,N),c(re,M),c(M,se),c(ge,V),c(ge,ye),c(ye,Be),c(ye,et),c(ye,Ee),c(Ee,Re),c(ge,Ke),c(ge,Xe),c(Xe,tt),c(Xe,St),c(Xe,lt),c(lt,ht),c(ge,Dt),c(ge,We),c(We,nt),c(We,jt),c(We,rt),c(rt,mt)},p(te,ue){ue[0]&16&&n!==(n=te[4].filename+"")&&W(i,n),ue[0]&16&&p!==(p=te[4].data_hash+"")&&W(g,p),ue[0]&16&&C!==(C=te[4].last_modified+"")&&W(j,C),ue[0]&16&&U!==(U=te[4].description.toString()+"")&&W(G,U),ue[0]&16&&Q!==(Q=te[4].taken_at.toString()+"")&&W(ne,Q),ue[0]&16&&X!==(X=te[4].tags.toString()+"")&&W(de,X),ue[0]&16&&me!==(me=te[4].place.toString()+"")&&W(He,me),ue[0]&16&&K!==(K=te[4].person_ids.toString()+"")&&W(se,K),ue[0]&16&&pe!==(pe=te[4].device.toString()+"")&&W(Re,pe),ue[0]&16&&st!==(st=te[4].resolution.toString()+"")&&W(ht,st),ue[0]&16&&it!==(it=te[4].absolute_path.toString()+"")&&W(mt,it)},d(te){te&&O(t),te&&O(e),te&&O(s),te&&O(T),te&&O(E)}}}function nl(l){let t,e,s;return{c(){t=_("img"),e=w(),s=wl("svg"),f(t,"class","object-cover h-screen w-full bg-black absolute top-0 left-0"),f(t,"alt",""),f(s,"class","animate-spin h-5 w-5 mr-3 bg-indigo-500 top-10 left-50 absolute"),f(s,"viewBox","0 0 24 24")},m(r,n){F(r,t,n),F(r,e,n),F(r,s,n)},d(r){r&&O(t),r&&O(e),r&&O(s)}}}function rl(l){let t,e,s;function r(...n){return l[28](l[52],...n)}return{c(){t=_("div"),f(t,"data-ix",l[54]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),he(t,"top",l[52].top+"px "),he(t,"left",l[52].left+"px"),he(t,"width",l[52].width+"px"),he(t,"height",l[52].height+"px")},m(n,i){F(n,t,i),e||(s=H(t,"click",r),e=!0)},p(n,i){l=n,i[0]&1024&&he(t,"top",l[52].top+"px "),i[0]&1024&&he(t,"left",l[52].left+"px"),i[0]&1024&&he(t,"width",l[52].width+"px"),i[0]&1024&&he(t,"height",l[52].height+"px")},d(n){n&&O(t),e=!1,s()}}}function il(l){let t,e,s,r,n,i,a;return{c(){t=_("div"),e=_("input"),r=w(),n=_("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[8]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),he(t,"top",l[9].top+"px "),he(t,"left",l[9].left+"px")},m(o,u){F(o,t,u),c(t,e),c(t,r),c(t,n),e.focus(),i||(a=[H(e,"keyup",l[22]),H(n,"click",l[29])],i=!0)},p(o,u){u[0]&272&&s!==(s=o[4].person_ids[o[8]])&&e.value!==s&&(e.value=s),u[0]&512&&he(t,"top",o[9].top+"px "),u[0]&512&&he(t,"left",o[9].left+"px")},d(o){o&&O(t),i=!1,be(a)}}}function Zl(l){let t,e,s,r,n,i;const a=[Yl,Jl,Ql],o=[];function u(d,p){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=u(l),e=o[t]=a[t](l),{c(){e.c(),s=w(),r=_("div"),n=_("div"),f(n,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),he(n,"width",(l[7]*100).toString()+"%"),f(r,"class","flex animate-pulse")},m(d,p){o[t].m(d,p),F(d,s,p),F(d,r,p),c(r,n),i=!0},p(d,p){let g=t;t=u(d),t===g?o[t].p(d,p):(Ze(),Y(o[g],1,1,()=>{o[g]=null}),$e(),e=o[t],e?e.p(d,p):(e=o[t]=a[t](d),e.c()),J(e,1),e.m(s.parentNode,s)),(!i||p[0]&128)&&he(n,"width",(d[7]*100).toString()+"%")},i(d){i||(J(e),i=!0)},o(d){Y(e),i=!1},d(d){o[t].d(d),d&&O(s),d&&O(r)}}}let qe=18;function bt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let r=0;r<l.length;r++){let n=r;t[r%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[r][e]}):s.push({ix:n,score:l[r]})}return s.sort((r,n)=>r.score>n.score?-1:r.score<n.score?1:0),s}function $l(l,t,e){const s=_t();let{show_exit_interface_button:r=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,i=!0;Ye(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),ut.update(N=>[])});let a={},o=!1,u=[],d=[],p=0,g=0,m=0,h=!1;function v(N){h!=!0&&(h=!0,g=0,e(7,m=0),e(27,p=p+qe),e(6,u=d.slice(p,p+qe)),ut.update(M=>b(u)))}function b(N){let M=[],K=N.length;for(let se=0;se<K;se++){let V=N[se].ix;M.push(n.list_metaData[V])}return M}Pe.subscribe(N=>{e(7,m=N.progress),N.done==!0?(C(N),e(7,m=0)):(e(27,p=0),e(6,u=[]))});function C(N){e(26,d=bt(N.list_score)),e(6,u=d.slice(0,0+qe)),ut.update(M=>b(u))}let j={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function T(N){let M=Object.keys(j);for(let K=0;K<M.length;K++)e(2,j[M[K]]=!1,j);e(2,j[N]=!0,j)}let E,q={active:!1,top:null,left:null};function S(N){let M={sorted_ix:null,image_ix:null};for(let K=N;K<u.length;K++)if(u[K].ix!==-1){M.image_ix=u[K].ix,M.sorted_ix=K;break}return M}let y;function k(N){Q={},e(5,o=!1),e(10,U=[]),e(9,q={active:!1,top:null,left:null});let M=N,K=u.length;M<0&&(M=K-1),M>K-1&&(M=0);let se=S(M),V=se.image_ix;M=se.sorted_ix,V===null&&(se=S(0),V=se.image_ix,M=se.sorted_ix),e(4,a.ix=M,a),e(4,a.data_hash=n.list_dataHash[V],a),j.image_card_fullscreen===!0&&(y=setTimeout(()=>{e(11,G=!1),console.log("set timeout...")},400)),e(4,a.height=Number(n.list_metaData[V].height),a),e(4,a.width=Number(n.list_metaData[V].width),a),e(4,a.face_bboxes=n.list_metaData[V].face_bboxes,a),e(4,a.person_ids=n.list_metaData[V].person,a),a.person_ids===null&&e(4,a.person_ids=[],a),e(4,a.resolution=a.height.toString()+" X "+a.width.toString(),a),e(4,a.filename=n.list_metaData[V].filename,a),e(4,a.taken_at=n.list_metaData[V].taken_at,a),a.taken_at==null&&e(4,a.taken_at="Unknown",a),e(4,a.last_modified=n.list_metaData[V].modified_at,a),e(4,a.device=n.list_metaData[V].device,a),a.device==null&&e(4,a.device="",a),e(4,a.place=n.list_metaData[V].place,a),e(4,a.absolute_path=n.list_metaData[V].absolute_path,a),e(4,a.description=n.list_metaData[V].description,a),e(4,a.tags=n.list_metaData[V].tags,a),e(5,o=!0)}function D(){k(a.ix+1)}function x(){k(a.ix-1)}let U=[],G=!0;function P(N){let M=N.target.getClientRects()[0],K=M.width,se=M.height,V=[],ye=a.face_bboxes;if(ye){let Be=a.width,et=a.height;for(let Ee=0;Ee<ye.length;Ee++){let pe=structuredClone(ye[Ee]),Re=Number(K)/(Number(Be)+1e-4),Ke=Number(se)/(Number(et)+1e-4);pe.top=pe[1]*Ke,pe.height=(pe[3]-pe[1])*Ke,pe.left=pe[0]*Re,pe.width=(pe[2]-pe[0])*Re,V.push(pe)}}e(10,U=V),y&&clearTimeout(y),e(11,G=!0)}let I=0;function L(){let N=u[0].score,M=u[u.length-1].score,se=n.list_score.map(V=>(V-M)/(N-M+1e-5)).map(V=>V>=I?1:0);e(6,u=bt(n.list_score,se))}function A(N){e(3,i=!0);let M=d.slice(p,p+qe);for(let K=0;K<N.length;K++)N[K]==0?e(6,u[K].ix=-1,u):e(6,u[K].ix=M[K].ix,u);e(3,i=!1)}function R(N){let M=N.target.value,K=a.data_hash,se=a.person_ids[E];if(N.key=="Enter"){let V=new FormData;V.append("new_person_id",M),V.append("old_person_id",se),V.append("data_hash",K),fetch("/api/tagPerson",{method:"POST",body:V}).then(ye=>{if(ye.ok)alert("Success");else throw new Error("Error occured")})}}let Q={};function ne(N){Q[N.target.name.toLowerCase()]=N.target.value}async function Z(N){N.target.disabled=!0,N.target.innerText="Saving...";let M=Object.keys(Q),K=new FormData;for(let V=0;V<M.length;V++)K.append(M[V],Q[M[V]]);K.append("data_hash",a.data_hash);let se=await fetch("/api/editMetaData",{method:"POST",body:K});se.ok?(alert("Success!"),await se.json(),e(2,j.image_card_edit_interface=!1,j)):alert("Error while saving. Contact Admin"),N.target.innerText="Save",N.target.disabled=!1}function le(N){h&&(g+=1,e(7,m+=1/qe),g==Math.min(u.length,qe)&&(e(7,m=0),h=!1))}const $=(N,M)=>{e(9,q={active:!0,top:N.top-28,left:N.left}),e(8,E=Number(M.target.attributes["data-ix"].value))},ve=()=>{e(9,q.active=!1,q)},ee=()=>{x()},X=()=>{D()},de=()=>{T("parent")},ce=()=>{T("image_card")},ie=()=>{T("parent")},Fe=()=>{T("image_card_fullscreen")},Le=()=>{x()},Te=()=>{console.log("hellll"),T("image_card_fullscreen")},me=()=>{e(2,j.image_card_edit_interface=!0,j)},He=()=>{e(2,j.image_card_edit_interface=!1,j)},ke=()=>{D()},Ce=()=>{console.log("pressed me!!!"),e(6,u=[]),s("exitButtonPressed")},ge=N=>{A(N.detail.mask)};function re(){I=yl(this.value),e(12,I)}const _e=N=>{k(N),T("image_card")};return l.$$set=N=>{"show_exit_interface_button"in N&&e(1,r=N.show_exit_interface_button),"image_data"in N&&e(0,n=N.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&201326593&&n&&(e(26,d=bt(n.list_score)),n.done==!1&&e(6,u=d.slice(p,p+qe))),l.$$.dirty[0]&4&&j){let N=!1;(j.image_card==!0||j.image_card_fullscreen==!0)&&(N=!0),s("imageCardActive",{active:N})}},[n,r,j,i,a,o,u,m,E,q,U,G,I,s,v,T,k,D,x,P,L,A,R,ne,Z,le,d,p,$,ve,ee,X,de,ce,ie,Fe,Le,Te,me,He,ke,Ce,ge,re,_e]}class pt extends Oe{constructor(t){super(),je(this,t,$l,Zl,xe,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const es="/assets/sample_place_bg-38f3fbd4.jpg";function ol(l,t,e){const s=l.slice();return s[10]=t[e],s}function ts(l){let t,e,s,r,n,i,a,o,u,d,p,g=l[0].people,m=[];for(let h=0;h<g.length;h+=1)m[h]=al(ol(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="People Album",i=w(),a=_("div"),o=_("input"),u=w();for(let h=0;h<m.length;h+=1)m[h].c();f(n,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search person"),f(a,"class","flex"),f(r,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(r,n),c(r,i),c(r,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=H(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].people;let b;for(b=0;b<g.length;b+=1){const C=ol(h,g,b);m[b]?m[b].p(C,v):(m[b]=al(C),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:B,o:B,d(h){h&&O(t),we(m,h),d=!1,p()}}}function ls(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){fe(t.$$.fragment)},m(s,r){oe(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function ss(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function al(l){let t,e,s,r,n,i,a,o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[7](l[10],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=w(),a=_("div"),u=z(o),d=w(),f(r,"loading","lazy"),Se(r.src,n="/api/getPreviewPerson/"+l[10])||f(r,"src",n),f(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[160px] w-[160px] bg-gray-800"),f(a,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=H(t,"click",m),p=!0)},p(h,v){l=h,v&1&&!Se(r.src,n="/api/getPreviewPerson/"+l[10])&&f(r,"src",n),v&1&&o!==(o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&W(u,o)},d(h){h&&O(t),p=!1,g()}}}function ns(l){let t,e,s,r;const n=[ss,ls,ts],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ne()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Ze(),Y(i[d],1,1,()=>{i[d]=null}),$e(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){r||(J(e),r=!0)},o(o){Y(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function rs(l,t,e){let s={people:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;De(()=>{e(3,a=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(h.data_hash[b]),r.list_score.push(h.score[b]),r.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.people=h.person,s),o=s.people})})}),Ye(()=>{console.log("destroying... people..")});async function u(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let h=0;h<r.list_dataHash.length;h++)r.list_metaData[h].person.includes(m)&&(n.list_metaData.push(r.list_metaData[h]),n.list_dataHash.push(r.list_dataHash[h]),n.list_score.push(r.list_score[h]));e(1,n.done=!0,n),e(2,i=!0),o&&e(0,s.people=o,s),Pe.update(h=>structuredClone(n))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.people=o,s);return}h&&a==!0&&o&&(e(0,s.people=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.people.push(v)}))}return[s,n,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class is extends Oe{constructor(t){super(),je(this,t,rs,ns,xe,{})}}function cl(l,t,e){const s=l.slice();return s[8]=t[e],s}function os(l){let t,e,s,r=l[0].places,n=[];for(let i=0;i<r.length;i+=1)n[i]=ul(cl(l,r,i));return{c(){t=_("div"),e=w(),s=_("div");for(let i=0;i<n.length;i+=1)n[i].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a);for(let o=0;o<n.length;o+=1)n[o].m(s,null)},p(i,a){if(a&17){r=i[0].places;let o;for(o=0;o<r.length;o+=1){const u=cl(i,r,o);n[o]?n[o].p(u,a):(n[o]=ul(u),n[o].c(),n[o].m(s,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},i:B,o:B,d(i){i&&O(t),i&&O(e),i&&O(s),we(n,i)}}}function as(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){fe(t.$$.fragment)},m(s,r){oe(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function cs(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function ul(l){let t,e,s,r,n,i,a,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[6](l[8],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=w(),a=_("div"),u=z(o),d=w(),Se(r.src,n=es)||f(r,"src",n),f(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[150px] w-[200px] bg-gray-800"),f(a,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=H(t,"click",m),p=!0)},p(h,v){l=h,v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&W(u,o)},d(h){h&&O(t),p=!1,g()}}}function us(l){let t,e,s,r;const n=[cs,as,os],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ne()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Ze(),Y(i[d],1,1,()=>{i[d]=null}),$e(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){r||(J(e),r=!0)},o(o){Y(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function fs(l,t,e){let s={places:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},i=!1,a=!0;De(()=>{e(3,a=!1),fetch("/api/getGroup/place").then(p=>{p.json().then(g=>{let m=g.meta_data.length;for(let h=0;h<m;h++)r.list_dataHash.push(g.data_hash[h]),r.list_score.push(g.score[h]),r.list_metaData.push(g.meta_data[h]);e(3,a=!0),e(0,s.places=g.place,s)})})}),Ye(()=>{console.log("destroying...")});async function o(p){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Pe.update(g=>structuredClone(n));for(let g=0;g<r.list_dataHash.length;g++)r.list_metaData[g].place.toLowerCase()===p.toLowerCase()&&(n.list_metaData.push(r.list_metaData[g]),n.list_dataHash.push(r.list_dataHash[g]),n.list_score.push(r.list_score[g]));e(1,n.done=!0,n),e(2,i=!0),Pe.update(g=>structuredClone(n))}return[s,n,i,a,o,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(p,g)=>{console.log("mine is: ",p),o(p)}]}class ds extends Oe{constructor(t){super(),je(this,t,fs,us,xe,{})}}const _s="/assets/folder-regular-1127ab6b.svg";function fl(l,t,e){const s=l.slice();return s[10]=t[e],s}function ps(l){let t,e,s,r,n,i,a,o,u,d,p,g=l[0].local_directories,m=[];for(let h=0;h<g.length;h+=1)m[h]=dl(fl(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="Local Resources",i=w(),a=_("div"),o=_("input"),u=w();for(let h=0;h<m.length;h+=1)m[h].c();f(n,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search directory"),f(a,"class","flex"),f(r,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(r,n),c(r,i),c(r,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=H(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].local_directories;let b;for(b=0;b<g.length;b+=1){const C=fl(h,g,b);m[b]?m[b].p(C,v):(m[b]=dl(C),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:B,o:B,d(h){h&&O(t),we(m,h),d=!1,p()}}}function hs(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){fe(t.$$.fragment)},m(s,r){oe(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function ms(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function dl(l){let t,e,s,r,n,i,a,o=l[10].slice(0,10)+"..",u,d,p,g,m;function h(...v){return l[7](l[10],...v)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=w(),a=_("div"),u=z(o),d=w(),Se(r.src,n=_s)||f(r,"src",n),f(r,"class","object-contain hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[100px] w-[100px] bg-gray-800 p-3"),f(a,"class","flex text-sm text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer p-2"),f(t,"title",p=l[10])},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),g||(m=H(t,"click",h),g=!0)},p(v,b){l=v,b&1&&o!==(o=l[10].slice(0,10)+"..")&&W(u,o),b&1&&p!==(p=l[10])&&f(t,"title",p)},d(v){v&&O(t),g=!1,m()}}}function gs(l){let t,e,s,r;const n=[ms,hs,ps],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ne()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Ze(),Y(i[d],1,1,()=>{i[d]=null}),$e(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){r||(J(e),r=!0)},o(o){Y(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function bs(l,t,e){let s={local_directories:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;De(()=>{e(3,a=!1),fetch("/api/getGroup/resource_directory").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(h.data_hash[b]),r.list_score.push(h.score[b]),r.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.local_directories=h.resource_directory,s),o=s.local_directories})})}),Ye(()=>{});async function u(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0}),console.log("looking for attribute ",m);for(let h=0;h<r.list_dataHash.length;h++)r.list_metaData[h].resource_directory.toLowerCase().includes(m)&&(n.list_metaData.push(r.list_metaData[h]),n.list_dataHash.push(r.list_dataHash[h]),n.list_score.push(r.list_score[h]));e(1,n.done=!0,n),console.log(n),e(2,i=!0),o&&e(0,s.local_directories=o,s),Pe.update(h=>structuredClone(n))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.local_directories=o,s);return}h&&a==!0&&o&&(e(0,s.local_directories=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.local_directories.push(v)}))}return[s,n,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class vs extends Oe{constructor(t){super(),je(this,t,bs,gs,xe,{})}}function ks(l){let t,e,s,r,n,i,a,o,u,d;return{c(){t=_("div"),e=_("p"),e.innerHTML=`* Make sure you have created an OAuth credential at google Cloud-Console for this app and have enabled <b>Google Photos Api</b>. For details visit <b>https://developers.google.com/photos/library/guides/get-started</b><br/>
                * <b>App type</b> must be chosen as <b>Web app</b> and One of Redirect URIs must be set as <b>http://localhost:5000/api/OAuthCallback</b> in corresponding credential.<br/>
                * Except <b>You</b> and <b>Google</b> , <b>No-one</b> would have access to your personal data.`,s=w(),r=_("div"),n=_("label"),i=z(l[2]),a=w(),o=_("input"),f(e,"class","p-4"),f(n,"for","file"),f(o,"type","file"),f(o,"accept",".json"),f(r,"class","flex items-center justify-center text-md p-2 bg-blue-300"),f(t,"class","border-2 flex-1 justify-center items-center bg-blue-200")},m(p,g){F(p,t,g),c(t,e),c(t,s),c(t,r),c(r,n),c(n,i),c(r,a),c(r,o),u||(d=H(o,"change",l[4]),u=!0)},p(p,g){g&4&&W(i,p[2])},d(p){p&&O(t),u=!1,d()}}}function ws(l){let t,e=l[0].client_id+"",s,r,n;function i(u,d){return u[0].is_activated?xs:ys}let a=i(l),o=a(l);return{c(){t=_("p"),s=z(e),r=w(),o.c(),n=Ne(),f(t,"class","bg-gray-100 p-2 border-2 border-black")},m(u,d){F(u,t,d),c(t,s),F(u,r,d),o.m(u,d),F(u,n,d)},p(u,d){d&1&&e!==(e=u[0].client_id+"")&&W(s,e),a!==(a=i(u))&&(o.d(1),o=a(u),o&&(o.c(),o.m(n.parentNode,n)))},d(u){u&&O(t),u&&O(r),o.d(u),u&&O(n)}}}function ys(l){let t;return{c(){t=_("p"),t.textContent="Inactive",f(t,"class","bg-rose-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function xs(l){let t;return{c(){t=_("p"),t.textContent="Active",f(t,"class","bg-green-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function _l(l){let t,e,s,r;return{c(){t=_("div"),e=_("button"),e.textContent="Activate Google photos",f(e,"class","bg-blue-400 p-2 text-md disabled:bg-blue-200"),f(t,"class","flex justify-center items-center m-3")},m(n,i){F(n,t,i),c(t,e),s||(r=H(e,"click",l[3]),s=!0)},p:B,d(n){n&&O(t),s=!1,r()}}}function Cs(l){let t,e,s;function r(o,u){return o[0]?ws:ks}let n=r(l),i=n(l),a=l[1]&&_l(l);return{c(){t=_("div"),i.c(),e=w(),a&&a.c(),s=Ne(),f(t,"class","flex w-full justify-center items-center")},m(o,u){F(o,t,u),i.m(t,null),F(o,e,u),a&&a.m(o,u),F(o,s,u)},p(o,[u]){n===(n=r(o))&&i?i.p(o,u):(i.d(1),i=n(o),i&&(i.c(),i.m(t,null))),o[1]?a?a.p(o,u):(a=_l(o),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},i:B,o:B,d(o){o&&O(t),i.d(),o&&O(e),a&&a.d(o),o&&O(s)}}}function Ss(l,t,e){let s=null,r=!1,n="Upload Client secret json";function i(){fetch("/api/gClientInfo").then(d=>{d.json().then(p=>{p.client_id_available===!0&&(e(0,s=p),p.is_activated==!1&&e(1,r=!0))})})}De(()=>{i()});function a(){fetch("/api/statusGAuthFlow").then(d=>{d.json().then(p=>{p.finished==!1?setTimeout(a,2e3):(e(1,r=!1),alert("Account Activation: "+p.status.toString()),i())})})}function o(d){d.target.disabled=!0,d.target.innerText="activation in progress...",fetch("/api/beginGAuthFlow").then(p=>{p.ok==!1?(alert("Some error occured while starting authorization flow !"),d.target.disabled=!1,d.target.innerText="Activate Google Photos"):setTimeout(a,1e3)})}function u(d){let p="http://localhost:5000/api/OAuthCallback";e(2,n="upload in progress.."),d.preventDefault(),console.log(d.target),d.target.disabled=!0;var g=new FileReader;g.onload=function(){var m=JSON.parse(g.result);let v=Object.keys(m).includes("web"),b=!1;if(v&&Object.keys(m.web).includes("redirect_uris")&&(b=m.web.redirect_uris.includes(p)),v===!0&&b==!0){let C=new FormData;C.append("client_data",g.result),fetch("/api/uploadClientData",{method:"POST",body:C}).then(j=>{j.ok==!1?alert("Some error occured !!"):(e(2,n="Upload Client secret json"),i(),d.target.disabled=!1,e(1,r=!0))})}else{alert("Must be a webapp and redirect_uris must contain: "+p);return}},g.readAsText(d.target.files[0])}return[s,r,n,o,u]}class Ds extends Oe{constructor(t){super(),je(this,t,Ss,Cs,xe,{})}}function pl(l){let t,e,s,r,n,i;return{c(){t=_("div"),e=_("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=w(),r=_("div"),r.textContent="X",f(e,"class","flex-1"),f(r,"class","flex text-xl hover:orange-900 cursor-pointer"),f(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),f(t,"role","alert")},m(a,o){F(a,t,o),c(t,e),c(t,s),c(t,r),n||(i=H(r,"click",l[9]),n=!0)},p:B,d(a){a&&O(t),n=!1,i()}}}function js(l){let t,e,s,r,n,i;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[21]),e.$on("sidebarStateChange",l[22]),n=new Ds({}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(n.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(n.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(n)}}}function Os(l){let t,e,s,r,n,i;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[19]),e.$on("sidebarStateChange",l[20]),n=new vs({}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(n.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(n.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(n)}}}function Fs(l){let t,e,s,r,n,i;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),n=new is({}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(n.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(n.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(n)}}}function Ls(l){let t,e,s,r,n,i;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new ds({}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(n.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(n.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(n)}}}function Ts(l){let t,e,s,r,n,i;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new Rl({}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(n.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(n.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(n)}}}function qs(l){let t,e,s,r,n,i,a,o;return e=new Ve({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),n=new El({props:{query_button_disabled:l[2]}}),n.$on("queryReady",l[12]),a=new pt({props:{image_data:l[1]}}),{c(){t=_("div"),fe(e.$$.fragment),s=w(),r=_("div"),fe(n.$$.fragment),i=w(),fe(a.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,d){F(u,t,d),oe(e,t,null),c(t,s),c(t,r),oe(n,r,null),c(r,i),oe(a,r,null),o=!0},p(u,d){const p={};d[0]&64&&(p.sidebarOpen=u[6]),e.$set(p);const g={};d[0]&4&&(g.query_button_disabled=u[2]),n.$set(g);const m={};d[0]&2&&(m.image_data=u[1]),a.$set(m)},i(u){o||(J(e.$$.fragment,u),J(n.$$.fragment,u),J(a.$$.fragment,u),o=!0)},o(u){Y(e.$$.fragment,u),Y(n.$$.fragment,u),Y(a.$$.fragment,u),o=!1},d(u){u&&O(t),ae(e),ae(n),ae(a)}}}function Hs(l){let t,e,s,r,n,i=l[0]&&pl(l);const a=[qs,Ts,Ls,Fs,Os,js],o=[];function u(d,p){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:d[5].local_album.status===!0?4:d[5].google_photos.status===!0?5:-1}return~(e=u(l))&&(s=o[e]=a[e](l)),{c(){i&&i.c(),t=w(),s&&s.c(),r=Ne()},m(d,p){i&&i.m(d,p),F(d,t,p),~e&&o[e].m(d,p),F(d,r,p),n=!0},p(d,p){d[0]?i?i.p(d,p):(i=pl(d),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null);let g=e;e=u(d),e===g?~e&&o[e].p(d,p):(s&&(Ze(),Y(o[g],1,1,()=>{o[g]=null}),$e()),~e?(s=o[e],s?s.p(d,p):(s=o[e]=a[e](d),s.c()),J(s,1),s.m(r.parentNode,r)):s=null)},i(d){n||(J(s),n=!0)},o(d){Y(s),n=!1},d(d){i&&i.d(d),d&&O(t),~e&&o[e].d(d),d&&O(r)}}}let Es=3;function Ps(l,t,e){let s=!1;De(()=>{window.onscrollend=function(){}}),De(()=>{fetch("/api/getMetaStats").then(L=>{L.ok?L.json().then(A=>{Number(A.image.count)==0&&e(0,s=!0),yt.update(R=>Number(A.image.count)),Ct.update(R=>Number(A.image.unique_place_count)),xt.update(R=>Number(A.image.unique_people_count)),gl.update(R=>Number(A.image.unique_resource_directories_count)),bl.update(R=>A.available_resource_attributes)}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let r=[],n=[],i=[],a,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},u=!1,d="",p={};async function g(L="xxxxxxx",A=!1){console.log("handleClick count",d,A,L),e(2,u=!0);let R=Es;if(a=new FormData,d.length===0)return;a.append("query",d),a.append("topk",R.toString()),A==!1?(n=[],r=[],i=[],e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),a.append("query_start","true"),Pe.update(X=>o)):(a.append("query_start","false"),a.append("client_id",L));let ne=await fetch("/api/query",{method:"POST",body:a});if(!ne.ok)throw e(2,u=!1),new Error(ne);let Z=await ne.json();console.log("data: ",Z);let le=Z.client_id,$=Z.meta_data,ve=Z.data_hash,ee=Z.score;Number(Z.progress);for(let X=0;X<$.length;X++){let de=ve[X],ce=Number(ee[X]),ie=n.indexOf(de);ie>=0?(r[ie]+=ce,e(1,o.list_score[ie]+=ce,o)):(n.push(de),r.push(ce),i.push($[X]),o.list_dataHash.push(de),o.list_score.push(ce),o.list_metaData.push($[X]))}if(Z.query_completed==!0?(e(1,o.done=!0,o),e(1,o.progress=1e-4,o)):(e(1,o),e(1,o.progress+=.12,o),e(1,o.progress=Math.min(o.progress,.92),o)),Z.query_completed==!0){e(2,u=!1),console.log("hey i am being called!!!"),Pe.update(X=>o);return}await g(le,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}},local_album:{status:!1,context:{}},google_photos:{status:!1,context:{}}};function h(L){m[L].status==!1&&(e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Pe.update(R=>structuredClone(o)));let A=Object.keys(m);for(let R=0;R<A.length;R++)m[A[R]].status&&e(5,m[A[R]].status=!1,m);m[L]&&e(5,m[L].status=!0,m)}let v=!0;function b(L){let A=L.detail.item.name;A.toLowerCase().includes("google")?h("google_photos"):A.toLowerCase().includes("photo")?h("query"):A.toLowerCase().includes("index")?h("indexing"):A.toLowerCase().includes("people")?h("people_album"):A.toLowerCase().includes("place")?h("place_album"):A.toLowerCase().includes("local")&&h("local_album")}return[s,o,u,d,p,m,v,g,b,()=>e(0,s=!1),L=>{b(L)},L=>{e(6,v=L.detail.open)},L=>{e(3,d=L.detail.query),e(4,p=L.detail.attributes),g()},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)}]}class Ns extends Oe{constructor(t){super(),je(this,t,Ps,Hs,xe,{},null,[-1,-1])}}new Ns({target:document.getElementById("app")});
