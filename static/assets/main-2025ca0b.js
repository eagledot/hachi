(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();function G(){}function ul(l){return l()}function jt(){return Object.create(null)}function pe(l){l.forEach(ul)}function vt(l){return typeof l=="function"}function Oe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let st;function je(l,t){return st||(st=document.createElement("a")),st.href=t,l===st.href}function pl(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function N(l,t,e){l.insertBefore(t,e||null)}function P(l){l.parentNode&&l.parentNode.removeChild(l)}function we(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function R(l){return document.createTextNode(l)}function w(){return R(" ")}function Re(){return R("")}function A(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function _l(l){return l===""?null:+l}function hl(l){return Array.from(l.childNodes)}function Q(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ot(l,t){l.value=t??""}function ce(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ot(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function ml(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function gl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,e,s,t),i}let Qe;function Xe(l){Qe=l}function kt(){if(!Qe)throw new Error("Function called outside component initialization");return Qe}function Ue(l){kt().$$.on_mount.push(l)}function ct(l){kt().$$.on_destroy.push(l)}function ut(){const l=kt();return(t,e,{cancelable:s=!1}={})=>{const i=l.$$.callbacks[t];if(i){const n=gl(t,e,{cancelable:s});return i.slice().forEach(r=>{r.call(l,n)}),!n.defaultPrevented}return!0}}const ze=[],He=[],nt=[],qt=[],bl=Promise.resolve();let bt=!1;function vl(){bt||(bt=!0,bl.then(fl))}function at(l){nt.push(l)}const mt=new Set;let Me=0;function fl(){if(Me!==0)return;const l=Qe;do{try{for(;Me<ze.length;){const t=ze[Me];Me++,Xe(t),kl(t.$$)}}catch(t){throw ze.length=0,Me=0,t}for(Xe(null),ze.length=0,Me=0;He.length;)He.pop()();for(let t=0;t<nt.length;t+=1){const e=nt[t];mt.has(e)||(mt.add(e),e())}nt.length=0}while(ze.length);for(;qt.length;)qt.pop()();bt=!1,mt.clear(),Xe(l)}function kl(l){if(l.fragment!==null){l.update(),pe(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(at)}}const it=new Set;let Pe;function ft(){Pe={r:0,c:[],p:Pe}}function dt(){Pe.r||pe(Pe.c),Pe=Pe.p}function ee(l,t){l&&l.i&&(it.delete(l),l.i(t))}function se(l,t,e,s){if(l&&l.o){if(it.has(l))return;it.add(l),Pe.c.push(()=>{it.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function ve(l){l&&l.c()}function _e(l,t,e,s){const{fragment:i,after_update:n}=l.$$;i&&i.m(t,e),s||at(()=>{const r=l.$$.on_mount.map(ul).filter(vt);l.$$.on_destroy?l.$$.on_destroy.push(...r):pe(r),l.$$.on_mount=[]}),n.forEach(at)}function he(l,t){const e=l.$$;e.fragment!==null&&(pe(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function wl(l,t){l.$$.dirty[0]===-1&&(ze.push(l),vl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Le(l,t,e,s,i,n,r,a=[-1]){const c=Qe;Xe(l);const u=l.$$={fragment:null,ctx:[],props:n,update:G,not_equal:i,bound:jt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:jt(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};r&&r(u.root);let h=!1;if(u.ctx=e?e(l,t.props||{},(_,g,...m)=>{const p=m.length?m[0]:g;return u.ctx&&i(u.ctx[_],u.ctx[_]=p)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](p),h&&wl(l,_)),g}):[],u.update(),h=!0,pe(u.before_update),u.fragment=s?s(u.ctx):!1,t.target){if(t.hydrate){const _=hl(t.target);u.fragment&&u.fragment.l(_),_.forEach(P)}else u.fragment&&u.fragment.c();t.intro&&ee(l.$$.fragment),_e(l,t.target,t.anchor,t.customElement),fl()}Xe(c)}class Te{$destroy(){he(this,1),this.$destroy=G}$on(t,e){if(!vt(e))return G;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const i=s.indexOf(e);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!pl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Et(l,t,e){const s=l.slice();return s[26]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Lt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Tt(l,t,e){const s=l.slice();return s[34]=t[e],s}function Pt(l){let t,e=l[4][l[29]],s=[];for(let i=0;i<e.length;i+=1)s[i]=Nt(Tt(l,e,i));return{c(){for(let i=0;i<s.length;i+=1)s[i].c();t=w()},m(i,n){for(let r=0;r<s.length;r+=1)s[r].m(i,n);N(i,t,n)},p(i,n){if(n[0]&2576){e=i[4][i[29]];let r;for(r=0;r<e.length;r+=1){const a=Tt(i,e,r);s[r]?s[r].p(a,n):(s[r]=Nt(a),s[r].c(),s[r].m(t.parentNode,t))}for(;r<s.length;r+=1)s[r].d(1);s.length=e.length}},d(i){we(s,i),i&&P(t)}}}function Nt(l){let t,e,s,i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,r,a,c=l[34]+" ",u,h,_,g,m;function p(...b){return l[14](l[29],l[34],...b)}return{c(){t=d("div"),e=d("div"),s=d("span"),n=R(i),r=w(),a=d("span"),u=R(c),h=w(),_=d("span"),_.textContent="x",f(s,"class","text-blue-800 "),f(a,"class","ml-1 text-sm font-semibold"),f(_,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),f(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),f(t,"class","flex items-center justify-center")},m(b,k){N(b,t,k),o(t,e),o(e,s),o(s,n),o(e,r),o(e,a),o(a,u),o(e,h),o(e,_),g||(m=[A(_,"click",p),A(e,"click",function(){vt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(b,k){l=b,k[0]&16&&i!==(i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&Q(n,i),k[0]&16&&c!==(c=l[34]+" ")&&Q(u,c)},d(b){b&&P(t),g=!1,pe(m)}}}function At(l){let t,e=l[4][l[29]].length>=1&&Pt(l);return{c(){e&&e.c(),t=Re()},m(s,i){e&&e.m(s,i),N(s,t,i)},p(s,i){s[4][s[29]].length>=1?e?e.p(s,i):(e=Pt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&P(t)}}}function It(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,i,n;return{c(){t=d("option"),s=R(e),i=w(),t.__value=n=l[29],t.value=t.__value},m(r,a){N(r,t,a),o(t,s),o(t,i)},p(r,a){a[0]&16&&e!==(e=r[29].charAt(0).toUpperCase()+r[29].slice(1)+"")&&Q(s,e),a[0]&16&&n!==(n=r[29])&&(t.__value=n,t.value=t.__value)},d(r){r&&P(t)}}}function Mt(l){let t,e,s,i,n,r,a,c,u=l[3],h=[];for(let _=0;_<u.length;_+=1)h[_]=Bt(Et(l,u,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<h.length;_+=1)h[_].c();s=w(),i=d("div"),n=d("button"),n.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(i,"class","flex w-full justify-center items-center"),f(t,"class",r=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,g){N(_,t,g),o(t,e);for(let m=0;m<h.length;m+=1)h[m].m(e,null);o(t,s),o(t,i),o(i,n),a||(c=A(n,"click",l[22]),a=!0)},p(_,g){if(g[0]&1034){u=_[3];let m;for(m=0;m<u.length;m+=1){const p=Et(_,u,m);h[m]?h[m].p(p,g):(h[m]=Bt(p),h[m].c(),h[m].m(e,null))}for(;m<h.length;m+=1)h[m].d(1);h.length=u.length}g[0]&32&&r!==(r=(_[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",r)},d(_){_&&P(t),we(h,_),a=!1,c()}}}function Bt(l){let t,e=l[26]+"",s,i,n,r;function a(){return l[21](l[26])}return{c(){t=d("li"),s=R(e),i=w(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(c,u){N(c,t,u),o(t,s),o(t,i),n||(r=A(t,"click",a),n=!0)},p(c,u){l=c,u[0]&8&&e!==(e=l[26]+"")&&Q(s,e)},d(c){c&&P(t),n=!1,r()}}}function zt(l){let t;return{c(){t=d("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,f(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){N(e,t,s)},d(e){e&&P(t)}}}function yl(l){let t,e,s,i,n,r,a,c,u,h,_,g,m,p,b,k,S,E=Object.keys(l[4]),D=[];for(let v=0;v<E.length;v+=1)D[v]=At(Lt(l,E,v));let q=Object.keys(l[4]),H=[];for(let v=0;v<q.length;v+=1)H[v]=It(Ht(l,q,v));let y=l[3].length>0&&Mt(l),C=l[6]==!0&&zt();return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("div");for(let v=0;v<D.length;v+=1)D[v].c();n=w(),r=d("div"),a=d("select");for(let v=0;v<H.length;v+=1)H[v].c();c=w(),u=d("div"),h=d("input"),_=w(),g=d("div"),m=d("button"),m.textContent="Search",p=w(),y&&y.c(),b=w(),C&&C.c(),f(i,"class","flex w-full items-center my-3 flex-wrap text-lg"),f(a,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(a,"name","select-option"),f(a,"id","select-option"),l[1]===void 0&&at(()=>l[16].call(a)),f(h,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(h,"type","search"),f(h,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(g,"class","flex"),f(r,"class","flex space-x-2"),f(s,"class","w-full"),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(v,F){N(v,t,F),o(t,e),o(e,s),o(s,i);for(let x=0;x<D.length;x+=1)D[x].m(i,null);o(s,n),o(s,r),o(r,a);for(let x=0;x<H.length;x+=1)H[x].m(a,null);Ot(a,l[1]),o(r,c),o(r,u),o(u,h),l[17](h),o(r,_),o(r,g),o(g,m),l[20](m),o(e,p),y&&y.m(e,null),o(e,b),C&&C.m(e,null),k||(S=[A(a,"change",l[15]),A(a,"change",l[16]),A(h,"focus",l[18],{once:!0}),A(h,"focusout",l[19]),A(h,"keyup",l[8]),A(h,"keydown",l[7]),A(m,"click",l[12])],k=!0)},p(v,F){if(F[0]&2576){E=Object.keys(v[4]);let x;for(x=0;x<E.length;x+=1){const I=Lt(v,E,x);D[x]?D[x].p(I,F):(D[x]=At(I),D[x].c(),D[x].m(i,null))}for(;x<D.length;x+=1)D[x].d(1);D.length=E.length}if(F[0]&16){q=Object.keys(v[4]);let x;for(x=0;x<q.length;x+=1){const I=Ht(v,q,x);H[x]?H[x].p(I,F):(H[x]=It(I),H[x].c(),H[x].m(a,null))}for(;x<H.length;x+=1)H[x].d(1);H.length=q.length}F[0]&18&&Ot(a,v[1]),v[3].length>0?y?y.p(v,F):(y=Mt(v),y.c(),y.m(e,b)):y&&(y.d(1),y=null),v[6]==!0?C||(C=zt(),C.c(),C.m(e,null)):C&&(C.d(1),C=null)},i:G,o:G,d(v){v&&P(t),we(D,v),we(H,v),l[17](null),l[20](null),y&&y.d(),C&&C.d(),k=!1,pe(S)}}}async function xl(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let i=await fetch(e,{method:"POST",body:s});return i.ok===!0?await i.json():{}}function Cl(l,t,e){const s=ut();let i="query",n,r,{query_button_disabled:a=!1}=t,c="",u=[],h={person:[],query:[],place:[],filename:[]},_=!1;var g={};function m(j){g[j.keyCode]=j.type=="keydown",g[13]==!0&&j.shiftKey&&(console.log("shift enter combination."),E())}async function p(j){e(6,D=!1),g[j.keyCode]=!1;let L=j.target;if(L.value.length==0){e(3,u=[]);return}if(console.log("current value: ",L.value),j.keyCode==13){let K=h[i].length;L.value.length>0&&!h[i].includes(L.value)&&e(4,h[i][K]=L.value,h),L.value="",e(3,u=[]),e(5,_=!1);return}let M=await xl(i,L.value);i in M?(e(3,u=M[i]),e(5,_=!0)):(e(3,u=[]),e(5,_=!1))}function b(j,L,M){let K=h[L].indexOf(M);K>=0&&(h[L].splice(K,1),e(4,h)),i==L&&e(3,u=[])}function k(j,L){e(5,_=!1),e(2,n.value=L,n),n.focus()}function S(j){e(1,i=j),e(3,u=h[i]),e(5,_=!0),n.focus()}function E(j){let L=h[i].length;n.value.length>0&&!h[i].includes(n.value)&&e(4,h[i][L]=n.value,h);let M=Object.keys(h);c="";for(let K=0;K<M.length;K++){let V=M[K],X=h[V];c+=V+":";for(let W=0;W<X.length;W++)c+=X[W],W!=X.length-1&&(c+="-");K!=M.length-1&&(c+=",")}console.log("Completed: "+c),e(2,n.value="",n),r.disabled==!1?s("queryReady",{query:c,attributes:h}):console.log("chill dawg!!!")}let D=!1;const q=(j,L,M)=>b(M.currentTarget,j,L),H=j=>S(j.target.value);function y(){i=ml(this),e(1,i),e(4,h)}function C(j){He[j?"unshift":"push"](()=>{n=j,e(2,n)})}const v=j=>{j.target.value.length==0&&e(6,D=!0)},F=j=>{e(6,D=!1)};function x(j){He[j?"unshift":"push"](()=>{r=j,e(0,r),e(13,a)})}const I=j=>k(i,j),O=()=>e(5,_=!1);return l.$$set=j=>{"query_button_disabled"in j&&e(13,a=j.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=a,r)},[r,i,n,u,h,_,D,m,p,b,k,S,E,a,q,H,y,C,v,F,x,I,O]}class Sl extends Te{constructor(t){super(),Le(this,t,Cl,yl,Oe,{query_button_disabled:13},null,[-1,-1])}}const Be=[];function We(l,t=G){let e;const s=new Set;function i(a){if(Oe(l,a)&&(l=a,e)){const c=!Be.length;for(const u of s)u[1](),Be.push(u,l);if(c){for(let u=0;u<Be.length;u+=2)Be[u][0](Be[u+1]);Be.length=0}}}function n(a){i(a(l))}function r(a,c=G){const u=[a,c];return s.add(u),s.size===1&&(e=t(i)||G),a(l),()=>{s.delete(u),s.size===0&&(e(),e=null)}}return{set:i,update:n,subscribe:r}}const wt=We(0),yt=We(0),xt=We(0),rt=We([]);let Dl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ne=We(Dl);function Rt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function Fl(l){let t,e,s;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(i,n){N(i,t,n),e||(s=A(t,"click",l[2]),e=!0)},p:G,d(i){i&&P(t),e=!1,s()}}}function jl(l){let t,e,s,i,n;return{c(){t=d("span"),t.textContent="Hachi",e=w(),s=d("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(s,"class","cursor-pointer px-4")},m(r,a){N(r,t,a),N(r,e,a),N(r,s,a),i||(n=A(s,"click",l[3]),i=!0)},p:G,d(r){r&&P(t),r&&P(e),r&&P(s),i=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",i,n,r,a=l[8].count+"",c;return{c(){t=d("div"),e=d("div"),i=R(s),n=w(),r=d("div"),c=R(a),f(e,"class","flex"),f(e,"data-ix",l[10]),f(r,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,h){N(u,t,h),o(t,e),o(e,i),o(t,n),o(t,r),o(r,c)},p(u,h){h&2&&s!==(s=u[8].name+"")&&Q(i,s),h&2&&a!==(a=u[8].count+"")&&Q(c,a)},d(u){u&&P(t)}}}function Vt(l){let t,e,s,i,n,r,a,c=l[0].sidebarOpen&&Ut(l);function u(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),i=w(),c&&c.c(),n=w(),f(e,"class",s="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(h,_){N(h,t,_),o(t,e),o(t,i),c&&c.m(t,null),o(t,n),r||(a=A(t,"click",u),r=!0)},p(h,_){l=h,_&2&&s!==(s="fa-solid fa-"+l[8].icon)&&f(e,"class",s),l[0].sidebarOpen?c?c.p(l,_):(c=Ut(l),c.c(),c.m(t,n)):c&&(c.d(1),c=null)},d(h){h&&P(t),c&&c.d(),r=!1,a()}}}function Ol(l){let t,e,s,i,n,r;function a(g,m){return g[0].sidebarOpen?jl:Fl}let c=a(l),u=c(l),h=l[1],_=[];for(let g=0;g<h.length;g+=1)_[g]=Vt(Rt(l,h,g));return{c(){t=d("div"),e=d("aside"),s=d("div"),u.c(),i=w(),n=d("nav");for(let g=0;g<_.length;g+=1)_[g].c();f(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(n,"class","mt-6"),f(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-screen text-white")},m(g,m){N(g,t,m),o(t,e),o(e,s),u.m(s,null),o(e,i),o(e,n);for(let p=0;p<_.length;p+=1)_[p].m(n,null)},p(g,[m]){if(c===(c=a(g))&&u?u.p(g,m):(u.d(1),u=c(g),u&&(u.c(),u.m(s,null))),m&19){h=g[1];let p;for(p=0;p<h.length;p+=1){const b=Rt(g,h,p);_[p]?_[p].p(b,m):(_[p]=Vt(b),_[p].c(),_[p].m(n,null))}for(;p<_.length;p+=1)_[p].d(1);_.length=h.length}m&1&&r!==(r=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",r)},i:G,o:G,d(g){g&&P(t),u.d(),we(_,g)}}}function ql(l,t,e){const s=ut();let{sidebarOpen:i=!1}=t;const n={sidebarOpen:i},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ue(()=>{wt.subscribe(_=>{r&&e(1,r[0].count=_,r)}),yt.subscribe(_=>{r&&e(1,r[3].count=_,r)}),xt.subscribe(_=>{r&&e(1,r[4].count=_,r)})});function a(){e(0,n.sidebarOpen=!0,n)}function c(){e(0,n.sidebarOpen=!1,n)}function u(_){s("menuClick",{item:r[_]})}const h=_=>{u(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,i=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,r,a,c,u,i,h]}class pt extends Te{constructor(t){super(),Le(this,t,ql,Ol,Oe,{sidebarOpen:5})}}function El(l){let t,e,s,i,n,r,a,c,u,h,_,g,m=(l[3]*100).toString().slice(0,4)+"",p,b,k,S,E,D,q,H,y,C,v,F,x,I,O,j,L,M,K,V,X,W,ie,$,ne,ye,Y,te,me,ge,ue,Ce,Se,De,fe,qe,be,xe,de;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",s=w(),i=d("div"),n=d("input"),r=w(),a=d("div"),c=d("div"),u=d("div"),h=d("div"),_=w(),g=d("div"),p=R(m),b=R("%"),k=w(),S=d("div"),E=R("Current directory: "),D=d("span"),q=R(l[4]),H=w(),y=d("span"),y.textContent="ETA:",C=w(),v=d("span"),F=R(l[6]),x=w(),I=d("div"),O=R("Details: "),j=d("span"),L=R(l[5]),M=w(),K=d("div"),V=d("div"),X=d("input"),W=w(),ie=d("label"),ie.textContent="Complete Rescan",$=w(),ne=d("div"),ne.textContent="Re-index all originals, including already indexed and unchanged files.",ye=w(),Y=d("div"),te=d("select"),me=d("option"),me.textContent="Images Only",ge=d("option"),ge.textContent="Videos Only",ue=d("option"),ue.textContent="Videos and Images",Ce=w(),Se=d("div"),Se.textContent="Filter by content type",De=w(),fe=d("button"),fe.textContent="Cancel",qe=w(),be=d("button"),be.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(n,"type","text"),f(n,"class","w-full rounded border p-1 text-sm"),f(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,f(i,"class","my-2"),f(h,"class","h-2rounded bg-blue-500"),ce(h,"width",(l[3]*100).toString()+"%"),f(u,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(g,"class","flex px-2 font-semibold"),f(c,"class","flex items-center"),f(D,"class","text-black"),f(y,"class","pl-3 text-right"),f(v,"class","text-black"),f(S,"class","pt-1 text-sm text-blue-600"),f(j,"class","text-black"),f(I,"class","pt-1 text-sm text-blue-600"),f(a,"class","mb-3"),f(X,"type","checkbox"),f(X,"class","h-5 w-5 text-blue-500"),f(ie,"class","ml-1"),f(V,"class","mr-2 flex items-center"),f(ne,"class","text-sm text-gray-600"),f(K,"class","mt-4 mb-3 flex flex-wrap items-center"),me.__value="Images Only",me.value=me.__value,ge.disabled=!0,ge.__value="Videos Only",ge.value=ge.__value,ue.disabled=!0,ue.__value="Videos and Images",ue.value=ue.__value,f(te,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(Se,"class","ml-2 text-sm text-gray-600"),f(Y,"class","mb-3 mt-3 flex flex-wrap items-center"),fe.disabled=!0,f(fe,"type","button"),f(fe,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(be,"type","button"),f(be,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(le,oe){N(le,t,oe),o(t,e),o(t,s),o(t,i),o(i,n),l[12](n),ot(n,l[7]),o(t,r),o(t,a),o(a,c),o(c,u),o(u,h),o(c,_),o(c,g),o(g,p),o(g,b),o(a,k),o(a,S),o(S,E),o(S,D),o(D,q),o(S,H),o(S,y),o(S,C),o(S,v),o(v,F),o(a,x),o(a,I),o(I,O),o(I,j),o(j,L),o(t,M),o(t,K),o(K,V),o(V,X),X.checked=l[8],o(V,W),o(V,ie),o(K,$),o(K,ne),o(t,ye),o(t,Y),o(Y,te),o(te,me),o(te,ge),o(te,ue),o(Y,Ce),o(Y,Se),o(t,De),o(t,fe),l[16](fe),o(t,qe),o(t,be),l[17](be),xe||(de=[A(n,"input",l[13]),A(n,"keydown",l[14]),A(X,"change",l[15]),A(fe,"click",l[10]),A(be,"click",l[9])],xe=!0)},p(le,[oe]){oe&128&&n.value!==le[7]&&ot(n,le[7]),oe&8&&ce(h,"width",(le[3]*100).toString()+"%"),oe&8&&m!==(m=(le[3]*100).toString().slice(0,4)+"")&&Q(p,m),oe&16&&Q(q,le[4]),oe&64&&Q(F,le[6]),oe&32&&Q(L,le[5]),oe&256&&(X.checked=le[8])},i:G,o:G,d(le){le&&P(t),l[12](null),l[16](null),l[17](null),xe=!1,pe(de)}}}function Hl(l,t,e){let s,i,n;Ue(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let C="/api/getIndexStatus/"+s;e(0,i.disabled=!1,i),e(1,n.disabled=!0,n),m(C)}}),ct(()=>{g&&clearTimeout(g)});let r,a=.001,c="",u="",h="",_="",g;async function m(C,v=0){v==0&&console.log("starting a new polll...");let x=await(await fetch(C,{method:"GET"})).json();if(x.is_active==!0){if(x.done==!0){let O=new FormData;O.append("ack","true"),(await fetch(C,{method:"POST",body:O})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let L=await fetch("/api/getMetaStats");L=await L.json(),wt.update(M=>Number(L.image.count)),yt.update(M=>Number(L.image.unique_people_count)),xt.update(M=>Number(L.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,a=0),e(4,c=""),e(6,h=""),e(5,u=""),e(7,_=""),e(0,i.disabled=!0,i),e(0,i.innerText="Cancel",i),e(2,r.disabled=!1,r);return}e(3,a=x.progress),e(6,h=x.eta),e(5,u=x.details),e(4,c=x.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(C,v+1)},1e3)}}let p=!1;async function b(){if(n&&_){e(1,n.disabled=!0,n),e(2,r.disabled=!0,r);let C=new FormData;C.append("image_directory_path",_),C.append("complete_rescan",p.toString());let x=await(await fetch("/api/indexStart",{method:"POST",body:C})).json();if(x.success===!0){e(0,i.disabled=!1,i);let O="/api/getIndexStatus/"+x.statusEndpoint;e(11,s=x.statusEndpoint),m(O)}else alert(x.reason),e(1,n.disabled=!1,n),e(2,r.disabled=!1,r)}else console.log("No index_start_button object found!!!")}async function k(){if(s){e(0,i.disabled=!0,i),e(0,i.innerText="Cancelling... Please wait.",i);let C="/api/indexCancel/"+s,v=await fetch(C,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!v.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(v);return}else return}function S(C){He[C?"unshift":"push"](()=>{r=C,e(2,r)})}function E(){_=this.value,e(7,_)}const D=C=>{C.key==="Enter"&&n.click()};function q(){p=this.checked,e(8,p)}function H(C){He[C?"unshift":"push"](()=>{i=C,e(0,i)})}function y(C){He[C?"unshift":"push"](()=>{n=C,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[i,n,r,a,c,u,h,_,p,b,k,s,S,E,D,q,H,y]}class Ll extends Te{constructor(t){super(),Le(this,t,Hl,El,Oe,{})}}function Gt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=d("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,s){N(e,t,s)},d(e){e&&P(t)}}}function Qt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),i,n,r,a=l[13]+"",c,u,h,_=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),n=w(),r=d("span"),c=R(a),f(e,"class",i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,p){N(m,t,p),o(t,e),_&&_.m(e,null),o(t,n),o(t,r),o(r,c),u||(h=A(t,"click",g),u=!0)},p(m,p){l=m,p&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?_||(_=Xt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),p&2&&i!==(i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",i),p&2&&a!==(a=l[13]+"")&&Q(c,a)},d(m){m&&P(t),_&&_.d(),u=!1,h()}}}function Wt(l){let t,e,s=l[10]+"",i,n,r,a,c,u,h,_,g;function m(){return l[6](l[10])}let p=l[1].selectFilters[l[10]].options,b=[];for(let k=0;k<p.length;k+=1)b[k]=Qt(Kt(l,p,k));return{c(){t=d("div"),e=d("div"),i=R(s),n=w(),r=d("i"),c=w(),u=d("div");for(let k=0;k<b.length;k+=1)b[k].c();f(r,"class",a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",h=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(k,S){N(k,t,S),o(t,e),o(e,i),o(e,n),o(e,r),o(t,c),o(t,u);for(let E=0;E<b.length;E+=1)b[E].m(u,null);_||(g=[A(e,"click",m),A(t,"mouseup",Il)],_=!0)},p(k,S){if(l=k,S&2&&s!==(s=l[10]+"")&&Q(i,s),S&2&&a!==(a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(r,"class",a),S&6){p=l[1].selectFilters[l[10]].options;let E;for(E=0;E<p.length;E+=1){const D=Kt(l,p,E);b[E]?b[E].p(D,S):(b[E]=Qt(D),b[E].c(),b[E].m(u,null))}for(;E<b.length;E+=1)b[E].d(1);b.length=p.length}S&2&&h!==(h=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",h)},d(k){k&&P(t),we(b,k),_=!1,pe(g)}}}function Tl(l){let t,e,s,i,n,r,a,c,u,h,_,g,m=Object.keys(l[1].selectFilters),p=[];for(let b=0;b<m.length;b+=1)p[b]=Wt(Gt(l,m,b));return{c(){t=d("div"),e=d("div"),s=d("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w(),n=d("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=w();for(let b=0;b<p.length;b+=1)p[b].c();a=w(),c=d("button"),u=R("Filter"),f(s,"class","flex items-center text-md"),f(n,"class","flex items-center text-md"),c.disabled=l[0],f(c,"class",h="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(b,k){N(b,t,k),o(t,e),o(e,s),o(e,i),o(e,n),o(e,r);for(let S=0;S<p.length;S+=1)p[S].m(e,null);o(e,a),o(e,c),o(c,u),_||(g=A(c,"click",l[4]),_=!0)},p(b,[k]){if(k&14){m=Object.keys(b[1].selectFilters);let S;for(S=0;S<m.length;S+=1){const E=Gt(b,m,S);p[S]?p[S].p(E,k):(p[S]=Wt(E),p[S].c(),p[S].m(e,a))}for(;S<p.length;S+=1)p[S].d(1);p.length=m.length}k&1&&(c.disabled=b[0]),k&1&&h!==(h="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(b[0]===!0?"disabled":""))&&f(c,"class",h)},i:G,o:G,d(b){b&&P(t),we(p,b),_=!1,g()}}}function dl(l,t,e=null,s=(i,n)=>i===n){let i=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?i.push(1):i.push(0):s(l[n],t)?i.push(1):i.push(0);return i}function Pl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=dl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Nl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=dl(l,t[s],null,(n,r)=>n?n.includes(r):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Al(l){let t=l[0].length,e=l[0];return l.forEach((s,i)=>{if(i>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(n))})}}),e}const Il=l=>l.stopPropagation();function Ml(l,t,e){let s=[],{filter_button_disabled:i=!0}=t;rt.subscribe(m=>{e(0,i=!1),e(5,s=m)});const n=ut(),r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ue(()=>{document.addEventListener("mouseup",a)});function a(m){e(1,r.selectFilterActive="",r)}function c(m,p){if(r.selectFilters[m].values.includes(p)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(b=>b!==p),r);return}e(1,r.selectFilters[m].values=[p,...r.selectFilters[m].values],r)}function u(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function h(){if(s){console.log(s);let m=[],p=[];s.map((q,H)=>{m.push(q.place),p.push(q.person)});let b=r.selectFilters.place.values,k=Pl(m,b),S=r.selectFilters.people.values,E=Nl(p,S),D=Al([k,E]);n("filterApplied",{mask:D})}}const _=m=>u(m),g=(m,p)=>c(m,p);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,i=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((S,E)=>{if(S.place)return S.place}),p=[];s.map((S,E)=>{S.person&&S.person.forEach(D=>p.push(D))});let b=[];new Set(m).forEach(S=>b.push(S));let k=[];new Set(p).forEach(S=>k.push(S)),e(1,r.selectFilters.place.values=b,r),e(1,r.selectFilters.place.options=b,r),e(1,r.selectFilters.people.values=k,r),e(1,r.selectFilters.people.options=k,r)}},[i,r,c,u,h,s,_,g]}class Bl extends Te{constructor(t){super(),Le(this,t,Ml,Tl,Oe,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[55]=t[e],s[54]=e,s}function Yt(l,t,e){const s=l.slice();return s[52]=t[e],s[54]=e,s}function zl(l){let t,e,s,i,n,r,a,c,u,h,_,g,m,p,b,k,S,E,D,q,H,y,C,v=l[1]&&Zt(l);e=new Bl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[42]);let F=l[6],x=[];for(let O=0;O<F.length;O+=1)x[O]=el(Jt(l,F,O));let I=l[6].length>=Fe&&tl(l);return{c(){v&&v.c(),t=w(),ve(e.$$.fragment),s=w(),i=d("div"),n=d("div"),r=d("div"),a=d("div"),c=w(),u=d("div"),h=d("div"),_=d("div"),g=d("input"),m=w(),p=d("label"),b=R("Score threshold: "),k=R(l[12]),S=R("."),E=w(),D=d("div");for(let O=0;O<x.length;O+=1)x[O].c();q=w(),I&&I.c(),f(a,"class","h-1 rounded bg-blue-600"),ce(a,"width",(l[7]*100).toString()+"%"),f(r,"class","flex animate-pulse"),f(g,"type","range"),f(g,"min","0"),f(g,"max","1.0"),f(g,"step","0.01"),f(g,"class","w-full"),f(p,"for","topk"),f(p,"class","dark:text-white"),f(_,"class","my-2"),f(u,"class","flex flex-row place-content-center mb-2 select-none mx-2"),f(D,"class","grid grid-cols-6 2xl:grid-cols-8 gap-2 p-1 sm:p-8 px-auto justify-center"),f(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),f(i,"class","flex")},m(O,j){v&&v.m(O,j),N(O,t,j),_e(e,O,j),N(O,s,j),N(O,i,j),o(i,n),o(n,r),o(r,a),o(n,c),o(n,u),o(u,h),o(h,_),o(_,g),ot(g,l[12]),o(_,m),o(_,p),o(p,b),o(p,k),o(p,S),o(n,E),o(n,D);for(let L=0;L<x.length;L+=1)x[L].m(D,null);o(n,q),I&&I.m(n,null),H=!0,y||(C=[A(g,"change",l[20]),A(g,"change",l[43]),A(g,"input",l[43])],y=!0)},p(O,j){O[1]?v?v.p(O,j):(v=Zt(O),v.c(),v.m(t.parentNode,t)):v&&(v.d(1),v=null);const L={};if(j[0]&8&&(L.filter_button_disabled=O[3]),e.$set(L),(!H||j[0]&128)&&ce(a,"width",(O[7]*100).toString()+"%"),j[0]&4096&&ot(g,O[12]),(!H||j[0]&4096)&&Q(k,O[12]),j[0]&33652801){F=O[6];let M;for(M=0;M<F.length;M+=1){const K=Jt(O,F,M);x[M]?x[M].p(K,j):(x[M]=el(K),x[M].c(),x[M].m(D,null))}for(;M<x.length;M+=1)x[M].d(1);x.length=F.length}O[6].length>=Fe?I?I.p(O,j):(I=tl(O),I.c(),I.m(n,null)):I&&(I.d(1),I=null)},i(O){H||(ee(e.$$.fragment,O),H=!0)},o(O){se(e.$$.fragment,O),H=!1},d(O){v&&v.d(O),O&&P(t),he(e,O),O&&P(s),O&&P(i),we(x,O),I&&I.d(),y=!1,pe(C)}}}function Rl(l){let t,e,s,i,n,r,a,c,u,h,_,g,m,p,b,k,S,E,D,q,H,y=l[2].image_card_edit_interface&&ll(l),C=l[5]&&sl(l);return{c(){t=d("div"),e=d("div"),s=d("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,i=w(),n=d("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=w(),a=d("div"),c=d("div"),c.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=w(),h=d("div"),_=d("div"),g=d("img"),p=w(),b=d("div"),b.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',k=w(),y&&y.c(),S=w(),E=d("div"),E.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',D=w(),C&&C.c(),f(s,"class","cursor-pointer hover:underline text-gray-200"),f(n,"title","Fullscreen"),f(n,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(c,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(g,"class","w-auto cursor-pointer h-full"),je(g.src,m="/api/getRawData/"+l[4].data_hash)||f(g,"src",m),f(g,"alt",""),f(b,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(_,"class","flex shrink h-full"),f(h,"class","flex h-full items-center justify-center p-2 gap-4"),f(E,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(a,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(v,F){N(v,t,F),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,a),o(a,c),o(a,u),o(a,h),o(h,_),o(_,g),o(_,p),o(_,b),o(h,k),y&&y.m(h,null),o(a,S),o(a,E),o(t,D),C&&C.m(t,null),q||(H=[A(s,"click",l[34]),A(n,"click",l[35]),A(c,"click",l[36]),A(g,"click",l[37]),A(b,"click",l[38]),A(E,"click",l[40])],q=!0)},p(v,F){F[0]&16&&!je(g.src,m="/api/getRawData/"+v[4].data_hash)&&f(g,"src",m),v[2].image_card_edit_interface?y?y.p(v,F):(y=ll(v),y.c(),y.m(h,null)):y&&(y.d(1),y=null),v[5]?C?C.p(v,F):(C=sl(v),C.c(),C.m(t,null)):C&&(C.d(1),C=null)},i:G,o:G,d(v){v&&P(t),y&&y.d(),C&&C.d(),q=!1,pe(H)}}}function Ul(l){let t,e,s,i,n,r,a,c,u,h,_,g,m,p,b,k,S,E,D=l[11],q=[];for(let y=0;y<D.length;y+=1)q[y]=nl(Yt(l,D,y));let H=l[10].active&&il(l);return{c(){t=d("div"),e=d("div"),s=d("img"),n=w();for(let y=0;y<q.length;y+=1)q[y].c();r=w(),H&&H.c(),a=w(),c=d("div"),u=d("div"),u.innerHTML='<i class="fa fa-arrow-left"></i>',h=w(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',g=w(),m=d("div"),p=d("div"),p.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),k=d("div"),k.innerHTML='<i class="fa fa-arrows-alt"></i>',f(s,"class","object-cover h-screen w-auto"),je(s.src,i="/api/getRawDataFull/"+l[4].data_hash)||f(s,"src",i),f(s,"alt",""),f(e,"class","relative flex"),f(u,"class","text-white cursor-pointer"),f(_,"class","text-white cursor-pointer"),f(c,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(p,"class","cursor-pointer hover:underline text-white"),f(k,"title","Fullscreen"),f(k,"class","cursor-pointer text-white"),f(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(y,C){N(y,t,C),o(t,e),o(e,s),o(e,n);for(let v=0;v<q.length;v+=1)q[v].m(e,null);o(e,r),H&&H.m(e,null),o(t,a),o(t,c),o(c,u),o(c,h),o(c,_),N(y,g,C),N(y,m,C),o(m,p),o(m,b),o(m,k),S||(E=[A(s,"load",l[19]),A(u,"click",l[30]),A(_,"click",l[31]),A(p,"click",l[32]),A(k,"click",l[33])],S=!0)},p(y,C){if(C[0]&16&&!je(s.src,i="/api/getRawDataFull/"+y[4].data_hash)&&f(s,"src",i),C[0]&3584){D=y[11];let v;for(v=0;v<D.length;v+=1){const F=Yt(y,D,v);q[v]?q[v].p(F,C):(q[v]=nl(F),q[v].c(),q[v].m(e,r))}for(;v<q.length;v+=1)q[v].d(1);q.length=D.length}y[10].active?H?H.p(y,C):(H=il(y),H.c(),H.m(e,null)):H&&(H.d(1),H=null)},i:G,o:G,d(y){y&&P(t),we(q,y),H&&H.d(),y&&P(g),y&&P(m),S=!1,pe(E)}}}function Zt(l){let t,e,s,i,n;return{c(){t=d("div"),e=d("div"),s=d("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(s,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(r,a){N(r,t,a),o(t,e),o(e,s),i||(n=A(s,"click",l[41]),i=!0)},p:G,d(r){r&&P(t),i=!1,n()}}}function $t(l){let t,e,s,i,n,r;function a(){return l[44](l[54])}return{c(){t=d("div"),e=d("img"),i=w(),f(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),je(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])||f(e,"src",s),f(e,"alt","image"),f(t,"class","flex justify-center bg-black")},m(c,u){N(c,t,u),o(t,e),o(t,i),n||(r=[A(e,"load",l[25]),A(t,"click",a)],n=!0)},p(c,u){l=c,u[0]&65&&!je(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])&&f(e,"src",s)},d(c){c&&P(t),n=!1,pe(r)}}}function el(l){let t,e=l[55].ix>=0&&$t(l);return{c(){e&&e.c(),t=Re()},m(s,i){e&&e.m(s,i),N(s,t,i)},p(s,i){s[55].ix>=0?e?e.p(s,i):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&P(t)}}}function tl(l){let t,e,s,i;return{c(){t=d("div"),e=d("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),f(t,"class","flex items-center justify-center")},m(n,r){N(n,t,r),o(t,e),l[45](e),s||(i=A(e,"click",l[14]),s=!0)},p:G,d(n){n&&P(t),l[45](null),s=!1,i()}}}function ll(l){let t,e,s,i,n,r,a,c,u,h,_,g,m,p,b,k,S,E,D,q,H,y,C,v,F,x,I,O,j,L,M,K,V,X,W,ie,$,ne,ye;return{c(){t=d("div"),e=d("div"),s=d("div"),s.textContent="Info",i=w(),n=d("div"),n.textContent="X",r=w(),a=d("div"),c=d("div"),c.textContent="Description",u=w(),h=d("input"),g=w(),m=d("div"),p=d("div"),p.textContent="place",b=w(),k=d("input"),E=w(),D=d("div"),q=d("div"),q.textContent="Tags",H=w(),y=d("input"),v=w(),F=d("div"),x=d("div"),x.textContent="Taken at:",I=w(),O=d("input"),j=w(),L=d("div"),M=d("div"),M.textContent="device",K=w(),V=d("input"),W=w(),ie=d("div"),$=d("button"),$.textContent="Save",f(s,"class","grow text-xl text-gray-100 font-bold"),f(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(c,"class","mb-1 text-gray-100"),f(h,"name","Description"),f(h,"placeholder",""),h.value=_=l[4].description.toString(),f(h,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(h,"type","text"),f(p,"class","mb-1 text-gray-100"),f(k,"name","place"),k.value=S=l[4].place.toString(),f(k,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(k,"type","text"),f(q,"class","mb-1 text-gray-100"),f(y,"name","tags"),f(y,"placeholder","Car, chair"),y.value=C=l[4].tags.toString(),f(y,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(y,"type","text"),f(x,"class","mb-1 text-gray-100"),f(O,"name","taken_at"),O.value="",f(O,"type","date"),f(O,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(M,"class","mb-1 text-gray-100"),f(V,"name","device"),f(V,"placeholder","Canon"),V.value=X=l[4].device.toString(),f(V,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(V,"type","text"),f($,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(Y,te){N(Y,t,te),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,a),o(a,c),o(a,u),o(a,h),o(t,g),o(t,m),o(m,p),o(m,b),o(m,k),o(t,E),o(t,D),o(D,q),o(D,H),o(D,y),o(t,v),o(t,F),o(F,x),o(F,I),o(F,O),o(t,j),o(t,L),o(L,M),o(L,K),o(L,V),o(t,W),o(t,ie),o(ie,$),ne||(ye=[A(n,"click",l[39]),A(h,"change",l[23]),A(k,"change",l[23]),A(y,"change",l[23]),A(O,"change",l[23]),A(V,"change",l[23]),A($,"click",l[24])],ne=!0)},p(Y,te){te[0]&16&&_!==(_=Y[4].description.toString())&&h.value!==_&&(h.value=_),te[0]&16&&S!==(S=Y[4].place.toString())&&k.value!==S&&(k.value=S),te[0]&16&&C!==(C=Y[4].tags.toString())&&y.value!==C&&(y.value=C),te[0]&16&&X!==(X=Y[4].device.toString())&&V.value!==X&&(V.value=X)},d(Y){Y&&P(t),ne=!1,pe(ye)}}}function sl(l){let t,e,s,i,n=l[4].filename+"",r,a,c,u,h,_=l[4].data_hash+"",g,m,p,b,k,S=l[4].last_modified+"",E,D,q,H,y,C,v,F,x,I=l[4].description.toString()+"",O,j,L,M,K,V,X=l[4].taken_at.toString()+"",W,ie,$,ne,ye,Y,te=l[4].tags.toString()+"",me,ge,ue,Ce,Se,De,fe=l[4].place.toString()+"",qe,be,xe,de,le,oe,T,B,U=l[4].person_ids.toString()+"",Z,z,ke,Ae,Je,Ee,ae=l[4].device.toString()+"",Ie,Ve,Ge,Ye,St,Ze,$e=l[4].resolution.toString()+"",_t,Dt,Ke,et,Ft,tt,lt=l[4].absolute_path.toString()+"",ht;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=d("div"),i=d("div"),r=R(n),a=w(),c=d("div"),u=R("UID: "),h=d("span"),g=R(_),m=w(),p=d("div"),b=R("Last Modified:  "),k=d("span"),E=R(S),D=w(),q=d("div"),H=d("div"),y=d("div"),C=d("div"),v=d("div"),v.textContent="Description",F=w(),x=d("div"),O=R(I),j=w(),L=d("div"),M=d("div"),M.textContent="Taken at",K=w(),V=d("div"),W=R(X),ie=w(),$=d("div"),ne=d("div"),ne.textContent="Tags",ye=w(),Y=d("div"),me=R(te),ge=w(),ue=d("div"),Ce=d("div"),Ce.textContent="Place",Se=w(),De=d("div"),qe=R(fe),be=w(),xe=d("div"),de=d("div"),le=d("div"),oe=d("div"),oe.textContent="people",T=w(),B=d("div"),Z=R(U),z=w(),ke=d("div"),Ae=d("div"),Ae.textContent="Device",Je=w(),Ee=d("div"),Ie=R(ae),Ve=w(),Ge=d("div"),Ye=d("div"),Ye.textContent="Resolution",St=w(),Ze=d("div"),_t=R($e),Dt=w(),Ke=d("div"),et=d("div"),et.textContent="Path",Ft=w(),tt=d("div"),ht=R(lt),f(i,"class","text-xl text-white"),f(h,"class","text-sm text-gray-400"),f(c,"class","text-white"),f(k,"class","text-sm text-gray-400"),f(p,"class","text-white"),f(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(v,"class",""),f(x,"class","text-sm text-gray-400"),f(M,"class",""),f(V,"class","text-sm text-gray-400"),f(ne,"class",""),f(Y,"class","text-sm text-gray-400"),f(Ce,"class",""),f(De,"class","text-sm text-gray-400"),f(y,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(H,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(oe,"class",""),f(B,"class","text-sm text-gray-400"),f(Ae,"class",""),f(Ee,"class","text-sm text-gray-400"),f(Ye,"class",""),f(Ze,"class","text-sm text-gray-400"),f(et,"class",""),f(tt,"class","text-sm text-gray-400"),f(de,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(xe,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(q,"class","flex w-full justify-center p-4")},m(J,re){N(J,t,re),N(J,e,re),N(J,s,re),o(s,i),o(i,r),o(s,a),o(s,c),o(c,u),o(c,h),o(h,g),o(s,m),o(s,p),o(p,b),o(p,k),o(k,E),N(J,D,re),N(J,q,re),o(q,H),o(H,y),o(y,C),o(C,v),o(C,F),o(C,x),o(x,O),o(y,j),o(y,L),o(L,M),o(L,K),o(L,V),o(V,W),o(y,ie),o(y,$),o($,ne),o($,ye),o($,Y),o(Y,me),o(y,ge),o(y,ue),o(ue,Ce),o(ue,Se),o(ue,De),o(De,qe),o(q,be),o(q,xe),o(xe,de),o(de,le),o(le,oe),o(le,T),o(le,B),o(B,Z),o(de,z),o(de,ke),o(ke,Ae),o(ke,Je),o(ke,Ee),o(Ee,Ie),o(de,Ve),o(de,Ge),o(Ge,Ye),o(Ge,St),o(Ge,Ze),o(Ze,_t),o(de,Dt),o(de,Ke),o(Ke,et),o(Ke,Ft),o(Ke,tt),o(tt,ht)},p(J,re){re[0]&16&&n!==(n=J[4].filename+"")&&Q(r,n),re[0]&16&&_!==(_=J[4].data_hash+"")&&Q(g,_),re[0]&16&&S!==(S=J[4].last_modified+"")&&Q(E,S),re[0]&16&&I!==(I=J[4].description.toString()+"")&&Q(O,I),re[0]&16&&X!==(X=J[4].taken_at.toString()+"")&&Q(W,X),re[0]&16&&te!==(te=J[4].tags.toString()+"")&&Q(me,te),re[0]&16&&fe!==(fe=J[4].place.toString()+"")&&Q(qe,fe),re[0]&16&&U!==(U=J[4].person_ids.toString()+"")&&Q(Z,U),re[0]&16&&ae!==(ae=J[4].device.toString()+"")&&Q(Ie,ae),re[0]&16&&$e!==($e=J[4].resolution.toString()+"")&&Q(_t,$e),re[0]&16&&lt!==(lt=J[4].absolute_path.toString()+"")&&Q(ht,lt)},d(J){J&&P(t),J&&P(e),J&&P(s),J&&P(D),J&&P(q)}}}function nl(l){let t,e,s;function i(...n){return l[28](l[52],...n)}return{c(){t=d("div"),f(t,"data-ix",l[54]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ce(t,"top",l[52].top+"px "),ce(t,"left",l[52].left+"px"),ce(t,"width",l[52].width+"px"),ce(t,"height",l[52].height+"px")},m(n,r){N(n,t,r),e||(s=A(t,"click",i),e=!0)},p(n,r){l=n,r[0]&2048&&ce(t,"top",l[52].top+"px "),r[0]&2048&&ce(t,"left",l[52].left+"px"),r[0]&2048&&ce(t,"width",l[52].width+"px"),r[0]&2048&&ce(t,"height",l[52].height+"px")},d(n){n&&P(t),e=!1,s()}}}function il(l){let t,e,s,i,n,r,a;return{c(){t=d("div"),e=d("input"),i=w(),n=d("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[9]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),ce(t,"top",l[10].top+"px "),ce(t,"left",l[10].left+"px")},m(c,u){N(c,t,u),o(t,e),o(t,i),o(t,n),e.focus(),r||(a=[A(e,"keyup",l[22]),A(n,"click",l[29])],r=!0)},p(c,u){u[0]&528&&s!==(s=c[4].person_ids[c[9]])&&e.value!==s&&(e.value=s),u[0]&1024&&ce(t,"top",c[10].top+"px "),u[0]&1024&&ce(t,"left",c[10].left+"px")},d(c){c&&P(t),r=!1,pe(a)}}}function Vl(l){let t,e,s,i;const n=[Ul,Rl,zl],r=[];function a(c,u){return c[2].image_card_fullscreen===!0?0:c[2].image_card===!0?1:2}return t=a(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(c,u){r[t].m(c,u),N(c,s,u),i=!0},p(c,u){let h=t;t=a(c),t===h?r[t].p(c,u):(ft(),se(r[h],1,1,()=>{r[h]=null}),dt(),e=r[t],e?e.p(c,u):(e=r[t]=n[t](c),e.c()),ee(e,1),e.m(s.parentNode,s))},i(c){i||(ee(e),i=!0)},o(c){se(e),i=!1},d(c){r[t].d(c),c&&P(s)}}}let Fe=20;function gt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let i=0;i<l.length;i++){let n=i;t[i%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[i][e]}):s.push({ix:n,score:l[i]})}return s.sort((i,n)=>i.score>n.score?-1:i.score<n.score?1:0),s}function Gl(l,t,e){const s=ut();let{show_exit_interface_button:i=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,r=!0;ct(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),rt.update(T=>[])});let a={},c=!1,u=[],h=[],_=0,g=0,m=0,p,b=!1;function k(T){b=!0,p&&e(8,p.disabled=!0,p),g=0,e(7,m=0),e(27,_=_+Fe),e(6,u=h.slice(_,_+Fe)),rt.update(B=>S(u))}function S(T){let B=[],U=T.length;for(let Z=0;Z<U;Z++){let z=T[Z].ix;B.push(n.list_metaData[z])}return B}Ne.subscribe(T=>{e(7,m=T.progress),T.done==!0?(E(T),e(7,m=0)):(e(27,_=0),e(6,u=[]))});function E(T){e(26,h=gt(T.list_score)),e(6,u=h.slice(0,0+Fe)),rt.update(B=>S(u))}let D={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function q(T){let B=Object.keys(D);for(let U=0;U<B.length;U++)e(2,D[B[U]]=!1,D);e(2,D[T]=!0,D)}let H,y={active:!1,top:null,left:null};function C(T){let B={sorted_ix:null,image_ix:null};for(let U=T;U<u.length;U++)if(u[U].ix!==-1){B.image_ix=u[U].ix,B.sorted_ix=U;break}return B}function v(T){V={},e(5,c=!1),e(11,I=[]),e(10,y={active:!1,top:null,left:null});let B=T,U=u.length;B<0&&(B=U-1),B>U-1&&(B=0);let Z=C(B),z=Z.image_ix;B=Z.sorted_ix,z===null&&(Z=C(0),z=Z.image_ix,B=Z.sorted_ix),e(4,a.ix=B,a),e(4,a.data_hash=n.list_dataHash[z],a),e(4,a.height=Number(n.list_metaData[z].height),a),e(4,a.width=Number(n.list_metaData[z].width),a),e(4,a.face_bboxes=n.list_metaData[z].face_bboxes,a),e(4,a.person_ids=n.list_metaData[z].person,a),a.person_ids===null&&e(4,a.person_ids=[],a),e(4,a.resolution=a.height.toString()+" X "+a.width.toString(),a),e(4,a.filename=n.list_metaData[z].filename,a),e(4,a.taken_at=n.list_metaData[z].taken_at,a),a.taken_at==null&&e(4,a.taken_at="Unknown",a),e(4,a.last_modified=n.list_metaData[z].modified_at,a),e(4,a.device=n.list_metaData[z].device,a),a.device==null&&e(4,a.device="",a),e(4,a.place=n.list_metaData[z].place,a),e(4,a.absolute_path=n.list_metaData[z].absolute_path,a),e(4,a.description=n.list_metaData[z].description,a),e(4,a.tags=n.list_metaData[z].tags,a),e(5,c=!0)}function F(){v(a.ix+1)}function x(){v(a.ix-1)}let I=[];function O(T){let B=T.target.getClientRects()[0],U=B.width,Z=B.height,z=[],ke=a.face_bboxes;if(ke){let Ae=a.width,Je=a.height;for(let Ee=0;Ee<ke.length;Ee++){let ae=structuredClone(ke[Ee]),Ie=Number(U)/(Number(Ae)+1e-4),Ve=Number(Z)/(Number(Je)+1e-4);ae.top=ae[1]*Ve,ae.height=(ae[3]-ae[1])*Ve,ae.left=ae[0]*Ie,ae.width=(ae[2]-ae[0])*Ie,z.push(ae)}}console.log(z),e(11,I=z)}let j=0;function L(){let T=u[0].score,B=u[u.length-1].score,Z=n.list_score.map(z=>(z-B)/(T-B+1e-5)).map(z=>z>=j?1:0);e(6,u=gt(n.list_score,Z))}function M(T){e(3,r=!0);let B=h.slice(_,_+Fe);for(let U=0;U<T.length;U++)T[U]==0?e(6,u[U].ix=-1,u):e(6,u[U].ix=B[U].ix,u);e(3,r=!1)}function K(T){let B=T.target.value,U=a.data_hash,Z=a.person_ids[H];if(T.key=="Enter"){let z=new FormData;z.append("new_person_id",B),z.append("old_person_id",Z),z.append("data_hash",U),fetch("/api/tagPerson",{method:"POST",body:z}).then(ke=>{if(ke.ok)alert("Success");else throw new Error("Error occured")})}}let V={};function X(T){V[T.target.name.toLowerCase()]=T.target.value}async function W(T){T.target.disabled=!0,T.target.innerText="Saving...";let B=Object.keys(V),U=new FormData;for(let z=0;z<B.length;z++)U.append(B[z],V[B[z]]);U.append("data_hash",a.data_hash);let Z=await fetch("/api/editMetaData",{method:"POST",body:U});Z.ok?(alert("Success!"),await Z.json(),e(2,D.image_card_edit_interface=!1,D)):alert("Error while saving. Contact Admin"),T.target.innerText="Save",T.target.disabled=!1}function ie(T){b&&(g+=1,e(7,m+=1/Fe),g==Math.min(u.length,Fe)&&(e(7,m=0),b=!1),p&&e(8,p.disabled=!1,p))}const $=(T,B)=>{e(10,y={active:!0,top:T.top-28,left:T.left}),e(9,H=Number(B.target.attributes["data-ix"].value))},ne=()=>{e(10,y.active=!1,y)},ye=()=>{x()},Y=()=>{F()},te=()=>{q("parent")},me=()=>{q("image_card")},ge=()=>{q("parent")},ue=()=>{q("image_card_fullscreen")},Ce=()=>{x()},Se=()=>{console.log("hellll"),q("image_card_fullscreen")},De=()=>{e(2,D.image_card_edit_interface=!0,D)},fe=()=>{e(2,D.image_card_edit_interface=!1,D)},qe=()=>{F()},be=()=>{console.log("pressed me!!!"),e(6,u=[]),s("exitButtonPressed")},xe=T=>{M(T.detail.mask)};function de(){j=_l(this.value),e(12,j)}const le=T=>{v(T),q("image_card")};function oe(T){He[T?"unshift":"push"](()=>{p=T,e(8,p)})}return l.$$set=T=>{"show_exit_interface_button"in T&&e(1,i=T.show_exit_interface_button),"image_data"in T&&e(0,n=T.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&201326593&&n&&(e(26,h=gt(n.list_score)),n.done==!1&&e(6,u=h.slice(_,_+Fe))),l.$$.dirty[0]&4&&D){let T=!1;(D.image_card==!0||D.image_card_fullscreen==!0)&&(T=!0),s("imageCardActive",{active:T})}},[n,i,D,r,a,c,u,m,p,H,y,I,j,s,k,q,v,F,x,O,L,M,K,X,W,ie,h,_,$,ne,ye,Y,te,me,ge,ue,Ce,Se,De,fe,qe,be,xe,de,le,oe]}class Ct extends Te{constructor(t){super(),Le(this,t,Gl,Vl,Oe,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const Kl="/assets/sample_place_bg-38f3fbd4.jpg";function rl(l,t,e){const s=l.slice();return s[10]=t[e],s}function Xl(l){let t,e,s,i,n,r,a,c,u,h,_,g=l[0].people,m=[];for(let p=0;p<g.length;p+=1)m[p]=ol(rl(l,g,p));return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("div"),n=d("div"),n.textContent="People Album",r=w(),a=d("div"),c=d("input"),u=w();for(let p=0;p<m.length;p+=1)m[p].c();f(n,"class","flex text-lg font-semibold"),f(c,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(c,"type","text"),f(c,"placeholder","Search person"),f(a,"class","flex"),f(i,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(p,b){N(p,t,b),o(t,e),o(e,s),o(s,i),o(i,n),o(i,r),o(i,a),o(a,c),o(e,u);for(let k=0;k<m.length;k+=1)m[k].m(e,null);h||(_=A(c,"input",l[5]),h=!0)},p(p,b){if(b&17){g=p[0].people;let k;for(k=0;k<g.length;k+=1){const S=rl(p,g,k);m[k]?m[k].p(S,b):(m[k]=ol(S),m[k].c(),m[k].m(e,null))}for(;k<m.length;k+=1)m[k].d(1);m.length=g.length}},i:G,o:G,d(p){p&&P(t),we(m,p),h=!1,_()}}}function Ql(l){let t,e;return t=new Ct({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){ve(t.$$.fragment)},m(s,i){_e(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(ee(t.$$.fragment,s),e=!0)},o(s){se(t.$$.fragment,s),e=!1},d(s){he(t,s)}}}function Wl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,s){N(e,t,s)},p:G,i:G,o:G,d(e){e&&P(t)}}}function ol(l){let t,e,s,i,n,r,a,c=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",u,h,_,g;function m(...p){return l[7](l[10],...p)}return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("img"),r=w(),a=d("div"),u=R(c),h=w(),f(i,"loading","lazy"),je(i.src,n="/api/getPreviewPerson/"+l[10])||f(i,"src",n),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[160px] w-[160px] bg-gray-800"),f(a,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(p,b){N(p,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,a),o(a,u),o(t,h),_||(g=A(t,"click",m),_=!0)},p(p,b){l=p,b&1&&!je(i.src,n="/api/getPreviewPerson/"+l[10])&&f(i,"src",n),b&1&&c!==(c=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&Q(u,c)},d(p){p&&P(t),_=!1,g()}}}function Jl(l){let t,e,s,i;const n=[Wl,Ql,Xl],r=[];function a(c,u){return c[3]===!1?0:c[2]?1:2}return t=a(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(c,u){r[t].m(c,u),N(c,s,u),i=!0},p(c,[u]){let h=t;t=a(c),t===h?r[t].p(c,u):(ft(),se(r[h],1,1,()=>{r[h]=null}),dt(),e=r[t],e?e.p(c,u):(e=r[t]=n[t](c),e.c()),ee(e,1),e.m(s.parentNode,s))},i(c){i||(ee(e),i=!0)},o(c){se(e),i=!1},d(c){r[t].d(c),c&&P(s)}}}function Yl(l,t,e){let s={people:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,a=!0,c;Ue(()=>{e(3,a=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(p=>{let b=p.meta_data.length;for(let k=0;k<b;k++)i.list_dataHash.push(p.data_hash[k]),i.list_score.push(p.score[k]),i.list_metaData.push(p.meta_data[k]);e(3,a=!0),e(0,s.people=p.person,s),c=s.people})})}),ct(()=>{console.log("destroying... people..")});async function u(m){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let p=0;p<i.list_dataHash.length;p++)i.list_metaData[p].person.includes(m)&&(n.list_metaData.push(i.list_metaData[p]),n.list_dataHash.push(i.list_dataHash[p]),n.list_score.push(i.list_score[p]));e(1,n.done=!0,n),e(2,r=!0),c&&e(0,s.people=c,s),Ne.update(p=>structuredClone(n))}function h(m){let p=m.target.value;if(p=p.toLowerCase(),!p){c&&e(0,s.people=c,s);return}p&&a==!0&&c&&(e(0,s.people=[],s),c.forEach(b=>{b.toLowerCase().includes(p)&&s.people.push(b)}))}return[s,n,r,a,u,h,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,p)=>{console.log("mine is: ",m),u(m)}]}class Zl extends Te{constructor(t){super(),Le(this,t,Yl,Jl,Oe,{})}}function al(l,t,e){const s=l.slice();return s[8]=t[e],s}function $l(l){let t,e,s,i=l[0].places,n=[];for(let r=0;r<i.length;r+=1)n[r]=cl(al(l,i,r));return{c(){t=d("div"),e=w(),s=d("div");for(let r=0;r<n.length;r+=1)n[r].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,a){N(r,t,a),N(r,e,a),N(r,s,a);for(let c=0;c<n.length;c+=1)n[c].m(s,null)},p(r,a){if(a&17){i=r[0].places;let c;for(c=0;c<i.length;c+=1){const u=al(r,i,c);n[c]?n[c].p(u,a):(n[c]=cl(u),n[c].c(),n[c].m(s,null))}for(;c<n.length;c+=1)n[c].d(1);n.length=i.length}},i:G,o:G,d(r){r&&P(t),r&&P(e),r&&P(s),we(n,r)}}}function es(l){let t,e;return t=new Ct({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){ve(t.$$.fragment)},m(s,i){_e(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(ee(t.$$.fragment,s),e=!0)},o(s){se(t.$$.fragment,s),e=!1},d(s){he(t,s)}}}function ts(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,s){N(e,t,s)},p:G,i:G,o:G,d(e){e&&P(t)}}}function cl(l){let t,e,s,i,n,r,a,c=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,h,_,g;function m(...p){return l[6](l[8],...p)}return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("img"),r=w(),a=d("div"),u=R(c),h=w(),je(i.src,n=Kl)||f(i,"src",n),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[150px] w-[200px] bg-gray-800"),f(a,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(p,b){N(p,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,a),o(a,u),o(t,h),_||(g=A(t,"click",m),_=!0)},p(p,b){l=p,b&1&&c!==(c=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&Q(u,c)},d(p){p&&P(t),_=!1,g()}}}function ls(l){let t,e,s,i;const n=[ts,es,$l],r=[];function a(c,u){return c[3]===!1?0:c[2]?1:2}return t=a(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(c,u){r[t].m(c,u),N(c,s,u),i=!0},p(c,[u]){let h=t;t=a(c),t===h?r[t].p(c,u):(ft(),se(r[h],1,1,()=>{r[h]=null}),dt(),e=r[t],e?e.p(c,u):(e=r[t]=n[t](c),e.c()),ee(e,1),e.m(s.parentNode,s))},i(c){i||(ee(e),i=!0)},o(c){se(e),i=!1},d(c){r[t].d(c),c&&P(s)}}}function ss(l,t,e){let s={places:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,a=!0;Ue(()=>{e(3,a=!1),fetch("/api/getGroup/place").then(_=>{_.json().then(g=>{let m=g.meta_data.length;for(let p=0;p<m;p++)i.list_dataHash.push(g.data_hash[p]),i.list_score.push(g.score[p]),i.list_metaData.push(g.meta_data[p]);e(3,a=!0),e(0,s.places=g.place,s)})})}),ct(()=>{console.log("destroying...")});async function c(_){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ne.update(g=>structuredClone(n));for(let g=0;g<i.list_dataHash.length;g++)i.list_metaData[g].place.toLowerCase()===_.toLowerCase()&&(n.list_metaData.push(i.list_metaData[g]),n.list_dataHash.push(i.list_dataHash[g]),n.list_score.push(i.list_score[g]));e(1,n.done=!0,n),e(2,r=!0),Ne.update(g=>structuredClone(n))}return[s,n,r,a,c,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),c(_)}]}class ns extends Te{constructor(t){super(),Le(this,t,ss,ls,Oe,{})}}function is(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new Zl({}),{c(){t=d("div"),ve(e.$$.fragment),s=w(),i=d("div"),ve(n.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,c){N(a,t,c),_e(e,t,null),o(t,s),o(t,i),_e(n,i,null),r=!0},p(a,c){const u={};c&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(ee(e.$$.fragment,a),ee(n.$$.fragment,a),r=!0)},o(a){se(e.$$.fragment,a),se(n.$$.fragment,a),r=!1},d(a){a&&P(t),he(e),he(n)}}}function rs(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new ns({}),{c(){t=d("div"),ve(e.$$.fragment),s=w(),i=d("div"),ve(n.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,c){N(a,t,c),_e(e,t,null),o(t,s),o(t,i),_e(n,i,null),r=!0},p(a,c){const u={};c&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(ee(e.$$.fragment,a),ee(n.$$.fragment,a),r=!0)},o(a){se(e.$$.fragment,a),se(n.$$.fragment,a),r=!1},d(a){a&&P(t),he(e),he(n)}}}function os(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[11]),e.$on("sidebarStateChange",l[12]),n=new Ll({}),{c(){t=d("div"),ve(e.$$.fragment),s=w(),i=d("div"),ve(n.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(a,c){N(a,t,c),_e(e,t,null),o(t,s),o(t,i),_e(n,i,null),r=!0},p(a,c){const u={};c&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(ee(e.$$.fragment,a),ee(n.$$.fragment,a),r=!0)},o(a){se(e.$$.fragment,a),se(n.$$.fragment,a),r=!1},d(a){a&&P(t),he(e),he(n)}}}function as(l){let t,e,s,i,n,r,a,c;return e=new pt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[8]),e.$on("sidebarStateChange",l[9]),n=new Sl({props:{query_button_disabled:l[1]}}),n.$on("queryReady",l[10]),a=new Ct({props:{image_data:l[0]}}),{c(){t=d("div"),ve(e.$$.fragment),s=w(),i=d("div"),ve(n.$$.fragment),r=w(),ve(a.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,h){N(u,t,h),_e(e,t,null),o(t,s),o(t,i),_e(n,i,null),o(i,r),_e(a,i,null),c=!0},p(u,h){const _={};h&32&&(_.sidebarOpen=u[5]),e.$set(_);const g={};h&2&&(g.query_button_disabled=u[1]),n.$set(g);const m={};h&1&&(m.image_data=u[0]),a.$set(m)},i(u){c||(ee(e.$$.fragment,u),ee(n.$$.fragment,u),ee(a.$$.fragment,u),c=!0)},o(u){se(e.$$.fragment,u),se(n.$$.fragment,u),se(a.$$.fragment,u),c=!1},d(u){u&&P(t),he(e),he(n),he(a)}}}function cs(l){let t,e,s,i;const n=[as,os,rs,is],r=[];function a(c,u){return c[4].query.status?0:c[4].indexing.status===!0?1:c[4].place_album.status===!0?2:c[4].people_album.status===!0?3:-1}return~(t=a(l))&&(e=r[t]=n[t](l)),{c(){e&&e.c(),s=Re()},m(c,u){~t&&r[t].m(c,u),N(c,s,u),i=!0},p(c,[u]){let h=t;t=a(c),t===h?~t&&r[t].p(c,u):(e&&(ft(),se(r[h],1,1,()=>{r[h]=null}),dt()),~t?(e=r[t],e?e.p(c,u):(e=r[t]=n[t](c),e.c()),ee(e,1),e.m(s.parentNode,s)):e=null)},i(c){i||(ee(e),i=!0)},o(c){se(e),i=!1},d(c){~t&&r[t].d(c),c&&P(s)}}}let us=3;function fs(l,t,e){Ue(()=>{fetch("/api/getMetaStats").then(F=>{F.ok?F.json().then(x=>{wt.update(I=>Number(x.image.count)),xt.update(I=>Number(x.image.unique_place_count)),yt.update(I=>Number(x.image.unique_people_count))}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let s=[],i=[],n=[],r,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},c=!1,u="",h={};async function _(F="xxxxxxx",x=!1){console.log("handleClick count",u,x,F),e(1,c=!0);let I=us;if(r=new FormData,u.length===0)return;r.append("query",u),r.append("topk",I.toString()),x==!1?(i=[],s=[],n=[],e(0,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),r.append("query_start","true"),Ne.update(W=>a)):(r.append("query_start","false"),r.append("client_id",F));let j=await fetch("/api/query",{method:"POST",body:r});if(!j.ok)throw e(1,c=!1),new Error(j);let L=await j.json();console.log("data: ",L);let M=L.client_id,K=L.meta_data,V=L.data_hash,X=L.score;Number(L.progress);for(let W=0;W<K.length;W++){let ie=V[W],$=Number(X[W]),ne=i.indexOf(ie);ne>=0?(s[ne]+=$,e(0,a.list_score[ne]+=$,a)):(i.push(ie),s.push($),n.push(K[W]),a.list_dataHash.push(ie),a.list_score.push($),a.list_metaData.push(K[W]))}if(L.query_completed==!0?(e(0,a.done=!0,a),e(0,a.progress=1e-4,a)):(e(0,a),e(0,a.progress+=.12,a),e(0,a.progress=Math.min(a.progress,.92),a)),L.query_completed==!0){e(1,c=!1),console.log("hey i am being called!!!"),Ne.update(W=>a);return}await _(M,!0)}const g={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function m(F){g[F].status==!1&&(e(0,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Ne.update(I=>structuredClone(a)));let x=Object.keys(g);for(let I=0;I<x.length;I++)g[x[I]].status&&e(4,g[x[I]].status=!1,g);g[F]&&e(4,g[F].status=!0,g)}let p=!0;function b(F){let x=F.detail.item.name;x.toLowerCase().includes("photo")?m("query"):x.toLowerCase().includes("index")?m("indexing"):x.toLowerCase().includes("people")?m("people_album"):x.toLowerCase().includes("place")&&m("place_album")}return[a,c,u,h,g,p,_,b,F=>{b(F)},F=>{e(5,p=F.detail.open)},F=>{e(2,u=F.detail.query),e(3,h=F.detail.attributes),_()},F=>b(F),F=>{e(5,p=F.detail.open)},F=>b(F),F=>{e(5,p=F.detail.open)},F=>b(F),F=>{e(5,p=F.detail.open)}]}class ds extends Te{constructor(t){super(),Le(this,t,fs,cs,Oe,{})}}new ds({target:document.getElementById("app")});
