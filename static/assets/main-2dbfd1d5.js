(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function U(){}function sl(l){return l()}function xt(){return Object.create(null)}function de(l){l.forEach(sl)}function il(l){return typeof l=="function"}function we(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let et;function ke(l,t){return et||(et=document.createElement("a")),et.href=t,l===et.href}function cl(l){return Object.keys(l).length===0}function c(l,t){l.appendChild(t)}function I(l,t,e){l.insertBefore(t,e||null)}function E(l){l.parentNode&&l.parentNode.removeChild(l)}function me(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function R(l){return document.createTextNode(l)}function x(){return R(" ")}function Ne(){return R("")}function L(l,t,e,n){return l.addEventListener(t,e,n),()=>l.removeEventListener(t,e,n)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function ul(l){return l===""?null:+l}function fl(l){return Array.from(l.childNodes)}function Q(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function Pe(l,t){l.value=t??""}function fe(l,t,e,n){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,n?"important":"")}function Ct(l,t){for(let e=0;e<l.options.length;e+=1){const n=l.options[e];if(n.__value===t){n.selected=!0;return}}l.selectedIndex=-1}function dl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function _l(l,t,{bubbles:e=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,e,n,t),i}let ze;function Re(l){ze=l}function mt(){if(!ze)throw new Error("Function called outside component initialization");return ze}function Ue(l){mt().$$.on_mount.push(l)}function it(l){mt().$$.on_destroy.push(l)}function rt(){const l=mt();return(t,e,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[t];if(i){const s=_l(t,e,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}const Te=[],qe=[],tt=[],St=[],pl=Promise.resolve();let ht=!1;function hl(){ht||(ht=!0,pl.then(rl))}function st(l){tt.push(l)}const _t=new Set;let He=0;function rl(){if(He!==0)return;const l=ze;do{try{for(;He<Te.length;){const t=Te[He];He++,Re(t),ml(t.$$)}}catch(t){throw Te.length=0,He=0,t}for(Re(null),Te.length=0,He=0;qe.length;)qe.pop()();for(let t=0;t<tt.length;t+=1){const e=tt[t];_t.has(e)||(_t.add(e),e())}tt.length=0}while(Te.length);for(;St.length;)St.pop()();ht=!1,_t.clear(),Re(l)}function ml(l){if(l.fragment!==null){l.update(),de(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(st)}}const lt=new Set;let je;function ot(){je={r:0,c:[],p:je}}function at(){je.r||de(je.c),je=je.p}function Z(l,t){l&&l.i&&(lt.delete(l),l.i(t))}function ee(l,t,e,n){if(l&&l.o){if(lt.has(l))return;lt.add(l),je.c.push(()=>{lt.delete(l),n&&(e&&l.d(1),n())}),l.o(t)}else n&&n()}function he(l){l&&l.c()}function _e(l,t,e,n){const{fragment:i,after_update:s}=l.$$;i&&i.m(t,e),n||st(()=>{const r=l.$$.on_mount.map(sl).filter(il);l.$$.on_destroy?l.$$.on_destroy.push(...r):de(r),l.$$.on_mount=[]}),s.forEach(st)}function pe(l,t){const e=l.$$;e.fragment!==null&&(de(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function gl(l,t){l.$$.dirty[0]===-1&&(Te.push(l),hl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Ce(l,t,e,n,i,s,r,a=[-1]){const o=ze;Re(l);const u=l.$$={fragment:null,ctx:[],props:s,update:U,not_equal:i,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:xt(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};r&&r(u.root);let p=!1;if(u.ctx=e?e(l,t.props||{},(_,h,...m)=>{const g=m.length?m[0]:h;return u.ctx&&i(u.ctx[_],u.ctx[_]=g)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](g),p&&gl(l,_)),h}):[],u.update(),p=!0,de(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){const _=fl(t.target);u.fragment&&u.fragment.l(_),_.forEach(E)}else u.fragment&&u.fragment.c();t.intro&&Z(l.$$.fragment),_e(l,t.target,t.anchor,t.customElement),rl()}Re(o)}class Se{$destroy(){pe(this,1),this.$destroy=U}$on(t,e){if(!il(e))return U;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const i=n.indexOf(e);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!cl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Dt(l,t,e){const n=l.slice();return n[25]=t[e],n}function Ft(l,t,e){const n=l.slice();return n[28]=t[e],n}function Ot(l,t,e){const n=l.slice();return n[28]=t[e],n}function jt(l,t,e){const n=l.slice();return n[33]=t[e],n}function qt(l){let t,e,n,i=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",s,r,a,o,u,p,_,h=l[4][l[28]],m=[];for(let y=0;y<h.length;y+=1)m[y]=Et(jt(l,h,y));function g(){return l[14](l[28])}function v(...y){return l[15](l[28],...y)}return{c(){t=d("div"),e=d("span"),n=d("span"),s=R(i),r=x();for(let y=0;y<m.length;y+=1)m[y].c();a=x(),o=d("span"),o.textContent="x",u=x(),f(n,"class","text-blue-800 "),f(e,"class","cursor-pointer"),f(o,"class","ml-2 text-red-600 cursor-pointer hover:text-blue-500"),f(t,"class","px-4 py-2 self-center bg-blue-200 rounded-md inline-flex place-self-center items-center mr-2 mb-2 h-10")},m(y,D){I(y,t,D),c(t,e),c(e,n),c(n,s),c(e,r);for(let S=0;S<m.length;S+=1)m[S].m(e,null);c(t,a),c(t,o),c(t,u),p||(_=[L(e,"click",g),L(o,"click",v)],p=!0)},p(y,D){if(l=y,D[0]&16&&i!==(i=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"")&&Q(s,i),D[0]&16){h=l[4][l[28]];let S;for(S=0;S<h.length;S+=1){const H=jt(l,h,S);m[S]?m[S].p(H,D):(m[S]=Et(H),m[S].c(),m[S].m(e,null))}for(;S<m.length;S+=1)m[S].d(1);m.length=h.length}},d(y){y&&E(t),me(m,y),p=!1,de(_)}}}function Et(l){let t,e=l[33]+" ",n;return{c(){t=d("span"),n=R(e),f(t,"class","ml-1")},m(i,s){I(i,t,s),c(t,n)},p(i,s){s[0]&16&&e!==(e=i[33]+" ")&&Q(n,e)},d(i){i&&E(t)}}}function It(l){let t,e=l[4][l[28]].length>=1&&qt(l);return{c(){e&&e.c(),t=Ne()},m(n,i){e&&e.m(n,i),I(n,t,i)},p(n,i){n[4][n[28]].length>=1?e?e.p(n,i):(e=qt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&E(t)}}}function Ht(l){let t,e=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",n,i,s;return{c(){t=d("option"),n=R(e),i=x(),t.__value=s=l[28],t.value=t.__value},m(r,a){I(r,t,a),c(t,n),c(t,i)},p(r,a){a[0]&16&&e!==(e=r[28].charAt(0).toUpperCase()+r[28].slice(1)+"")&&Q(n,e),a[0]&16&&s!==(s=r[28])&&(t.__value=s,t.value=t.__value)},d(r){r&&E(t)}}}function Lt(l){let t,e,n,i,s,r,a,o,u=l[3],p=[];for(let _=0;_<u.length;_+=1)p[_]=Tt(Dt(l,u,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<p.length;_+=1)p[_].c();n=x(),i=d("div"),s=d("button"),s.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(s,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(i,"class","flex w-full justify-center items-center"),f(t,"class",r=(l[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,h){I(_,t,h),c(t,e);for(let m=0;m<p.length;m+=1)p[m].m(e,null);c(t,n),c(t,i),c(i,s),a||(o=L(s,"click",l[22]),a=!0)},p(_,h){if(h[0]&522){u=_[3];let m;for(m=0;m<u.length;m+=1){const g=Dt(_,u,m);p[m]?p[m].p(g,h):(p[m]=Tt(g),p[m].c(),p[m].m(e,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=u.length}h[0]&64&&r!==(r=(_[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",r)},d(_){_&&E(t),me(p,_),a=!1,o()}}}function Tt(l){let t,e=l[25]+"",n,i,s,r;function a(){return l[21](l[25])}return{c(){t=d("li"),n=R(e),i=x(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(o,u){I(o,t,u),c(t,n),c(t,i),s||(r=L(t,"click",a),s=!0)},p(o,u){l=o,u[0]&8&&e!==(e=l[25]+"")&&Q(n,e)},d(o){o&&E(t),s=!1,r()}}}function bl(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D=Object.keys(l[4]),S=[];for(let b=0;b<D.length;b+=1)S[b]=It(Ot(l,D,b));let H=Object.keys(l[4]),j=[];for(let b=0;b<H.length;b+=1)j[b]=Ht(Ft(l,H,b));let F=l[3].length>0&&Lt(l);return{c(){t=d("div"),e=d("div"),n=d("form"),i=d("div");for(let b=0;b<S.length;b+=1)S[b].c();s=x(),r=d("div"),a=d("select");for(let b=0;b<j.length;b+=1)j[b].c();o=x(),u=d("div"),p=d("input"),_=x(),h=d("div"),m=d("button"),m.textContent="Search",g=x(),F&&F.c(),f(i,"class","flex w-full items-center my-2 flex-wrap"),f(a,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(a,"name","select-option"),f(a,"id","select-option"),l[1]===void 0&&st(()=>l[17].call(a)),f(p,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(p,"type","search"),f(p,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(h,"class","flex"),f(r,"class","flex space-x-2"),f(n,"class","w-full"),f(n,"action",""),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(b,C){I(b,t,C),c(t,e),c(e,n),c(n,i);for(let k=0;k<S.length;k+=1)S[k].m(i,null);c(n,s),c(n,r),c(r,a);for(let k=0;k<j.length;k+=1)j[k].m(a,null);Ct(a,l[1]),c(r,o),c(r,u),c(u,p),l[18](p),Pe(p,l[5]),c(r,_),c(r,h),c(h,m),l[20](m),c(e,g),F&&F.m(e,null),v||(y=[L(a,"change",l[16]),L(a,"change",l[17]),L(p,"input",l[19]),L(p,"input",l[7]),L(m,"click",l[12]),L(n,"submit",l[11])],v=!0)},p(b,C){if(C[0]&1296){D=Object.keys(b[4]);let k;for(k=0;k<D.length;k+=1){const w=Ot(b,D,k);S[k]?S[k].p(w,C):(S[k]=It(w),S[k].c(),S[k].m(i,null))}for(;k<S.length;k+=1)S[k].d(1);S.length=D.length}if(C[0]&16){H=Object.keys(b[4]);let k;for(k=0;k<H.length;k+=1){const w=Ft(b,H,k);j[k]?j[k].p(w,C):(j[k]=Ht(w),j[k].c(),j[k].m(a,null))}for(;k<j.length;k+=1)j[k].d(1);j.length=H.length}C[0]&18&&Ct(a,b[1]),C[0]&32&&Pe(p,b[5]),b[3].length>0?F?F.p(b,C):(F=Lt(b),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:U,o:U,d(b){b&&E(t),me(S,b),me(j,b),l[18](null),l[20](null),F&&F.d(),v=!1,de(y)}}}async function vl(l,t){let e="/api/getSuggestion",n=new FormData;n.append("attribute",l),n.append("query",t);let i=await fetch(e,{method:"POST",body:n});return i.ok===!0?await i.json():{}}function kl(l,t,e){const n=rt();let i="query",s,r,{query_button_disabled:a=!1}=t,o="",u=[],p={person:[],query:[],place:[],filename:[]},_="",h=!1;async function m(O){if(_.length===0)return;let z=await vl(i,_);i in z?(e(3,u=z[i]),e(6,h=!0)):(e(3,u=[]),e(6,h=!1))}function g(O,z){e(4,p[z]=[],p),i==z&&e(3,u=[])}function v(O,z){e(6,h=!1),e(5,_=z),s.focus()}function y(O){e(1,i=O),e(3,u=p[i]),e(6,h=!0),s.focus()}function D(O){O&&O.preventDefault(),e(6,h=!1);let z=p[i].length;_.length>0&&!p[i].includes(_)&&e(4,p[i][z]=_,p),e(5,_="");let A=Object.keys(p);o="";for(let Y=0;Y<A.length;Y++){let te=A[Y],G=p[te];o+=te+":";for(let X=0;X<G.length;X++)o+=G[X],X!=G.length-1&&(o+="-");Y!=A.length-1&&(o+=",")}console.log("Completed: "+o)}function S(O){D(),n("queryReady",{query:o,attributes:p})}const H=O=>y(O),j=(O,z)=>g(z.currentTarget,O),F=O=>y(O.target.value);function b(){i=dl(this),e(1,i),e(4,p)}function C(O){qe[O?"unshift":"push"](()=>{s=O,e(2,s)})}function k(){_=this.value,e(5,_)}function w(O){qe[O?"unshift":"push"](()=>{r=O,e(0,r),e(13,a)})}const q=O=>v(i,O),M=()=>e(6,h=!1);return l.$$set=O=>{"query_button_disabled"in O&&e(13,a=O.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=a,r)},[r,i,s,u,p,_,h,m,g,v,y,D,S,a,H,j,F,b,C,k,w,q,M]}class wl extends Se{constructor(t){super(),Ce(this,t,kl,bl,we,{query_button_disabled:13},null,[-1,-1])}}function Pt(l,t,e){const n=l.slice();return n[8]=t[e],n[10]=e,n}function yl(l){let t,e,n;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(i,s){I(i,t,s),e||(n=L(t,"click",l[2]),e=!0)},p:U,d(i){i&&E(t),e=!1,n()}}}function xl(l){let t,e,n,i,s;return{c(){t=d("span"),t.textContent="Hachi",e=x(),n=d("span"),n.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(n,"class","cursor-pointer px-4")},m(r,a){I(r,t,a),I(r,e,a),I(r,n,a),i||(s=L(n,"click",l[3]),i=!0)},p:U,d(r){r&&E(t),r&&E(e),r&&E(n),i=!1,s()}}}function Nt(l){let t,e,n=l[8].name+"",i,s,r,a=l[8].count+"",o;return{c(){t=d("div"),e=d("div"),i=R(n),s=x(),r=d("div"),o=R(a),f(e,"class","flex"),f(e,"data-ix",l[10]),f(r,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,p){I(u,t,p),c(t,e),c(e,i),c(t,s),c(t,r),c(r,o)},p(u,p){p&2&&n!==(n=u[8].name+"")&&Q(i,n),p&2&&a!==(a=u[8].count+"")&&Q(o,a)},d(u){u&&E(t)}}}function Mt(l){let t,e,n,i,s,r,a,o=l[0].sidebarOpen&&Nt(l);function u(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),i=x(),o&&o.c(),s=x(),f(e,"class",n="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(p,_){I(p,t,_),c(t,e),c(t,i),o&&o.m(t,null),c(t,s),r||(a=L(t,"click",u),r=!0)},p(p,_){l=p,_&2&&n!==(n="fa-solid fa-"+l[8].icon)&&f(e,"class",n),l[0].sidebarOpen?o?o.p(l,_):(o=Nt(l),o.c(),o.m(t,s)):o&&(o.d(1),o=null)},d(p){p&&E(t),o&&o.d(),r=!1,a()}}}function Cl(l){let t,e,n,i,s,r;function a(h,m){return h[0].sidebarOpen?xl:yl}let o=a(l),u=o(l),p=l[1],_=[];for(let h=0;h<p.length;h+=1)_[h]=Mt(Pt(l,p,h));return{c(){t=d("div"),e=d("aside"),n=d("div"),u.c(),i=x(),s=d("nav");for(let h=0;h<_.length;h+=1)_[h].c();f(n,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(s,"class","mt-6"),f(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-screen text-white")},m(h,m){I(h,t,m),c(t,e),c(e,n),u.m(n,null),c(e,i),c(e,s);for(let g=0;g<_.length;g+=1)_[g].m(s,null)},p(h,[m]){if(o===(o=a(h))&&u?u.p(h,m):(u.d(1),u=o(h),u&&(u.c(),u.m(n,null))),m&19){p=h[1];let g;for(g=0;g<p.length;g+=1){const v=Pt(h,p,g);_[g]?_[g].p(v,m):(_[g]=Mt(v),_[g].c(),_[g].m(s,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=p.length}m&1&&r!==(r=(h[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",r)},i:U,o:U,d(h){h&&E(t),u.d(),me(_,h)}}}function Sl(l,t,e){const n=rt();let{sidebarOpen:i=!1}=t;const s={sidebarOpen:i},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ue(()=>{localStorage.getItem("no_images_indexed")?(e(1,r[0].count=Number(localStorage.getItem("no_images_indexed")),r),e(1,r[3].count=Number(localStorage.getItem("unique_people_count")),r),e(1,r[4].count=Number(localStorage.getItem("unique_place_count")),r)):fetch("/api/getMetaStats").then(_=>{_.json().then(h=>{e(1,r[0].count=h.image.count,r),e(1,r[3].count=h.image.unique_people_count,r),e(1,r[4].count=h.image.unique_place_count,r),localStorage.setItem("no_images_indexed",r[0].count.toString()),localStorage.setItem("unique_people_count",r[3].count.toString()),localStorage.setItem("unique_place_count",r[4].count.toString())})})});function a(){e(0,s.sidebarOpen=!0,s)}function o(){e(0,s.sidebarOpen=!1,s)}function u(_){n("menuClick",{item:r[_]})}const p=_=>{u(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,i=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&s&&n("sidebarStateChange",{open:s.sidebarOpen})},[s,r,a,o,u,i,p]}class ct extends Se{constructor(t){super(),Ce(this,t,Sl,Cl,we,{sidebarOpen:5})}}function Dl(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D,S,H,j,F,b,C,k,w,q,M,O,z,A,Y,te,G,X,K,le,W,ne,ge,$,re,ue,De,oe,be,Fe;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",n=x(),i=d("div"),s=d("input"),r=x(),a=d("div"),o=d("div"),u=d("div"),p=x(),_=d("div"),h=R("Current directory: "),m=d("span"),g=R(l[4]),v=x(),y=d("span"),y.textContent="ETA:",D=x(),S=d("span"),H=R(l[6]),j=x(),F=d("div"),b=R("Details: "),C=d("span"),k=R(l[5]),w=x(),q=d("div"),M=d("div"),O=d("input"),z=x(),A=d("label"),A.textContent="Complete Rescan",Y=x(),te=d("div"),te.textContent="Re-index all originals, including already indexed and unchanged files.",G=x(),X=d("div"),K=d("select"),le=d("option"),le.textContent="Images Only",W=d("option"),W.textContent="Videos Only",ne=d("option"),ne.textContent="Videos and Images",ge=x(),$=d("div"),$.textContent="Filter by content type",re=x(),ue=d("button"),ue.textContent="Cancel",De=x(),oe=d("button"),oe.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(s,"type","text"),f(s,"class","w-full rounded border p-1 text-sm"),f(s,"placeholder","D://images (Full path to directory to index)"),s.required=!0,f(i,"class","my-2"),f(u,"class","h-2 rounded bg-blue-500"),fe(u,"width",(l[3]*100).toString()+"%"),f(o,"class","h-2 rounded bg-gray-300"),f(m,"class","text-black"),f(y,"class","pl-3 text-right"),f(S,"class","text-black"),f(_,"class","pt-1 text-sm text-blue-600"),f(C,"class","text-black"),f(F,"class","pt-1 text-sm text-blue-600"),f(a,"class","mb-3"),f(O,"type","checkbox"),f(O,"class","h-5 w-5 text-blue-500"),f(A,"class","ml-1"),f(M,"class","mr-2 flex items-center"),f(te,"class","text-sm text-gray-600"),f(q,"class","mt-4 mb-3 flex flex-wrap items-center"),le.__value="Images Only",le.value=le.__value,W.disabled=!0,W.__value="Videos Only",W.value=W.__value,ne.disabled=!0,ne.__value="Videos and Images",ne.value=ne.__value,f(K,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f($,"class","ml-2 text-sm text-gray-600"),f(X,"class","mb-3 mt-3 flex flex-wrap items-center"),ue.disabled=!0,f(ue,"type","button"),f(ue,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200"),f(oe,"type","button"),f(oe,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(se,ae){I(se,t,ae),c(t,e),c(t,n),c(t,i),c(i,s),l[12](s),Pe(s,l[7]),c(t,r),c(t,a),c(a,o),c(o,u),c(a,p),c(a,_),c(_,h),c(_,m),c(m,g),c(_,v),c(_,y),c(_,D),c(_,S),c(S,H),c(a,j),c(a,F),c(F,b),c(F,C),c(C,k),c(t,w),c(t,q),c(q,M),c(M,O),O.checked=l[8],c(M,z),c(M,A),c(q,Y),c(q,te),c(t,G),c(t,X),c(X,K),c(K,le),c(K,W),c(K,ne),c(X,ge),c(X,$),c(t,re),c(t,ue),l[16](ue),c(t,De),c(t,oe),l[17](oe),be||(Fe=[L(s,"input",l[13]),L(s,"keydown",l[14]),L(O,"change",l[15]),L(ue,"click",l[10]),L(oe,"click",l[9])],be=!0)},p(se,[ae]){ae&128&&s.value!==se[7]&&Pe(s,se[7]),ae&8&&fe(u,"width",(se[3]*100).toString()+"%"),ae&16&&Q(g,se[4]),ae&64&&Q(H,se[6]),ae&32&&Q(k,se[5]),ae&256&&(O.checked=se[8])},i:U,o:U,d(se){se&&E(t),l[12](null),l[16](null),l[17](null),be=!1,de(Fe)}}}function Fl(l,t,e){let n,i,s;Ue(()=>{if(e(11,n=localStorage.getItem("stored_indexing_endpoint")),n!==null){let C="/api/getIndexStatus/"+n;e(0,i.disabled=!1,i),e(1,s.disabled=!0,s),m(C)}}),it(()=>{h&&clearTimeout(h)});let r,a=.01,o="",u="",p="",_="",h;async function m(C,k=0){k==0&&console.log("starting a new polll...");let q=await(await fetch(C,{method:"GET"})).json();if(q.is_active==!0){if(q.done==!0){let O=new FormData;O.append("ack","true"),(await fetch(C,{method:"POST",body:O})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let A=await fetch("/api/getMetaStats");A=await A.json(),localStorage.setItem("no_images_indexed",A.image.count.toString()),localStorage.setItem("unique_people_count",A.image.unique_people_count.toString()),localStorage.setItem("unique_place_count",A.image.unique_place_count.toString()),e(1,s.disabled=!1,s),e(11,n=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,a=0),e(4,o=""),e(6,p=""),e(5,u=""),e(7,_=""),e(0,i.disabled=!0,i),e(2,r.disabled=!1,r);return}e(3,a=q.progress),e(6,p=q.eta),e(5,u=q.details),e(4,o=q.current_directory),h&&clearTimeout(h),h=setTimeout(function(){m(C,k+1)},1e3)}}let g=!1;async function v(){if(s&&_){e(1,s.disabled=!0,s),e(2,r.disabled=!0,r);let C=new FormData;C.append("image_directory_path",_),C.append("complete_rescan",g.toString());let q=await(await fetch("/api/indexStart",{method:"POST",body:C})).json();if(q.success===!0){e(0,i.disabled=!1,i);let O="/api/getIndexStatus/"+q.statusEndpoint;e(11,n=q.statusEndpoint),m(O)}else alert(q.reason),e(1,s.disabled=!1,s),e(2,r.disabled=!1,r)}else console.log("No index_start_button object found!!!")}async function y(){if(n){localStorage.removeItem("stored_indexing_endpoint"),e(0,i.disabled=!0,i);let C="/api/indexCancel/"+n,k=await fetch(C,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,n=null),!k.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(k);return}else return}function D(C){qe[C?"unshift":"push"](()=>{r=C,e(2,r)})}function S(){_=this.value,e(7,_)}const H=C=>{C.key==="Enter"&&s.click()};function j(){g=this.checked,e(8,g)}function F(C){qe[C?"unshift":"push"](()=>{i=C,e(0,i)})}function b(C){qe[C?"unshift":"push"](()=>{s=C,e(1,s)})}return l.$$.update=()=>{l.$$.dirty&2048&&n&&localStorage.setItem("stored_indexing_endpoint",n)},[i,s,r,a,o,u,p,_,g,v,y,n,D,S,H,j,F,b]}class Ol extends Se{constructor(t){super(),Ce(this,t,Fl,Dl,we,{})}}const Le=[];function ol(l,t=U){let e;const n=new Set;function i(a){if(we(l,a)&&(l=a,e)){const o=!Le.length;for(const u of n)u[1](),Le.push(u,l);if(o){for(let u=0;u<Le.length;u+=2)Le[u][0](Le[u+1]);Le.length=0}}}function s(a){i(a(l))}function r(a,o=U){const u=[a,o];return n.add(u),n.size===1&&(e=t(i)||U),a(l),()=>{n.delete(u),n.size===0&&(e(),e=null)}}return{set:i,update:s,subscribe:r}}const nt=ol([]);let jl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ee=ol(jl);function At(l,t,e){const n=l.slice();return n[10]=t[e],n}function Bt(l,t,e){const n=l.slice();return n[13]=t[e],n}function Rt(l){let t;return{c(){t=d("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,n){I(e,t,n)},d(e){e&&E(t)}}}function zt(l){let t,e,n=l[1].selectFilters[l[10]].values.includes(l[13]),i,s,r,a=l[13]+"",o,u,p,_=n&&Rt();function h(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),s=x(),r=d("span"),o=R(a),f(e,"class",i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,g){I(m,t,g),c(t,e),_&&_.m(e,null),c(t,s),c(t,r),c(r,o),u||(p=L(t,"click",h),u=!0)},p(m,g){l=m,g&2&&(n=l[1].selectFilters[l[10]].values.includes(l[13])),n?_||(_=Rt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),g&2&&i!==(i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",i),g&2&&a!==(a=l[13]+"")&&Q(o,a)},d(m){m&&E(t),_&&_.d(),u=!1,p()}}}function Ut(l){let t,e,n=l[10]+"",i,s,r,a,o,u,p,_,h;function m(){return l[6](l[10])}let g=l[1].selectFilters[l[10]].options,v=[];for(let y=0;y<g.length;y+=1)v[y]=zt(Bt(l,g,y));return{c(){t=d("div"),e=d("div"),i=R(n),s=x(),r=d("i"),o=x(),u=d("div");for(let y=0;y<v.length;y+=1)v[y].c();f(r,"class",a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(y,D){I(y,t,D),c(t,e),c(e,i),c(e,s),c(e,r),c(t,o),c(t,u);for(let S=0;S<v.length;S+=1)v[S].m(u,null);_||(h=[L(e,"click",m),L(t,"mouseup",Ll)],_=!0)},p(y,D){if(l=y,D&2&&n!==(n=l[10]+"")&&Q(i,n),D&2&&a!==(a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(r,"class",a),D&6){g=l[1].selectFilters[l[10]].options;let S;for(S=0;S<g.length;S+=1){const H=Bt(l,g,S);v[S]?v[S].p(H,D):(v[S]=zt(H),v[S].c(),v[S].m(u,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=g.length}D&2&&p!==(p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",p)},d(y){y&&E(t),me(v,y),_=!1,de(h)}}}function ql(l){let t,e,n,i,s,r,a,o,u,p,_,h,m=Object.keys(l[1].selectFilters),g=[];for(let v=0;v<m.length;v+=1)g[v]=Ut(At(l,m,v));return{c(){t=d("div"),e=d("div"),n=d("span"),n.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=x(),s=d("span"),s.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=x();for(let v=0;v<g.length;v+=1)g[v].c();a=x(),o=d("button"),u=R("Filter"),f(n,"class","flex items-center text-md"),f(s,"class","flex items-center text-md"),o.disabled=l[0],f(o,"class",p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(v,y){I(v,t,y),c(t,e),c(e,n),c(e,i),c(e,s),c(e,r);for(let D=0;D<g.length;D+=1)g[D].m(e,null);c(e,a),c(e,o),c(o,u),_||(h=L(o,"click",l[4]),_=!0)},p(v,[y]){if(y&14){m=Object.keys(v[1].selectFilters);let D;for(D=0;D<m.length;D+=1){const S=At(v,m,D);g[D]?g[D].p(S,y):(g[D]=Ut(S),g[D].c(),g[D].m(e,a))}for(;D<g.length;D+=1)g[D].d(1);g.length=m.length}y&1&&(o.disabled=v[0]),y&1&&p!==(p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&f(o,"class",p)},i:U,o:U,d(v){v&&E(t),me(g,v),_=!1,h()}}}function al(l,t,e=null,n=(i,s)=>i===s){let i=[];for(let s=0;s<l.length;s++)e?n(l[s].key,t)?i.push(1):i.push(0):n(l[s],t)?i.push(1):i.push(0);return i}function El(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let i=al(l,t[n]);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(i[s]))}return e}function Il(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let i=al(l,t[n],null,(s,r)=>s?s.includes(r):!1);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(i[s]))}return e}function Hl(l){let t=l[0].length,e=l[0];return l.forEach((n,i)=>{if(i>0){if(n.length!==t)throw new Error("all mask must be of same length!!");n.forEach((s,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(s))})}}),e}const Ll=l=>l.stopPropagation();function Tl(l,t,e){let n=[],{filter_button_disabled:i=!0}=t;nt.subscribe(m=>{e(0,i=!1),e(5,n=m)});const s=rt(),r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ue(()=>{document.addEventListener("mouseup",a)});function a(m){e(1,r.selectFilterActive="",r)}function o(m,g){if(r.selectFilters[m].values.includes(g)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(v=>v!==g),r);return}e(1,r.selectFilters[m].values=[g,...r.selectFilters[m].values],r)}function u(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function p(){if(n){console.log(n);let m=[],g=[];n.map((j,F)=>{m.push(j.place),g.push(j.person)});let v=r.selectFilters.place.values,y=El(m,v),D=r.selectFilters.people.values,S=Il(g,D),H=Hl([y,S]);s("filterApplied",{mask:H})}}const _=m=>u(m),h=(m,g)=>o(m,g);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,i=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&n){let m=n.map((D,S)=>{if(D.place)return D.place}),g=[];n.map((D,S)=>{D.person&&D.person.forEach(H=>g.push(H))});let v=[];new Set(m).forEach(D=>v.push(D));let y=[];new Set(g).forEach(D=>y.push(D)),e(1,r.selectFilters.place.values=v,r),e(1,r.selectFilters.place.options=v,r),e(1,r.selectFilters.people.values=y,r),e(1,r.selectFilters.people.options=y,r)}},[i,r,o,u,p,n,_,h]}class Pl extends Se{constructor(t){super(),Ce(this,t,Tl,ql,we,{filter_button_disabled:0})}}function Vt(l,t,e){const n=l.slice();return n[49]=t[e],n[48]=e,n}function Gt(l,t,e){const n=l.slice();return n[46]=t[e],n[48]=e,n}function Nl(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D,S,H,j,F=l[1]&&Xt(l);e=new Pl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[39]);let b=l[6],C=[];for(let w=0;w<b.length;w+=1)C[w]=Kt(Vt(l,b,w));let k=l[6].length>=Oe&&Wt(l);return{c(){F&&F.c(),t=x(),he(e.$$.fragment),n=x(),i=d("div"),s=d("div"),r=d("div"),a=d("div"),o=d("div"),u=d("input"),p=x(),_=d("label"),h=R("Score threshold: "),m=R(l[10]),g=R("."),v=x(),y=d("div");for(let w=0;w<C.length;w+=1)C[w].c();D=x(),k&&k.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(_,"for","topk"),f(_,"class","dark:text-white"),f(o,"class","my-4"),f(r,"class","flex flex-row place-content-center mb-10 select-none mx-2"),f(y,"class","flex flex-wrap gap-6 p-4 sm:p-12 px-auto justify-center"),f(s,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(i,"class","flex")},m(w,q){F&&F.m(w,q),I(w,t,q),_e(e,w,q),I(w,n,q),I(w,i,q),c(i,s),c(s,r),c(r,a),c(a,o),c(o,u),Pe(u,l[10]),c(o,p),c(o,_),c(_,h),c(_,m),c(_,g),c(s,v),c(s,y);for(let M=0;M<C.length;M+=1)C[M].m(y,null);c(s,D),k&&k.m(s,null),S=!0,H||(j=[L(u,"change",l[18]),L(u,"change",l[40]),L(u,"input",l[40])],H=!0)},p(w,q){w[1]?F?F.p(w,q):(F=Xt(w),F.c(),F.m(t.parentNode,t)):F&&(F.d(1),F=null);const M={};if(q[0]&8&&(M.filter_button_disabled=w[3]),e.$set(M),q[0]&1024&&Pe(u,w[10]),(!S||q[0]&1024)&&Q(m,w[10]),q[0]&24641){b=w[6];let O;for(O=0;O<b.length;O+=1){const z=Vt(w,b,O);C[O]?C[O].p(z,q):(C[O]=Kt(z),C[O].c(),C[O].m(y,null))}for(;O<C.length;O+=1)C[O].d(1);C.length=b.length}w[6].length>=Oe?k?k.p(w,q):(k=Wt(w),k.c(),k.m(s,null)):k&&(k.d(1),k=null)},i(w){S||(Z(e.$$.fragment,w),S=!0)},o(w){ee(e.$$.fragment,w),S=!1},d(w){F&&F.d(w),w&&E(t),pe(e,w),w&&E(n),w&&E(i),me(C,w),k&&k.d(),H=!1,de(j)}}}function Ml(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D,S,H,j,F,b=l[2].image_card_edit_interface&&Jt(l),C=l[5]&&Yt(l);return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,i=x(),s=d("div"),s.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=x(),a=d("div"),o=d("div"),o.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=x(),p=d("div"),_=d("div"),h=d("img"),g=x(),v=d("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',y=x(),b&&b.c(),D=x(),S=d("div"),S.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',H=x(),C&&C.c(),f(n,"class","cursor-pointer hover:underline text-gray-200"),f(s,"title","Fullscreen"),f(s,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(o,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(h,"class","w-auto cursor-pointer h-full"),ke(h.src,m="/api/getRawData/"+l[4].data_hash)||f(h,"src",m),f(h,"alt",""),f(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(_,"class","flex shrink h-full"),f(p,"class","flex h-full items-center justify-center p-2 gap-4"),f(S,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(a,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(k,w){I(k,t,w),c(t,e),c(e,n),c(e,i),c(e,s),c(t,r),c(t,a),c(a,o),c(a,u),c(a,p),c(p,_),c(_,h),c(_,g),c(_,v),c(p,y),b&&b.m(p,null),c(a,D),c(a,S),c(t,H),C&&C.m(t,null),j||(F=[L(n,"click",l[31]),L(s,"click",l[32]),L(o,"click",l[33]),L(h,"click",l[34]),L(v,"click",l[35]),L(S,"click",l[37])],j=!0)},p(k,w){w[0]&16&&!ke(h.src,m="/api/getRawData/"+k[4].data_hash)&&f(h,"src",m),k[2].image_card_edit_interface?b?b.p(k,w):(b=Jt(k),b.c(),b.m(p,null)):b&&(b.d(1),b=null),k[5]?C?C.p(k,w):(C=Yt(k),C.c(),C.m(t,null)):C&&(C.d(1),C=null)},i:U,o:U,d(k){k&&E(t),b&&b.d(),C&&C.d(),j=!1,de(F)}}}function Al(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D,S,H=l[9],j=[];for(let b=0;b<H.length;b+=1)j[b]=Zt(Gt(l,H,b));let F=l[8].active&&$t(l);return{c(){t=d("div"),e=d("div"),n=d("img"),s=x();for(let b=0;b<j.length;b+=1)j[b].c();r=x(),F&&F.c(),a=x(),o=d("div"),u=d("div"),u.innerHTML='<i class="fa fa-arrow-left"></i>',p=x(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',h=x(),m=d("div"),g=d("div"),g.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,v=x(),y=d("div"),y.innerHTML='<i class="fa fa-arrows-alt"></i>',f(n,"class","object-cover h-screen w-auto"),ke(n.src,i="/api/getRawDataFull/"+l[4].data_hash)||f(n,"src",i),f(n,"alt",""),f(e,"class","relative flex"),f(u,"class","text-white cursor-pointer"),f(_,"class","text-white cursor-pointer"),f(o,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(g,"class","cursor-pointer hover:underline text-white"),f(y,"title","Fullscreen"),f(y,"class","cursor-pointer text-white"),f(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(b,C){I(b,t,C),c(t,e),c(e,n),c(e,s);for(let k=0;k<j.length;k+=1)j[k].m(e,null);c(e,r),F&&F.m(e,null),c(t,a),c(t,o),c(o,u),c(o,p),c(o,_),I(b,h,C),I(b,m,C),c(m,g),c(m,v),c(m,y),D||(S=[L(n,"load",l[17]),L(u,"click",l[27]),L(_,"click",l[28]),L(g,"click",l[29]),L(y,"click",l[30])],D=!0)},p(b,C){if(C[0]&16&&!ke(n.src,i="/api/getRawDataFull/"+b[4].data_hash)&&f(n,"src",i),C[0]&896){H=b[9];let k;for(k=0;k<H.length;k+=1){const w=Gt(b,H,k);j[k]?j[k].p(w,C):(j[k]=Zt(w),j[k].c(),j[k].m(e,r))}for(;k<j.length;k+=1)j[k].d(1);j.length=H.length}b[8].active?F?F.p(b,C):(F=$t(b),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:U,o:U,d(b){b&&E(t),me(j,b),F&&F.d(),b&&E(h),b&&E(m),D=!1,de(S)}}}function Xt(l){let t,e,n,i,s;return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(n,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(r,a){I(r,t,a),c(t,e),c(e,n),i||(s=L(n,"click",l[38]),i=!0)},p:U,d(r){r&&E(t),i=!1,s()}}}function Qt(l){let t,e,n,i,s,r;function a(){return l[41](l[48])}return{c(){t=d("div"),e=d("img"),i=x(),f(e,"class","sm:max-h-48 rounded-lg shadow-xl cursor-pointer"),ke(e.src,n="api/getRawData/"+l[0].list_dataHash[l[49].ix])||f(e,"src",n),f(e,"alt","image"),f(t,"class","relative group")},m(o,u){I(o,t,u),c(t,e),c(t,i),s||(r=L(t,"click",a),s=!0)},p(o,u){l=o,u[0]&65&&!ke(e.src,n="api/getRawData/"+l[0].list_dataHash[l[49].ix])&&f(e,"src",n)},d(o){o&&E(t),s=!1,r()}}}function Kt(l){let t,e=l[49].ix>=0&&Qt(l);return{c(){e&&e.c(),t=Ne()},m(n,i){e&&e.m(n,i),I(n,t,i)},p(n,i){n[49].ix>=0?e?e.p(n,i):(e=Qt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&E(t)}}}function Wt(l){let t,e,n,i;return{c(){t=d("div"),e=d("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200"),f(t,"class","flex items-center justify-center")},m(s,r){I(s,t,r),c(t,e),n||(i=L(e,"click",l[12]),n=!0)},p:U,d(s){s&&E(t),n=!1,i()}}}function Jt(l){let t,e,n,i,s,r,a,o,u,p,_,h,m,g,v,y,D,S,H,j,F,b,C,k,w,q,M,O,z,A,Y,te,G,X,K,le,W,ne,ge;return{c(){t=d("div"),e=d("div"),n=d("div"),n.textContent="Info",i=x(),s=d("div"),s.textContent="X",r=x(),a=d("div"),o=d("div"),o.textContent="Description",u=x(),p=d("input"),h=x(),m=d("div"),g=d("div"),g.textContent="place",v=x(),y=d("input"),S=x(),H=d("div"),j=d("div"),j.textContent="Tags",F=x(),b=d("input"),k=x(),w=d("div"),q=d("div"),q.textContent="Taken at:",M=x(),O=d("input"),z=x(),A=d("div"),Y=d("div"),Y.textContent="device",te=x(),G=d("input"),K=x(),le=d("div"),W=d("button"),W.textContent="Save",f(n,"class","grow text-xl text-gray-100 font-bold"),f(s,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(o,"class","mb-1 text-gray-100"),f(p,"name","Description"),f(p,"placeholder",""),p.value=_=l[4].description.toString(),f(p,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(p,"type","text"),f(g,"class","mb-1 text-gray-100"),f(y,"name","place"),y.value=D=l[4].place.toString(),f(y,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(y,"type","text"),f(j,"class","mb-1 text-gray-100"),f(b,"name","tags"),f(b,"placeholder","Car, chair"),b.value=C=l[4].tags.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(q,"class","mb-1 text-gray-100"),f(O,"name","taken_at"),O.value="",f(O,"type","date"),f(O,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(Y,"class","mb-1 text-gray-100"),f(G,"name","device"),f(G,"placeholder","Canon"),G.value=X=l[4].device.toString(),f(G,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(G,"type","text"),f(W,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m($,re){I($,t,re),c(t,e),c(e,n),c(e,i),c(e,s),c(t,r),c(t,a),c(a,o),c(a,u),c(a,p),c(t,h),c(t,m),c(m,g),c(m,v),c(m,y),c(t,S),c(t,H),c(H,j),c(H,F),c(H,b),c(t,k),c(t,w),c(w,q),c(w,M),c(w,O),c(t,z),c(t,A),c(A,Y),c(A,te),c(A,G),c(t,K),c(t,le),c(le,W),ne||(ge=[L(s,"click",l[36]),L(p,"change",l[21]),L(y,"change",l[21]),L(b,"change",l[21]),L(O,"change",l[21]),L(G,"change",l[21]),L(W,"click",l[22])],ne=!0)},p($,re){re[0]&16&&_!==(_=$[4].description.toString())&&p.value!==_&&(p.value=_),re[0]&16&&D!==(D=$[4].place.toString())&&y.value!==D&&(y.value=D),re[0]&16&&C!==(C=$[4].tags.toString())&&b.value!==C&&(b.value=C),re[0]&16&&X!==(X=$[4].device.toString())&&G.value!==X&&(G.value=X)},d($){$&&E(t),ne=!1,de(ge)}}}function Yt(l){let t,e,n,i,s=l[4].filename+"",r,a,o,u,p,_=l[4].data_hash+"",h,m,g,v,y,D=l[4].last_modified+"",S,H,j,F,b,C,k,w,q,M=l[4].description.toString()+"",O,z,A,Y,te,G,X=l[4].taken_at.toString()+"",K,le,W,ne,ge,$,re=l[4].tags.toString()+"",ue,De,oe,be,Fe,se,ae=l[4].place.toString()+"",T,N,B,V,P,ve,Ve,Ie,ye=l[4].person_ids.toString()+"",ce,Me,xe,Ge,bt,Xe,Qe=l[4].device.toString()+"",ut,vt,Ae,Ke,kt,We,Je=l[4].resolution.toString()+"",ft,wt,Be,Ye,yt,Ze,$e=l[4].absolute_path.toString()+"",dt;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=x(),n=d("div"),i=d("div"),r=R(s),a=x(),o=d("div"),u=R("UID: "),p=d("span"),h=R(_),m=x(),g=d("div"),v=R("Last Modified:  "),y=d("span"),S=R(D),H=x(),j=d("div"),F=d("div"),b=d("div"),C=d("div"),k=d("div"),k.textContent="Description",w=x(),q=d("div"),O=R(M),z=x(),A=d("div"),Y=d("div"),Y.textContent="Taken at",te=x(),G=d("div"),K=R(X),le=x(),W=d("div"),ne=d("div"),ne.textContent="Tags",ge=x(),$=d("div"),ue=R(re),De=x(),oe=d("div"),be=d("div"),be.textContent="Place",Fe=x(),se=d("div"),T=R(ae),N=x(),B=d("div"),V=d("div"),P=d("div"),ve=d("div"),ve.textContent="people",Ve=x(),Ie=d("div"),ce=R(ye),Me=x(),xe=d("div"),Ge=d("div"),Ge.textContent="Device",bt=x(),Xe=d("div"),ut=R(Qe),vt=x(),Ae=d("div"),Ke=d("div"),Ke.textContent="Resolution",kt=x(),We=d("div"),ft=R(Je),wt=x(),Be=d("div"),Ye=d("div"),Ye.textContent="Path",yt=x(),Ze=d("div"),dt=R($e),f(i,"class","text-xl text-white"),f(p,"class","text-sm text-gray-400"),f(o,"class","text-white"),f(y,"class","text-sm text-gray-400"),f(g,"class","text-white"),f(n,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(k,"class",""),f(q,"class","text-sm text-gray-400"),f(Y,"class",""),f(G,"class","text-sm text-gray-400"),f(ne,"class",""),f($,"class","text-sm text-gray-400"),f(be,"class",""),f(se,"class","text-sm text-gray-400"),f(b,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(F,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(ve,"class",""),f(Ie,"class","text-sm text-gray-400"),f(Ge,"class",""),f(Xe,"class","text-sm text-gray-400"),f(Ke,"class",""),f(We,"class","text-sm text-gray-400"),f(Ye,"class",""),f(Ze,"class","text-sm text-gray-400"),f(V,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(B,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(j,"class","flex w-full justify-center p-4")},m(J,ie){I(J,t,ie),I(J,e,ie),I(J,n,ie),c(n,i),c(i,r),c(n,a),c(n,o),c(o,u),c(o,p),c(p,h),c(n,m),c(n,g),c(g,v),c(g,y),c(y,S),I(J,H,ie),I(J,j,ie),c(j,F),c(F,b),c(b,C),c(C,k),c(C,w),c(C,q),c(q,O),c(b,z),c(b,A),c(A,Y),c(A,te),c(A,G),c(G,K),c(b,le),c(b,W),c(W,ne),c(W,ge),c(W,$),c($,ue),c(b,De),c(b,oe),c(oe,be),c(oe,Fe),c(oe,se),c(se,T),c(j,N),c(j,B),c(B,V),c(V,P),c(P,ve),c(P,Ve),c(P,Ie),c(Ie,ce),c(V,Me),c(V,xe),c(xe,Ge),c(xe,bt),c(xe,Xe),c(Xe,ut),c(V,vt),c(V,Ae),c(Ae,Ke),c(Ae,kt),c(Ae,We),c(We,ft),c(V,wt),c(V,Be),c(Be,Ye),c(Be,yt),c(Be,Ze),c(Ze,dt)},p(J,ie){ie[0]&16&&s!==(s=J[4].filename+"")&&Q(r,s),ie[0]&16&&_!==(_=J[4].data_hash+"")&&Q(h,_),ie[0]&16&&D!==(D=J[4].last_modified+"")&&Q(S,D),ie[0]&16&&M!==(M=J[4].description.toString()+"")&&Q(O,M),ie[0]&16&&X!==(X=J[4].taken_at.toString()+"")&&Q(K,X),ie[0]&16&&re!==(re=J[4].tags.toString()+"")&&Q(ue,re),ie[0]&16&&ae!==(ae=J[4].place.toString()+"")&&Q(T,ae),ie[0]&16&&ye!==(ye=J[4].person_ids.toString()+"")&&Q(ce,ye),ie[0]&16&&Qe!==(Qe=J[4].device.toString()+"")&&Q(ut,Qe),ie[0]&16&&Je!==(Je=J[4].resolution.toString()+"")&&Q(ft,Je),ie[0]&16&&$e!==($e=J[4].absolute_path.toString()+"")&&Q(dt,$e)},d(J){J&&E(t),J&&E(e),J&&E(n),J&&E(H),J&&E(j)}}}function Zt(l){let t,e,n;function i(...s){return l[25](l[46],...s)}return{c(){t=d("div"),f(t,"data-ix",l[48]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),fe(t,"top",l[46].top+"px "),fe(t,"left",l[46].left+"px"),fe(t,"width",l[46].width+"px"),fe(t,"height",l[46].height+"px")},m(s,r){I(s,t,r),e||(n=L(t,"click",i),e=!0)},p(s,r){l=s,r[0]&512&&fe(t,"top",l[46].top+"px "),r[0]&512&&fe(t,"left",l[46].left+"px"),r[0]&512&&fe(t,"width",l[46].width+"px"),r[0]&512&&fe(t,"height",l[46].height+"px")},d(s){s&&E(t),e=!1,n()}}}function $t(l){let t,e,n,i,s,r,a;return{c(){t=d("div"),e=d("input"),i=x(),s=d("div"),s.textContent="X",e.autofocus=!0,e.value=n=l[4].person_ids[l[7]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(s,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),fe(t,"top",l[8].top+"px "),fe(t,"left",l[8].left+"px")},m(o,u){I(o,t,u),c(t,e),c(t,i),c(t,s),e.focus(),r||(a=[L(e,"keyup",l[20]),L(s,"click",l[26])],r=!0)},p(o,u){u[0]&144&&n!==(n=o[4].person_ids[o[7]])&&e.value!==n&&(e.value=n),u[0]&256&&fe(t,"top",o[8].top+"px "),u[0]&256&&fe(t,"left",o[8].left+"px")},d(o){o&&E(t),r=!1,de(a)}}}function Bl(l){let t,e,n,i;const s=[Al,Ml,Nl],r=[];function a(o,u){return o[2].image_card_fullscreen===!0?0:o[2].image_card===!0?1:2}return t=a(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(o,u){r[t].m(o,u),I(o,n,u),i=!0},p(o,u){let p=t;t=a(o),t===p?r[t].p(o,u):(ot(),ee(r[p],1,1,()=>{r[p]=null}),at(),e=r[t],e?e.p(o,u):(e=r[t]=s[t](o),e.c()),Z(e,1),e.m(n.parentNode,n))},i(o){i||(Z(e),i=!0)},o(o){ee(e),i=!1},d(o){r[t].d(o),o&&E(n)}}}let Oe=20;function pt(l,t=[1],e=null){let n=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let i=0;i<l.length;i++){let s=i;t[i%t.length]!==1&&(s=-1),e?n.push({ix:s,score:l[i][e]}):n.push({ix:s,score:l[i]})}return n.sort((i,s)=>i.score>s.score?-1:i.score<s.score?1:0),n}function Rl(l,t,e){const n=rt();let{show_exit_interface_button:i=!1}=t,{image_data:s={list_metaData:[],list_dataHash:[],list_score:[],done:!1}}=t,r=!0;it(()=>{e(0,s={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),nt.update(T=>[])});let a={},o=!1,u=[],p=[],_=0;function h(T){e(24,_=_+Oe),e(6,u=p.slice(_,_+Oe)),nt.update(N=>m(u))}function m(T){let N=[],B=T.length;for(let V=0;V<B;V++){let P=T[V].ix;N.push(s.list_metaData[P])}return N}Ee.subscribe(T=>{T.done==!0?g(T):(e(24,_=0),e(6,u=[]))});function g(T){e(23,p=pt(T.list_score)),e(6,u=p.slice(0,0+Oe)),nt.update(N=>m(u))}let v={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function y(T){let N=Object.keys(v);for(let B=0;B<N.length;B++)e(2,v[N[B]]=!1,v);e(2,v[T]=!0,v)}let D,S={active:!1,top:null,left:null};function H(T){let N={sorted_ix:null,image_ix:null};for(let B=T;B<u.length;B++)if(u[B].ix!==-1){N.image_ix=u[B].ix,N.sorted_ix=B;break}return N}function j(T){z={},e(5,o=!1),e(9,C=[]),e(8,S={active:!1,top:null,left:null});let N=T,B=u.length;N<0&&(N=B-1),N>B-1&&(N=0);let V=H(N),P=V.image_ix;N=V.sorted_ix,P===null&&(V=H(0),P=V.image_ix,N=V.sorted_ix),e(4,a.ix=N,a),e(4,a.data_hash=s.list_dataHash[P],a),e(4,a.height=Number(s.list_metaData[P].height),a),e(4,a.width=Number(s.list_metaData[P].width),a),e(4,a.face_bboxes=s.list_metaData[P].face_bboxes,a),e(4,a.person_ids=s.list_metaData[P].person,a),a.person_ids===null&&e(4,a.person_ids=[],a),e(4,a.resolution=a.height.toString()+" X "+a.width.toString(),a),e(4,a.filename=s.list_metaData[P].filename,a),e(4,a.taken_at=s.list_metaData[P].taken_at,a),a.taken_at==null&&e(4,a.taken_at="Unknown",a),e(4,a.last_modified=s.list_metaData[P].modified_at,a),e(4,a.device=s.list_metaData[P].device,a),a.device==null&&e(4,a.device="",a),e(4,a.place=s.list_metaData[P].place,a),e(4,a.absolute_path=s.list_metaData[P].absolute_path,a),e(4,a.description=s.list_metaData[P].description,a),e(4,a.tags=s.list_metaData[P].tags,a),e(5,o=!0)}function F(){j(a.ix+1)}function b(){j(a.ix-1)}let C=[];function k(T){let N=T.target.getClientRects()[0],B=N.width,V=N.height,P=[],ve=a.face_bboxes;if(ve){let Ve=a.width,Ie=a.height;for(let ye=0;ye<ve.length;ye++){let ce=structuredClone(ve[ye]),Me=Number(B)/(Number(Ve)+1e-4),xe=Number(V)/(Number(Ie)+1e-4);ce.top=ce[1]*xe,ce.height=(ce[3]-ce[1])*xe,ce.left=ce[0]*Me,ce.width=(ce[2]-ce[0])*Me,P.push(ce)}}console.log(P),e(9,C=P)}let w=0;function q(){let T=u[0].score,N=u[u.length-1].score,V=s.list_score.map(P=>(P-N)/(T-N+1e-5)).map(P=>P>=w?1:0);e(6,u=pt(s.list_score,V))}function M(T){e(3,r=!0);let N=p.slice(_,_+Oe);for(let B=0;B<T.length;B++)T[B]==0?e(6,u[B].ix=-1,u):e(6,u[B].ix=N[B].ix,u);e(3,r=!1)}function O(T){let N=T.target.value,B=a.data_hash,V=a.person_ids[D];if(T.key=="Enter"){let P=new FormData;P.append("new_person_id",N),P.append("old_person_id",V),P.append("data_hash",B),fetch("/api/tagPerson",{method:"POST",body:P}).then(ve=>{if(ve.ok)alert("Success");else throw new Error("Error occured")})}}let z={};function A(T){z[T.target.name.toLowerCase()]=T.target.value}async function Y(T){T.target.disabled=!0;let N=Object.keys(z),B=new FormData;for(let P=0;P<N.length;P++)B.append(N[P],z[N[P]]);B.append("data_hash",a.data_hash);let V=await fetch("/api/editMetaData",{method:"POST",body:B});if(!V.ok)throw new Error("Error while updating meta-data !!");await V.json(),T.target.disabled=!1}const te=(T,N)=>{e(8,S={active:!0,top:T.top-28,left:T.left}),e(7,D=Number(N.target.attributes["data-ix"].value))},G=()=>{e(8,S.active=!1,S)},X=()=>{b()},K=()=>{F()},le=()=>{y("parent")},W=()=>{y("image_card")},ne=()=>{y("parent")},ge=()=>{y("image_card_fullscreen")},$=()=>{b()},re=()=>{console.log("hellll"),y("image_card_fullscreen")},ue=()=>{e(2,v.image_card_edit_interface=!0,v)},De=()=>{e(2,v.image_card_edit_interface=!1,v)},oe=()=>{F()},be=()=>{console.log("pressed me!!!"),e(6,u=[]),n("exitButtonPressed")},Fe=T=>{M(T.detail.mask)};function se(){w=ul(this.value),e(10,w)}const ae=T=>{j(T),y("image_card")};return l.$$set=T=>{"show_exit_interface_button"in T&&e(1,i=T.show_exit_interface_button),"image_data"in T&&e(0,s=T.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&25165825&&s&&(e(23,p=pt(s.list_score)),s.done==!1&&e(6,u=p.slice(_,_+Oe))),l.$$.dirty[0]&4&&v){let T=!1;(v.image_card==!0||v.image_card_fullscreen==!0)&&(T=!0),n("imageCardActive",{active:T})}},[s,i,v,r,a,o,u,D,S,C,w,n,h,y,j,F,b,k,q,M,O,A,Y,p,_,te,G,X,K,le,W,ne,ge,$,re,ue,De,oe,be,Fe,se,ae]}class gt extends Se{constructor(t){super(),Ce(this,t,Rl,Bl,we,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const zl="/assets/sample_place_bg-38f3fbd4.jpg";function el(l,t,e){const n=l.slice();return n[8]=t[e],n}function Ul(l){let t,e,n,i=l[0].people,s=[];for(let r=0;r<i.length;r+=1)s[r]=tl(el(l,i,r));return{c(){t=d("div"),e=x(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-gray-900 flex-wrap")},m(r,a){I(r,t,a),I(r,e,a),I(r,n,a);for(let o=0;o<s.length;o+=1)s[o].m(n,null)},p(r,a){if(a&17){i=r[0].people;let o;for(o=0;o<i.length;o+=1){const u=el(r,i,o);s[o]?s[o].p(u,a):(s[o]=tl(u),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:U,o:U,d(r){r&&E(t),r&&E(e),r&&E(n),me(s,r)}}}function Vl(l){let t,e;return t=new gt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){he(t.$$.fragment)},m(n,i){_e(t,n,i),e=!0},p(n,i){const s={};i&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){ee(t.$$.fragment,n),e=!1},d(n){pe(t,n)}}}function Gl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){I(e,t,n)},p:U,i:U,o:U,d(e){e&&E(t)}}}function tl(l){let t,e,n,i,s,r,a,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,p,_,h;function m(...g){return l[6](l[8],...g)}return{c(){t=d("div"),e=d("div"),n=d("div"),i=d("img"),r=x(),a=d("div"),u=R(o),p=x(),ke(i.src,s="/api/getPreviewPerson/"+l[8])||f(i,"src",s),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(n,"class","h-[100px] w-[120px] bg-gray-800"),f(a,"class","flex text-md text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(g,v){I(g,t,v),c(t,e),c(e,n),c(n,i),c(e,r),c(e,a),c(a,u),c(t,p),_||(h=L(t,"click",m),_=!0)},p(g,v){l=g,v&1&&!ke(i.src,s="/api/getPreviewPerson/"+l[8])&&f(i,"src",s),v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&Q(u,o)},d(g){g&&E(t),_=!1,h()}}}function Xl(l){let t,e,n,i;const s=[Gl,Vl,Ul],r=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(o,u){r[t].m(o,u),I(o,n,u),i=!0},p(o,[u]){let p=t;t=a(o),t===p?r[t].p(o,u):(ot(),ee(r[p],1,1,()=>{r[p]=null}),at(),e=r[t],e?e.p(o,u):(e=r[t]=s[t](o),e.c()),Z(e,1),e.m(n.parentNode,n))},i(o){i||(Z(e),i=!0)},o(o){ee(e),i=!1},d(o){r[t].d(o),o&&E(n)}}}function Ql(l,t,e){let n={people:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,a=!0;Ue(()=>{e(3,a=!1),fetch("/api/getGroup/person").then(_=>{_.json().then(h=>{let m=h.meta_data.length;console.log("data length: ",m);for(let g=0;g<m;g++)i.list_dataHash.push(h.data_hash[g]),i.list_score.push(h.score[g]),i.list_metaData.push(h.meta_data[g]);e(3,a=!0),e(0,n.people=h.person,n)})})}),it(()=>{console.log("destroying... people..")});async function o(_){e(2,r=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1});for(let h=0;h<i.list_dataHash.length;h++)i.list_metaData[h].person.includes(_)&&(s.list_metaData.push(i.list_metaData[h]),s.list_dataHash.push(i.list_dataHash[h]),s.list_score.push(i.list_score[h]));e(1,s.done=!0,s),e(2,r=!0),Ee.update(h=>structuredClone(s))}return[n,s,r,a,o,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,h)=>{console.log("mine is: ",_),o(_)}]}class Kl extends Se{constructor(t){super(),Ce(this,t,Ql,Xl,we,{})}}function ll(l,t,e){const n=l.slice();return n[8]=t[e],n}function Wl(l){let t,e,n,i=l[0].places,s=[];for(let r=0;r<i.length;r+=1)s[r]=nl(ll(l,i,r));return{c(){t=d("div"),e=x(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,a){I(r,t,a),I(r,e,a),I(r,n,a);for(let o=0;o<s.length;o+=1)s[o].m(n,null)},p(r,a){if(a&17){i=r[0].places;let o;for(o=0;o<i.length;o+=1){const u=ll(r,i,o);s[o]?s[o].p(u,a):(s[o]=nl(u),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:U,o:U,d(r){r&&E(t),r&&E(e),r&&E(n),me(s,r)}}}function Jl(l){let t,e;return t=new gt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){he(t.$$.fragment)},m(n,i){_e(t,n,i),e=!0},p(n,i){const s={};i&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){ee(t.$$.fragment,n),e=!1},d(n){pe(t,n)}}}function Yl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){I(e,t,n)},p:U,i:U,o:U,d(e){e&&E(t)}}}function nl(l){let t,e,n,i,s,r,a,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,p,_,h;function m(...g){return l[6](l[8],...g)}return{c(){t=d("div"),e=d("div"),n=d("div"),i=d("img"),r=x(),a=d("div"),u=R(o),p=x(),ke(i.src,s=zl)||f(i,"src",s),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(n,"class","h-[150px] w-[200px] bg-gray-800"),f(a,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(g,v){I(g,t,v),c(t,e),c(e,n),c(n,i),c(e,r),c(e,a),c(a,u),c(t,p),_||(h=L(t,"click",m),_=!0)},p(g,v){l=g,v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&Q(u,o)},d(g){g&&E(t),_=!1,h()}}}function Zl(l){let t,e,n,i;const s=[Yl,Jl,Wl],r=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(o,u){r[t].m(o,u),I(o,n,u),i=!0},p(o,[u]){let p=t;t=a(o),t===p?r[t].p(o,u):(ot(),ee(r[p],1,1,()=>{r[p]=null}),at(),e=r[t],e?e.p(o,u):(e=r[t]=s[t](o),e.c()),Z(e,1),e.m(n.parentNode,n))},i(o){i||(Z(e),i=!0)},o(o){ee(e),i=!1},d(o){r[t].d(o),o&&E(n)}}}function $l(l,t,e){let n={places:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,a=!0;Ue(()=>{e(3,a=!1),fetch("/api/getGroup/place").then(_=>{_.json().then(h=>{let m=h.meta_data.length;for(let g=0;g<m;g++)i.list_dataHash.push(h.data_hash[g]),i.list_score.push(h.score[g]),i.list_metaData.push(h.meta_data[g]);e(3,a=!0),e(0,n.places=h.place,n)})})}),it(()=>{console.log("destroying...")});async function o(_){e(2,r=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ee.update(h=>structuredClone(s));for(let h=0;h<i.list_dataHash.length;h++)i.list_metaData[h].place.toLowerCase()===_.toLowerCase()&&(s.list_metaData.push(i.list_metaData[h]),s.list_dataHash.push(i.list_dataHash[h]),s.list_score.push(i.list_score[h]));e(1,s.done=!0,s),e(2,r=!0),Ee.update(h=>structuredClone(s))}return[n,s,r,a,o,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,h)=>{console.log("mine is: ",_),o(_)}]}class en extends Se{constructor(t){super(),Ce(this,t,$l,Zl,we,{})}}function tn(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),s=new Kl({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),i=d("div"),he(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){I(a,t,o),_e(e,t,null),c(t,n),c(t,i),_e(s,i,null),r=!0},p(a,o){const u={};o&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(Z(e.$$.fragment,a),Z(s.$$.fragment,a),r=!0)},o(a){ee(e.$$.fragment,a),ee(s.$$.fragment,a),r=!1},d(a){a&&E(t),pe(e),pe(s)}}}function ln(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),s=new en({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),i=d("div"),he(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){I(a,t,o),_e(e,t,null),c(t,n),c(t,i),_e(s,i,null),r=!0},p(a,o){const u={};o&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(Z(e.$$.fragment,a),Z(s.$$.fragment,a),r=!0)},o(a){ee(e.$$.fragment,a),ee(s.$$.fragment,a),r=!1},d(a){a&&E(t),pe(e),pe(s)}}}function nn(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[11]),e.$on("sidebarStateChange",l[12]),s=new Ol({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),i=d("div"),he(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(a,o){I(a,t,o),_e(e,t,null),c(t,n),c(t,i),_e(s,i,null),r=!0},p(a,o){const u={};o&32&&(u.sidebarOpen=a[5]),e.$set(u)},i(a){r||(Z(e.$$.fragment,a),Z(s.$$.fragment,a),r=!0)},o(a){ee(e.$$.fragment,a),ee(s.$$.fragment,a),r=!1},d(a){a&&E(t),pe(e),pe(s)}}}function sn(l){let t,e,n,i,s,r,a,o;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[8]),e.$on("sidebarStateChange",l[9]),s=new wl({props:{query_button_disabled:l[1]}}),s.$on("queryReady",l[10]),a=new gt({props:{image_data:l[0]}}),{c(){t=d("div"),he(e.$$.fragment),n=x(),i=d("div"),he(s.$$.fragment),r=x(),he(a.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,p){I(u,t,p),_e(e,t,null),c(t,n),c(t,i),_e(s,i,null),c(i,r),_e(a,i,null),o=!0},p(u,p){const _={};p&32&&(_.sidebarOpen=u[5]),e.$set(_);const h={};p&2&&(h.query_button_disabled=u[1]),s.$set(h);const m={};p&1&&(m.image_data=u[0]),a.$set(m)},i(u){o||(Z(e.$$.fragment,u),Z(s.$$.fragment,u),Z(a.$$.fragment,u),o=!0)},o(u){ee(e.$$.fragment,u),ee(s.$$.fragment,u),ee(a.$$.fragment,u),o=!1},d(u){u&&E(t),pe(e),pe(s),pe(a)}}}function rn(l){let t,e,n,i;const s=[sn,nn,ln,tn],r=[];function a(o,u){return o[4].query.status?0:o[4].indexing.status===!0?1:o[4].place_album.status===!0?2:o[4].people_album.status===!0?3:-1}return~(t=a(l))&&(e=r[t]=s[t](l)),{c(){e&&e.c(),n=Ne()},m(o,u){~t&&r[t].m(o,u),I(o,n,u),i=!0},p(o,[u]){let p=t;t=a(o),t===p?~t&&r[t].p(o,u):(e&&(ot(),ee(r[p],1,1,()=>{r[p]=null}),at()),~t?(e=r[t],e?e.p(o,u):(e=r[t]=s[t](o),e.c()),Z(e,1),e.m(n.parentNode,n)):e=null)},i(o){i||(Z(e),i=!0)},o(o){ee(e),i=!1},d(o){~t&&r[t].d(o),o&&E(n)}}}let on=3;function an(l,t,e){let n=[],i=[],s=[],r,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1},o=!1,u="",p={};async function _(w="xxxxxxx",q=!1){console.log("handleClick count",u,q,w),e(1,o=!0);let M=on;if(r=new FormData,u.length===0)return;r.append("query",u),r.append("topk",M.toString()),q==!1?(i=[],n=[],s=[],e(0,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),r.append("query_start","true"),Ee.update(K=>a)):(r.append("query_start","false"),r.append("client_id",w));let z=await fetch("/api/query",{method:"POST",body:r});if(!z.ok)throw e(1,o=!1),new Error(z);let A=await z.json();console.log("data: ",A);let Y=A.client_id,te=A.meta_data,G=A.data_hash,X=A.score;for(let K=0;K<te.length;K++){let le=G[K],W=X[K];i.push(le),n.push(W),s.push(te[K]),a.list_dataHash.push(le),a.list_score.push(W),a.list_metaData.push(te[K])}if(A.query_completed==!0?e(0,a.done=!0,a):e(0,a),A.query_completed==!0){e(1,o=!1),console.log("hey i am being called!!!"),Ee.update(K=>a);return}await _(Y,!0)}const h={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function m(w){h[w].status==!1&&(e(0,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),Ee.update(M=>structuredClone(a)));let q=Object.keys(h);for(let M=0;M<q.length;M++)h[q[M]].status&&e(4,h[q[M]].status=!1,h);h[w]&&e(4,h[w].status=!0,h)}let g=!0;function v(w){let q=w.detail.item.name;q.toLowerCase().includes("photo")?m("query"):q.toLowerCase().includes("index")?m("indexing"):q.toLowerCase().includes("people")?m("people_album"):q.toLowerCase().includes("place")&&m("place_album")}return[a,o,u,p,h,g,_,v,w=>{v(w)},w=>{e(5,g=w.detail.open)},w=>{e(2,u=w.detail.query),e(3,p=w.detail.attributes),_()},w=>v(w),w=>{e(5,g=w.detail.open)},w=>v(w),w=>{e(5,g=w.detail.open)},w=>v(w),w=>{e(5,g=w.detail.open)}]}class cn extends Se{constructor(t){super(),Ce(this,t,an,rn,we,{})}}new cn({target:document.getElementById("app")});
