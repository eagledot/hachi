(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();function G(){}function fl(l){return l()}function jt(){return Object.create(null)}function _e(l){l.forEach(fl)}function vt(l){return typeof l=="function"}function Oe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let st;function je(l,t){return st||(st=document.createElement("a")),st.href=t,l===st.href}function _l(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function T(l,t,e){l.insertBefore(t,e||null)}function L(l){l.parentNode&&l.parentNode.removeChild(l)}function ye(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function U(l){return document.createTextNode(l)}function w(){return U(" ")}function Re(){return U("")}function P(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function u(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function hl(l){return l===""?null:+l}function ml(l){return Array.from(l.childNodes)}function W(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ot(l,t){l.value=t??""}function ae(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ot(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function gl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function bl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,e,s,t),i}let Qe;function Xe(l){Qe=l}function kt(){if(!Qe)throw new Error("Function called outside component initialization");return Qe}function Ue(l){kt().$$.on_mount.push(l)}function ct(l){kt().$$.on_destroy.push(l)}function ut(){const l=kt();return(t,e,{cancelable:s=!1}={})=>{const i=l.$$.callbacks[t];if(i){const n=bl(t,e,{cancelable:s});return i.slice().forEach(r=>{r.call(l,n)}),!n.defaultPrevented}return!0}}const ze=[],He=[],nt=[],qt=[],vl=Promise.resolve();let bt=!1;function kl(){bt||(bt=!0,vl.then(dl))}function at(l){nt.push(l)}const mt=new Set;let Ae=0;function dl(){if(Ae!==0)return;const l=Qe;do{try{for(;Ae<ze.length;){const t=ze[Ae];Ae++,Xe(t),wl(t.$$)}}catch(t){throw ze.length=0,Ae=0,t}for(Xe(null),ze.length=0,Ae=0;He.length;)He.pop()();for(let t=0;t<nt.length;t+=1){const e=nt[t];mt.has(e)||(mt.add(e),e())}nt.length=0}while(ze.length);for(;qt.length;)qt.pop()();bt=!1,mt.clear(),Xe(l)}function wl(l){if(l.fragment!==null){l.update(),_e(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(at)}}const it=new Set;let Ne;function ft(){Ne={r:0,c:[],p:Ne}}function dt(){Ne.r||_e(Ne.c),Ne=Ne.p}function $(l,t){l&&l.i&&(it.delete(l),l.i(t))}function le(l,t,e,s){if(l&&l.o){if(it.has(l))return;it.add(l),Ne.c.push(()=>{it.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function ke(l){l&&l.c()}function he(l,t,e,s){const{fragment:i,after_update:n}=l.$$;i&&i.m(t,e),s||at(()=>{const r=l.$$.on_mount.map(fl).filter(vt);l.$$.on_destroy?l.$$.on_destroy.push(...r):_e(r),l.$$.on_mount=[]}),n.forEach(at)}function me(l,t){const e=l.$$;e.fragment!==null&&(_e(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function yl(l,t){l.$$.dirty[0]===-1&&(ze.push(l),kl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Le(l,t,e,s,i,n,r,c=[-1]){const a=Qe;Xe(l);const f=l.$$={fragment:null,ctx:[],props:n,update:G,not_equal:i,bound:jt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:jt(),dirty:c,skip_bound:!1,root:t.target||a.$$.root};r&&r(f.root);let p=!1;if(f.ctx=e?e(l,t.props||{},(_,g,...m)=>{const h=m.length?m[0]:g;return f.ctx&&i(f.ctx[_],f.ctx[_]=h)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](h),p&&yl(l,_)),g}):[],f.update(),p=!0,_e(f.before_update),f.fragment=s?s(f.ctx):!1,t.target){if(t.hydrate){const _=ml(t.target);f.fragment&&f.fragment.l(_),_.forEach(L)}else f.fragment&&f.fragment.c();t.intro&&$(l.$$.fragment),he(l,t.target,t.anchor,t.customElement),dl()}Xe(a)}class Te{$destroy(){me(this,1),this.$destroy=G}$on(t,e){if(!vt(e))return G;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const i=s.indexOf(e);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!_l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Et(l,t,e){const s=l.slice();return s[26]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Lt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Tt(l,t,e){const s=l.slice();return s[34]=t[e],s}function Nt(l){let t,e=l[4][l[29]],s=[];for(let i=0;i<e.length;i+=1)s[i]=Pt(Tt(l,e,i));return{c(){for(let i=0;i<s.length;i+=1)s[i].c();t=w()},m(i,n){for(let r=0;r<s.length;r+=1)s[r].m(i,n);T(i,t,n)},p(i,n){if(n[0]&2576){e=i[4][i[29]];let r;for(r=0;r<e.length;r+=1){const c=Tt(i,e,r);s[r]?s[r].p(c,n):(s[r]=Pt(c),s[r].c(),s[r].m(t.parentNode,t))}for(;r<s.length;r+=1)s[r].d(1);s.length=e.length}},d(i){ye(s,i),i&&L(t)}}}function Pt(l){let t,e,s,i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,r,c,a=l[34]+" ",f,p,_,g,m;function h(...b){return l[14](l[29],l[34],...b)}return{c(){t=d("div"),e=d("div"),s=d("span"),n=U(i),r=w(),c=d("span"),f=U(a),p=w(),_=d("span"),_.textContent="x",u(s,"class","text-blue-800 "),u(c,"class","ml-1 text-sm font-semibold"),u(_,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),u(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),u(t,"class","flex items-center justify-center")},m(b,v){T(b,t,v),o(t,e),o(e,s),o(s,n),o(e,r),o(e,c),o(c,f),o(e,p),o(e,_),g||(m=[P(_,"click",h),P(e,"click",function(){vt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(b,v){l=b,v[0]&16&&i!==(i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&W(n,i),v[0]&16&&a!==(a=l[34]+" ")&&W(f,a)},d(b){b&&L(t),g=!1,_e(m)}}}function It(l){let t,e=l[4][l[29]].length>=1&&Nt(l);return{c(){e&&e.c(),t=Re()},m(s,i){e&&e.m(s,i),T(s,t,i)},p(s,i){s[4][s[29]].length>=1?e?e.p(s,i):(e=Nt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&L(t)}}}function Mt(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,i,n;return{c(){t=d("option"),s=U(e),i=w(),t.__value=n=l[29],t.value=t.__value},m(r,c){T(r,t,c),o(t,s),o(t,i)},p(r,c){c[0]&16&&e!==(e=r[29].charAt(0).toUpperCase()+r[29].slice(1)+"")&&W(s,e),c[0]&16&&n!==(n=r[29])&&(t.__value=n,t.value=t.__value)},d(r){r&&L(t)}}}function At(l){let t,e,s,i,n,r,c,a,f=l[3],p=[];for(let _=0;_<f.length;_+=1)p[_]=Bt(Et(l,f,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<p.length;_+=1)p[_].c();s=w(),i=d("div"),n=d("button"),n.textContent="Close",u(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),u(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),u(i,"class","flex w-full justify-center items-center"),u(t,"class",r=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,g){T(_,t,g),o(t,e);for(let m=0;m<p.length;m+=1)p[m].m(e,null);o(t,s),o(t,i),o(i,n),c||(a=P(n,"click",l[22]),c=!0)},p(_,g){if(g[0]&1034){f=_[3];let m;for(m=0;m<f.length;m+=1){const h=Et(_,f,m);p[m]?p[m].p(h,g):(p[m]=Bt(h),p[m].c(),p[m].m(e,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=f.length}g[0]&32&&r!==(r=(_[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&u(t,"class",r)},d(_){_&&L(t),ye(p,_),c=!1,a()}}}function Bt(l){let t,e=l[26]+"",s,i,n,r;function c(){return l[21](l[26])}return{c(){t=d("li"),s=U(e),i=w(),u(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(a,f){T(a,t,f),o(t,s),o(t,i),n||(r=P(t,"click",c),n=!0)},p(a,f){l=a,f[0]&8&&e!==(e=l[26]+"")&&W(s,e)},d(a){a&&L(t),n=!1,r()}}}function zt(l){let t;return{c(){t=d("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,u(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){T(e,t,s)},d(e){e&&L(t)}}}function xl(l){let t,e,s,i,n,r,c,a,f,p,_,g,m,h,b,v,C,E=Object.keys(l[4]),F=[];for(let k=0;k<E.length;k+=1)F[k]=It(Lt(l,E,k));let q=Object.keys(l[4]),H=[];for(let k=0;k<q.length;k+=1)H[k]=Mt(Ht(l,q,k));let y=l[3].length>0&&At(l),x=l[6]==!0&&zt();return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("div");for(let k=0;k<F.length;k+=1)F[k].c();n=w(),r=d("div"),c=d("select");for(let k=0;k<H.length;k+=1)H[k].c();a=w(),f=d("div"),p=d("input"),_=w(),g=d("div"),m=d("button"),m.textContent="Search",h=w(),y&&y.c(),b=w(),x&&x.c(),u(i,"class","flex w-full items-center my-3 flex-wrap text-lg"),u(c,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),u(c,"name","select-option"),u(c,"id","select-option"),l[1]===void 0&&at(()=>l[16].call(c)),u(p,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),u(p,"type","search"),u(p,"placeholder","Enter value here"),u(f,"class","bg-blue-200 rounded-md flex-grow h-10"),u(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),u(g,"class","flex"),u(r,"class","flex space-x-2"),u(s,"class","w-full"),u(e,"class","w-full relative place-content-center"),u(t,"class","max-w-screen p-4 mx-auto")},m(k,M){T(k,t,M),o(t,e),o(e,s),o(s,i);for(let S=0;S<F.length;S+=1)F[S].m(i,null);o(s,n),o(s,r),o(r,c);for(let S=0;S<H.length;S+=1)H[S].m(c,null);Ot(c,l[1]),o(r,a),o(r,f),o(f,p),l[17](p),o(r,_),o(r,g),o(g,m),l[20](m),o(e,h),y&&y.m(e,null),o(e,b),x&&x.m(e,null),v||(C=[P(c,"change",l[15]),P(c,"change",l[16]),P(p,"focus",l[18],{once:!0}),P(p,"focusout",l[19]),P(p,"keyup",l[8]),P(p,"keydown",l[7]),P(m,"click",l[12])],v=!0)},p(k,M){if(M[0]&2576){E=Object.keys(k[4]);let S;for(S=0;S<E.length;S+=1){const j=Lt(k,E,S);F[S]?F[S].p(j,M):(F[S]=It(j),F[S].c(),F[S].m(i,null))}for(;S<F.length;S+=1)F[S].d(1);F.length=E.length}if(M[0]&16){q=Object.keys(k[4]);let S;for(S=0;S<q.length;S+=1){const j=Ht(k,q,S);H[S]?H[S].p(j,M):(H[S]=Mt(j),H[S].c(),H[S].m(c,null))}for(;S<H.length;S+=1)H[S].d(1);H.length=q.length}M[0]&18&&Ot(c,k[1]),k[3].length>0?y?y.p(k,M):(y=At(k),y.c(),y.m(e,b)):y&&(y.d(1),y=null),k[6]==!0?x||(x=zt(),x.c(),x.m(e,null)):x&&(x.d(1),x=null)},i:G,o:G,d(k){k&&L(t),ye(F,k),ye(H,k),l[17](null),l[20](null),y&&y.d(),x&&x.d(),v=!1,_e(C)}}}async function Cl(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let i=await fetch(e,{method:"POST",body:s});return i.ok===!0?await i.json():{}}function Sl(l,t,e){const s=ut();let i="query",n,r,{query_button_disabled:c=!1}=t,a="",f=[],p={person:[],query:[],place:[],filename:[]},_=!1;var g={};function m(O){g[O.keyCode]=O.type=="keydown",g[13]==!0&&O.shiftKey&&(console.log("shift enter combination."),E())}async function h(O){e(6,F=!1),g[O.keyCode]=!1;let I=O.target;if(I.value.length==0){e(3,f=[]);return}if(console.log("current value: ",I.value),O.keyCode==13){let R=p[i].length;I.value.length>0&&!p[i].includes(I.value)&&e(4,p[i][R]=I.value,p),I.value="",e(3,f=[]),e(5,_=!1);return}let A=await Cl(i,I.value);i in A?(e(3,f=A[i]),e(5,_=!0)):(e(3,f=[]),e(5,_=!1))}function b(O,I,A){let R=p[I].indexOf(A);R>=0&&(p[I].splice(R,1),e(4,p)),i==I&&e(3,f=[])}function v(O,I){e(5,_=!1),e(2,n.value=I,n),n.focus()}function C(O){e(1,i=O),e(3,f=p[i]),e(5,_=!0),n.focus()}function E(O){let I=p[i].length;n.value.length>0&&!p[i].includes(n.value)&&e(4,p[i][I]=n.value,p);let A=Object.keys(p);a="";for(let R=0;R<A.length;R++){let K=A[R],X=p[K];a+=K+":";for(let ne=0;ne<X.length;ne++)a+=X[ne],ne!=X.length-1&&(a+="-");R!=A.length-1&&(a+=",")}console.log("Completed: "+a),e(2,n.value="",n),r.disabled==!1?s("queryReady",{query:a,attributes:p}):console.log("chill dawg!!!")}let F=!1;const q=(O,I,A)=>b(A.currentTarget,O,I),H=O=>C(O.target.value);function y(){i=gl(this),e(1,i),e(4,p)}function x(O){He[O?"unshift":"push"](()=>{n=O,e(2,n)})}const k=O=>{O.target.value.length==0&&e(6,F=!0)},M=O=>{e(6,F=!1)};function S(O){He[O?"unshift":"push"](()=>{r=O,e(0,r),e(13,c)})}const j=O=>v(i,O),D=()=>e(5,_=!1);return l.$$set=O=>{"query_button_disabled"in O&&e(13,c=O.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=c,r)},[r,i,n,f,p,_,F,m,h,b,v,C,E,c,q,H,y,x,k,M,S,j,D]}class Dl extends Te{constructor(t){super(),Le(this,t,Sl,xl,Oe,{query_button_disabled:13},null,[-1,-1])}}const Be=[];function We(l,t=G){let e;const s=new Set;function i(c){if(Oe(l,c)&&(l=c,e)){const a=!Be.length;for(const f of s)f[1](),Be.push(f,l);if(a){for(let f=0;f<Be.length;f+=2)Be[f][0](Be[f+1]);Be.length=0}}}function n(c){i(c(l))}function r(c,a=G){const f=[c,a];return s.add(f),s.size===1&&(e=t(i)||G),c(l),()=>{s.delete(f),s.size===0&&(e(),e=null)}}return{set:i,update:n,subscribe:r}}const wt=We(0),yt=We(0),xt=We(0),rt=We([]);let Fl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Pe=We(Fl);function Rt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function jl(l){let t,e,s;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',u(t,"class","px-4")},m(i,n){T(i,t,n),e||(s=P(t,"click",l[2]),e=!0)},p:G,d(i){i&&L(t),e=!1,s()}}}function Ol(l){let t,e,s,i,n;return{c(){t=d("span"),t.textContent="Hachi",e=w(),s=d("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',u(t,"class","px-4"),u(s,"class","cursor-pointer px-4")},m(r,c){T(r,t,c),T(r,e,c),T(r,s,c),i||(n=P(s,"click",l[3]),i=!0)},p:G,d(r){r&&L(t),r&&L(e),r&&L(s),i=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",i,n,r,c=l[8].count+"",a;return{c(){t=d("div"),e=d("div"),i=U(s),n=w(),r=d("div"),a=U(c),u(e,"class","flex"),u(e,"data-ix",l[10]),u(r,"class","px-3 flex text-black text-md text-bold"),u(t,"class","flex w-full justify-between")},m(f,p){T(f,t,p),o(t,e),o(e,i),o(t,n),o(t,r),o(r,a)},p(f,p){p&2&&s!==(s=f[8].name+"")&&W(i,s),p&2&&c!==(c=f[8].count+"")&&W(a,c)},d(f){f&&L(t)}}}function Vt(l){let t,e,s,i,n,r,c,a=l[0].sidebarOpen&&Ut(l);function f(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),i=w(),a&&a.c(),n=w(),u(e,"class",s="fa-solid fa-"+l[8].icon),u(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(p,_){T(p,t,_),o(t,e),o(t,i),a&&a.m(t,null),o(t,n),r||(c=P(t,"click",f),r=!0)},p(p,_){l=p,_&2&&s!==(s="fa-solid fa-"+l[8].icon)&&u(e,"class",s),l[0].sidebarOpen?a?a.p(l,_):(a=Ut(l),a.c(),a.m(t,n)):a&&(a.d(1),a=null)},d(p){p&&L(t),a&&a.d(),r=!1,c()}}}function ql(l){let t,e,s,i,n,r;function c(g,m){return g[0].sidebarOpen?Ol:jl}let a=c(l),f=a(l),p=l[1],_=[];for(let g=0;g<p.length;g+=1)_[g]=Vt(Rt(l,p,g));return{c(){t=d("div"),e=d("aside"),s=d("div"),f.c(),i=w(),n=d("nav");for(let g=0;g<_.length;g+=1)_[g].c();u(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),u(n,"class","mt-6"),u(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),u(t,"class","flex h-screen text-white")},m(g,m){T(g,t,m),o(t,e),o(e,s),f.m(s,null),o(e,i),o(e,n);for(let h=0;h<_.length;h+=1)_[h].m(n,null)},p(g,[m]){if(a===(a=c(g))&&f?f.p(g,m):(f.d(1),f=a(g),f&&(f.c(),f.m(s,null))),m&19){p=g[1];let h;for(h=0;h<p.length;h+=1){const b=Rt(g,p,h);_[h]?_[h].p(b,m):(_[h]=Vt(b),_[h].c(),_[h].m(n,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=p.length}m&1&&r!==(r=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&u(e,"class",r)},i:G,o:G,d(g){g&&L(t),f.d(),ye(_,g)}}}function El(l,t,e){const s=ut();let{sidebarOpen:i=!1}=t;const n={sidebarOpen:i},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ue(()=>{wt.subscribe(_=>{r&&e(1,r[0].count=_,r)}),yt.subscribe(_=>{r&&e(1,r[3].count=_,r)}),xt.subscribe(_=>{r&&e(1,r[4].count=_,r)})});function c(){e(0,n.sidebarOpen=!0,n)}function a(){e(0,n.sidebarOpen=!1,n)}function f(_){s("menuClick",{item:r[_]})}const p=_=>{f(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,i=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,r,c,a,f,i,p]}class pt extends Te{constructor(t){super(),Le(this,t,El,ql,Oe,{sidebarOpen:5})}}function Hl(l){let t,e,s,i,n,r,c,a,f,p,_,g,m=(l[3]*100).toString().slice(0,4)+"",h,b,v,C,E,F,q,H,y,x,k,M,S,j,D,O,I,A,R,K,X,ne,ce,J,se,ue,Q,ee,ge,be,fe,Ce,Se,De,de,qe,ve,xe,pe;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",s=w(),i=d("div"),n=d("input"),r=w(),c=d("div"),a=d("div"),f=d("div"),p=d("div"),_=w(),g=d("div"),h=U(m),b=U("%"),v=w(),C=d("div"),E=U("Current directory: "),F=d("span"),q=U(l[4]),H=w(),y=d("span"),y.textContent="ETA:",x=w(),k=d("span"),M=U(l[6]),S=w(),j=d("div"),D=U("Details: "),O=d("span"),I=U(l[5]),A=w(),R=d("div"),K=d("div"),X=d("input"),ne=w(),ce=d("label"),ce.textContent="Complete Rescan",J=w(),se=d("div"),se.textContent="Re-index all originals, including already indexed and unchanged files.",ue=w(),Q=d("div"),ee=d("select"),ge=d("option"),ge.textContent="Images Only",be=d("option"),be.textContent="Videos Only",fe=d("option"),fe.textContent="Videos and Images",Ce=w(),Se=d("div"),Se.textContent="Filter by content type",De=w(),de=d("button"),de.textContent="Cancel",qe=w(),ve=d("button"),ve.textContent="Start",u(e,"class","mb-2 text-sm font-semibold"),u(n,"type","text"),u(n,"class","w-full rounded border p-1 text-sm"),u(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,u(i,"class","my-2"),u(p,"class","h-2rounded bg-blue-500"),ae(p,"width",(l[3]*100).toString()+"%"),u(f,"class","flex h-2 w-11/12 rounded bg-gray-300"),u(g,"class","flex px-2 font-semibold"),u(a,"class","flex items-center"),u(F,"class","text-black"),u(y,"class","pl-3 text-right"),u(k,"class","text-black"),u(C,"class","pt-1 text-sm text-blue-600"),u(O,"class","text-black"),u(j,"class","pt-1 text-sm text-blue-600"),u(c,"class","mb-3"),u(X,"type","checkbox"),u(X,"class","h-5 w-5 text-blue-500"),u(ce,"class","ml-1"),u(K,"class","mr-2 flex items-center"),u(se,"class","text-sm text-gray-600"),u(R,"class","mt-4 mb-3 flex flex-wrap items-center"),ge.__value="Images Only",ge.value=ge.__value,be.disabled=!0,be.__value="Videos Only",be.value=be.__value,fe.disabled=!0,fe.__value="Videos and Images",fe.value=fe.__value,u(ee,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),u(Se,"class","ml-2 text-sm text-gray-600"),u(Q,"class","mb-3 mt-3 flex flex-wrap items-center"),de.disabled=!0,u(de,"type","button"),u(de,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),u(ve,"type","button"),u(ve,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),u(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(te,re){T(te,t,re),o(t,e),o(t,s),o(t,i),o(i,n),l[12](n),ot(n,l[7]),o(t,r),o(t,c),o(c,a),o(a,f),o(f,p),o(a,_),o(a,g),o(g,h),o(g,b),o(c,v),o(c,C),o(C,E),o(C,F),o(F,q),o(C,H),o(C,y),o(C,x),o(C,k),o(k,M),o(c,S),o(c,j),o(j,D),o(j,O),o(O,I),o(t,A),o(t,R),o(R,K),o(K,X),X.checked=l[8],o(K,ne),o(K,ce),o(R,J),o(R,se),o(t,ue),o(t,Q),o(Q,ee),o(ee,ge),o(ee,be),o(ee,fe),o(Q,Ce),o(Q,Se),o(t,De),o(t,de),l[16](de),o(t,qe),o(t,ve),l[17](ve),xe||(pe=[P(n,"input",l[13]),P(n,"keydown",l[14]),P(X,"change",l[15]),P(de,"click",l[10]),P(ve,"click",l[9])],xe=!0)},p(te,[re]){re&128&&n.value!==te[7]&&ot(n,te[7]),re&8&&ae(p,"width",(te[3]*100).toString()+"%"),re&8&&m!==(m=(te[3]*100).toString().slice(0,4)+"")&&W(h,m),re&16&&W(q,te[4]),re&64&&W(M,te[6]),re&32&&W(I,te[5]),re&256&&(X.checked=te[8])},i:G,o:G,d(te){te&&L(t),l[12](null),l[16](null),l[17](null),xe=!1,_e(pe)}}}function Ll(l,t,e){let s,i,n;Ue(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let x="/api/getIndexStatus/"+s;e(0,i.disabled=!1,i),e(1,n.disabled=!0,n),m(x)}}),ct(()=>{g&&clearTimeout(g)});let r,c=.001,a="",f="",p="",_="",g;async function m(x,k=0){k==0&&console.log("starting a new polll...");let S=await(await fetch(x,{method:"GET"})).json();if(S.is_active==!0){if(S.done==!0){let D=new FormData;D.append("ack","true"),(await fetch(x,{method:"POST",body:D})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let I=await fetch("/api/getMetaStats");I=await I.json(),wt.update(A=>Number(I.image.count)),yt.update(A=>Number(I.image.unique_people_count)),xt.update(A=>Number(I.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,c=0),e(4,a=""),e(6,p=""),e(5,f=""),e(7,_=""),e(0,i.disabled=!0,i),e(0,i.innerText="Cancel",i),e(2,r.disabled=!1,r);return}e(3,c=S.progress),e(6,p=S.eta),e(5,f=S.details),e(4,a=S.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(x,k+1)},1e3)}}let h=!1;async function b(){if(n&&_){e(1,n.disabled=!0,n),e(2,r.disabled=!0,r);let x=new FormData;x.append("image_directory_path",_),x.append("complete_rescan",h.toString());let S=await(await fetch("/api/indexStart",{method:"POST",body:x})).json();if(S.success===!0){e(0,i.disabled=!1,i);let D="/api/getIndexStatus/"+S.statusEndpoint;e(11,s=S.statusEndpoint),m(D)}else alert(S.reason),e(1,n.disabled=!1,n),e(2,r.disabled=!1,r)}else console.log("No index_start_button object found!!!")}async function v(){if(s){e(0,i.disabled=!0,i),e(0,i.innerText="Cancelling... Please wait.",i);let x="/api/indexCancel/"+s,k=await fetch(x,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!k.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(k);return}else return}function C(x){He[x?"unshift":"push"](()=>{r=x,e(2,r)})}function E(){_=this.value,e(7,_)}const F=x=>{x.key==="Enter"&&n.click()};function q(){h=this.checked,e(8,h)}function H(x){He[x?"unshift":"push"](()=>{i=x,e(0,i)})}function y(x){He[x?"unshift":"push"](()=>{n=x,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[i,n,r,c,a,f,p,_,h,b,v,s,C,E,F,q,H,y]}class Tl extends Te{constructor(t){super(),Le(this,t,Ll,Hl,Oe,{})}}function Gt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=d("i"),u(t,"class","fa fa-plus text-xs text-black")},m(e,s){T(e,t,s)},d(e){e&&L(t)}}}function Qt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),i,n,r,c=l[13]+"",a,f,p,_=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),n=w(),r=d("span"),a=U(c),u(e,"class",i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),u(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){T(m,t,h),o(t,e),_&&_.m(e,null),o(t,n),o(t,r),o(r,a),f||(p=P(t,"click",g),f=!0)},p(m,h){l=m,h&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?_||(_=Xt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),h&2&&i!==(i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&u(e,"class",i),h&2&&c!==(c=l[13]+"")&&W(a,c)},d(m){m&&L(t),_&&_.d(),f=!1,p()}}}function Wt(l){let t,e,s=l[10]+"",i,n,r,c,a,f,p,_,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,b=[];for(let v=0;v<h.length;v+=1)b[v]=Qt(Kt(l,h,v));return{c(){t=d("div"),e=d("div"),i=U(s),n=w(),r=d("i"),a=w(),f=d("div");for(let v=0;v<b.length;v+=1)b[v].c();u(r,"class",c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),u(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),u(f,"class",p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),u(t,"class","relative")},m(v,C){T(v,t,C),o(t,e),o(e,i),o(e,n),o(e,r),o(t,a),o(t,f);for(let E=0;E<b.length;E+=1)b[E].m(f,null);_||(g=[P(e,"click",m),P(t,"mouseup",Al)],_=!0)},p(v,C){if(l=v,C&2&&s!==(s=l[10]+"")&&W(i,s),C&2&&c!==(c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&u(r,"class",c),C&6){h=l[1].selectFilters[l[10]].options;let E;for(E=0;E<h.length;E+=1){const F=Kt(l,h,E);b[E]?b[E].p(F,C):(b[E]=Qt(F),b[E].c(),b[E].m(f,null))}for(;E<b.length;E+=1)b[E].d(1);b.length=h.length}C&2&&p!==(p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&u(f,"class",p)},d(v){v&&L(t),ye(b,v),_=!1,_e(g)}}}function Nl(l){let t,e,s,i,n,r,c,a,f,p,_,g,m=Object.keys(l[1].selectFilters),h=[];for(let b=0;b<m.length;b+=1)h[b]=Wt(Gt(l,m,b));return{c(){t=d("div"),e=d("div"),s=d("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w(),n=d("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=w();for(let b=0;b<h.length;b+=1)h[b].c();c=w(),a=d("button"),f=U("Filter"),u(s,"class","flex items-center text-md"),u(n,"class","flex items-center text-md"),a.disabled=l[0],u(a,"class",p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),u(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),u(t,"class","flex container mx-auto max-w-4xl")},m(b,v){T(b,t,v),o(t,e),o(e,s),o(e,i),o(e,n),o(e,r);for(let C=0;C<h.length;C+=1)h[C].m(e,null);o(e,c),o(e,a),o(a,f),_||(g=P(a,"click",l[4]),_=!0)},p(b,[v]){if(v&14){m=Object.keys(b[1].selectFilters);let C;for(C=0;C<m.length;C+=1){const E=Gt(b,m,C);h[C]?h[C].p(E,v):(h[C]=Wt(E),h[C].c(),h[C].m(e,c))}for(;C<h.length;C+=1)h[C].d(1);h.length=m.length}v&1&&(a.disabled=b[0]),v&1&&p!==(p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(b[0]===!0?"disabled":""))&&u(a,"class",p)},i:G,o:G,d(b){b&&L(t),ye(h,b),_=!1,g()}}}function pl(l,t,e=null,s=(i,n)=>i===n){let i=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?i.push(1):i.push(0):s(l[n],t)?i.push(1):i.push(0);return i}function Pl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=pl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Il(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=pl(l,t[s],null,(n,r)=>n?n.includes(r):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Ml(l){let t=l[0].length,e=l[0];return l.forEach((s,i)=>{if(i>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(n))})}}),e}const Al=l=>l.stopPropagation();function Bl(l,t,e){let s=[],{filter_button_disabled:i=!0}=t;rt.subscribe(m=>{e(0,i=!1),e(5,s=m)});const n=ut(),r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ue(()=>{document.addEventListener("mouseup",c)});function c(m){e(1,r.selectFilterActive="",r)}function a(m,h){if(r.selectFilters[m].values.includes(h)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(b=>b!==h),r);return}e(1,r.selectFilters[m].values=[h,...r.selectFilters[m].values],r)}function f(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function p(){if(s){console.log(s);let m=[],h=[];s.map((q,H)=>{m.push(q.place),h.push(q.person)});let b=r.selectFilters.place.values,v=Pl(m,b),C=r.selectFilters.people.values,E=Il(h,C),F=Ml([v,E]);n("filterApplied",{mask:F})}}const _=m=>f(m),g=(m,h)=>a(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,i=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((C,E)=>{if(C.place)return C.place}),h=[];s.map((C,E)=>{C.person&&C.person.forEach(F=>h.push(F))});let b=[];new Set(m).forEach(C=>b.push(C));let v=[];new Set(h).forEach(C=>v.push(C)),e(1,r.selectFilters.place.values=b,r),e(1,r.selectFilters.place.options=b,r),e(1,r.selectFilters.people.values=v,r),e(1,r.selectFilters.people.options=v,r)}},[i,r,a,f,p,s,_,g]}class zl extends Te{constructor(t){super(),Le(this,t,Bl,Nl,Oe,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[55]=t[e],s[54]=e,s}function Yt(l,t,e){const s=l.slice();return s[52]=t[e],s[54]=e,s}function Rl(l){let t,e,s,i,n,r,c,a,f,p,_,g,m,h,b,v,C,E,F,q,H,y,x,k=l[1]&&Zt(l);e=new zl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[42]);let M=l[6],S=[];for(let D=0;D<M.length;D+=1)S[D]=el(Jt(l,M,D));let j=l[6].length>=Fe&&tl(l);return{c(){k&&k.c(),t=w(),ke(e.$$.fragment),s=w(),i=d("div"),n=d("div"),r=d("div"),c=d("div"),a=w(),f=d("div"),p=d("div"),_=d("div"),g=d("input"),m=w(),h=d("label"),b=U("Score threshold: "),v=U(l[12]),C=U("."),E=w(),F=d("div");for(let D=0;D<S.length;D+=1)S[D].c();q=w(),j&&j.c(),u(c,"class","h-1 rounded bg-blue-600"),ae(c,"width",(l[7]*100).toString()+"%"),u(r,"class","flex animate-pulse"),u(g,"type","range"),u(g,"min","0"),u(g,"max","1.0"),u(g,"step","0.01"),u(g,"class","w-full"),u(h,"for","topk"),u(h,"class","dark:text-white"),u(_,"class","my-2"),u(f,"class","flex flex-row place-content-center mb-2 select-none mx-2"),u(F,"class","grid grid-cols-6 2xl:grid-cols-8 gap-2 p-1 sm:p-8 px-auto justify-center"),u(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),u(i,"class","flex")},m(D,O){k&&k.m(D,O),T(D,t,O),he(e,D,O),T(D,s,O),T(D,i,O),o(i,n),o(n,r),o(r,c),o(n,a),o(n,f),o(f,p),o(p,_),o(_,g),ot(g,l[12]),o(_,m),o(_,h),o(h,b),o(h,v),o(h,C),o(n,E),o(n,F);for(let I=0;I<S.length;I+=1)S[I].m(F,null);o(n,q),j&&j.m(n,null),H=!0,y||(x=[P(g,"change",l[20]),P(g,"change",l[43]),P(g,"input",l[43])],y=!0)},p(D,O){D[1]?k?k.p(D,O):(k=Zt(D),k.c(),k.m(t.parentNode,t)):k&&(k.d(1),k=null);const I={};if(O[0]&8&&(I.filter_button_disabled=D[3]),e.$set(I),(!H||O[0]&128)&&ae(c,"width",(D[7]*100).toString()+"%"),O[0]&4096&&ot(g,D[12]),(!H||O[0]&4096)&&W(v,D[12]),O[0]&33652801){M=D[6];let A;for(A=0;A<M.length;A+=1){const R=Jt(D,M,A);S[A]?S[A].p(R,O):(S[A]=el(R),S[A].c(),S[A].m(F,null))}for(;A<S.length;A+=1)S[A].d(1);S.length=M.length}D[6].length>=Fe?j?j.p(D,O):(j=tl(D),j.c(),j.m(n,null)):j&&(j.d(1),j=null)},i(D){H||($(e.$$.fragment,D),H=!0)},o(D){le(e.$$.fragment,D),H=!1},d(D){k&&k.d(D),D&&L(t),me(e,D),D&&L(s),D&&L(i),ye(S,D),j&&j.d(),y=!1,_e(x)}}}function Ul(l){let t,e,s,i,n,r,c,a,f,p,_,g,m,h,b,v,C,E,F,q,H,y=l[2].image_card_edit_interface&&ll(l),x=l[5]&&sl(l);return{c(){t=d("div"),e=d("div"),s=d("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,i=w(),n=d("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=w(),c=d("div"),a=d("div"),a.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',f=w(),p=d("div"),_=d("div"),g=d("img"),h=w(),b=d("div"),b.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',v=w(),y&&y.c(),C=w(),E=d("div"),E.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',F=w(),x&&x.c(),u(s,"class","cursor-pointer hover:underline text-gray-200"),u(n,"title","Fullscreen"),u(n,"class","cursor-pointer"),u(e,"class","flex h-6 items-center justify-between"),u(a,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),u(g,"class","w-auto cursor-pointer h-full"),je(g.src,m="/api/getRawData/"+l[4].data_hash)||u(g,"src",m),u(g,"alt",""),u(b,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),u(_,"class","flex shrink h-full"),u(p,"class","flex h-full items-center justify-center p-2 gap-4"),u(E,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),u(c,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),u(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(k,M){T(k,t,M),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,c),o(c,a),o(c,f),o(c,p),o(p,_),o(_,g),o(_,h),o(_,b),o(p,v),y&&y.m(p,null),o(c,C),o(c,E),o(t,F),x&&x.m(t,null),q||(H=[P(s,"click",l[34]),P(n,"click",l[35]),P(a,"click",l[36]),P(g,"click",l[37]),P(b,"click",l[38]),P(E,"click",l[40])],q=!0)},p(k,M){M[0]&16&&!je(g.src,m="/api/getRawData/"+k[4].data_hash)&&u(g,"src",m),k[2].image_card_edit_interface?y?y.p(k,M):(y=ll(k),y.c(),y.m(p,null)):y&&(y.d(1),y=null),k[5]?x?x.p(k,M):(x=sl(k),x.c(),x.m(t,null)):x&&(x.d(1),x=null)},i:G,o:G,d(k){k&&L(t),y&&y.d(),x&&x.d(),q=!1,_e(H)}}}function Vl(l){let t,e,s,i,n,r,c,a,f,p,_,g,m,h,b,v,C,E,F=l[11],q=[];for(let y=0;y<F.length;y+=1)q[y]=nl(Yt(l,F,y));let H=l[10].active&&il(l);return{c(){t=d("div"),e=d("div"),s=d("img"),n=w();for(let y=0;y<q.length;y+=1)q[y].c();r=w(),H&&H.c(),c=w(),a=d("div"),f=d("div"),f.innerHTML='<i class="fa fa-arrow-left"></i>',p=w(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',g=w(),m=d("div"),h=d("div"),h.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),v=d("div"),v.innerHTML='<i class="fa fa-arrows-alt"></i>',u(s,"class","object-cover h-screen w-auto"),je(s.src,i="/api/getRawDataFull/"+l[4].data_hash)||u(s,"src",i),u(s,"alt",""),u(e,"class","relative flex"),u(f,"class","text-white cursor-pointer"),u(_,"class","text-white cursor-pointer"),u(a,"class","absolute flex mx-auto items-center justify-between w-screen"),u(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),u(h,"class","cursor-pointer hover:underline text-white"),u(v,"title","Fullscreen"),u(v,"class","cursor-pointer text-white"),u(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(y,x){T(y,t,x),o(t,e),o(e,s),o(e,n);for(let k=0;k<q.length;k+=1)q[k].m(e,null);o(e,r),H&&H.m(e,null),o(t,c),o(t,a),o(a,f),o(a,p),o(a,_),T(y,g,x),T(y,m,x),o(m,h),o(m,b),o(m,v),C||(E=[P(s,"load",l[19]),P(f,"click",l[30]),P(_,"click",l[31]),P(h,"click",l[32]),P(v,"click",l[33])],C=!0)},p(y,x){if(x[0]&16&&!je(s.src,i="/api/getRawDataFull/"+y[4].data_hash)&&u(s,"src",i),x[0]&3584){F=y[11];let k;for(k=0;k<F.length;k+=1){const M=Yt(y,F,k);q[k]?q[k].p(M,x):(q[k]=nl(M),q[k].c(),q[k].m(e,r))}for(;k<q.length;k+=1)q[k].d(1);q.length=F.length}y[10].active?H?H.p(y,x):(H=il(y),H.c(),H.m(e,null)):H&&(H.d(1),H=null)},i:G,o:G,d(y){y&&L(t),ye(q,y),H&&H.d(),y&&L(g),y&&L(m),C=!1,_e(E)}}}function Zt(l){let t,e,s,i,n;return{c(){t=d("div"),e=d("div"),s=d("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,u(s,"class","cursor-pointer hover:underline text-black"),u(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),u(t,"class","flex")},m(r,c){T(r,t,c),o(t,e),o(e,s),i||(n=P(s,"click",l[41]),i=!0)},p:G,d(r){r&&L(t),i=!1,n()}}}function $t(l){let t,e,s,i,n,r;function c(){return l[44](l[54])}return{c(){t=d("div"),e=d("img"),i=w(),u(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),je(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])||u(e,"src",s),u(e,"alt","image"),u(t,"class","flex justify-center bg-black")},m(a,f){T(a,t,f),o(t,e),o(t,i),n||(r=[P(e,"load",l[25]),P(t,"click",c)],n=!0)},p(a,f){l=a,f[0]&65&&!je(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])&&u(e,"src",s)},d(a){a&&L(t),n=!1,_e(r)}}}function el(l){let t,e=l[55].ix>=0&&$t(l);return{c(){e&&e.c(),t=Re()},m(s,i){e&&e.m(s,i),T(s,t,i)},p(s,i){s[55].ix>=0?e?e.p(s,i):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&L(t)}}}function tl(l){let t,e,s,i;return{c(){t=d("div"),e=d("button"),e.textContent="More results ..",u(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),u(t,"class","flex items-center justify-center")},m(n,r){T(n,t,r),o(t,e),l[45](e),s||(i=P(e,"click",l[14]),s=!0)},p:G,d(n){n&&L(t),l[45](null),s=!1,i()}}}function ll(l){let t,e,s,i,n,r,c,a,f,p,_,g,m,h,b,v,C,E,F,q,H,y,x,k,M,S,j,D,O,I,A,R,K,X,ne,ce,J,se,ue;return{c(){t=d("div"),e=d("div"),s=d("div"),s.textContent="Info",i=w(),n=d("div"),n.textContent="X",r=w(),c=d("div"),a=d("div"),a.textContent="Description",f=w(),p=d("input"),g=w(),m=d("div"),h=d("div"),h.textContent="place",b=w(),v=d("input"),E=w(),F=d("div"),q=d("div"),q.textContent="Tags",H=w(),y=d("input"),k=w(),M=d("div"),S=d("div"),S.textContent="Taken at:",j=w(),D=d("input"),O=w(),I=d("div"),A=d("div"),A.textContent="device",R=w(),K=d("input"),ne=w(),ce=d("div"),J=d("button"),J.textContent="Save",u(s,"class","grow text-xl text-gray-100 font-bold"),u(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),u(e,"class","flex items-center"),u(a,"class","mb-1 text-gray-100"),u(p,"name","Description"),u(p,"placeholder",""),p.value=_=l[4].description.toString(),u(p,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(p,"type","text"),u(h,"class","mb-1 text-gray-100"),u(v,"name","place"),v.value=C=l[4].place.toString(),u(v,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(v,"type","text"),u(q,"class","mb-1 text-gray-100"),u(y,"name","tags"),u(y,"placeholder","Car, chair"),y.value=x=l[4].tags.toString(),u(y,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(y,"type","text"),u(S,"class","mb-1 text-gray-100"),u(D,"name","taken_at"),D.value="",u(D,"type","date"),u(D,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(A,"class","mb-1 text-gray-100"),u(K,"name","device"),u(K,"placeholder","Canon"),K.value=X=l[4].device.toString(),u(K,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(K,"type","text"),u(J,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),u(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(Q,ee){T(Q,t,ee),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,c),o(c,a),o(c,f),o(c,p),o(t,g),o(t,m),o(m,h),o(m,b),o(m,v),o(t,E),o(t,F),o(F,q),o(F,H),o(F,y),o(t,k),o(t,M),o(M,S),o(M,j),o(M,D),o(t,O),o(t,I),o(I,A),o(I,R),o(I,K),o(t,ne),o(t,ce),o(ce,J),se||(ue=[P(n,"click",l[39]),P(p,"change",l[23]),P(v,"change",l[23]),P(y,"change",l[23]),P(D,"change",l[23]),P(K,"change",l[23]),P(J,"click",l[24])],se=!0)},p(Q,ee){ee[0]&16&&_!==(_=Q[4].description.toString())&&p.value!==_&&(p.value=_),ee[0]&16&&C!==(C=Q[4].place.toString())&&v.value!==C&&(v.value=C),ee[0]&16&&x!==(x=Q[4].tags.toString())&&y.value!==x&&(y.value=x),ee[0]&16&&X!==(X=Q[4].device.toString())&&K.value!==X&&(K.value=X)},d(Q){Q&&L(t),se=!1,_e(ue)}}}function sl(l){let t,e,s,i,n=l[4].filename+"",r,c,a,f,p,_=l[4].data_hash+"",g,m,h,b,v,C=l[4].last_modified+"",E,F,q,H,y,x,k,M,S,j=l[4].description.toString()+"",D,O,I,A,R,K,X=l[4].taken_at.toString()+"",ne,ce,J,se,ue,Q,ee=l[4].tags.toString()+"",ge,be,fe,Ce,Se,De,de=l[4].place.toString()+"",qe,ve,xe,pe,te,re,N,B,V=l[4].person_ids.toString()+"",Z,z,we,Ie,Je,Ee,oe=l[4].device.toString()+"",Me,Ve,Ge,Ye,St,Ze,$e=l[4].resolution.toString()+"",_t,Dt,Ke,et,Ft,tt,lt=l[4].absolute_path.toString()+"",ht;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=d("div"),i=d("div"),r=U(n),c=w(),a=d("div"),f=U("UID: "),p=d("span"),g=U(_),m=w(),h=d("div"),b=U("Last Modified:  "),v=d("span"),E=U(C),F=w(),q=d("div"),H=d("div"),y=d("div"),x=d("div"),k=d("div"),k.textContent="Description",M=w(),S=d("div"),D=U(j),O=w(),I=d("div"),A=d("div"),A.textContent="Taken at",R=w(),K=d("div"),ne=U(X),ce=w(),J=d("div"),se=d("div"),se.textContent="Tags",ue=w(),Q=d("div"),ge=U(ee),be=w(),fe=d("div"),Ce=d("div"),Ce.textContent="Place",Se=w(),De=d("div"),qe=U(de),ve=w(),xe=d("div"),pe=d("div"),te=d("div"),re=d("div"),re.textContent="people",N=w(),B=d("div"),Z=U(V),z=w(),we=d("div"),Ie=d("div"),Ie.textContent="Device",Je=w(),Ee=d("div"),Me=U(oe),Ve=w(),Ge=d("div"),Ye=d("div"),Ye.textContent="Resolution",St=w(),Ze=d("div"),_t=U($e),Dt=w(),Ke=d("div"),et=d("div"),et.textContent="Path",Ft=w(),tt=d("div"),ht=U(lt),u(i,"class","text-xl text-white"),u(p,"class","text-sm text-gray-400"),u(a,"class","text-white"),u(v,"class","text-sm text-gray-400"),u(h,"class","text-white"),u(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),u(k,"class",""),u(S,"class","text-sm text-gray-400"),u(A,"class",""),u(K,"class","text-sm text-gray-400"),u(se,"class",""),u(Q,"class","text-sm text-gray-400"),u(Ce,"class",""),u(De,"class","text-sm text-gray-400"),u(y,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(H,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),u(re,"class",""),u(B,"class","text-sm text-gray-400"),u(Ie,"class",""),u(Ee,"class","text-sm text-gray-400"),u(Ye,"class",""),u(Ze,"class","text-sm text-gray-400"),u(et,"class",""),u(tt,"class","text-sm text-gray-400"),u(pe,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(xe,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),u(q,"class","flex w-full justify-center p-4")},m(Y,ie){T(Y,t,ie),T(Y,e,ie),T(Y,s,ie),o(s,i),o(i,r),o(s,c),o(s,a),o(a,f),o(a,p),o(p,g),o(s,m),o(s,h),o(h,b),o(h,v),o(v,E),T(Y,F,ie),T(Y,q,ie),o(q,H),o(H,y),o(y,x),o(x,k),o(x,M),o(x,S),o(S,D),o(y,O),o(y,I),o(I,A),o(I,R),o(I,K),o(K,ne),o(y,ce),o(y,J),o(J,se),o(J,ue),o(J,Q),o(Q,ge),o(y,be),o(y,fe),o(fe,Ce),o(fe,Se),o(fe,De),o(De,qe),o(q,ve),o(q,xe),o(xe,pe),o(pe,te),o(te,re),o(te,N),o(te,B),o(B,Z),o(pe,z),o(pe,we),o(we,Ie),o(we,Je),o(we,Ee),o(Ee,Me),o(pe,Ve),o(pe,Ge),o(Ge,Ye),o(Ge,St),o(Ge,Ze),o(Ze,_t),o(pe,Dt),o(pe,Ke),o(Ke,et),o(Ke,Ft),o(Ke,tt),o(tt,ht)},p(Y,ie){ie[0]&16&&n!==(n=Y[4].filename+"")&&W(r,n),ie[0]&16&&_!==(_=Y[4].data_hash+"")&&W(g,_),ie[0]&16&&C!==(C=Y[4].last_modified+"")&&W(E,C),ie[0]&16&&j!==(j=Y[4].description.toString()+"")&&W(D,j),ie[0]&16&&X!==(X=Y[4].taken_at.toString()+"")&&W(ne,X),ie[0]&16&&ee!==(ee=Y[4].tags.toString()+"")&&W(ge,ee),ie[0]&16&&de!==(de=Y[4].place.toString()+"")&&W(qe,de),ie[0]&16&&V!==(V=Y[4].person_ids.toString()+"")&&W(Z,V),ie[0]&16&&oe!==(oe=Y[4].device.toString()+"")&&W(Me,oe),ie[0]&16&&$e!==($e=Y[4].resolution.toString()+"")&&W(_t,$e),ie[0]&16&&lt!==(lt=Y[4].absolute_path.toString()+"")&&W(ht,lt)},d(Y){Y&&L(t),Y&&L(e),Y&&L(s),Y&&L(F),Y&&L(q)}}}function nl(l){let t,e,s;function i(...n){return l[28](l[52],...n)}return{c(){t=d("div"),u(t,"data-ix",l[54]),u(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ae(t,"top",l[52].top+"px "),ae(t,"left",l[52].left+"px"),ae(t,"width",l[52].width+"px"),ae(t,"height",l[52].height+"px")},m(n,r){T(n,t,r),e||(s=P(t,"click",i),e=!0)},p(n,r){l=n,r[0]&2048&&ae(t,"top",l[52].top+"px "),r[0]&2048&&ae(t,"left",l[52].left+"px"),r[0]&2048&&ae(t,"width",l[52].width+"px"),r[0]&2048&&ae(t,"height",l[52].height+"px")},d(n){n&&L(t),e=!1,s()}}}function il(l){let t,e,s,i,n,r,c;return{c(){t=d("div"),e=d("input"),i=w(),n=d("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[9]],u(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),u(e,"placeholder","Enter person id"),u(e,"type","text"),u(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),u(t,"class","absolute flex h-auto w-240 bg-blue-300"),ae(t,"top",l[10].top+"px "),ae(t,"left",l[10].left+"px")},m(a,f){T(a,t,f),o(t,e),o(t,i),o(t,n),e.focus(),r||(c=[P(e,"keyup",l[22]),P(n,"click",l[29])],r=!0)},p(a,f){f[0]&528&&s!==(s=a[4].person_ids[a[9]])&&e.value!==s&&(e.value=s),f[0]&1024&&ae(t,"top",a[10].top+"px "),f[0]&1024&&ae(t,"left",a[10].left+"px")},d(a){a&&L(t),r=!1,_e(c)}}}function Gl(l){let t,e,s,i;const n=[Vl,Ul,Rl],r=[];function c(a,f){return a[2].image_card_fullscreen===!0?0:a[2].image_card===!0?1:2}return t=c(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(a,f){r[t].m(a,f),T(a,s,f),i=!0},p(a,f){let p=t;t=c(a),t===p?r[t].p(a,f):(ft(),le(r[p],1,1,()=>{r[p]=null}),dt(),e=r[t],e?e.p(a,f):(e=r[t]=n[t](a),e.c()),$(e,1),e.m(s.parentNode,s))},i(a){i||($(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&L(s)}}}let Fe=20;function gt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let i=0;i<l.length;i++){let n=i;t[i%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[i][e]}):s.push({ix:n,score:l[i]})}return s.sort((i,n)=>i.score>n.score?-1:i.score<n.score?1:0),s}function Kl(l,t,e){const s=ut();let{show_exit_interface_button:i=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,r=!0;ct(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),rt.update(N=>[])});let c={},a=!1,f=[],p=[],_=0,g=0,m=0,h,b=!1;function v(N){b=!0,h&&e(8,h.disabled=!0,h),g=0,e(7,m=0),e(27,_=_+Fe),e(6,f=p.slice(_,_+Fe)),rt.update(B=>C(f))}function C(N){let B=[],V=N.length;for(let Z=0;Z<V;Z++){let z=N[Z].ix;B.push(n.list_metaData[z])}return B}Pe.subscribe(N=>{e(7,m=N.progress),N.done==!0?(E(N),e(7,m=0)):(e(27,_=0),e(6,f=[]))});function E(N){e(26,p=gt(N.list_score)),e(6,f=p.slice(0,0+Fe)),rt.update(B=>C(f))}let F={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function q(N){let B=Object.keys(F);for(let V=0;V<B.length;V++)e(2,F[B[V]]=!1,F);e(2,F[N]=!0,F)}let H,y={active:!1,top:null,left:null};function x(N){let B={sorted_ix:null,image_ix:null};for(let V=N;V<f.length;V++)if(f[V].ix!==-1){B.image_ix=f[V].ix,B.sorted_ix=V;break}return B}function k(N){K={},e(5,a=!1),e(11,j=[]),e(10,y={active:!1,top:null,left:null});let B=N,V=f.length;B<0&&(B=V-1),B>V-1&&(B=0);let Z=x(B),z=Z.image_ix;B=Z.sorted_ix,z===null&&(Z=x(0),z=Z.image_ix,B=Z.sorted_ix),e(4,c.ix=B,c),e(4,c.data_hash=n.list_dataHash[z],c),e(4,c.height=Number(n.list_metaData[z].height),c),e(4,c.width=Number(n.list_metaData[z].width),c),e(4,c.face_bboxes=n.list_metaData[z].face_bboxes,c),e(4,c.person_ids=n.list_metaData[z].person,c),c.person_ids===null&&e(4,c.person_ids=[],c),e(4,c.resolution=c.height.toString()+" X "+c.width.toString(),c),e(4,c.filename=n.list_metaData[z].filename,c),e(4,c.taken_at=n.list_metaData[z].taken_at,c),c.taken_at==null&&e(4,c.taken_at="Unknown",c),e(4,c.last_modified=n.list_metaData[z].modified_at,c),e(4,c.device=n.list_metaData[z].device,c),c.device==null&&e(4,c.device="",c),e(4,c.place=n.list_metaData[z].place,c),e(4,c.absolute_path=n.list_metaData[z].absolute_path,c),e(4,c.description=n.list_metaData[z].description,c),e(4,c.tags=n.list_metaData[z].tags,c),e(5,a=!0)}function M(){k(c.ix+1)}function S(){k(c.ix-1)}let j=[];function D(N){let B=N.target.getClientRects()[0],V=B.width,Z=B.height,z=[],we=c.face_bboxes;if(we){let Ie=c.width,Je=c.height;for(let Ee=0;Ee<we.length;Ee++){let oe=structuredClone(we[Ee]),Me=Number(V)/(Number(Ie)+1e-4),Ve=Number(Z)/(Number(Je)+1e-4);oe.top=oe[1]*Ve,oe.height=(oe[3]-oe[1])*Ve,oe.left=oe[0]*Me,oe.width=(oe[2]-oe[0])*Me,z.push(oe)}}console.log(z),e(11,j=z)}let O=0;function I(){let N=f[0].score,B=f[f.length-1].score,Z=n.list_score.map(z=>(z-B)/(N-B+1e-5)).map(z=>z>=O?1:0);e(6,f=gt(n.list_score,Z))}function A(N){e(3,r=!0);let B=p.slice(_,_+Fe);for(let V=0;V<N.length;V++)N[V]==0?e(6,f[V].ix=-1,f):e(6,f[V].ix=B[V].ix,f);e(3,r=!1)}function R(N){let B=N.target.value,V=c.data_hash,Z=c.person_ids[H];if(N.key=="Enter"){let z=new FormData;z.append("new_person_id",B),z.append("old_person_id",Z),z.append("data_hash",V),fetch("/api/tagPerson",{method:"POST",body:z}).then(we=>{if(we.ok)alert("Success");else throw new Error("Error occured")})}}let K={};function X(N){K[N.target.name.toLowerCase()]=N.target.value}async function ne(N){N.target.disabled=!0,N.target.innerText="Saving...";let B=Object.keys(K),V=new FormData;for(let z=0;z<B.length;z++)V.append(B[z],K[B[z]]);V.append("data_hash",c.data_hash);let Z=await fetch("/api/editMetaData",{method:"POST",body:V});Z.ok?(alert("Success!"),await Z.json(),e(2,F.image_card_edit_interface=!1,F)):alert("Error while saving. Contact Admin"),N.target.innerText="Save",N.target.disabled=!1}function ce(N){b&&(g+=1,e(7,m+=1/Fe),g==Math.min(f.length,Fe)&&(e(7,m=0),b=!1),h&&e(8,h.disabled=!1,h))}const J=(N,B)=>{e(10,y={active:!0,top:N.top-28,left:N.left}),e(9,H=Number(B.target.attributes["data-ix"].value))},se=()=>{e(10,y.active=!1,y)},ue=()=>{S()},Q=()=>{M()},ee=()=>{q("parent")},ge=()=>{q("image_card")},be=()=>{q("parent")},fe=()=>{q("image_card_fullscreen")},Ce=()=>{S()},Se=()=>{console.log("hellll"),q("image_card_fullscreen")},De=()=>{e(2,F.image_card_edit_interface=!0,F)},de=()=>{e(2,F.image_card_edit_interface=!1,F)},qe=()=>{M()},ve=()=>{console.log("pressed me!!!"),e(6,f=[]),s("exitButtonPressed")},xe=N=>{A(N.detail.mask)};function pe(){O=hl(this.value),e(12,O)}const te=N=>{k(N),q("image_card")};function re(N){He[N?"unshift":"push"](()=>{h=N,e(8,h)})}return l.$$set=N=>{"show_exit_interface_button"in N&&e(1,i=N.show_exit_interface_button),"image_data"in N&&e(0,n=N.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&201326593&&n&&(e(26,p=gt(n.list_score)),n.done==!1&&e(6,f=p.slice(_,_+Fe))),l.$$.dirty[0]&4&&F){let N=!1;(F.image_card==!0||F.image_card_fullscreen==!0)&&(N=!0),s("imageCardActive",{active:N})}},[n,i,F,r,c,a,f,m,h,H,y,j,O,s,v,q,k,M,S,D,I,A,R,X,ne,ce,p,_,J,se,ue,Q,ee,ge,be,fe,Ce,Se,De,de,qe,ve,xe,pe,te,re]}class Ct extends Te{constructor(t){super(),Le(this,t,Kl,Gl,Oe,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const Xl="/assets/sample_place_bg-38f3fbd4.jpg";function rl(l,t,e){const s=l.slice();return s[10]=t[e],s}function Ql(l){let t,e,s,i,n,r,c,a,f,p,_,g=l[0].people,m=[];for(let h=0;h<g.length;h+=1)m[h]=ol(rl(l,g,h));return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("div"),n=d("div"),n.textContent="People Album",r=w(),c=d("div"),a=d("input"),f=w();for(let h=0;h<m.length;h+=1)m[h].c();u(n,"class","flex text-lg font-semibold"),u(a,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),u(a,"type","text"),u(a,"placeholder","Search person"),u(c,"class","flex"),u(i,"class","flex w-full justify-between items-center"),u(s,"class","flex w-screen h-[80px]"),u(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),u(t,"class","flex w-full justify-center items-center")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(i,n),o(i,r),o(i,c),o(c,a),o(e,f);for(let v=0;v<m.length;v+=1)m[v].m(e,null);p||(_=P(a,"input",l[5]),p=!0)},p(h,b){if(b&17){g=h[0].people;let v;for(v=0;v<g.length;v+=1){const C=rl(h,g,v);m[v]?m[v].p(C,b):(m[v]=ol(C),m[v].c(),m[v].m(e,null))}for(;v<m.length;v+=1)m[v].d(1);m.length=g.length}},i:G,o:G,d(h){h&&L(t),ye(m,h),p=!1,_()}}}function Wl(l){let t,e;return t=new Ct({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){ke(t.$$.fragment)},m(s,i){he(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||($(t.$$.fragment,s),e=!0)},o(s){le(t.$$.fragment,s),e=!1},d(s){me(t,s)}}}function Jl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:G,i:G,o:G,d(e){e&&L(t)}}}function ol(l){let t,e,s,i,n,r,c,a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",f,p,_,g;function m(...h){return l[7](l[10],...h)}return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("img"),r=w(),c=d("div"),f=U(a),p=w(),u(i,"loading","lazy"),je(i.src,n="/api/getPreviewPerson/"+l[10])||u(i,"src",n),u(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[160px] w-[160px] bg-gray-800"),u(c,"class","flex text-md text-black justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,c),o(c,f),o(t,p),_||(g=P(t,"click",m),_=!0)},p(h,b){l=h,b&1&&!je(i.src,n="/api/getPreviewPerson/"+l[10])&&u(i,"src",n),b&1&&a!==(a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&W(f,a)},d(h){h&&L(t),_=!1,g()}}}function Yl(l){let t,e,s,i;const n=[Jl,Wl,Ql],r=[];function c(a,f){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(a,f){r[t].m(a,f),T(a,s,f),i=!0},p(a,[f]){let p=t;t=c(a),t===p?r[t].p(a,f):(ft(),le(r[p],1,1,()=>{r[p]=null}),dt(),e=r[t],e?e.p(a,f):(e=r[t]=n[t](a),e.c()),$(e,1),e.m(s.parentNode,s))},i(a){i||($(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&L(s)}}}function Zl(l,t,e){let s={people:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,c=!0,a;Ue(()=>{e(3,c=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{let b=h.meta_data.length;for(let v=0;v<b;v++)i.list_dataHash.push(h.data_hash[v]),i.list_score.push(h.score[v]),i.list_metaData.push(h.meta_data[v]);e(3,c=!0),e(0,s.people=h.person,s),a=s.people})})}),ct(()=>{console.log("destroying... people..")});async function f(m){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let h=0;h<i.list_dataHash.length;h++)i.list_metaData[h].person.includes(m)&&(n.list_metaData.push(i.list_metaData[h]),n.list_dataHash.push(i.list_dataHash[h]),n.list_score.push(i.list_score[h]));e(1,n.done=!0,n),e(2,r=!0),a&&e(0,s.people=a,s),Pe.update(h=>structuredClone(n))}function p(m){let h=m.target.value;if(h=h.toLowerCase(),!h){a&&e(0,s.people=a,s);return}h&&c==!0&&a&&(e(0,s.people=[],s),a.forEach(b=>{b.toLowerCase().includes(h)&&s.people.push(b)}))}return[s,n,r,c,f,p,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,h)=>{console.log("mine is: ",m),f(m)}]}class $l extends Te{constructor(t){super(),Le(this,t,Zl,Yl,Oe,{})}}function al(l,t,e){const s=l.slice();return s[8]=t[e],s}function es(l){let t,e,s,i=l[0].places,n=[];for(let r=0;r<i.length;r+=1)n[r]=cl(al(l,i,r));return{c(){t=d("div"),e=w(),s=d("div");for(let r=0;r<n.length;r+=1)n[r].c();u(t,"class","flex w-screen h-[80px] bg-blue-100"),u(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,c){T(r,t,c),T(r,e,c),T(r,s,c);for(let a=0;a<n.length;a+=1)n[a].m(s,null)},p(r,c){if(c&17){i=r[0].places;let a;for(a=0;a<i.length;a+=1){const f=al(r,i,a);n[a]?n[a].p(f,c):(n[a]=cl(f),n[a].c(),n[a].m(s,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},i:G,o:G,d(r){r&&L(t),r&&L(e),r&&L(s),ye(n,r)}}}function ts(l){let t,e;return t=new Ct({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){ke(t.$$.fragment)},m(s,i){he(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||($(t.$$.fragment,s),e=!0)},o(s){le(t.$$.fragment,s),e=!1},d(s){me(t,s)}}}function ls(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:G,i:G,o:G,d(e){e&&L(t)}}}function cl(l){let t,e,s,i,n,r,c,a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",f,p,_,g;function m(...h){return l[6](l[8],...h)}return{c(){t=d("div"),e=d("div"),s=d("div"),i=d("img"),r=w(),c=d("div"),f=U(a),p=w(),je(i.src,n=Xl)||u(i,"src",n),u(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[150px] w-[200px] bg-gray-800"),u(c,"class","flex text-xl text-white justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,c),o(c,f),o(t,p),_||(g=P(t,"click",m),_=!0)},p(h,b){l=h,b&1&&a!==(a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&W(f,a)},d(h){h&&L(t),_=!1,g()}}}function ss(l){let t,e,s,i;const n=[ls,ts,es],r=[];function c(a,f){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=n[t](l),{c(){e.c(),s=Re()},m(a,f){r[t].m(a,f),T(a,s,f),i=!0},p(a,[f]){let p=t;t=c(a),t===p?r[t].p(a,f):(ft(),le(r[p],1,1,()=>{r[p]=null}),dt(),e=r[t],e?e.p(a,f):(e=r[t]=n[t](a),e.c()),$(e,1),e.m(s.parentNode,s))},i(a){i||($(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&L(s)}}}function ns(l,t,e){let s={places:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,c=!0;Ue(()=>{e(3,c=!1),fetch("/api/getGroup/place").then(_=>{_.json().then(g=>{let m=g.meta_data.length;for(let h=0;h<m;h++)i.list_dataHash.push(g.data_hash[h]),i.list_score.push(g.score[h]),i.list_metaData.push(g.meta_data[h]);e(3,c=!0),e(0,s.places=g.place,s)})})}),ct(()=>{console.log("destroying...")});async function a(_){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Pe.update(g=>structuredClone(n));for(let g=0;g<i.list_dataHash.length;g++)i.list_metaData[g].place.toLowerCase()===_.toLowerCase()&&(n.list_metaData.push(i.list_metaData[g]),n.list_dataHash.push(i.list_dataHash[g]),n.list_score.push(i.list_score[g]));e(1,n.done=!0,n),e(2,r=!0),Pe.update(g=>structuredClone(n))}return[s,n,r,c,a,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),a(_)}]}class is extends Te{constructor(t){super(),Le(this,t,ns,ss,Oe,{})}}function ul(l){let t,e,s,i,n,r;return{c(){t=d("div"),e=d("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=w(),i=d("div"),i.textContent="X",u(e,"class","flex-1"),u(i,"class","flex text-xl hover:orange-900 cursor-pointer"),u(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),u(t,"role","alert")},m(c,a){T(c,t,a),o(t,e),o(t,s),o(t,i),n||(r=P(i,"click",l[9]),n=!0)},p:G,d(c){c&&L(t),n=!1,r()}}}function rs(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),n=new $l({}),{c(){t=d("div"),ke(e.$$.fragment),s=w(),i=d("div"),ke(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),he(e,t,null),o(t,s),o(t,i),he(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(n.$$.fragment,c),r=!1},d(c){c&&L(t),me(e),me(n)}}}function os(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new is({}),{c(){t=d("div"),ke(e.$$.fragment),s=w(),i=d("div"),ke(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),he(e,t,null),o(t,s),o(t,i),he(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(n.$$.fragment,c),r=!1},d(c){c&&L(t),me(e),me(n)}}}function as(l){let t,e,s,i,n,r;return e=new pt({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new Tl({}),{c(){t=d("div"),ke(e.$$.fragment),s=w(),i=d("div"),ke(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),he(e,t,null),o(t,s),o(t,i),he(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(n.$$.fragment,c),r=!1},d(c){c&&L(t),me(e),me(n)}}}function cs(l){let t,e,s,i,n,r,c,a;return e=new pt({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),n=new Dl({props:{query_button_disabled:l[2]}}),n.$on("queryReady",l[12]),c=new Ct({props:{image_data:l[1]}}),{c(){t=d("div"),ke(e.$$.fragment),s=w(),i=d("div"),ke(n.$$.fragment),r=w(),ke(c.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),u(t,"class","flex")},m(f,p){T(f,t,p),he(e,t,null),o(t,s),o(t,i),he(n,i,null),o(i,r),he(c,i,null),a=!0},p(f,p){const _={};p&64&&(_.sidebarOpen=f[6]),e.$set(_);const g={};p&4&&(g.query_button_disabled=f[2]),n.$set(g);const m={};p&2&&(m.image_data=f[1]),c.$set(m)},i(f){a||($(e.$$.fragment,f),$(n.$$.fragment,f),$(c.$$.fragment,f),a=!0)},o(f){le(e.$$.fragment,f),le(n.$$.fragment,f),le(c.$$.fragment,f),a=!1},d(f){f&&L(t),me(e),me(n),me(c)}}}function us(l){let t,e,s,i,n,r=l[0]&&ul(l);const c=[cs,as,os,rs],a=[];function f(p,_){return p[5].query.status?0:p[5].indexing.status===!0?1:p[5].place_album.status===!0?2:p[5].people_album.status===!0?3:-1}return~(e=f(l))&&(s=a[e]=c[e](l)),{c(){r&&r.c(),t=w(),s&&s.c(),i=Re()},m(p,_){r&&r.m(p,_),T(p,t,_),~e&&a[e].m(p,_),T(p,i,_),n=!0},p(p,[_]){p[0]?r?r.p(p,_):(r=ul(p),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null);let g=e;e=f(p),e===g?~e&&a[e].p(p,_):(s&&(ft(),le(a[g],1,1,()=>{a[g]=null}),dt()),~e?(s=a[e],s?s.p(p,_):(s=a[e]=c[e](p),s.c()),$(s,1),s.m(i.parentNode,i)):s=null)},i(p){n||($(s),n=!0)},o(p){le(s),n=!1},d(p){r&&r.d(p),p&&L(t),~e&&a[e].d(p),p&&L(i)}}}let fs=3;function ds(l,t,e){let s=!1;Ue(()=>{fetch("/api/getMetaStats").then(j=>{j.ok?j.json().then(D=>{Number(D.image.count)==0&&e(0,s=!0),wt.update(O=>Number(D.image.count)),xt.update(O=>Number(D.image.unique_place_count)),yt.update(O=>Number(D.image.unique_people_count))}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let i=[],n=[],r=[],c,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},f=!1,p="",_={};async function g(j="xxxxxxx",D=!1){console.log("handleClick count",p,D,j),e(2,f=!0);let O=fs;if(c=new FormData,p.length===0)return;c.append("query",p),c.append("topk",O.toString()),D==!1?(n=[],i=[],r=[],e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),c.append("query_start","true"),Pe.update(J=>a)):(c.append("query_start","false"),c.append("client_id",j));let A=await fetch("/api/query",{method:"POST",body:c});if(!A.ok)throw e(2,f=!1),new Error(A);let R=await A.json();console.log("data: ",R);let K=R.client_id,X=R.meta_data,ne=R.data_hash,ce=R.score;Number(R.progress);for(let J=0;J<X.length;J++){let se=ne[J],ue=Number(ce[J]),Q=n.indexOf(se);Q>=0?(i[Q]+=ue,e(1,a.list_score[Q]+=ue,a)):(n.push(se),i.push(ue),r.push(X[J]),a.list_dataHash.push(se),a.list_score.push(ue),a.list_metaData.push(X[J]))}if(R.query_completed==!0?(e(1,a.done=!0,a),e(1,a.progress=1e-4,a)):(e(1,a),e(1,a.progress+=.12,a),e(1,a.progress=Math.min(a.progress,.92),a)),R.query_completed==!0){e(2,f=!1),console.log("hey i am being called!!!"),Pe.update(J=>a);return}await g(K,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function h(j){m[j].status==!1&&(e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Pe.update(O=>structuredClone(a)));let D=Object.keys(m);for(let O=0;O<D.length;O++)m[D[O]].status&&e(5,m[D[O]].status=!1,m);m[j]&&e(5,m[j].status=!0,m)}let b=!0;function v(j){let D=j.detail.item.name;D.toLowerCase().includes("photo")?h("query"):D.toLowerCase().includes("index")?h("indexing"):D.toLowerCase().includes("people")?h("people_album"):D.toLowerCase().includes("place")&&h("place_album")}return[s,a,f,p,_,m,b,g,v,()=>e(0,s=!1),j=>{v(j)},j=>{e(6,b=j.detail.open)},j=>{e(3,p=j.detail.query),e(4,_=j.detail.attributes),g()},j=>v(j),j=>{e(6,b=j.detail.open)},j=>v(j),j=>{e(6,b=j.detail.open)},j=>v(j),j=>{e(6,b=j.detail.open)}]}class ps extends Te{constructor(t){super(),Le(this,t,ds,us,Oe,{})}}new ps({target:document.getElementById("app")});
