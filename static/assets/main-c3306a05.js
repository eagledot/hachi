(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function V(){}function sl(l){return l()}function xt(){return Object.create(null)}function fe(l){l.forEach(sl)}function il(l){return typeof l=="function"}function xe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let et;function ye(l,t){return et||(et=document.createElement("a")),et.href=t,l===et.href}function cl(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function H(l,t,e){l.insertBefore(t,e||null)}function q(l){l.parentNode&&l.parentNode.removeChild(l)}function ge(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function M(l){return document.createTextNode(l)}function x(){return M(" ")}function Ne(){return M("")}function P(l,t,e,n){return l.addEventListener(t,e,n),()=>l.removeEventListener(t,e,n)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function ul(l){return l===""?null:+l}function fl(l){return Array.from(l.childNodes)}function Q(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function Pe(l,t){l.value=t??""}function ue(l,t,e,n){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,n?"important":"")}function Ct(l,t){for(let e=0;e<l.options.length;e+=1){const n=l.options[e];if(n.__value===t){n.selected=!0;return}}l.selectedIndex=-1}function dl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function _l(l,t,{bubbles:e=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,e,n,t),i}let ze;function Re(l){ze=l}function mt(){if(!ze)throw new Error("Function called outside component initialization");return ze}function Ue(l){mt().$$.on_mount.push(l)}function it(l){mt().$$.on_destroy.push(l)}function rt(){const l=mt();return(t,e,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[t];if(i){const s=_l(t,e,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}const Te=[],qe=[],tt=[],St=[],pl=Promise.resolve();let ht=!1;function hl(){ht||(ht=!0,pl.then(rl))}function st(l){tt.push(l)}const _t=new Set;let He=0;function rl(){if(He!==0)return;const l=ze;do{try{for(;He<Te.length;){const t=Te[He];He++,Re(t),ml(t.$$)}}catch(t){throw Te.length=0,He=0,t}for(Re(null),Te.length=0,He=0;qe.length;)qe.pop()();for(let t=0;t<tt.length;t+=1){const e=tt[t];_t.has(e)||(_t.add(e),e())}tt.length=0}while(Te.length);for(;St.length;)St.pop()();ht=!1,_t.clear(),Re(l)}function ml(l){if(l.fragment!==null){l.update(),fe(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(st)}}const lt=new Set;let Oe;function ot(){Oe={r:0,c:[],p:Oe}}function at(){Oe.r||fe(Oe.c),Oe=Oe.p}function Z(l,t){l&&l.i&&(lt.delete(l),l.i(t))}function le(l,t,e,n){if(l&&l.o){if(lt.has(l))return;lt.add(l),Oe.c.push(()=>{lt.delete(l),n&&(e&&l.d(1),n())}),l.o(t)}else n&&n()}function me(l){l&&l.c()}function de(l,t,e,n){const{fragment:i,after_update:s}=l.$$;i&&i.m(t,e),n||st(()=>{const r=l.$$.on_mount.map(sl).filter(il);l.$$.on_destroy?l.$$.on_destroy.push(...r):fe(r),l.$$.on_mount=[]}),s.forEach(st)}function _e(l,t){const e=l.$$;e.fragment!==null&&(fe(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function gl(l,t){l.$$.dirty[0]===-1&&(Te.push(l),hl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function De(l,t,e,n,i,s,r,c=[-1]){const a=ze;Re(l);const u=l.$$={fragment:null,ctx:[],props:s,update:V,not_equal:i,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:xt(),dirty:c,skip_bound:!1,root:t.target||a.$$.root};r&&r(u.root);let h=!1;if(u.ctx=e?e(l,t.props||{},(_,g,...m)=>{const p=m.length?m[0]:g;return u.ctx&&i(u.ctx[_],u.ctx[_]=p)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](p),h&&gl(l,_)),g}):[],u.update(),h=!0,fe(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){const _=fl(t.target);u.fragment&&u.fragment.l(_),_.forEach(q)}else u.fragment&&u.fragment.c();t.intro&&Z(l.$$.fragment),de(l,t.target,t.anchor,t.customElement),rl()}Re(a)}class Fe{$destroy(){_e(this,1),this.$destroy=V}$on(t,e){if(!il(e))return V;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const i=n.indexOf(e);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!cl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Dt(l,t,e){const n=l.slice();return n[25]=t[e],n}function Ft(l,t,e){const n=l.slice();return n[28]=t[e],n}function jt(l,t,e){const n=l.slice();return n[28]=t[e],n}function Ot(l,t,e){const n=l.slice();return n[33]=t[e],n}function qt(l){let t,e,n,i=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",s,r,c,a,u,h,_,g=l[4][l[28]],m=[];for(let b=0;b<g.length;b+=1)m[b]=Et(Ot(l,g,b));function p(){return l[14](l[28])}function k(...b){return l[15](l[28],...b)}return{c(){t=d("div"),e=d("span"),n=d("span"),s=M(i),r=x();for(let b=0;b<m.length;b+=1)m[b].c();c=x(),a=d("span"),a.textContent="x",u=x(),f(n,"class","text-blue-800 "),f(e,"class","cursor-pointer"),f(a,"class","ml-2 text-red-600 cursor-pointer hover:text-blue-500"),f(t,"class","px-4 py-2 self-center bg-blue-200 rounded-md inline-flex place-self-center items-center mr-2 mb-2 h-10")},m(b,C){H(b,t,C),o(t,e),o(e,n),o(n,s),o(e,r);for(let D=0;D<m.length;D+=1)m[D].m(e,null);o(t,c),o(t,a),o(t,u),h||(_=[P(e,"click",p),P(a,"click",k)],h=!0)},p(b,C){if(l=b,C[0]&16&&i!==(i=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"")&&Q(s,i),C[0]&16){g=l[4][l[28]];let D;for(D=0;D<g.length;D+=1){const L=Ot(l,g,D);m[D]?m[D].p(L,C):(m[D]=Et(L),m[D].c(),m[D].m(e,null))}for(;D<m.length;D+=1)m[D].d(1);m.length=g.length}},d(b){b&&q(t),ge(m,b),h=!1,fe(_)}}}function Et(l){let t,e=l[33]+" ",n;return{c(){t=d("span"),n=M(e),f(t,"class","ml-1")},m(i,s){H(i,t,s),o(t,n)},p(i,s){s[0]&16&&e!==(e=i[33]+" ")&&Q(n,e)},d(i){i&&q(t)}}}function It(l){let t,e=l[4][l[28]].length>=1&&qt(l);return{c(){e&&e.c(),t=Ne()},m(n,i){e&&e.m(n,i),H(n,t,i)},p(n,i){n[4][n[28]].length>=1?e?e.p(n,i):(e=qt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&q(t)}}}function Ht(l){let t,e=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",n,i,s;return{c(){t=d("option"),n=M(e),i=x(),t.__value=s=l[28],t.value=t.__value},m(r,c){H(r,t,c),o(t,n),o(t,i)},p(r,c){c[0]&16&&e!==(e=r[28].charAt(0).toUpperCase()+r[28].slice(1)+"")&&Q(n,e),c[0]&16&&s!==(s=r[28])&&(t.__value=s,t.value=t.__value)},d(r){r&&q(t)}}}function Lt(l){let t,e,n,i,s,r,c,a,u=l[3],h=[];for(let _=0;_<u.length;_+=1)h[_]=Tt(Dt(l,u,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<h.length;_+=1)h[_].c();n=x(),i=d("div"),s=d("button"),s.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(s,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(i,"class","flex w-full justify-center items-center"),f(t,"class",r=(l[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,g){H(_,t,g),o(t,e);for(let m=0;m<h.length;m+=1)h[m].m(e,null);o(t,n),o(t,i),o(i,s),c||(a=P(s,"click",l[22]),c=!0)},p(_,g){if(g[0]&522){u=_[3];let m;for(m=0;m<u.length;m+=1){const p=Dt(_,u,m);h[m]?h[m].p(p,g):(h[m]=Tt(p),h[m].c(),h[m].m(e,null))}for(;m<h.length;m+=1)h[m].d(1);h.length=u.length}g[0]&64&&r!==(r=(_[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",r)},d(_){_&&q(t),ge(h,_),c=!1,a()}}}function Tt(l){let t,e=l[25]+"",n,i,s,r;function c(){return l[21](l[25])}return{c(){t=d("li"),n=M(e),i=x(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(a,u){H(a,t,u),o(t,n),o(t,i),s||(r=P(t,"click",c),s=!0)},p(a,u){l=a,u[0]&8&&e!==(e=l[25]+"")&&Q(n,e)},d(a){a&&q(t),s=!1,r()}}}function bl(l){let t,e,n,i,s,r,c,a,u,h,_,g,m,p,k,b,C=Object.keys(l[4]),D=[];for(let v=0;v<C.length;v+=1)D[v]=It(jt(l,C,v));let L=Object.keys(l[4]),j=[];for(let v=0;v<L.length;v+=1)j[v]=Ht(Ft(l,L,v));let F=l[3].length>0&&Lt(l);return{c(){t=d("div"),e=d("div"),n=d("form"),i=d("div");for(let v=0;v<D.length;v+=1)D[v].c();s=x(),r=d("div"),c=d("select");for(let v=0;v<j.length;v+=1)j[v].c();a=x(),u=d("div"),h=d("input"),_=x(),g=d("div"),m=d("button"),m.textContent="Search",p=x(),F&&F.c(),f(i,"class","flex w-full items-center my-2 flex-wrap"),f(c,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(c,"name","select-option"),f(c,"id","select-option"),l[1]===void 0&&st(()=>l[17].call(c)),f(h,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(h,"type","search"),f(h,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(g,"class","flex"),f(r,"class","flex space-x-2"),f(n,"class","w-full"),f(n,"action",""),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(v,S){H(v,t,S),o(t,e),o(e,n),o(n,i);for(let w=0;w<D.length;w+=1)D[w].m(i,null);o(n,s),o(n,r),o(r,c);for(let w=0;w<j.length;w+=1)j[w].m(c,null);Ct(c,l[1]),o(r,a),o(r,u),o(u,h),l[18](h),Pe(h,l[5]),o(r,_),o(r,g),o(g,m),l[20](m),o(e,p),F&&F.m(e,null),k||(b=[P(c,"change",l[16]),P(c,"change",l[17]),P(h,"input",l[19]),P(h,"input",l[7]),P(m,"click",l[12]),P(n,"submit",l[11])],k=!0)},p(v,S){if(S[0]&1296){C=Object.keys(v[4]);let w;for(w=0;w<C.length;w+=1){const y=jt(v,C,w);D[w]?D[w].p(y,S):(D[w]=It(y),D[w].c(),D[w].m(i,null))}for(;w<D.length;w+=1)D[w].d(1);D.length=C.length}if(S[0]&16){L=Object.keys(v[4]);let w;for(w=0;w<L.length;w+=1){const y=Ft(v,L,w);j[w]?j[w].p(y,S):(j[w]=Ht(y),j[w].c(),j[w].m(c,null))}for(;w<j.length;w+=1)j[w].d(1);j.length=L.length}S[0]&18&&Ct(c,v[1]),S[0]&32&&Pe(h,v[5]),v[3].length>0?F?F.p(v,S):(F=Lt(v),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:V,o:V,d(v){v&&q(t),ge(D,v),ge(j,v),l[18](null),l[20](null),F&&F.d(),k=!1,fe(b)}}}async function vl(l,t){let e="/api/getSuggestion",n=new FormData;n.append("attribute",l),n.append("query",t);let i=await fetch(e,{method:"POST",body:n});return i.ok===!0?await i.json():{}}function kl(l,t,e){const n=rt();let i="query",s,r,{query_button_disabled:c=!1}=t,a="",u=[],h={person:[],query:[],place:[],filename:[]},_="",g=!1;async function m(O){if(_.length===0)return;let R=await vl(i,_);i in R?(e(3,u=R[i]),e(6,g=!0)):(e(3,u=[]),e(6,g=!1))}function p(O,R){e(4,h[R]=[],h),i==R&&e(3,u=[])}function k(O,R){e(6,g=!1),e(5,_=R),s.focus()}function b(O){e(1,i=O),e(3,u=h[i]),e(6,g=!0),s.focus()}function C(O){O&&O.preventDefault(),e(6,g=!1);let R=h[i].length;_.length>0&&!h[i].includes(_)&&e(4,h[i][R]=_,h),e(5,_="");let z=Object.keys(h);a="";for(let J=0;J<z.length;J++){let Y=z[J],G=h[Y];a+=Y+":";for(let X=0;X<G.length;X++)a+=G[X],X!=G.length-1&&(a+="-");J!=z.length-1&&(a+=",")}console.log("Completed: "+a)}function D(O){C(),n("queryReady",{query:a,attributes:h})}const L=O=>b(O),j=(O,R)=>p(R.currentTarget,O),F=O=>b(O.target.value);function v(){i=dl(this),e(1,i),e(4,h)}function S(O){qe[O?"unshift":"push"](()=>{s=O,e(2,s)})}function w(){_=this.value,e(5,_)}function y(O){qe[O?"unshift":"push"](()=>{r=O,e(0,r),e(13,c)})}const E=O=>k(i,O),B=()=>e(6,g=!1);return l.$$set=O=>{"query_button_disabled"in O&&e(13,c=O.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=c,r)},[r,i,s,u,h,_,g,m,p,k,b,C,D,c,L,j,F,v,S,w,y,E,B]}class wl extends Fe{constructor(t){super(),De(this,t,kl,bl,xe,{query_button_disabled:13},null,[-1,-1])}}function Pt(l,t,e){const n=l.slice();return n[8]=t[e],n[10]=e,n}function yl(l){let t,e,n;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(i,s){H(i,t,s),e||(n=P(t,"click",l[2]),e=!0)},p:V,d(i){i&&q(t),e=!1,n()}}}function xl(l){let t,e,n,i,s;return{c(){t=d("span"),t.textContent="Hachi",e=x(),n=d("span"),n.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(n,"class","cursor-pointer px-4")},m(r,c){H(r,t,c),H(r,e,c),H(r,n,c),i||(s=P(n,"click",l[3]),i=!0)},p:V,d(r){r&&q(t),r&&q(e),r&&q(n),i=!1,s()}}}function Nt(l){let t,e,n=l[8].name+"",i,s,r,c=l[8].count+"",a;return{c(){t=d("div"),e=d("div"),i=M(n),s=x(),r=d("div"),a=M(c),f(e,"class","flex"),f(e,"data-ix",l[10]),f(r,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,h){H(u,t,h),o(t,e),o(e,i),o(t,s),o(t,r),o(r,a)},p(u,h){h&2&&n!==(n=u[8].name+"")&&Q(i,n),h&2&&c!==(c=u[8].count+"")&&Q(a,c)},d(u){u&&q(t)}}}function At(l){let t,e,n,i,s,r,c,a=l[0].sidebarOpen&&Nt(l);function u(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),i=x(),a&&a.c(),s=x(),f(e,"class",n="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(h,_){H(h,t,_),o(t,e),o(t,i),a&&a.m(t,null),o(t,s),r||(c=P(t,"click",u),r=!0)},p(h,_){l=h,_&2&&n!==(n="fa-solid fa-"+l[8].icon)&&f(e,"class",n),l[0].sidebarOpen?a?a.p(l,_):(a=Nt(l),a.c(),a.m(t,s)):a&&(a.d(1),a=null)},d(h){h&&q(t),a&&a.d(),r=!1,c()}}}function Cl(l){let t,e,n,i,s,r;function c(g,m){return g[0].sidebarOpen?xl:yl}let a=c(l),u=a(l),h=l[1],_=[];for(let g=0;g<h.length;g+=1)_[g]=At(Pt(l,h,g));return{c(){t=d("div"),e=d("aside"),n=d("div"),u.c(),i=x(),s=d("nav");for(let g=0;g<_.length;g+=1)_[g].c();f(n,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(s,"class","mt-6"),f(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-screen text-white")},m(g,m){H(g,t,m),o(t,e),o(e,n),u.m(n,null),o(e,i),o(e,s);for(let p=0;p<_.length;p+=1)_[p].m(s,null)},p(g,[m]){if(a===(a=c(g))&&u?u.p(g,m):(u.d(1),u=a(g),u&&(u.c(),u.m(n,null))),m&19){h=g[1];let p;for(p=0;p<h.length;p+=1){const k=Pt(g,h,p);_[p]?_[p].p(k,m):(_[p]=At(k),_[p].c(),_[p].m(s,null))}for(;p<_.length;p+=1)_[p].d(1);_.length=h.length}m&1&&r!==(r=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",r)},i:V,o:V,d(g){g&&q(t),u.d(),ge(_,g)}}}function Sl(l,t,e){const n=rt();let{sidebarOpen:i=!1}=t;const s={sidebarOpen:i},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ue(()=>{localStorage.getItem("no_images_indexed")?(e(1,r[0].count=Number(localStorage.getItem("no_images_indexed")),r),e(1,r[3].count=Number(localStorage.getItem("unique_people_count")),r),e(1,r[4].count=Number(localStorage.getItem("unique_place_count")),r)):fetch("/api/getMetaStats").then(_=>{_.json().then(g=>{e(1,r[0].count=g.image.count,r),e(1,r[3].count=g.image.unique_people_count,r),e(1,r[4].count=g.image.unique_place_count,r),localStorage.setItem("no_images_indexed",r[0].count.toString()),localStorage.setItem("unique_people_count",r[3].count.toString()),localStorage.setItem("unique_place_count",r[4].count.toString())})})});function c(){e(0,s.sidebarOpen=!0,s)}function a(){e(0,s.sidebarOpen=!1,s)}function u(_){n("menuClick",{item:r[_]})}const h=_=>{u(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,i=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&s&&n("sidebarStateChange",{open:s.sidebarOpen})},[s,r,c,a,u,i,h]}class ct extends Fe{constructor(t){super(),De(this,t,Sl,Cl,xe,{sidebarOpen:5})}}function Dl(l){let t,e,n,i,s,r,c,a,u,h,_,g,m=(l[3]*100).toString().slice(0,4)+"",p,k,b,C,D,L,j,F,v,S,w,y,E,B,O,R,z,J,Y,G,X,$,ie,ne,re,be,W,ee,pe,he,oe,ve,ke,we,ae,T,N,A,U;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",n=x(),i=d("div"),s=d("input"),r=x(),c=d("div"),a=d("div"),u=d("div"),h=d("div"),_=x(),g=d("div"),p=M(m),k=M("%"),b=x(),C=d("div"),D=M("Current directory: "),L=d("span"),j=M(l[4]),F=x(),v=d("span"),v.textContent="ETA:",S=x(),w=d("span"),y=M(l[6]),E=x(),B=d("div"),O=M("Details: "),R=d("span"),z=M(l[5]),J=x(),Y=d("div"),G=d("div"),X=d("input"),$=x(),ie=d("label"),ie.textContent="Complete Rescan",ne=x(),re=d("div"),re.textContent="Re-index all originals, including already indexed and unchanged files.",be=x(),W=d("div"),ee=d("select"),pe=d("option"),pe.textContent="Images Only",he=d("option"),he.textContent="Videos Only",oe=d("option"),oe.textContent="Videos and Images",ve=x(),ke=d("div"),ke.textContent="Filter by content type",we=x(),ae=d("button"),ae.textContent="Cancel",T=x(),N=d("button"),N.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(s,"type","text"),f(s,"class","w-full rounded border p-1 text-sm"),f(s,"placeholder","D://images (Full path to directory to index)"),s.required=!0,f(i,"class","my-2"),f(h,"class","h-2rounded bg-blue-500"),ue(h,"width",(l[3]*100).toString()+"%"),f(u,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(g,"class","flex px-2 font-semibold"),f(a,"class","flex items-center"),f(L,"class","text-black"),f(v,"class","pl-3 text-right"),f(w,"class","text-black"),f(C,"class","pt-1 text-sm text-blue-600"),f(R,"class","text-black"),f(B,"class","pt-1 text-sm text-blue-600"),f(c,"class","mb-3"),f(X,"type","checkbox"),f(X,"class","h-5 w-5 text-blue-500"),f(ie,"class","ml-1"),f(G,"class","mr-2 flex items-center"),f(re,"class","text-sm text-gray-600"),f(Y,"class","mt-4 mb-3 flex flex-wrap items-center"),pe.__value="Images Only",pe.value=pe.__value,he.disabled=!0,he.__value="Videos Only",he.value=he.__value,oe.disabled=!0,oe.__value="Videos and Images",oe.value=oe.__value,f(ee,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(ke,"class","ml-2 text-sm text-gray-600"),f(W,"class","mb-3 mt-3 flex flex-wrap items-center"),ae.disabled=!0,f(ae,"type","button"),f(ae,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(N,"type","button"),f(N,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(I,te){H(I,t,te),o(t,e),o(t,n),o(t,i),o(i,s),l[12](s),Pe(s,l[7]),o(t,r),o(t,c),o(c,a),o(a,u),o(u,h),o(a,_),o(a,g),o(g,p),o(g,k),o(c,b),o(c,C),o(C,D),o(C,L),o(L,j),o(C,F),o(C,v),o(C,S),o(C,w),o(w,y),o(c,E),o(c,B),o(B,O),o(B,R),o(R,z),o(t,J),o(t,Y),o(Y,G),o(G,X),X.checked=l[8],o(G,$),o(G,ie),o(Y,ne),o(Y,re),o(t,be),o(t,W),o(W,ee),o(ee,pe),o(ee,he),o(ee,oe),o(W,ve),o(W,ke),o(t,we),o(t,ae),l[16](ae),o(t,T),o(t,N),l[17](N),A||(U=[P(s,"input",l[13]),P(s,"keydown",l[14]),P(X,"change",l[15]),P(ae,"click",l[10]),P(N,"click",l[9])],A=!0)},p(I,[te]){te&128&&s.value!==I[7]&&Pe(s,I[7]),te&8&&ue(h,"width",(I[3]*100).toString()+"%"),te&8&&m!==(m=(I[3]*100).toString().slice(0,4)+"")&&Q(p,m),te&16&&Q(j,I[4]),te&64&&Q(y,I[6]),te&32&&Q(z,I[5]),te&256&&(X.checked=I[8])},i:V,o:V,d(I){I&&q(t),l[12](null),l[16](null),l[17](null),A=!1,fe(U)}}}function Fl(l,t,e){let n,i,s;Ue(()=>{if(e(11,n=localStorage.getItem("stored_indexing_endpoint")),n!==null){let S="/api/getIndexStatus/"+n;e(0,i.disabled=!1,i),e(1,s.disabled=!0,s),m(S)}}),it(()=>{g&&clearTimeout(g)});let r,c=.001,a="",u="",h="",_="",g;async function m(S,w=0){w==0&&console.log("starting a new polll...");let E=await(await fetch(S,{method:"GET"})).json();if(E.is_active==!0){if(E.done==!0){let O=new FormData;O.append("ack","true"),(await fetch(S,{method:"POST",body:O})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let z=await fetch("/api/getMetaStats");z=await z.json(),localStorage.setItem("no_images_indexed",z.image.count.toString()),localStorage.setItem("unique_people_count",z.image.unique_people_count.toString()),localStorage.setItem("unique_place_count",z.image.unique_place_count.toString()),e(1,s.disabled=!1,s),e(11,n=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,c=0),e(4,a=""),e(6,h=""),e(5,u=""),e(7,_=""),e(0,i.disabled=!0,i),e(0,i.innerText="Cancel",i),e(2,r.disabled=!1,r);return}e(3,c=E.progress),e(6,h=E.eta),e(5,u=E.details),e(4,a=E.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(S,w+1)},1e3)}}let p=!1;async function k(){if(s&&_){e(1,s.disabled=!0,s),e(2,r.disabled=!0,r);let S=new FormData;S.append("image_directory_path",_),S.append("complete_rescan",p.toString());let E=await(await fetch("/api/indexStart",{method:"POST",body:S})).json();if(E.success===!0){e(0,i.disabled=!1,i);let O="/api/getIndexStatus/"+E.statusEndpoint;e(11,n=E.statusEndpoint),m(O)}else alert(E.reason),e(1,s.disabled=!1,s),e(2,r.disabled=!1,r)}else console.log("No index_start_button object found!!!")}async function b(){if(n){localStorage.removeItem("stored_indexing_endpoint"),e(0,i.disabled=!0,i),e(0,i.innerText="Cancelling... Please wait.",i);let S="/api/indexCancel/"+n,w=await fetch(S,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,n=null),!w.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(w);return}else return}function C(S){qe[S?"unshift":"push"](()=>{r=S,e(2,r)})}function D(){_=this.value,e(7,_)}const L=S=>{S.key==="Enter"&&s.click()};function j(){p=this.checked,e(8,p)}function F(S){qe[S?"unshift":"push"](()=>{i=S,e(0,i)})}function v(S){qe[S?"unshift":"push"](()=>{s=S,e(1,s)})}return l.$$.update=()=>{l.$$.dirty&2048&&n&&localStorage.setItem("stored_indexing_endpoint",n)},[i,s,r,c,a,u,h,_,p,k,b,n,C,D,L,j,F,v]}class jl extends Fe{constructor(t){super(),De(this,t,Fl,Dl,xe,{})}}const Le=[];function ol(l,t=V){let e;const n=new Set;function i(c){if(xe(l,c)&&(l=c,e)){const a=!Le.length;for(const u of n)u[1](),Le.push(u,l);if(a){for(let u=0;u<Le.length;u+=2)Le[u][0](Le[u+1]);Le.length=0}}}function s(c){i(c(l))}function r(c,a=V){const u=[c,a];return n.add(u),n.size===1&&(e=t(i)||V),c(l),()=>{n.delete(u),n.size===0&&(e(),e=null)}}return{set:i,update:s,subscribe:r}}const nt=ol([]);let Ol={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ee=ol(Ol);function Mt(l,t,e){const n=l.slice();return n[10]=t[e],n}function Bt(l,t,e){const n=l.slice();return n[13]=t[e],n}function Rt(l){let t;return{c(){t=d("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,n){H(e,t,n)},d(e){e&&q(t)}}}function zt(l){let t,e,n=l[1].selectFilters[l[10]].values.includes(l[13]),i,s,r,c=l[13]+"",a,u,h,_=n&&Rt();function g(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),s=x(),r=d("span"),a=M(c),f(e,"class",i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,p){H(m,t,p),o(t,e),_&&_.m(e,null),o(t,s),o(t,r),o(r,a),u||(h=P(t,"click",g),u=!0)},p(m,p){l=m,p&2&&(n=l[1].selectFilters[l[10]].values.includes(l[13])),n?_||(_=Rt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),p&2&&i!==(i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",i),p&2&&c!==(c=l[13]+"")&&Q(a,c)},d(m){m&&q(t),_&&_.d(),u=!1,h()}}}function Ut(l){let t,e,n=l[10]+"",i,s,r,c,a,u,h,_,g;function m(){return l[6](l[10])}let p=l[1].selectFilters[l[10]].options,k=[];for(let b=0;b<p.length;b+=1)k[b]=zt(Bt(l,p,b));return{c(){t=d("div"),e=d("div"),i=M(n),s=x(),r=d("i"),a=x(),u=d("div");for(let b=0;b<k.length;b+=1)k[b].c();f(r,"class",c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",h=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(b,C){H(b,t,C),o(t,e),o(e,i),o(e,s),o(e,r),o(t,a),o(t,u);for(let D=0;D<k.length;D+=1)k[D].m(u,null);_||(g=[P(e,"click",m),P(t,"mouseup",Ll)],_=!0)},p(b,C){if(l=b,C&2&&n!==(n=l[10]+"")&&Q(i,n),C&2&&c!==(c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(r,"class",c),C&6){p=l[1].selectFilters[l[10]].options;let D;for(D=0;D<p.length;D+=1){const L=Bt(l,p,D);k[D]?k[D].p(L,C):(k[D]=zt(L),k[D].c(),k[D].m(u,null))}for(;D<k.length;D+=1)k[D].d(1);k.length=p.length}C&2&&h!==(h=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",h)},d(b){b&&q(t),ge(k,b),_=!1,fe(g)}}}function ql(l){let t,e,n,i,s,r,c,a,u,h,_,g,m=Object.keys(l[1].selectFilters),p=[];for(let k=0;k<m.length;k+=1)p[k]=Ut(Mt(l,m,k));return{c(){t=d("div"),e=d("div"),n=d("span"),n.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=x(),s=d("span"),s.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=x();for(let k=0;k<p.length;k+=1)p[k].c();c=x(),a=d("button"),u=M("Filter"),f(n,"class","flex items-center text-md"),f(s,"class","flex items-center text-md"),a.disabled=l[0],f(a,"class",h="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(k,b){H(k,t,b),o(t,e),o(e,n),o(e,i),o(e,s),o(e,r);for(let C=0;C<p.length;C+=1)p[C].m(e,null);o(e,c),o(e,a),o(a,u),_||(g=P(a,"click",l[4]),_=!0)},p(k,[b]){if(b&14){m=Object.keys(k[1].selectFilters);let C;for(C=0;C<m.length;C+=1){const D=Mt(k,m,C);p[C]?p[C].p(D,b):(p[C]=Ut(D),p[C].c(),p[C].m(e,c))}for(;C<p.length;C+=1)p[C].d(1);p.length=m.length}b&1&&(a.disabled=k[0]),b&1&&h!==(h="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(k[0]===!0?"disabled":""))&&f(a,"class",h)},i:V,o:V,d(k){k&&q(t),ge(p,k),_=!1,g()}}}function al(l,t,e=null,n=(i,s)=>i===s){let i=[];for(let s=0;s<l.length;s++)e?n(l[s].key,t)?i.push(1):i.push(0):n(l[s],t)?i.push(1):i.push(0);return i}function El(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let i=al(l,t[n]);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(i[s]))}return e}function Il(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let i=al(l,t[n],null,(s,r)=>s?s.includes(r):!1);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(i[s]))}return e}function Hl(l){let t=l[0].length,e=l[0];return l.forEach((n,i)=>{if(i>0){if(n.length!==t)throw new Error("all mask must be of same length!!");n.forEach((s,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(s))})}}),e}const Ll=l=>l.stopPropagation();function Tl(l,t,e){let n=[],{filter_button_disabled:i=!0}=t;nt.subscribe(m=>{e(0,i=!1),e(5,n=m)});const s=rt(),r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ue(()=>{document.addEventListener("mouseup",c)});function c(m){e(1,r.selectFilterActive="",r)}function a(m,p){if(r.selectFilters[m].values.includes(p)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(k=>k!==p),r);return}e(1,r.selectFilters[m].values=[p,...r.selectFilters[m].values],r)}function u(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function h(){if(n){console.log(n);let m=[],p=[];n.map((j,F)=>{m.push(j.place),p.push(j.person)});let k=r.selectFilters.place.values,b=El(m,k),C=r.selectFilters.people.values,D=Il(p,C),L=Hl([b,D]);s("filterApplied",{mask:L})}}const _=m=>u(m),g=(m,p)=>a(m,p);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,i=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&n){let m=n.map((C,D)=>{if(C.place)return C.place}),p=[];n.map((C,D)=>{C.person&&C.person.forEach(L=>p.push(L))});let k=[];new Set(m).forEach(C=>k.push(C));let b=[];new Set(p).forEach(C=>b.push(C)),e(1,r.selectFilters.place.values=k,r),e(1,r.selectFilters.place.options=k,r),e(1,r.selectFilters.people.values=b,r),e(1,r.selectFilters.people.options=b,r)}},[i,r,a,u,h,n,_,g]}class Pl extends Fe{constructor(t){super(),De(this,t,Tl,ql,xe,{filter_button_disabled:0})}}function Vt(l,t,e){const n=l.slice();return n[49]=t[e],n[48]=e,n}function Gt(l,t,e){const n=l.slice();return n[46]=t[e],n[48]=e,n}function Nl(l){let t,e,n,i,s,r,c,a,u,h,_,g,m,p,k,b,C,D,L,j,F=l[1]&&Xt(l);e=new Pl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[39]);let v=l[6],S=[];for(let y=0;y<v.length;y+=1)S[y]=Kt(Vt(l,v,y));let w=l[6].length>=je&&Wt(l);return{c(){F&&F.c(),t=x(),me(e.$$.fragment),n=x(),i=d("div"),s=d("div"),r=d("div"),c=d("div"),a=d("div"),u=d("input"),h=x(),_=d("label"),g=M("Score threshold: "),m=M(l[10]),p=M("."),k=x(),b=d("div");for(let y=0;y<S.length;y+=1)S[y].c();C=x(),w&&w.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(_,"for","topk"),f(_,"class","dark:text-white"),f(a,"class","my-4"),f(r,"class","flex flex-row place-content-center mb-10 select-none mx-2"),f(b,"class","flex flex-wrap gap-6 p-4 sm:p-12 px-auto justify-center"),f(s,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(i,"class","flex")},m(y,E){F&&F.m(y,E),H(y,t,E),de(e,y,E),H(y,n,E),H(y,i,E),o(i,s),o(s,r),o(r,c),o(c,a),o(a,u),Pe(u,l[10]),o(a,h),o(a,_),o(_,g),o(_,m),o(_,p),o(s,k),o(s,b);for(let B=0;B<S.length;B+=1)S[B].m(b,null);o(s,C),w&&w.m(s,null),D=!0,L||(j=[P(u,"change",l[18]),P(u,"change",l[40]),P(u,"input",l[40])],L=!0)},p(y,E){y[1]?F?F.p(y,E):(F=Xt(y),F.c(),F.m(t.parentNode,t)):F&&(F.d(1),F=null);const B={};if(E[0]&8&&(B.filter_button_disabled=y[3]),e.$set(B),E[0]&1024&&Pe(u,y[10]),(!D||E[0]&1024)&&Q(m,y[10]),E[0]&24641){v=y[6];let O;for(O=0;O<v.length;O+=1){const R=Vt(y,v,O);S[O]?S[O].p(R,E):(S[O]=Kt(R),S[O].c(),S[O].m(b,null))}for(;O<S.length;O+=1)S[O].d(1);S.length=v.length}y[6].length>=je?w?w.p(y,E):(w=Wt(y),w.c(),w.m(s,null)):w&&(w.d(1),w=null)},i(y){D||(Z(e.$$.fragment,y),D=!0)},o(y){le(e.$$.fragment,y),D=!1},d(y){F&&F.d(y),y&&q(t),_e(e,y),y&&q(n),y&&q(i),ge(S,y),w&&w.d(),L=!1,fe(j)}}}function Al(l){let t,e,n,i,s,r,c,a,u,h,_,g,m,p,k,b,C,D,L,j,F,v=l[2].image_card_edit_interface&&Jt(l),S=l[5]&&Yt(l);return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,i=x(),s=d("div"),s.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=x(),c=d("div"),a=d("div"),a.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=x(),h=d("div"),_=d("div"),g=d("img"),p=x(),k=d("div"),k.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=x(),v&&v.c(),C=x(),D=d("div"),D.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',L=x(),S&&S.c(),f(n,"class","cursor-pointer hover:underline text-gray-200"),f(s,"title","Fullscreen"),f(s,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(a,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(g,"class","w-auto cursor-pointer h-full"),ye(g.src,m="/api/getRawData/"+l[4].data_hash)||f(g,"src",m),f(g,"alt",""),f(k,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(_,"class","flex shrink h-full"),f(h,"class","flex h-full items-center justify-center p-2 gap-4"),f(D,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(c,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(w,y){H(w,t,y),o(t,e),o(e,n),o(e,i),o(e,s),o(t,r),o(t,c),o(c,a),o(c,u),o(c,h),o(h,_),o(_,g),o(_,p),o(_,k),o(h,b),v&&v.m(h,null),o(c,C),o(c,D),o(t,L),S&&S.m(t,null),j||(F=[P(n,"click",l[31]),P(s,"click",l[32]),P(a,"click",l[33]),P(g,"click",l[34]),P(k,"click",l[35]),P(D,"click",l[37])],j=!0)},p(w,y){y[0]&16&&!ye(g.src,m="/api/getRawData/"+w[4].data_hash)&&f(g,"src",m),w[2].image_card_edit_interface?v?v.p(w,y):(v=Jt(w),v.c(),v.m(h,null)):v&&(v.d(1),v=null),w[5]?S?S.p(w,y):(S=Yt(w),S.c(),S.m(t,null)):S&&(S.d(1),S=null)},i:V,o:V,d(w){w&&q(t),v&&v.d(),S&&S.d(),j=!1,fe(F)}}}function Ml(l){let t,e,n,i,s,r,c,a,u,h,_,g,m,p,k,b,C,D,L=l[9],j=[];for(let v=0;v<L.length;v+=1)j[v]=Zt(Gt(l,L,v));let F=l[8].active&&$t(l);return{c(){t=d("div"),e=d("div"),n=d("img"),s=x();for(let v=0;v<j.length;v+=1)j[v].c();r=x(),F&&F.c(),c=x(),a=d("div"),u=d("div"),u.innerHTML='<i class="fa fa-arrow-left"></i>',h=x(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',g=x(),m=d("div"),p=d("div"),p.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,k=x(),b=d("div"),b.innerHTML='<i class="fa fa-arrows-alt"></i>',f(n,"class","object-cover h-screen w-auto"),ye(n.src,i="/api/getRawDataFull/"+l[4].data_hash)||f(n,"src",i),f(n,"alt",""),f(e,"class","relative flex"),f(u,"class","text-white cursor-pointer"),f(_,"class","text-white cursor-pointer"),f(a,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(p,"class","cursor-pointer hover:underline text-white"),f(b,"title","Fullscreen"),f(b,"class","cursor-pointer text-white"),f(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(v,S){H(v,t,S),o(t,e),o(e,n),o(e,s);for(let w=0;w<j.length;w+=1)j[w].m(e,null);o(e,r),F&&F.m(e,null),o(t,c),o(t,a),o(a,u),o(a,h),o(a,_),H(v,g,S),H(v,m,S),o(m,p),o(m,k),o(m,b),C||(D=[P(n,"load",l[17]),P(u,"click",l[27]),P(_,"click",l[28]),P(p,"click",l[29]),P(b,"click",l[30])],C=!0)},p(v,S){if(S[0]&16&&!ye(n.src,i="/api/getRawDataFull/"+v[4].data_hash)&&f(n,"src",i),S[0]&896){L=v[9];let w;for(w=0;w<L.length;w+=1){const y=Gt(v,L,w);j[w]?j[w].p(y,S):(j[w]=Zt(y),j[w].c(),j[w].m(e,r))}for(;w<j.length;w+=1)j[w].d(1);j.length=L.length}v[8].active?F?F.p(v,S):(F=$t(v),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:V,o:V,d(v){v&&q(t),ge(j,v),F&&F.d(),v&&q(g),v&&q(m),C=!1,fe(D)}}}function Xt(l){let t,e,n,i,s;return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(n,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(r,c){H(r,t,c),o(t,e),o(e,n),i||(s=P(n,"click",l[38]),i=!0)},p:V,d(r){r&&q(t),i=!1,s()}}}function Qt(l){let t,e,n,i,s,r;function c(){return l[41](l[48])}return{c(){t=d("div"),e=d("img"),i=x(),f(e,"class","sm:max-h-48 rounded-lg shadow-xl cursor-pointer"),ye(e.src,n="api/getRawData/"+l[0].list_dataHash[l[49].ix])||f(e,"src",n),f(e,"alt","image"),f(t,"class","relative group")},m(a,u){H(a,t,u),o(t,e),o(t,i),s||(r=P(t,"click",c),s=!0)},p(a,u){l=a,u[0]&65&&!ye(e.src,n="api/getRawData/"+l[0].list_dataHash[l[49].ix])&&f(e,"src",n)},d(a){a&&q(t),s=!1,r()}}}function Kt(l){let t,e=l[49].ix>=0&&Qt(l);return{c(){e&&e.c(),t=Ne()},m(n,i){e&&e.m(n,i),H(n,t,i)},p(n,i){n[49].ix>=0?e?e.p(n,i):(e=Qt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&q(t)}}}function Wt(l){let t,e,n,i;return{c(){t=d("div"),e=d("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200"),f(t,"class","flex items-center justify-center")},m(s,r){H(s,t,r),o(t,e),n||(i=P(e,"click",l[12]),n=!0)},p:V,d(s){s&&q(t),n=!1,i()}}}function Jt(l){let t,e,n,i,s,r,c,a,u,h,_,g,m,p,k,b,C,D,L,j,F,v,S,w,y,E,B,O,R,z,J,Y,G,X,$,ie,ne,re,be;return{c(){t=d("div"),e=d("div"),n=d("div"),n.textContent="Info",i=x(),s=d("div"),s.textContent="X",r=x(),c=d("div"),a=d("div"),a.textContent="Description",u=x(),h=d("input"),g=x(),m=d("div"),p=d("div"),p.textContent="place",k=x(),b=d("input"),D=x(),L=d("div"),j=d("div"),j.textContent="Tags",F=x(),v=d("input"),w=x(),y=d("div"),E=d("div"),E.textContent="Taken at:",B=x(),O=d("input"),R=x(),z=d("div"),J=d("div"),J.textContent="device",Y=x(),G=d("input"),$=x(),ie=d("div"),ne=d("button"),ne.textContent="Save",f(n,"class","grow text-xl text-gray-100 font-bold"),f(s,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(a,"class","mb-1 text-gray-100"),f(h,"name","Description"),f(h,"placeholder",""),h.value=_=l[4].description.toString(),f(h,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(h,"type","text"),f(p,"class","mb-1 text-gray-100"),f(b,"name","place"),b.value=C=l[4].place.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(j,"class","mb-1 text-gray-100"),f(v,"name","tags"),f(v,"placeholder","Car, chair"),v.value=S=l[4].tags.toString(),f(v,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(v,"type","text"),f(E,"class","mb-1 text-gray-100"),f(O,"name","taken_at"),O.value="",f(O,"type","date"),f(O,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(J,"class","mb-1 text-gray-100"),f(G,"name","device"),f(G,"placeholder","Canon"),G.value=X=l[4].device.toString(),f(G,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(G,"type","text"),f(ne,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(W,ee){H(W,t,ee),o(t,e),o(e,n),o(e,i),o(e,s),o(t,r),o(t,c),o(c,a),o(c,u),o(c,h),o(t,g),o(t,m),o(m,p),o(m,k),o(m,b),o(t,D),o(t,L),o(L,j),o(L,F),o(L,v),o(t,w),o(t,y),o(y,E),o(y,B),o(y,O),o(t,R),o(t,z),o(z,J),o(z,Y),o(z,G),o(t,$),o(t,ie),o(ie,ne),re||(be=[P(s,"click",l[36]),P(h,"change",l[21]),P(b,"change",l[21]),P(v,"change",l[21]),P(O,"change",l[21]),P(G,"change",l[21]),P(ne,"click",l[22])],re=!0)},p(W,ee){ee[0]&16&&_!==(_=W[4].description.toString())&&h.value!==_&&(h.value=_),ee[0]&16&&C!==(C=W[4].place.toString())&&b.value!==C&&(b.value=C),ee[0]&16&&S!==(S=W[4].tags.toString())&&v.value!==S&&(v.value=S),ee[0]&16&&X!==(X=W[4].device.toString())&&G.value!==X&&(G.value=X)},d(W){W&&q(t),re=!1,fe(be)}}}function Yt(l){let t,e,n,i,s=l[4].filename+"",r,c,a,u,h,_=l[4].data_hash+"",g,m,p,k,b,C=l[4].last_modified+"",D,L,j,F,v,S,w,y,E,B=l[4].description.toString()+"",O,R,z,J,Y,G,X=l[4].taken_at.toString()+"",$,ie,ne,re,be,W,ee=l[4].tags.toString()+"",pe,he,oe,ve,ke,we,ae=l[4].place.toString()+"",T,N,A,U,I,te,Ve,Ie,Ce=l[4].person_ids.toString()+"",ce,Ae,Se,Ge,bt,Xe,Qe=l[4].device.toString()+"",ut,vt,Me,Ke,kt,We,Je=l[4].resolution.toString()+"",ft,wt,Be,Ye,yt,Ze,$e=l[4].absolute_path.toString()+"",dt;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=x(),n=d("div"),i=d("div"),r=M(s),c=x(),a=d("div"),u=M("UID: "),h=d("span"),g=M(_),m=x(),p=d("div"),k=M("Last Modified:  "),b=d("span"),D=M(C),L=x(),j=d("div"),F=d("div"),v=d("div"),S=d("div"),w=d("div"),w.textContent="Description",y=x(),E=d("div"),O=M(B),R=x(),z=d("div"),J=d("div"),J.textContent="Taken at",Y=x(),G=d("div"),$=M(X),ie=x(),ne=d("div"),re=d("div"),re.textContent="Tags",be=x(),W=d("div"),pe=M(ee),he=x(),oe=d("div"),ve=d("div"),ve.textContent="Place",ke=x(),we=d("div"),T=M(ae),N=x(),A=d("div"),U=d("div"),I=d("div"),te=d("div"),te.textContent="people",Ve=x(),Ie=d("div"),ce=M(Ce),Ae=x(),Se=d("div"),Ge=d("div"),Ge.textContent="Device",bt=x(),Xe=d("div"),ut=M(Qe),vt=x(),Me=d("div"),Ke=d("div"),Ke.textContent="Resolution",kt=x(),We=d("div"),ft=M(Je),wt=x(),Be=d("div"),Ye=d("div"),Ye.textContent="Path",yt=x(),Ze=d("div"),dt=M($e),f(i,"class","text-xl text-white"),f(h,"class","text-sm text-gray-400"),f(a,"class","text-white"),f(b,"class","text-sm text-gray-400"),f(p,"class","text-white"),f(n,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(w,"class",""),f(E,"class","text-sm text-gray-400"),f(J,"class",""),f(G,"class","text-sm text-gray-400"),f(re,"class",""),f(W,"class","text-sm text-gray-400"),f(ve,"class",""),f(we,"class","text-sm text-gray-400"),f(v,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(F,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(te,"class",""),f(Ie,"class","text-sm text-gray-400"),f(Ge,"class",""),f(Xe,"class","text-sm text-gray-400"),f(Ke,"class",""),f(We,"class","text-sm text-gray-400"),f(Ye,"class",""),f(Ze,"class","text-sm text-gray-400"),f(U,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(A,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(j,"class","flex w-full justify-center p-4")},m(K,se){H(K,t,se),H(K,e,se),H(K,n,se),o(n,i),o(i,r),o(n,c),o(n,a),o(a,u),o(a,h),o(h,g),o(n,m),o(n,p),o(p,k),o(p,b),o(b,D),H(K,L,se),H(K,j,se),o(j,F),o(F,v),o(v,S),o(S,w),o(S,y),o(S,E),o(E,O),o(v,R),o(v,z),o(z,J),o(z,Y),o(z,G),o(G,$),o(v,ie),o(v,ne),o(ne,re),o(ne,be),o(ne,W),o(W,pe),o(v,he),o(v,oe),o(oe,ve),o(oe,ke),o(oe,we),o(we,T),o(j,N),o(j,A),o(A,U),o(U,I),o(I,te),o(I,Ve),o(I,Ie),o(Ie,ce),o(U,Ae),o(U,Se),o(Se,Ge),o(Se,bt),o(Se,Xe),o(Xe,ut),o(U,vt),o(U,Me),o(Me,Ke),o(Me,kt),o(Me,We),o(We,ft),o(U,wt),o(U,Be),o(Be,Ye),o(Be,yt),o(Be,Ze),o(Ze,dt)},p(K,se){se[0]&16&&s!==(s=K[4].filename+"")&&Q(r,s),se[0]&16&&_!==(_=K[4].data_hash+"")&&Q(g,_),se[0]&16&&C!==(C=K[4].last_modified+"")&&Q(D,C),se[0]&16&&B!==(B=K[4].description.toString()+"")&&Q(O,B),se[0]&16&&X!==(X=K[4].taken_at.toString()+"")&&Q($,X),se[0]&16&&ee!==(ee=K[4].tags.toString()+"")&&Q(pe,ee),se[0]&16&&ae!==(ae=K[4].place.toString()+"")&&Q(T,ae),se[0]&16&&Ce!==(Ce=K[4].person_ids.toString()+"")&&Q(ce,Ce),se[0]&16&&Qe!==(Qe=K[4].device.toString()+"")&&Q(ut,Qe),se[0]&16&&Je!==(Je=K[4].resolution.toString()+"")&&Q(ft,Je),se[0]&16&&$e!==($e=K[4].absolute_path.toString()+"")&&Q(dt,$e)},d(K){K&&q(t),K&&q(e),K&&q(n),K&&q(L),K&&q(j)}}}function Zt(l){let t,e,n;function i(...s){return l[25](l[46],...s)}return{c(){t=d("div"),f(t,"data-ix",l[48]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ue(t,"top",l[46].top+"px "),ue(t,"left",l[46].left+"px"),ue(t,"width",l[46].width+"px"),ue(t,"height",l[46].height+"px")},m(s,r){H(s,t,r),e||(n=P(t,"click",i),e=!0)},p(s,r){l=s,r[0]&512&&ue(t,"top",l[46].top+"px "),r[0]&512&&ue(t,"left",l[46].left+"px"),r[0]&512&&ue(t,"width",l[46].width+"px"),r[0]&512&&ue(t,"height",l[46].height+"px")},d(s){s&&q(t),e=!1,n()}}}function $t(l){let t,e,n,i,s,r,c;return{c(){t=d("div"),e=d("input"),i=x(),s=d("div"),s.textContent="X",e.autofocus=!0,e.value=n=l[4].person_ids[l[7]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(s,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),ue(t,"top",l[8].top+"px "),ue(t,"left",l[8].left+"px")},m(a,u){H(a,t,u),o(t,e),o(t,i),o(t,s),e.focus(),r||(c=[P(e,"keyup",l[20]),P(s,"click",l[26])],r=!0)},p(a,u){u[0]&144&&n!==(n=a[4].person_ids[a[7]])&&e.value!==n&&(e.value=n),u[0]&256&&ue(t,"top",a[8].top+"px "),u[0]&256&&ue(t,"left",a[8].left+"px")},d(a){a&&q(t),r=!1,fe(c)}}}function Bl(l){let t,e,n,i;const s=[Ml,Al,Nl],r=[];function c(a,u){return a[2].image_card_fullscreen===!0?0:a[2].image_card===!0?1:2}return t=c(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(a,u){r[t].m(a,u),H(a,n,u),i=!0},p(a,u){let h=t;t=c(a),t===h?r[t].p(a,u):(ot(),le(r[h],1,1,()=>{r[h]=null}),at(),e=r[t],e?e.p(a,u):(e=r[t]=s[t](a),e.c()),Z(e,1),e.m(n.parentNode,n))},i(a){i||(Z(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&q(n)}}}let je=20;function pt(l,t=[1],e=null){let n=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let i=0;i<l.length;i++){let s=i;t[i%t.length]!==1&&(s=-1),e?n.push({ix:s,score:l[i][e]}):n.push({ix:s,score:l[i]})}return n.sort((i,s)=>i.score>s.score?-1:i.score<s.score?1:0),n}function Rl(l,t,e){const n=rt();let{show_exit_interface_button:i=!1}=t,{image_data:s={list_metaData:[],list_dataHash:[],list_score:[],done:!1}}=t,r=!0;it(()=>{e(0,s={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),nt.update(T=>[])});let c={},a=!1,u=[],h=[],_=0;function g(T){e(24,_=_+je),e(6,u=h.slice(_,_+je)),nt.update(N=>m(u))}function m(T){let N=[],A=T.length;for(let U=0;U<A;U++){let I=T[U].ix;N.push(s.list_metaData[I])}return N}Ee.subscribe(T=>{T.done==!0?p(T):(e(24,_=0),e(6,u=[]))});function p(T){e(23,h=pt(T.list_score)),e(6,u=h.slice(0,0+je)),nt.update(N=>m(u))}let k={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function b(T){let N=Object.keys(k);for(let A=0;A<N.length;A++)e(2,k[N[A]]=!1,k);e(2,k[T]=!0,k)}let C,D={active:!1,top:null,left:null};function L(T){let N={sorted_ix:null,image_ix:null};for(let A=T;A<u.length;A++)if(u[A].ix!==-1){N.image_ix=u[A].ix,N.sorted_ix=A;break}return N}function j(T){R={},e(5,a=!1),e(9,S=[]),e(8,D={active:!1,top:null,left:null});let N=T,A=u.length;N<0&&(N=A-1),N>A-1&&(N=0);let U=L(N),I=U.image_ix;N=U.sorted_ix,I===null&&(U=L(0),I=U.image_ix,N=U.sorted_ix),e(4,c.ix=N,c),e(4,c.data_hash=s.list_dataHash[I],c),e(4,c.height=Number(s.list_metaData[I].height),c),e(4,c.width=Number(s.list_metaData[I].width),c),e(4,c.face_bboxes=s.list_metaData[I].face_bboxes,c),e(4,c.person_ids=s.list_metaData[I].person,c),c.person_ids===null&&e(4,c.person_ids=[],c),e(4,c.resolution=c.height.toString()+" X "+c.width.toString(),c),e(4,c.filename=s.list_metaData[I].filename,c),e(4,c.taken_at=s.list_metaData[I].taken_at,c),c.taken_at==null&&e(4,c.taken_at="Unknown",c),e(4,c.last_modified=s.list_metaData[I].modified_at,c),e(4,c.device=s.list_metaData[I].device,c),c.device==null&&e(4,c.device="",c),e(4,c.place=s.list_metaData[I].place,c),e(4,c.absolute_path=s.list_metaData[I].absolute_path,c),e(4,c.description=s.list_metaData[I].description,c),e(4,c.tags=s.list_metaData[I].tags,c),e(5,a=!0)}function F(){j(c.ix+1)}function v(){j(c.ix-1)}let S=[];function w(T){let N=T.target.getClientRects()[0],A=N.width,U=N.height,I=[],te=c.face_bboxes;if(te){let Ve=c.width,Ie=c.height;for(let Ce=0;Ce<te.length;Ce++){let ce=structuredClone(te[Ce]),Ae=Number(A)/(Number(Ve)+1e-4),Se=Number(U)/(Number(Ie)+1e-4);ce.top=ce[1]*Se,ce.height=(ce[3]-ce[1])*Se,ce.left=ce[0]*Ae,ce.width=(ce[2]-ce[0])*Ae,I.push(ce)}}console.log(I),e(9,S=I)}let y=0;function E(){let T=u[0].score,N=u[u.length-1].score,U=s.list_score.map(I=>(I-N)/(T-N+1e-5)).map(I=>I>=y?1:0);e(6,u=pt(s.list_score,U))}function B(T){e(3,r=!0);let N=h.slice(_,_+je);for(let A=0;A<T.length;A++)T[A]==0?e(6,u[A].ix=-1,u):e(6,u[A].ix=N[A].ix,u);e(3,r=!1)}function O(T){let N=T.target.value,A=c.data_hash,U=c.person_ids[C];if(T.key=="Enter"){let I=new FormData;I.append("new_person_id",N),I.append("old_person_id",U),I.append("data_hash",A),fetch("/api/tagPerson",{method:"POST",body:I}).then(te=>{if(te.ok)alert("Success");else throw new Error("Error occured")})}}let R={};function z(T){R[T.target.name.toLowerCase()]=T.target.value}async function J(T){T.target.disabled=!0;let N=Object.keys(R),A=new FormData;for(let I=0;I<N.length;I++)A.append(N[I],R[N[I]]);A.append("data_hash",c.data_hash);let U=await fetch("/api/editMetaData",{method:"POST",body:A});if(!U.ok)throw new Error("Error while updating meta-data !!");await U.json(),T.target.disabled=!1}const Y=(T,N)=>{e(8,D={active:!0,top:T.top-28,left:T.left}),e(7,C=Number(N.target.attributes["data-ix"].value))},G=()=>{e(8,D.active=!1,D)},X=()=>{v()},$=()=>{F()},ie=()=>{b("parent")},ne=()=>{b("image_card")},re=()=>{b("parent")},be=()=>{b("image_card_fullscreen")},W=()=>{v()},ee=()=>{console.log("hellll"),b("image_card_fullscreen")},pe=()=>{e(2,k.image_card_edit_interface=!0,k)},he=()=>{e(2,k.image_card_edit_interface=!1,k)},oe=()=>{F()},ve=()=>{console.log("pressed me!!!"),e(6,u=[]),n("exitButtonPressed")},ke=T=>{B(T.detail.mask)};function we(){y=ul(this.value),e(10,y)}const ae=T=>{j(T),b("image_card")};return l.$$set=T=>{"show_exit_interface_button"in T&&e(1,i=T.show_exit_interface_button),"image_data"in T&&e(0,s=T.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&25165825&&s&&(e(23,h=pt(s.list_score)),s.done==!1&&e(6,u=h.slice(_,_+je))),l.$$.dirty[0]&4&&k){let T=!1;(k.image_card==!0||k.image_card_fullscreen==!0)&&(T=!0),n("imageCardActive",{active:T})}},[s,i,k,r,c,a,u,C,D,S,y,n,g,b,j,F,v,w,E,B,O,z,J,h,_,Y,G,X,$,ie,ne,re,be,W,ee,pe,he,oe,ve,ke,we,ae]}class gt extends Fe{constructor(t){super(),De(this,t,Rl,Bl,xe,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const zl="/assets/sample_place_bg-38f3fbd4.jpg";function el(l,t,e){const n=l.slice();return n[10]=t[e],n}function Ul(l){let t,e,n,i,s,r,c,a,u,h,_,g=l[0].people,m=[];for(let p=0;p<g.length;p+=1)m[p]=tl(el(l,g,p));return{c(){t=d("div"),e=d("div"),n=d("div"),i=d("div"),s=d("div"),s.textContent="People Album",r=x(),c=d("div"),a=d("input"),u=x();for(let p=0;p<m.length;p+=1)m[p].c();f(s,"class","flex text-lg font-semibold"),f(a,"class","text-md py-2 px-3 border-2 border-rose-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-rose-200 focus:border-rose-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-rose-500 dark:focus:ring-rose-900 dark:focus:border-rose-600"),f(a,"type","text"),f(a,"placeholder","Search person"),f(c,"class","flex"),f(i,"class","flex w-full justify-between items-center"),f(n,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(p,k){H(p,t,k),o(t,e),o(e,n),o(n,i),o(i,s),o(i,r),o(i,c),o(c,a),o(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);h||(_=P(a,"keyup",l[5]),h=!0)},p(p,k){if(k&17){g=p[0].people;let b;for(b=0;b<g.length;b+=1){const C=el(p,g,b);m[b]?m[b].p(C,k):(m[b]=tl(C),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:V,o:V,d(p){p&&q(t),ge(m,p),h=!1,_()}}}function Vl(l){let t,e;return t=new gt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){me(t.$$.fragment)},m(n,i){de(t,n,i),e=!0},p(n,i){const s={};i&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){le(t.$$.fragment,n),e=!1},d(n){_e(t,n)}}}function Gl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){H(e,t,n)},p:V,i:V,o:V,d(e){e&&q(t)}}}function tl(l){let t,e,n,i,s,r,c,a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",u,h,_,g;function m(...p){return l[7](l[10],...p)}return{c(){t=d("div"),e=d("div"),n=d("div"),i=d("img"),r=x(),c=d("div"),u=M(a),h=x(),ye(i.src,s="/api/getPreviewPerson/"+l[10])||f(i,"src",s),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(n,"class","h-[160px] w-[160px] bg-gray-800"),f(c,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(p,k){H(p,t,k),o(t,e),o(e,n),o(n,i),o(e,r),o(e,c),o(c,u),o(t,h),_||(g=P(t,"click",m),_=!0)},p(p,k){l=p,k&1&&!ye(i.src,s="/api/getPreviewPerson/"+l[10])&&f(i,"src",s),k&1&&a!==(a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&Q(u,a)},d(p){p&&q(t),_=!1,g()}}}function Xl(l){let t,e,n,i;const s=[Gl,Vl,Ul],r=[];function c(a,u){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(a,u){r[t].m(a,u),H(a,n,u),i=!0},p(a,[u]){let h=t;t=c(a),t===h?r[t].p(a,u):(ot(),le(r[h],1,1,()=>{r[h]=null}),at(),e=r[t],e?e.p(a,u):(e=r[t]=s[t](a),e.c()),Z(e,1),e.m(n.parentNode,n))},i(a){i||(Z(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&q(n)}}}function Ql(l,t,e){let n={people:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,c=!0,a;Ue(()=>{e(3,c=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(p=>{let k=p.meta_data.length;for(let b=0;b<k;b++)i.list_dataHash.push(p.data_hash[b]),i.list_score.push(p.score[b]),i.list_metaData.push(p.meta_data[b]);e(3,c=!0),e(0,n.people=p.person,n),a=n.people})})}),it(()=>{console.log("destroying... people..")});async function u(m){e(2,r=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1});for(let p=0;p<i.list_dataHash.length;p++)i.list_metaData[p].person.includes(m)&&(s.list_metaData.push(i.list_metaData[p]),s.list_dataHash.push(i.list_dataHash[p]),s.list_score.push(i.list_score[p]));e(1,s.done=!0,s),e(2,r=!0),a&&e(0,n.people=a,n),Ee.update(p=>structuredClone(s))}function h(m){let p=m.target.value;if(p=p.toLowerCase(),!p){a&&e(0,n.people=a,n);return}p&&c==!0&&a&&(e(0,n.people=[],n),a.forEach(k=>{k.toLowerCase().includes(p)&&n.people.push(k)}))}return[n,s,r,c,u,h,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,p)=>{console.log("mine is: ",m),u(m)}]}class Kl extends Fe{constructor(t){super(),De(this,t,Ql,Xl,xe,{})}}function ll(l,t,e){const n=l.slice();return n[8]=t[e],n}function Wl(l){let t,e,n,i=l[0].places,s=[];for(let r=0;r<i.length;r+=1)s[r]=nl(ll(l,i,r));return{c(){t=d("div"),e=x(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,c){H(r,t,c),H(r,e,c),H(r,n,c);for(let a=0;a<s.length;a+=1)s[a].m(n,null)},p(r,c){if(c&17){i=r[0].places;let a;for(a=0;a<i.length;a+=1){const u=ll(r,i,a);s[a]?s[a].p(u,c):(s[a]=nl(u),s[a].c(),s[a].m(n,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},i:V,o:V,d(r){r&&q(t),r&&q(e),r&&q(n),ge(s,r)}}}function Jl(l){let t,e;return t=new gt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){me(t.$$.fragment)},m(n,i){de(t,n,i),e=!0},p(n,i){const s={};i&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Z(t.$$.fragment,n),e=!0)},o(n){le(t.$$.fragment,n),e=!1},d(n){_e(t,n)}}}function Yl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){H(e,t,n)},p:V,i:V,o:V,d(e){e&&q(t)}}}function nl(l){let t,e,n,i,s,r,c,a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,h,_,g;function m(...p){return l[6](l[8],...p)}return{c(){t=d("div"),e=d("div"),n=d("div"),i=d("img"),r=x(),c=d("div"),u=M(a),h=x(),ye(i.src,s=zl)||f(i,"src",s),f(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(n,"class","h-[150px] w-[200px] bg-gray-800"),f(c,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(p,k){H(p,t,k),o(t,e),o(e,n),o(n,i),o(e,r),o(e,c),o(c,u),o(t,h),_||(g=P(t,"click",m),_=!0)},p(p,k){l=p,k&1&&a!==(a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&Q(u,a)},d(p){p&&q(t),_=!1,g()}}}function Zl(l){let t,e,n,i;const s=[Yl,Jl,Wl],r=[];function c(a,u){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=s[t](l),{c(){e.c(),n=Ne()},m(a,u){r[t].m(a,u),H(a,n,u),i=!0},p(a,[u]){let h=t;t=c(a),t===h?r[t].p(a,u):(ot(),le(r[h],1,1,()=>{r[h]=null}),at(),e=r[t],e?e.p(a,u):(e=r[t]=s[t](a),e.c()),Z(e,1),e.m(n.parentNode,n))},i(a){i||(Z(e),i=!0)},o(a){le(e),i=!1},d(a){r[t].d(a),a&&q(n)}}}function $l(l,t,e){let n={places:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,c=!0;Ue(()=>{e(3,c=!1),fetch("/api/getGroup/place").then(_=>{_.json().then(g=>{let m=g.meta_data.length;for(let p=0;p<m;p++)i.list_dataHash.push(g.data_hash[p]),i.list_score.push(g.score[p]),i.list_metaData.push(g.meta_data[p]);e(3,c=!0),e(0,n.places=g.place,n)})})}),it(()=>{console.log("destroying...")});async function a(_){e(2,r=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ee.update(g=>structuredClone(s));for(let g=0;g<i.list_dataHash.length;g++)i.list_metaData[g].place.toLowerCase()===_.toLowerCase()&&(s.list_metaData.push(i.list_metaData[g]),s.list_dataHash.push(i.list_dataHash[g]),s.list_score.push(i.list_score[g]));e(1,s.done=!0,s),e(2,r=!0),Ee.update(g=>structuredClone(s))}return[n,s,r,c,a,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),a(_)}]}class en extends Fe{constructor(t){super(),De(this,t,$l,Zl,xe,{})}}function tn(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),s=new Kl({}),{c(){t=d("div"),me(e.$$.fragment),n=x(),i=d("div"),me(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(c,a){H(c,t,a),de(e,t,null),o(t,n),o(t,i),de(s,i,null),r=!0},p(c,a){const u={};a&32&&(u.sidebarOpen=c[5]),e.$set(u)},i(c){r||(Z(e.$$.fragment,c),Z(s.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(s.$$.fragment,c),r=!1},d(c){c&&q(t),_e(e),_e(s)}}}function ln(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),s=new en({}),{c(){t=d("div"),me(e.$$.fragment),n=x(),i=d("div"),me(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(c,a){H(c,t,a),de(e,t,null),o(t,n),o(t,i),de(s,i,null),r=!0},p(c,a){const u={};a&32&&(u.sidebarOpen=c[5]),e.$set(u)},i(c){r||(Z(e.$$.fragment,c),Z(s.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(s.$$.fragment,c),r=!1},d(c){c&&q(t),_e(e),_e(s)}}}function nn(l){let t,e,n,i,s,r;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[11]),e.$on("sidebarStateChange",l[12]),s=new jl({}),{c(){t=d("div"),me(e.$$.fragment),n=x(),i=d("div"),me(s.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(c,a){H(c,t,a),de(e,t,null),o(t,n),o(t,i),de(s,i,null),r=!0},p(c,a){const u={};a&32&&(u.sidebarOpen=c[5]),e.$set(u)},i(c){r||(Z(e.$$.fragment,c),Z(s.$$.fragment,c),r=!0)},o(c){le(e.$$.fragment,c),le(s.$$.fragment,c),r=!1},d(c){c&&q(t),_e(e),_e(s)}}}function sn(l){let t,e,n,i,s,r,c,a;return e=new ct({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[8]),e.$on("sidebarStateChange",l[9]),s=new wl({props:{query_button_disabled:l[1]}}),s.$on("queryReady",l[10]),c=new gt({props:{image_data:l[0]}}),{c(){t=d("div"),me(e.$$.fragment),n=x(),i=d("div"),me(s.$$.fragment),r=x(),me(c.$$.fragment),f(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,h){H(u,t,h),de(e,t,null),o(t,n),o(t,i),de(s,i,null),o(i,r),de(c,i,null),a=!0},p(u,h){const _={};h&32&&(_.sidebarOpen=u[5]),e.$set(_);const g={};h&2&&(g.query_button_disabled=u[1]),s.$set(g);const m={};h&1&&(m.image_data=u[0]),c.$set(m)},i(u){a||(Z(e.$$.fragment,u),Z(s.$$.fragment,u),Z(c.$$.fragment,u),a=!0)},o(u){le(e.$$.fragment,u),le(s.$$.fragment,u),le(c.$$.fragment,u),a=!1},d(u){u&&q(t),_e(e),_e(s),_e(c)}}}function rn(l){let t,e,n,i;const s=[sn,nn,ln,tn],r=[];function c(a,u){return a[4].query.status?0:a[4].indexing.status===!0?1:a[4].place_album.status===!0?2:a[4].people_album.status===!0?3:-1}return~(t=c(l))&&(e=r[t]=s[t](l)),{c(){e&&e.c(),n=Ne()},m(a,u){~t&&r[t].m(a,u),H(a,n,u),i=!0},p(a,[u]){let h=t;t=c(a),t===h?~t&&r[t].p(a,u):(e&&(ot(),le(r[h],1,1,()=>{r[h]=null}),at()),~t?(e=r[t],e?e.p(a,u):(e=r[t]=s[t](a),e.c()),Z(e,1),e.m(n.parentNode,n)):e=null)},i(a){i||(Z(e),i=!0)},o(a){le(e),i=!1},d(a){~t&&r[t].d(a),a&&q(n)}}}let on=3;function an(l,t,e){let n=[],i=[],s=[],r,c={list_metaData:[],list_dataHash:[],list_score:[],done:!1},a=!1,u="",h={};async function _(y="xxxxxxx",E=!1){console.log("handleClick count",u,E,y),e(1,a=!0);let B=on;if(r=new FormData,u.length===0)return;r.append("query",u),r.append("topk",B.toString()),E==!1?(i=[],n=[],s=[],e(0,c={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),r.append("query_start","true"),Ee.update($=>c)):(r.append("query_start","false"),r.append("client_id",y));let R=await fetch("/api/query",{method:"POST",body:r});if(!R.ok)throw e(1,a=!1),new Error(R);let z=await R.json();console.log("data: ",z);let J=z.client_id,Y=z.meta_data,G=z.data_hash,X=z.score;for(let $=0;$<Y.length;$++){let ie=G[$],ne=X[$];i.push(ie),n.push(ne),s.push(Y[$]),c.list_dataHash.push(ie),c.list_score.push(ne),c.list_metaData.push(Y[$])}if(z.query_completed==!0?e(0,c.done=!0,c):e(0,c),z.query_completed==!0){e(1,a=!1),console.log("hey i am being called!!!"),Ee.update($=>c);return}await _(J,!0)}const g={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function m(y){g[y].status==!1&&(e(0,c={list_metaData:[],list_dataHash:[],list_score:[],done:!1}),Ee.update(B=>structuredClone(c)));let E=Object.keys(g);for(let B=0;B<E.length;B++)g[E[B]].status&&e(4,g[E[B]].status=!1,g);g[y]&&e(4,g[y].status=!0,g)}let p=!0;function k(y){let E=y.detail.item.name;E.toLowerCase().includes("photo")?m("query"):E.toLowerCase().includes("index")?m("indexing"):E.toLowerCase().includes("people")?m("people_album"):E.toLowerCase().includes("place")&&m("place_album")}return[c,a,u,h,g,p,_,k,y=>{k(y)},y=>{e(5,p=y.detail.open)},y=>{e(2,u=y.detail.query),e(3,h=y.detail.attributes),_()},y=>k(y),y=>{e(5,p=y.detail.open)},y=>k(y),y=>{e(5,p=y.detail.open)},y=>k(y),y=>{e(5,p=y.detail.open)}]}class cn extends Fe{constructor(t){super(),De(this,t,an,rn,xe,{})}}new cn({target:document.getElementById("app")});
