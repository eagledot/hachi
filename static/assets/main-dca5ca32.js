(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function z(){}function hl(l){return l()}function Ot(){return Object.create(null)}function be(l){l.forEach(hl)}function kt(l){return typeof l=="function"}function je(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let ot;function Oe(l,t){return ot||(ot=document.createElement("a")),ot.href=t,l===ot.href}function kl(l){return Object.keys(l).length===0}function c(l,t){l.appendChild(t)}function F(l,t,e){l.insertBefore(t,e||null)}function O(l){l.parentNode&&l.parentNode.removeChild(l)}function xe(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function _(l){return document.createElement(l)}function wl(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function G(l){return document.createTextNode(l)}function w(){return G(" ")}function Ie(){return G("")}function N(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function yl(l){return l===""?null:+l}function xl(l){return Array.from(l.childNodes)}function Q(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ft(l,t){l.value=t??""}function he(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ft(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function Cl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function Sl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const n=document.createEvent("CustomEvent");return n.initCustomEvent(l,e,s,t),n}let Ye;function Je(l){Ye=l}function wt(){if(!Ye)throw new Error("Function called outside component initialization");return Ye}function Fe(l){wt().$$.on_mount.push(l)}function Ze(l){wt().$$.on_destroy.push(l)}function _t(){const l=wt();return(t,e,{cancelable:s=!1}={})=>{const n=l.$$.callbacks[t];if(n){const r=Sl(t,e,{cancelable:s});return n.slice().forEach(i=>{i.call(l,r)}),!r.defaultPrevented}return!0}}const Ve=[],Pe=[],at=[],Lt=[],Dl=Promise.resolve();let vt=!1;function jl(){vt||(vt=!0,Dl.then(ml))}function dt(l){at.push(l)}const gt=new Set;let Ue=0;function ml(){if(Ue!==0)return;const l=Ye;do{try{for(;Ue<Ve.length;){const t=Ve[Ue];Ue++,Je(t),Ol(t.$$)}}catch(t){throw Ve.length=0,Ue=0,t}for(Je(null),Ve.length=0,Ue=0;Pe.length;)Pe.pop()();for(let t=0;t<at.length;t+=1){const e=at[t];gt.has(e)||(gt.add(e),e())}at.length=0}while(Ve.length);for(;Lt.length;)Lt.pop()();vt=!1,gt.clear(),Je(l)}function Ol(l){if(l.fragment!==null){l.update(),be(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(dt)}}const ct=new Set;let Be;function $e(){Be={r:0,c:[],p:Be}}function et(){Be.r||be(Be.c),Be=Be.p}function J(l,t){l&&l.i&&(ct.delete(l),l.i(t))}function Y(l,t,e,s){if(l&&l.o){if(ct.has(l))return;ct.add(l),Be.c.push(()=>{ct.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function de(l){l&&l.c()}function oe(l,t,e,s){const{fragment:n,after_update:r}=l.$$;n&&n.m(t,e),s||dt(()=>{const i=l.$$.on_mount.map(hl).filter(kt);l.$$.on_destroy?l.$$.on_destroy.push(...i):be(i),l.$$.on_mount=[]}),r.forEach(dt)}function ae(l,t){const e=l.$$;e.fragment!==null&&(be(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Fl(l,t){l.$$.dirty[0]===-1&&(Ve.push(l),jl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Le(l,t,e,s,n,r,i,a=[-1]){const o=Ye;Je(l);const u=l.$$={fragment:null,ctx:[],props:r,update:z,not_equal:n,bound:Ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:Ot(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};i&&i(u.root);let d=!1;if(u.ctx=e?e(l,t.props||{},(p,g,...m)=>{const h=m.length?m[0]:g;return u.ctx&&n(u.ctx[p],u.ctx[p]=h)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](h),d&&Fl(l,p)),g}):[],u.update(),d=!0,be(u.before_update),u.fragment=s?s(u.ctx):!1,t.target){if(t.hydrate){const p=xl(t.target);u.fragment&&u.fragment.l(p),p.forEach(O)}else u.fragment&&u.fragment.c();t.intro&&J(l.$$.fragment),oe(l,t.target,t.anchor,t.customElement),ml()}Je(o)}class Te{$destroy(){ae(this,1),this.$destroy=z}$on(t,e){if(!kt(e))return z;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const n=s.indexOf(e);n!==-1&&s.splice(n,1)}}$set(t){this.$$set&&!kl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ge=[];function Re(l,t=z){let e;const s=new Set;function n(a){if(je(l,a)&&(l=a,e)){const o=!Ge.length;for(const u of s)u[1](),Ge.push(u,l);if(o){for(let u=0;u<Ge.length;u+=2)Ge[u][0](Ge[u+1]);Ge.length=0}}}function r(a){n(a(l))}function i(a,o=z){const u=[a,o];return s.add(u),s.size===1&&(e=t(n)||z),a(l),()=>{s.delete(u),s.size===0&&(e(),e=null)}}return{set:n,update:r,subscribe:i}}const yt=Re(0),xt=Re(0),Ct=Re(0),gl=Re(0),ut=Re([]);let Ll={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ae=Re(Ll),bl=Re([]);function Tt(l,t,e){const s=l.slice();return s[26]=t[e],s}function qt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Nt(l,t,e){const s=l.slice();return s[34]=t[e],s}function Et(l){let t,e=l[4][l[29]],s=[];for(let n=0;n<e.length;n+=1)s[n]=Pt(Nt(l,e,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=w()},m(n,r){for(let i=0;i<s.length;i+=1)s[i].m(n,r);F(n,t,r)},p(n,r){if(r[0]&2576){e=n[4][n[29]];let i;for(i=0;i<e.length;i+=1){const a=Nt(n,e,i);s[i]?s[i].p(a,r):(s[i]=Pt(a),s[i].c(),s[i].m(t.parentNode,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=e.length}},d(n){xe(s,n),n&&O(t)}}}function Pt(l){let t,e,s,n=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",r,i,a,o=l[34]+" ",u,d,p,g,m;function h(...v){return l[14](l[29],l[34],...v)}return{c(){t=_("div"),e=_("div"),s=_("span"),r=G(n),i=w(),a=_("span"),u=G(o),d=w(),p=_("span"),p.textContent="x",f(s,"class","text-blue-800 "),f(a,"class","ml-1 text-sm font-semibold"),f(p,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),f(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),f(t,"class","flex items-center justify-center")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(e,d),c(e,p),g||(m=[N(p,"click",h),N(e,"click",function(){kt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(v,b){l=v,b[0]&16&&n!==(n=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&Q(r,n),b[0]&16&&o!==(o=l[34]+" ")&&Q(u,o)},d(v){v&&O(t),g=!1,be(m)}}}function At(l){let t,e=l[4][l[29]].length>=1&&Et(l);return{c(){e&&e.c(),t=Ie()},m(s,n){e&&e.m(s,n),F(s,t,n)},p(s,n){s[4][s[29]].length>=1?e?e.p(s,n):(e=Et(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function It(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,n,r;return{c(){t=_("option"),s=G(e),n=w(),t.__value=r=l[29],t.value=t.__value},m(i,a){F(i,t,a),c(t,s),c(t,n)},p(i,a){a[0]&16&&e!==(e=i[29].charAt(0).toUpperCase()+i[29].slice(1)+"")&&Q(s,e),a[0]&16&&r!==(r=i[29])&&(t.__value=r,t.value=t.__value)},d(i){i&&O(t)}}}function Mt(l){let t,e,s,n,r,i,a,o,u=l[3],d=[];for(let p=0;p<u.length;p+=1)d[p]=Bt(Tt(l,u,p));return{c(){t=_("div"),e=_("ul");for(let p=0;p<d.length;p+=1)d[p].c();s=w(),n=_("div"),r=_("button"),r.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(r,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(n,"class","flex w-full justify-center items-center"),f(t,"class",i=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(p,g){F(p,t,g),c(t,e);for(let m=0;m<d.length;m+=1)d[m].m(e,null);c(t,s),c(t,n),c(n,r),a||(o=N(r,"click",l[22]),a=!0)},p(p,g){if(g[0]&1034){u=p[3];let m;for(m=0;m<u.length;m+=1){const h=Tt(p,u,m);d[m]?d[m].p(h,g):(d[m]=Bt(h),d[m].c(),d[m].m(e,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=u.length}g[0]&32&&i!==(i=(p[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",i)},d(p){p&&O(t),xe(d,p),a=!1,o()}}}function Bt(l){let t,e=l[26]+"",s,n,r,i;function a(){return l[21](l[26])}return{c(){t=_("li"),s=G(e),n=w(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(o,u){F(o,t,u),c(t,s),c(t,n),r||(i=N(t,"click",a),r=!0)},p(o,u){l=o,u[0]&8&&e!==(e=l[26]+"")&&Q(s,e)},d(o){o&&O(t),r=!1,i()}}}function Rt(l){let t;return{c(){t=_("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,f(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Tl(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S=Object.keys(l[4]),q=[];for(let y=0;y<S.length;y+=1)q[y]=At(Ht(l,S,y));let P=Object.keys(l[4]),T=[];for(let y=0;y<P.length;y+=1)T[y]=It(qt(l,P,y));let C=l[3].length>0&&Mt(l),D=l[6]==!0&&Rt();return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("div");for(let y=0;y<q.length;y+=1)q[y].c();r=w(),i=_("div"),a=_("select");for(let y=0;y<T.length;y+=1)T[y].c();o=w(),u=_("div"),d=_("input"),p=w(),g=_("div"),m=_("button"),m.textContent="Search",h=w(),C&&C.c(),v=w(),D&&D.c(),f(n,"class","flex w-full items-center my-3 flex-wrap text-lg"),f(a,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(a,"name","select-option"),f(a,"id","select-option"),l[1]===void 0&&dt(()=>l[16].call(a)),f(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(d,"type","search"),f(d,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(g,"class","flex"),f(i,"class","flex space-x-2"),f(s,"class","w-full"),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(y,j){F(y,t,j),c(t,e),c(e,s),c(s,n);for(let k=0;k<q.length;k+=1)q[k].m(n,null);c(s,r),c(s,i),c(i,a);for(let k=0;k<T.length;k+=1)T[k].m(a,null);Ft(a,l[1]),c(i,o),c(i,u),c(u,d),l[17](d),c(i,p),c(i,g),c(g,m),l[20](m),c(e,h),C&&C.m(e,null),c(e,v),D&&D.m(e,null),b||(x=[N(a,"change",l[15]),N(a,"change",l[16]),N(d,"focus",l[18],{once:!0}),N(d,"focusout",l[19]),N(d,"keyup",l[8]),N(d,"keydown",l[7]),N(m,"click",l[12])],b=!0)},p(y,j){if(j[0]&2576){S=Object.keys(y[4]);let k;for(k=0;k<S.length;k+=1){const U=Ht(y,S,k);q[k]?q[k].p(U,j):(q[k]=At(U),q[k].c(),q[k].m(n,null))}for(;k<q.length;k+=1)q[k].d(1);q.length=S.length}if(j[0]&16){P=Object.keys(y[4]);let k;for(k=0;k<P.length;k+=1){const U=qt(y,P,k);T[k]?T[k].p(U,j):(T[k]=It(U),T[k].c(),T[k].m(a,null))}for(;k<T.length;k+=1)T[k].d(1);T.length=P.length}j[0]&18&&Ft(a,y[1]),y[3].length>0?C?C.p(y,j):(C=Mt(y),C.c(),C.m(e,v)):C&&(C.d(1),C=null),y[6]==!0?D||(D=Rt(),D.c(),D.m(e,null)):D&&(D.d(1),D=null)},i:z,o:z,d(y){y&&O(t),xe(q,y),xe(T,y),l[17](null),l[20](null),C&&C.d(),D&&D.d(),b=!1,be(x)}}}async function ql(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let n=await fetch(e,{method:"POST",body:s});return n.ok===!0?await n.json():{}}function Hl(l,t,e){Fe(()=>{bl.subscribe(H=>{for(let I=0;I<H.length;I++)e(4,d[H[I]]=[],d)})});const s=_t();let n="query",r,i,{query_button_disabled:a=!1}=t,o="",u=[],d={query:[]},p=!1;var g={};function m(H){g[H.keyCode]=H.type=="keydown",g[13]==!0&&H.shiftKey&&(console.log("shift enter combination."),S())}async function h(H){e(6,q=!1),g[H.keyCode]=!1;let I=H.target;if(I.value.length==0){e(3,u=[]);return}if(console.log("current value: ",I.value),H.keyCode==13){let R=d[n].length;I.value.length>0&&!d[n].includes(I.value)&&e(4,d[n][R]=I.value,d),I.value="",e(3,u=[]),e(5,p=!1);return}let L=await ql(n,I.value);n in L?(e(3,u=L[n]),e(5,p=!0)):(e(3,u=[]),e(5,p=!1))}function v(H,I,L){let R=d[I].indexOf(L);R>=0&&(d[I].splice(R,1),e(4,d)),n==I&&e(3,u=[])}function b(H,I){e(5,p=!1),e(2,r.value=I,r),r.focus()}function x(H){e(1,n=H),e(3,u=d[n]),e(5,p=!0),r.focus()}function S(H){let I="&",L="?",R="=",K=d[n].length;r.value.length>0&&!d[n].includes(r.value)&&e(4,d[n][K]=r.value,d);let X=Object.keys(d);o="";for(let te=0;te<X.length;te++){let Z=X[te],se=d[Z];o+=Z+R;for(let ee=0;ee<se.length;ee++)o+=se[ee],ee!=se.length-1&&(o+=L);te!=X.length-1&&(o+=I)}console.log("Completed: "+o),e(2,r.value="",r),i.disabled==!1?s("queryReady",{query:o,attributes:d}):console.log("chill dawg!!!")}let q=!1;const P=(H,I,L)=>v(L.currentTarget,H,I),T=H=>x(H.target.value);function C(){n=Cl(this),e(1,n),e(4,d)}function D(H){Pe[H?"unshift":"push"](()=>{r=H,e(2,r)})}const y=H=>{H.target.value.length==0&&e(6,q=!0)},j=H=>{e(6,q=!1)};function k(H){Pe[H?"unshift":"push"](()=>{i=H,e(0,i),e(13,a)})}const U=H=>b(n,H),V=()=>e(5,p=!1);return l.$$set=H=>{"query_button_disabled"in H&&e(13,a=H.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&i&&e(0,i.disabled=a,i)},[i,n,r,u,d,p,q,m,h,v,b,x,S,a,P,T,C,D,y,j,k,U,V]}class Nl extends Te{constructor(t){super(),Le(this,t,Hl,Tl,je,{query_button_disabled:13},null,[-1,-1])}}function zt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function El(l){let t,e,s;return{c(){t=_("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(n,r){F(n,t,r),e||(s=N(t,"click",l[2]),e=!0)},p:z,d(n){n&&O(t),e=!1,s()}}}function Pl(l){let t,e,s,n,r;return{c(){t=_("span"),t.textContent="Hachi",e=w(),s=_("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(s,"class","cursor-pointer px-4")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a),n||(r=N(s,"click",l[3]),n=!0)},p:z,d(i){i&&O(t),i&&O(e),i&&O(s),n=!1,r()}}}function Ut(l){let t,e,s=l[8].name+"",n,r,i,a=l[8].count+"",o;return{c(){t=_("div"),e=_("div"),n=G(s),r=w(),i=_("div"),o=G(a),f(e,"class","flex"),f(e,"data-ix",l[10]),f(i,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,d){F(u,t,d),c(t,e),c(e,n),c(t,r),c(t,i),c(i,o)},p(u,d){d&2&&s!==(s=u[8].name+"")&&Q(n,s),d&2&&a!==(a=u[8].count+"")&&Q(o,a)},d(u){u&&O(t)}}}function Gt(l){let t,e,s,n,r,i,a,o=l[0].sidebarOpen&&Ut(l);function u(){return l[6](l[10])}return{c(){t=_("div"),e=_("i"),n=w(),o&&o.c(),r=w(),f(e,"class",s="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,p){F(d,t,p),c(t,e),c(t,n),o&&o.m(t,null),c(t,r),i||(a=N(t,"click",u),i=!0)},p(d,p){l=d,p&2&&s!==(s="fa-solid fa-"+l[8].icon)&&f(e,"class",s),l[0].sidebarOpen?o?o.p(l,p):(o=Ut(l),o.c(),o.m(t,r)):o&&(o.d(1),o=null)},d(d){d&&O(t),o&&o.d(),i=!1,a()}}}function Al(l){let t,e,s,n,r,i;function a(g,m){return g[0].sidebarOpen?Pl:El}let o=a(l),u=o(l),d=l[1],p=[];for(let g=0;g<d.length;g+=1)p[g]=Gt(zt(l,d,g));return{c(){t=_("div"),e=_("aside"),s=_("div"),u.c(),n=w(),r=_("nav");for(let g=0;g<p.length;g+=1)p[g].c();f(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(r,"class","mt-6"),f(e,"class",i=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-100 text-white")},m(g,m){F(g,t,m),c(t,e),c(e,s),u.m(s,null),c(e,n),c(e,r);for(let h=0;h<p.length;h+=1)p[h].m(r,null)},p(g,[m]){if(o===(o=a(g))&&u?u.p(g,m):(u.d(1),u=o(g),u&&(u.c(),u.m(s,null))),m&19){d=g[1];let h;for(h=0;h<d.length;h+=1){const v=zt(g,d,h);p[h]?p[h].p(v,m):(p[h]=Gt(v),p[h].c(),p[h].m(r,null))}for(;h<p.length;h+=1)p[h].d(1);p.length=d.length}m&1&&i!==(i=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",i)},i:z,o:z,d(g){g&&O(t),u.d(),xe(p,g)}}}function Il(l,t,e){const s=_t();let{sidebarOpen:n=!1}=t;const r={sidebarOpen:n},i=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0},{icon:"folder",path:"#",name:"Local",count:0},{icon:"image",path:"#",name:"Google Photos",count:0}];Fe(()=>{yt.subscribe(p=>{i&&e(1,i[0].count=p,i)}),xt.subscribe(p=>{i&&e(1,i[3].count=p,i)}),Ct.subscribe(p=>{i&&e(1,i[4].count=p,i)}),gl.subscribe(p=>{i&&e(1,i[5].count=p,i)})});function a(){e(0,r.sidebarOpen=!0,r)}function o(){e(0,r.sidebarOpen=!1,r)}function u(p){s("menuClick",{item:i[p]})}const d=p=>{u(p)};return l.$$set=p=>{"sidebarOpen"in p&&e(5,n=p.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&r&&s("sidebarStateChange",{open:r.sidebarOpen})},[r,i,a,o,u,n,d]}class Ke extends Te{constructor(t){super(),Le(this,t,Il,Al,je,{sidebarOpen:5})}}function Ml(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S,q,P,T,C=(l[4]*100).toString().slice(0,4)+"",D,y,j,k,U,V,H,I,L,R,K,X,te,Z,se,ee,ke,ne,W,_e,ce,ve,Ce,Me,Se,qe,ye,De,we,re,me,He,E,M,B,$,A,ge,Ne;return{c(){t=_("div"),e=_("p"),e.textContent="Press Start button to start indexing",s=w(),n=_("div"),r=_("input"),i=w(),a=_("p"),a.textContent="OR",o=w(),u=_("div"),d=_("select"),p=_("option"),p.textContent="None selected",g=_("option"),g.textContent="google_photos",m=w(),h=_("div"),h.textContent="Choose a supported remote protocol",v=w(),b=_("div"),x=_("div"),S=_("div"),q=_("div"),P=w(),T=_("div"),D=G(C),y=G("%"),j=w(),k=_("div"),U=G("Current directory: "),V=_("span"),H=G(l[5]),I=w(),L=_("span"),L.textContent="ETA:",R=w(),K=_("span"),X=G(l[7]),te=w(),Z=_("div"),se=G("Details: "),ee=_("span"),ke=G(l[6]),ne=w(),W=_("div"),_e=_("div"),ce=_("input"),ve=w(),Ce=_("label"),Ce.textContent="Complete Rescan",Me=w(),Se=_("div"),Se.textContent="Re-index all originals, including already indexed and unchanged files.",qe=w(),ye=_("div"),De=_("select"),we=_("option"),we.textContent="Images Only",re=_("option"),re.textContent="Videos Only",me=_("option"),me.textContent="Videos and Images",He=w(),E=_("div"),E.textContent="Filter by content type",M=w(),B=_("button"),B.textContent="Cancel",$=w(),A=_("button"),A.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(r,"type","text"),f(r,"class","w-full rounded border p-1 text-sm disabled:bg-gray-200"),f(r,"placeholder","D://images (Full path to directory to index)"),r.required=!0,f(a,"class","font-semibold"),p.__value="None selected",p.value=p.__value,g.__value="google_photos",g.value=g.__value,f(d,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(h,"class","ml-2 text-sm text-gray-600"),f(u,"class","mb-3 mt-3 flex flex-wrap items-center"),f(n,"class","my-2"),f(q,"class","h-2rounded bg-blue-500"),he(q,"width",(l[4]*100).toString()+"%"),f(S,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(T,"class","flex px-2 font-semibold"),f(x,"class","flex items-center"),f(V,"class","text-black"),f(L,"class","pl-3 text-right"),f(K,"class","text-black"),f(k,"class","pt-1 text-sm text-blue-600"),f(ee,"class","text-black"),f(Z,"class","pt-1 text-sm text-blue-600"),f(b,"class","mb-3"),f(ce,"type","checkbox"),f(ce,"class","h-5 w-5 text-blue-500"),f(Ce,"class","ml-1"),f(_e,"class","mr-2 flex items-center"),f(Se,"class","text-sm text-gray-600"),f(W,"class","mt-4 mb-3 flex flex-wrap items-center"),we.__value="Images Only",we.value=we.__value,re.disabled=!0,re.__value="Videos Only",re.value=re.__value,me.disabled=!0,me.__value="Videos and Images",me.value=me.__value,f(De,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(E,"class","ml-2 text-sm text-gray-600"),f(ye,"class","mb-3 mt-3 flex flex-wrap items-center"),B.disabled=!0,f(B,"type","button"),f(B,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(A,"type","button"),f(A,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(ue,ie){F(ue,t,ie),c(t,e),c(t,s),c(t,n),c(n,r),l[13](r),ft(r,l[8]),c(n,i),c(n,a),c(n,o),c(n,u),c(u,d),c(d,p),c(d,g),l[16](d),c(u,m),c(u,h),c(t,v),c(t,b),c(b,x),c(x,S),c(S,q),c(x,P),c(x,T),c(T,D),c(T,y),c(b,j),c(b,k),c(k,U),c(k,V),c(V,H),c(k,I),c(k,L),c(k,R),c(k,K),c(K,X),c(b,te),c(b,Z),c(Z,se),c(Z,ee),c(ee,ke),c(t,ne),c(t,W),c(W,_e),c(_e,ce),ce.checked=l[9],c(_e,ve),c(_e,Ce),c(W,Me),c(W,Se),c(t,qe),c(t,ye),c(ye,De),c(De,we),c(De,re),c(De,me),c(ye,He),c(ye,E),c(t,M),c(t,B),l[19](B),c(t,$),c(t,A),l[20](A),ge||(Ne=[N(r,"input",l[14]),N(r,"keydown",l[15]),N(d,"change",l[17]),N(ce,"change",l[18]),N(B,"click",l[11]),N(A,"click",l[10])],ge=!0)},p(ue,[ie]){ie&256&&r.value!==ue[8]&&ft(r,ue[8]),ie&16&&he(q,"width",(ue[4]*100).toString()+"%"),ie&16&&C!==(C=(ue[4]*100).toString().slice(0,4)+"")&&Q(D,C),ie&32&&Q(H,ue[5]),ie&128&&Q(X,ue[7]),ie&64&&Q(ke,ue[6]),ie&512&&(ce.checked=ue[9])},i:z,o:z,d(ue){ue&&O(t),l[13](null),l[16](null),l[19](null),l[20](null),ge=!1,be(Ne)}}}function Bl(l,t,e){let s,n,r;Fe(()=>{if(e(12,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let k="/api/getIndexStatus/"+s;e(0,n.disabled=!1,n),e(1,r.disabled=!0,r),h(k)}}),Ze(()=>{m&&clearTimeout(m)});let i,a,o=0,u="",d="",p="",g="",m;async function h(k,U=0){U==0&&console.log("starting a new polll...");let H=await(await fetch(k,{method:"GET"})).json();if(H.is_active==!0){if(H.done==!0){let L=H.details,R=new FormData;R.append("ack","true"),(await fetch(k,{method:"POST",body:R})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert(`Indexing Completed.
Final Status: `+L);let X=await fetch("/api/getMetaStats");X=await X.json(),yt.update(te=>Number(X.image.count)),xt.update(te=>Number(X.image.unique_people_count)),Ct.update(te=>Number(X.image.unique_place_count)),e(1,r.disabled=!1,r),e(12,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(4,o=0),e(5,u=""),e(7,p=""),e(6,d=""),e(8,g=""),e(0,n.disabled=!0,n),e(0,n.innerText="Cancel",n),e(2,i.disabled=!1,i),a&&e(3,a.value="None selected",a);return}e(4,o=H.progress),e(7,p=H.eta),e(6,d=H.details),e(5,u=H.current_directory),m&&clearTimeout(m),m=setTimeout(function(){h(k,U+1)},1e3)}}let v=!1;async function b(){if(r&&g){e(1,r.disabled=!0,r),e(2,i.disabled=!0,i);let k=new FormData;k.append("image_directory_path",g),k.append("complete_rescan",v.toString());let H=await(await fetch("/api/indexStart",{method:"POST",body:k})).json();if(H.success===!0){e(0,n.disabled=!1,n);let L="/api/getIndexStatus/"+H.statusEndpoint;e(12,s=H.statusEndpoint),h(L)}else alert(H.reason),e(1,r.disabled=!1,r),e(2,i.disabled=!1,i)}else console.log("No index_start_button object found!!!")}async function x(){if(s){e(0,n.disabled=!0,n),e(0,n.innerText="Cancelling... Please wait.",n);let k="/api/indexCancel/"+s,U=await fetch(k,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(12,s=null),!U.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(U);return}else return}function S(k){Pe[k?"unshift":"push"](()=>{i=k,e(2,i)})}function q(){g=this.value,e(8,g)}const P=k=>{k.key==="Enter"&&r.click()};function T(k){Pe[k?"unshift":"push"](()=>{a=k,e(3,a)})}const C=k=>{k.target.value=="None selected"?(e(8,g=""),e(2,i.disabled=!1,i)):(e(8,g=k.target.value),e(2,i.disabled=!0,i))};function D(){v=this.checked,e(9,v)}function y(k){Pe[k?"unshift":"push"](()=>{n=k,e(0,n)})}function j(k){Pe[k?"unshift":"push"](()=>{r=k,e(1,r)})}return l.$$.update=()=>{l.$$.dirty&4096&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[n,r,i,a,o,u,d,p,g,v,b,x,s,S,q,P,T,C,D,y,j]}class Rl extends Te{constructor(t){super(),Le(this,t,Bl,Ml,je,{})}}function Vt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=_("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Wt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),n,r,i,a=l[13]+"",o,u,d,p=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=_("div"),e=_("div"),p&&p.c(),r=w(),i=_("span"),o=G(a),f(e,"class",n="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){F(m,t,h),c(t,e),p&&p.m(e,null),c(t,r),c(t,i),c(i,o),u||(d=N(t,"click",g),u=!0)},p(m,h){l=m,h&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?p||(p=Xt(),p.c(),p.m(e,null)):p&&(p.d(1),p=null),h&2&&n!==(n="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",n),h&2&&a!==(a=l[13]+"")&&Q(o,a)},d(m){m&&O(t),p&&p.d(),u=!1,d()}}}function Qt(l){let t,e,s=l[10]+"",n,r,i,a,o,u,d,p,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,v=[];for(let b=0;b<h.length;b+=1)v[b]=Wt(Kt(l,h,b));return{c(){t=_("div"),e=_("div"),n=G(s),r=w(),i=_("i"),o=w(),u=_("div");for(let b=0;b<v.length;b+=1)v[b].c();f(i,"class",a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(b,x){F(b,t,x),c(t,e),c(e,n),c(e,r),c(e,i),c(t,o),c(t,u);for(let S=0;S<v.length;S+=1)v[S].m(u,null);p||(g=[N(e,"click",m),N(t,"mouseup",Kl)],p=!0)},p(b,x){if(l=b,x&2&&s!==(s=l[10]+"")&&Q(n,s),x&2&&a!==(a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(i,"class",a),x&6){h=l[1].selectFilters[l[10]].options;let S;for(S=0;S<h.length;S+=1){const q=Kt(l,h,S);v[S]?v[S].p(q,x):(v[S]=Wt(q),v[S].c(),v[S].m(u,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=h.length}x&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",d)},d(b){b&&O(t),xe(v,b),p=!1,be(g)}}}function zl(l){let t,e,s,n,r,i,a,o,u,d,p,g,m=Object.keys(l[1].selectFilters),h=[];for(let v=0;v<m.length;v+=1)h[v]=Qt(Vt(l,m,v));return{c(){t=_("div"),e=_("div"),s=_("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',n=w(),r=_("span"),r.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w();for(let v=0;v<h.length;v+=1)h[v].c();a=w(),o=_("button"),u=G("Filter"),f(s,"class","flex items-center text-md"),f(r,"class","flex items-center text-md"),o.disabled=l[0],f(o,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(e,n),c(e,r),c(e,i);for(let x=0;x<h.length;x+=1)h[x].m(e,null);c(e,a),c(e,o),c(o,u),p||(g=N(o,"click",l[4]),p=!0)},p(v,[b]){if(b&14){m=Object.keys(v[1].selectFilters);let x;for(x=0;x<m.length;x+=1){const S=Vt(v,m,x);h[x]?h[x].p(S,b):(h[x]=Qt(S),h[x].c(),h[x].m(e,a))}for(;x<h.length;x+=1)h[x].d(1);h.length=m.length}b&1&&(o.disabled=v[0]),b&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&f(o,"class",d)},i:z,o:z,d(v){v&&O(t),xe(h,v),p=!1,g()}}}function vl(l,t,e=null,s=(n,r)=>n===r){let n=[];for(let r=0;r<l.length;r++)e?s(l[r].key,t)?n.push(1):n.push(0):s(l[r],t)?n.push(1):n.push(0);return n}function Ul(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let n=vl(l,t[s]);for(let r=0;r<e.length;r++)e[r]=Number(Boolean(e[r])||Boolean(n[r]))}return e}function Gl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let n=vl(l,t[s],null,(r,i)=>r?r.includes(i):!1);for(let r=0;r<e.length;r++)e[r]=Number(Boolean(e[r])||Boolean(n[r]))}return e}function Vl(l){let t=l[0].length,e=l[0];return l.forEach((s,n)=>{if(n>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((r,i)=>{e[i]=Number(Boolean(e[i])&&Boolean(r))})}}),e}const Kl=l=>l.stopPropagation();function Xl(l,t,e){let s=[],{filter_button_disabled:n=!0}=t;ut.subscribe(m=>{e(0,n=!1),e(5,s=m)});const r=_t(),i={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Fe(()=>{document.addEventListener("mouseup",a)});function a(m){e(1,i.selectFilterActive="",i)}function o(m,h){if(i.selectFilters[m].values.includes(h)){e(1,i.selectFilters[m].values=i.selectFilters[m].values.filter(v=>v!==h),i);return}e(1,i.selectFilters[m].values=[h,...i.selectFilters[m].values],i)}function u(m){if(i.selectFilterActive===m){e(1,i.selectFilterActive="",i);return}e(1,i.selectFilterActive=m,i)}function d(){if(s){console.log(s);let m=[],h=[];s.map((P,T)=>{m.push(P.place),h.push(P.person)});let v=i.selectFilters.place.values,b=Ul(m,v),x=i.selectFilters.people.values,S=Gl(h,x),q=Vl([b,S]);r("filterApplied",{mask:q})}}const p=m=>u(m),g=(m,h)=>o(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,n=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((x,S)=>{if(x.place)return x.place}),h=[];s.map((x,S)=>{x.person&&x.person.forEach(q=>h.push(q))});let v=[];new Set(m).forEach(x=>v.push(x));let b=[];new Set(h).forEach(x=>b.push(x)),e(1,i.selectFilters.place.values=v,i),e(1,i.selectFilters.place.options=v,i),e(1,i.selectFilters.people.values=b,i),e(1,i.selectFilters.people.options=b,i)}},[n,i,o,u,d,s,p,g]}class Wl extends Te{constructor(t){super(),Le(this,t,Xl,zl,je,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[55]=t[e],s[54]=e,s}function Yt(l,t,e){const s=l.slice();return s[52]=t[e],s[54]=e,s}function Ql(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S,q,P,T=l[1]&&Zt(l);e=new Wl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[42]);let C=l[6],D=[];for(let j=0;j<C.length;j+=1)D[j]=el(Jt(l,C,j));let y=l[6].length>=Ee&&tl(l);return{c(){T&&T.c(),t=w(),de(e.$$.fragment),s=w(),n=_("div"),r=_("div"),i=_("div"),a=_("div"),o=_("div"),u=_("input"),d=w(),p=_("label"),g=G("Score threshold: "),m=G(l[12]),h=G("."),v=w(),b=_("div");for(let j=0;j<D.length;j+=1)D[j].c();x=w(),y&&y.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(p,"for","topk"),f(p,"class","dark:text-white"),f(o,"class","my-2"),f(i,"class","flex flex-row place-content-center mb-2 select-none mx-2"),f(b,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),f(r,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),f(n,"class","flex")},m(j,k){T&&T.m(j,k),F(j,t,k),oe(e,j,k),F(j,s,k),F(j,n,k),c(n,r),c(r,i),c(i,a),c(a,o),c(o,u),ft(u,l[12]),c(o,d),c(o,p),c(p,g),c(p,m),c(p,h),c(r,v),c(r,b);for(let U=0;U<D.length;U+=1)D[U].m(b,null);c(r,x),y&&y.m(r,null),S=!0,q||(P=[N(u,"change",l[20]),N(u,"change",l[43]),N(u,"input",l[43])],q=!0)},p(j,k){j[1]?T?T.p(j,k):(T=Zt(j),T.c(),T.m(t.parentNode,t)):T&&(T.d(1),T=null);const U={};if(k[0]&8&&(U.filter_button_disabled=j[3]),e.$set(U),k[0]&4096&&ft(u,j[12]),(!S||k[0]&4096)&&Q(m,j[12]),k[0]&33652801){C=j[6];let V;for(V=0;V<C.length;V+=1){const H=Jt(j,C,V);D[V]?D[V].p(H,k):(D[V]=el(H),D[V].c(),D[V].m(b,null))}for(;V<D.length;V+=1)D[V].d(1);D.length=C.length}j[6].length>=Ee?y?y.p(j,k):(y=tl(j),y.c(),y.m(r,null)):y&&(y.d(1),y=null)},i(j){S||(J(e.$$.fragment,j),S=!0)},o(j){Y(e.$$.fragment,j),S=!1},d(j){T&&T.d(j),j&&O(t),ae(e,j),j&&O(s),j&&O(n),xe(D,j),y&&y.d(),q=!1,be(P)}}}function Jl(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S,q,P,T,C=l[2].image_card_edit_interface&&ll(l),D=l[5]&&sl(l);return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,n=w(),r=_("div"),r.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',i=w(),a=_("div"),o=_("div"),o.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=w(),d=_("div"),p=_("div"),g=_("img"),h=w(),v=_("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=w(),C&&C.c(),x=w(),S=_("div"),S.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',q=w(),D&&D.c(),f(s,"class","cursor-pointer hover:underline text-gray-200"),f(r,"title","Fullscreen"),f(r,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(o,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(g,"class","w-auto cursor-pointer h-full"),Oe(g.src,m="/api/getRawData/"+l[4].data_hash)||f(g,"src",m),f(g,"alt",""),f(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(p,"class","flex shrink h-full"),f(d,"class","flex h-full items-center justify-center p-2 gap-4"),f(S,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(a,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(y,j){F(y,t,j),c(t,e),c(e,s),c(e,n),c(e,r),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(d,p),c(p,g),c(p,h),c(p,v),c(d,b),C&&C.m(d,null),c(a,x),c(a,S),c(t,q),D&&D.m(t,null),P||(T=[N(s,"click",l[34]),N(r,"click",l[35]),N(o,"click",l[36]),N(g,"click",l[37]),N(v,"click",l[38]),N(S,"click",l[40])],P=!0)},p(y,j){j[0]&16&&!Oe(g.src,m="/api/getRawData/"+y[4].data_hash)&&f(g,"src",m),y[2].image_card_edit_interface?C?C.p(y,j):(C=ll(y),C.c(),C.m(d,null)):C&&(C.d(1),C=null),y[5]?D?D.p(y,j):(D=sl(y),D.c(),D.m(t,null)):D&&(D.d(1),D=null)},i:z,o:z,d(y){y&&O(t),C&&C.d(),D&&D.d(),P=!1,be(T)}}}function Yl(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S,q,P=l[11]==!1&&nl(),T=l[10],C=[];for(let y=0;y<T.length;y+=1)C[y]=rl(Yt(l,T,y));let D=l[9].active&&il(l);return{c(){t=_("div"),e=_("div"),s=_("img"),r=w(),P&&P.c(),i=w();for(let y=0;y<C.length;y+=1)C[y].c();a=w(),D&&D.c(),o=w(),u=_("div"),d=_("div"),d.innerHTML='<i class="fa fa-arrow-left"></i>',p=w(),g=_("div"),g.innerHTML='<i class="fa fa-arrow-right"></i>',m=w(),h=_("div"),v=_("div"),v.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),x=_("div"),x.innerHTML='<i class="fa fa-arrows-alt"></i>',f(s,"class","object-cover h-screen w-auto"),Oe(s.src,n="/api/getRawDataFull/"+l[4].data_hash)||f(s,"src",n),f(s,"alt",""),f(e,"class","relative flex"),f(d,"class","text-white cursor-pointer"),f(g,"class","text-white cursor-pointer"),f(u,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(v,"class","cursor-pointer hover:underline text-white"),f(x,"title","Fullscreen"),f(x,"class","cursor-pointer text-white"),f(h,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(y,j){F(y,t,j),c(t,e),c(e,s),c(e,r),P&&P.m(e,null),c(e,i);for(let k=0;k<C.length;k+=1)C[k].m(e,null);c(e,a),D&&D.m(e,null),c(t,o),c(t,u),c(u,d),c(u,p),c(u,g),F(y,m,j),F(y,h,j),c(h,v),c(h,b),c(h,x),S||(q=[N(s,"load",l[19]),N(d,"click",l[30]),N(g,"click",l[31]),N(v,"click",l[32]),N(x,"click",l[33])],S=!0)},p(y,j){if(j[0]&16&&!Oe(s.src,n="/api/getRawDataFull/"+y[4].data_hash)&&f(s,"src",n),y[11]==!1?P||(P=nl(),P.c(),P.m(e,i)):P&&(P.d(1),P=null),j[0]&1792){T=y[10];let k;for(k=0;k<T.length;k+=1){const U=Yt(y,T,k);C[k]?C[k].p(U,j):(C[k]=rl(U),C[k].c(),C[k].m(e,a))}for(;k<C.length;k+=1)C[k].d(1);C.length=T.length}y[9].active?D?D.p(y,j):(D=il(y),D.c(),D.m(e,null)):D&&(D.d(1),D=null)},i:z,o:z,d(y){y&&O(t),P&&P.d(),xe(C,y),D&&D.d(),y&&O(m),y&&O(h),S=!1,be(q)}}}function Zt(l){let t,e,s,n,r;return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(s,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(i,a){F(i,t,a),c(t,e),c(e,s),n||(r=N(s,"click",l[41]),n=!0)},p:z,d(i){i&&O(t),n=!1,r()}}}function $t(l){let t,e,s,n,r,i;function a(){return l[44](l[54])}return{c(){t=_("div"),e=_("img"),n=w(),f(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),Oe(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])||f(e,"src",s),f(e,"alt","image"),f(t,"class","flex justify-center bg-black")},m(o,u){F(o,t,u),c(t,e),c(t,n),r||(i=[N(e,"load",l[25]),N(t,"click",a)],r=!0)},p(o,u){l=o,u[0]&65&&!Oe(e.src,s="api/getRawData/"+l[0].list_dataHash[l[55].ix])&&f(e,"src",s)},d(o){o&&O(t),r=!1,be(i)}}}function el(l){let t,e=l[55].ix>=0&&$t(l);return{c(){e&&e.c(),t=Ie()},m(s,n){e&&e.m(s,n),F(s,t,n)},p(s,n){s[55].ix>=0?e?e.p(s,n):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function tl(l){let t,e,s,n;return{c(){t=_("div"),e=_("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),f(t,"class","flex items-center justify-center")},m(r,i){F(r,t,i),c(t,e),s||(n=N(e,"click",l[14]),s=!0)},p:z,d(r){r&&O(t),s=!1,n()}}}function ll(l){let t,e,s,n,r,i,a,o,u,d,p,g,m,h,v,b,x,S,q,P,T,C,D,y,j,k,U,V,H,I,L,R,K,X,te,Z,se,ee,ke;return{c(){t=_("div"),e=_("div"),s=_("div"),s.textContent="Info",n=w(),r=_("div"),r.textContent="X",i=w(),a=_("div"),o=_("div"),o.textContent="Description",u=w(),d=_("input"),g=w(),m=_("div"),h=_("div"),h.textContent="place",v=w(),b=_("input"),S=w(),q=_("div"),P=_("div"),P.textContent="Tags",T=w(),C=_("input"),y=w(),j=_("div"),k=_("div"),k.textContent="Taken at:",U=w(),V=_("input"),H=w(),I=_("div"),L=_("div"),L.textContent="device",R=w(),K=_("input"),te=w(),Z=_("div"),se=_("button"),se.textContent="Save",f(s,"class","grow text-xl text-gray-100 font-bold"),f(r,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(o,"class","mb-1 text-gray-100"),f(d,"name","Description"),f(d,"placeholder",""),d.value=p=l[4].description.toString(),f(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(d,"type","text"),f(h,"class","mb-1 text-gray-100"),f(b,"name","place"),b.value=x=l[4].place.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(P,"class","mb-1 text-gray-100"),f(C,"name","tags"),f(C,"placeholder","Car, chair"),C.value=D=l[4].tags.toString(),f(C,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(C,"type","text"),f(k,"class","mb-1 text-gray-100"),f(V,"name","taken_at"),V.value="",f(V,"type","date"),f(V,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(L,"class","mb-1 text-gray-100"),f(K,"name","device"),f(K,"placeholder","Canon"),K.value=X=l[4].device.toString(),f(K,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(K,"type","text"),f(se,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(ne,W){F(ne,t,W),c(t,e),c(e,s),c(e,n),c(e,r),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(t,g),c(t,m),c(m,h),c(m,v),c(m,b),c(t,S),c(t,q),c(q,P),c(q,T),c(q,C),c(t,y),c(t,j),c(j,k),c(j,U),c(j,V),c(t,H),c(t,I),c(I,L),c(I,R),c(I,K),c(t,te),c(t,Z),c(Z,se),ee||(ke=[N(r,"click",l[39]),N(d,"change",l[23]),N(b,"change",l[23]),N(C,"change",l[23]),N(V,"change",l[23]),N(K,"change",l[23]),N(se,"click",l[24])],ee=!0)},p(ne,W){W[0]&16&&p!==(p=ne[4].description.toString())&&d.value!==p&&(d.value=p),W[0]&16&&x!==(x=ne[4].place.toString())&&b.value!==x&&(b.value=x),W[0]&16&&D!==(D=ne[4].tags.toString())&&C.value!==D&&(C.value=D),W[0]&16&&X!==(X=ne[4].device.toString())&&K.value!==X&&(K.value=X)},d(ne){ne&&O(t),ee=!1,be(ke)}}}function sl(l){let t,e,s,n,r=l[4].filename+"",i,a,o,u,d,p=l[4].data_hash+"",g,m,h,v,b,x=l[4].last_modified+"",S,q,P,T,C,D,y,j,k,U=l[4].description.toString()+"",V,H,I,L,R,K,X=l[4].taken_at.toString()+"",te,Z,se,ee,ke,ne,W=l[4].tags.toString()+"",_e,ce,ve,Ce,Me,Se,qe=l[4].place.toString()+"",ye,De,we,re,me,He,E,M,B=l[4].person_ids.toString()+"",$,A,ge,Ne,ue,ie,pe=l[4].device.toString()+"",ze,Xe,We,tt,St,lt,st=l[4].resolution.toString()+"",ht,Dt,Qe,nt,jt,rt,it=l[4].absolute_path.toString()+"",mt;return{c(){t=_("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=_("div"),n=_("div"),i=G(r),a=w(),o=_("div"),u=G("UID: "),d=_("span"),g=G(p),m=w(),h=_("div"),v=G("Last Modified:  "),b=_("span"),S=G(x),q=w(),P=_("div"),T=_("div"),C=_("div"),D=_("div"),y=_("div"),y.textContent="Description",j=w(),k=_("div"),V=G(U),H=w(),I=_("div"),L=_("div"),L.textContent="Taken at",R=w(),K=_("div"),te=G(X),Z=w(),se=_("div"),ee=_("div"),ee.textContent="Tags",ke=w(),ne=_("div"),_e=G(W),ce=w(),ve=_("div"),Ce=_("div"),Ce.textContent="Place",Me=w(),Se=_("div"),ye=G(qe),De=w(),we=_("div"),re=_("div"),me=_("div"),He=_("div"),He.textContent="people",E=w(),M=_("div"),$=G(B),A=w(),ge=_("div"),Ne=_("div"),Ne.textContent="Device",ue=w(),ie=_("div"),ze=G(pe),Xe=w(),We=_("div"),tt=_("div"),tt.textContent="Resolution",St=w(),lt=_("div"),ht=G(st),Dt=w(),Qe=_("div"),nt=_("div"),nt.textContent="Path",jt=w(),rt=_("div"),mt=G(it),f(n,"class","text-xl text-white"),f(d,"class","text-sm text-gray-400"),f(o,"class","text-white"),f(b,"class","text-sm text-gray-400"),f(h,"class","text-white"),f(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(y,"class",""),f(k,"class","text-sm text-gray-400"),f(L,"class",""),f(K,"class","text-sm text-gray-400"),f(ee,"class",""),f(ne,"class","text-sm text-gray-400"),f(Ce,"class",""),f(Se,"class","text-sm text-gray-400"),f(C,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(T,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(He,"class",""),f(M,"class","text-sm text-gray-400"),f(Ne,"class",""),f(ie,"class","text-sm text-gray-400"),f(tt,"class",""),f(lt,"class","text-sm text-gray-400"),f(nt,"class",""),f(rt,"class","text-sm text-gray-400"),f(re,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(we,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(P,"class","flex w-full justify-center p-4")},m(le,fe){F(le,t,fe),F(le,e,fe),F(le,s,fe),c(s,n),c(n,i),c(s,a),c(s,o),c(o,u),c(o,d),c(d,g),c(s,m),c(s,h),c(h,v),c(h,b),c(b,S),F(le,q,fe),F(le,P,fe),c(P,T),c(T,C),c(C,D),c(D,y),c(D,j),c(D,k),c(k,V),c(C,H),c(C,I),c(I,L),c(I,R),c(I,K),c(K,te),c(C,Z),c(C,se),c(se,ee),c(se,ke),c(se,ne),c(ne,_e),c(C,ce),c(C,ve),c(ve,Ce),c(ve,Me),c(ve,Se),c(Se,ye),c(P,De),c(P,we),c(we,re),c(re,me),c(me,He),c(me,E),c(me,M),c(M,$),c(re,A),c(re,ge),c(ge,Ne),c(ge,ue),c(ge,ie),c(ie,ze),c(re,Xe),c(re,We),c(We,tt),c(We,St),c(We,lt),c(lt,ht),c(re,Dt),c(re,Qe),c(Qe,nt),c(Qe,jt),c(Qe,rt),c(rt,mt)},p(le,fe){fe[0]&16&&r!==(r=le[4].filename+"")&&Q(i,r),fe[0]&16&&p!==(p=le[4].data_hash+"")&&Q(g,p),fe[0]&16&&x!==(x=le[4].last_modified+"")&&Q(S,x),fe[0]&16&&U!==(U=le[4].description.toString()+"")&&Q(V,U),fe[0]&16&&X!==(X=le[4].taken_at.toString()+"")&&Q(te,X),fe[0]&16&&W!==(W=le[4].tags.toString()+"")&&Q(_e,W),fe[0]&16&&qe!==(qe=le[4].place.toString()+"")&&Q(ye,qe),fe[0]&16&&B!==(B=le[4].person_ids.toString()+"")&&Q($,B),fe[0]&16&&pe!==(pe=le[4].device.toString()+"")&&Q(ze,pe),fe[0]&16&&st!==(st=le[4].resolution.toString()+"")&&Q(ht,st),fe[0]&16&&it!==(it=le[4].absolute_path.toString()+"")&&Q(mt,it)},d(le){le&&O(t),le&&O(e),le&&O(s),le&&O(q),le&&O(P)}}}function nl(l){let t,e,s;return{c(){t=_("img"),e=w(),s=wl("svg"),f(t,"class","object-cover h-screen w-full bg-black absolute top-0 left-0"),f(t,"alt",""),f(s,"class","animate-spin h-5 w-5 mr-3 bg-indigo-500 top-10 left-50 absolute"),f(s,"viewBox","0 0 24 24")},m(n,r){F(n,t,r),F(n,e,r),F(n,s,r)},d(n){n&&O(t),n&&O(e),n&&O(s)}}}function rl(l){let t,e,s;function n(...r){return l[28](l[52],...r)}return{c(){t=_("div"),f(t,"data-ix",l[54]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),he(t,"top",l[52].top+"px "),he(t,"left",l[52].left+"px"),he(t,"width",l[52].width+"px"),he(t,"height",l[52].height+"px")},m(r,i){F(r,t,i),e||(s=N(t,"click",n),e=!0)},p(r,i){l=r,i[0]&1024&&he(t,"top",l[52].top+"px "),i[0]&1024&&he(t,"left",l[52].left+"px"),i[0]&1024&&he(t,"width",l[52].width+"px"),i[0]&1024&&he(t,"height",l[52].height+"px")},d(r){r&&O(t),e=!1,s()}}}function il(l){let t,e,s,n,r,i,a;return{c(){t=_("div"),e=_("input"),n=w(),r=_("div"),r.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[8]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(r,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),he(t,"top",l[9].top+"px "),he(t,"left",l[9].left+"px")},m(o,u){F(o,t,u),c(t,e),c(t,n),c(t,r),e.focus(),i||(a=[N(e,"keyup",l[22]),N(r,"click",l[29])],i=!0)},p(o,u){u[0]&272&&s!==(s=o[4].person_ids[o[8]])&&e.value!==s&&(e.value=s),u[0]&512&&he(t,"top",o[9].top+"px "),u[0]&512&&he(t,"left",o[9].left+"px")},d(o){o&&O(t),i=!1,be(a)}}}function Zl(l){let t,e,s,n,r,i;const a=[Yl,Jl,Ql],o=[];function u(d,p){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=u(l),e=o[t]=a[t](l),{c(){e.c(),s=w(),n=_("div"),r=_("div"),f(r,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),he(r,"width",(l[7]*100).toString()+"%"),f(n,"class","flex animate-pulse")},m(d,p){o[t].m(d,p),F(d,s,p),F(d,n,p),c(n,r),i=!0},p(d,p){let g=t;t=u(d),t===g?o[t].p(d,p):($e(),Y(o[g],1,1,()=>{o[g]=null}),et(),e=o[t],e?e.p(d,p):(e=o[t]=a[t](d),e.c()),J(e,1),e.m(s.parentNode,s)),(!i||p[0]&128)&&he(r,"width",(d[7]*100).toString()+"%")},i(d){i||(J(e),i=!0)},o(d){Y(e),i=!1},d(d){o[t].d(d),d&&O(s),d&&O(n)}}}let Ee=18;function bt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let n=0;n<l.length;n++){let r=n;t[n%t.length]!==1&&(r=-1),e?s.push({ix:r,score:l[n][e]}):s.push({ix:r,score:l[n]})}return s.sort((n,r)=>n.score>r.score?-1:n.score<r.score?1:0),s}function $l(l,t,e){const s=_t();let{show_exit_interface_button:n=!1}=t,{image_data:r={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,i=!0;Ze(()=>{e(0,r={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),ut.update(E=>[])});let a={},o=!1,u=[],d=[],p=0,g=0,m=0,h=!1;function v(E){h!=!0&&(h=!0,g=0,e(7,m=0),e(27,p=p+Ee),e(6,u=d.slice(p,p+Ee)),ut.update(M=>b(u)))}function b(E){let M=[],B=E.length;for(let $=0;$<B;$++){let A=E[$].ix;M.push(r.list_metaData[A])}return M}Ae.subscribe(E=>{e(7,m=E.progress),E.done==!0?(x(E),e(7,m=0)):(e(27,p=0),e(6,u=[]))});function x(E){e(26,d=bt(E.list_score)),e(6,u=d.slice(0,0+Ee)),ut.update(M=>b(u))}let S={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function q(E){let M=Object.keys(S);for(let B=0;B<M.length;B++)e(2,S[M[B]]=!1,S);e(2,S[E]=!0,S)}let P,T={active:!1,top:null,left:null};function C(E){let M={sorted_ix:null,image_ix:null};for(let B=E;B<u.length;B++)if(u[B].ix!==-1){M.image_ix=u[B].ix,M.sorted_ix=B;break}return M}let D;function y(E){X={},e(5,o=!1),e(10,U=[]),e(9,T={active:!1,top:null,left:null});let M=E,B=u.length;M<0&&(M=B-1),M>B-1&&(M=0);let $=C(M),A=$.image_ix;M=$.sorted_ix,A===null&&($=C(0),A=$.image_ix,M=$.sorted_ix),e(4,a.ix=M,a),e(4,a.data_hash=r.list_dataHash[A],a),S.image_card_fullscreen===!0&&(D=setTimeout(()=>{e(11,V=!1),console.log("set timeout...")},400)),e(4,a.height=Number(r.list_metaData[A].height),a),e(4,a.width=Number(r.list_metaData[A].width),a),e(4,a.face_bboxes=r.list_metaData[A].face_bboxes,a),e(4,a.person_ids=r.list_metaData[A].person,a),a.person_ids===null&&e(4,a.person_ids=[],a),e(4,a.resolution=a.height.toString()+" X "+a.width.toString(),a),e(4,a.filename=r.list_metaData[A].filename,a),e(4,a.taken_at=r.list_metaData[A].taken_at,a),a.taken_at==null&&e(4,a.taken_at="Unknown",a),e(4,a.last_modified=r.list_metaData[A].modified_at,a),e(4,a.device=r.list_metaData[A].device,a),a.device==null&&e(4,a.device="",a),e(4,a.place=r.list_metaData[A].place,a),e(4,a.absolute_path=r.list_metaData[A].absolute_path,a),e(4,a.description=r.list_metaData[A].description,a),e(4,a.tags=r.list_metaData[A].tags,a),e(5,o=!0)}function j(){y(a.ix+1)}function k(){y(a.ix-1)}let U=[],V=!0;function H(E){let M=E.target.getClientRects()[0],B=M.width,$=M.height,A=[],ge=a.face_bboxes;if(ge){let Ne=a.width,ue=a.height;for(let ie=0;ie<ge.length;ie++){let pe=structuredClone(ge[ie]),ze=Number(B)/(Number(Ne)+1e-4),Xe=Number($)/(Number(ue)+1e-4);pe.top=pe[1]*Xe,pe.height=(pe[3]-pe[1])*Xe,pe.left=pe[0]*ze,pe.width=(pe[2]-pe[0])*ze,A.push(pe)}}e(10,U=A),D&&clearTimeout(D),e(11,V=!0)}let I=0;function L(){let E=u[0].score,M=u[u.length-1].score,$=r.list_score.map(A=>(A-M)/(E-M+1e-5)).map(A=>A>=I?1:0);e(6,u=bt(r.list_score,$))}function R(E){e(3,i=!0);let M=d.slice(p,p+Ee);for(let B=0;B<E.length;B++)E[B]==0?e(6,u[B].ix=-1,u):e(6,u[B].ix=M[B].ix,u);e(3,i=!1)}function K(E){let M=E.target.value,B=a.data_hash,$=a.person_ids[P];if(E.key=="Enter"){let A=new FormData;A.append("new_person_id",M),A.append("old_person_id",$),A.append("data_hash",B),fetch("/api/tagPerson",{method:"POST",body:A}).then(ge=>{if(ge.ok)alert("Success");else throw new Error("Error occured")})}}let X={};function te(E){X[E.target.name.toLowerCase()]=E.target.value}async function Z(E){E.target.disabled=!0,E.target.innerText="Saving...";let M=Object.keys(X),B=new FormData;for(let A=0;A<M.length;A++)B.append(M[A],X[M[A]]);B.append("data_hash",a.data_hash);let $=await fetch("/api/editMetaData",{method:"POST",body:B});$.ok?(alert("Success!"),await $.json(),e(2,S.image_card_edit_interface=!1,S)):alert("Error while saving. Contact Admin"),E.target.innerText="Save",E.target.disabled=!1}function se(E){h&&(g+=1,e(7,m+=1/Ee),g==Math.min(u.length,Ee)&&(e(7,m=0),h=!1))}const ee=(E,M)=>{e(9,T={active:!0,top:E.top-28,left:E.left}),e(8,P=Number(M.target.attributes["data-ix"].value))},ke=()=>{e(9,T.active=!1,T)},ne=()=>{k()},W=()=>{j()},_e=()=>{q("parent")},ce=()=>{q("image_card")},ve=()=>{q("parent")},Ce=()=>{q("image_card_fullscreen")},Me=()=>{k()},Se=()=>{console.log("hellll"),q("image_card_fullscreen")},qe=()=>{e(2,S.image_card_edit_interface=!0,S)},ye=()=>{e(2,S.image_card_edit_interface=!1,S)},De=()=>{j()},we=()=>{console.log("pressed me!!!"),e(6,u=[]),s("exitButtonPressed")},re=E=>{R(E.detail.mask)};function me(){I=yl(this.value),e(12,I)}const He=E=>{y(E),q("image_card")};return l.$$set=E=>{"show_exit_interface_button"in E&&e(1,n=E.show_exit_interface_button),"image_data"in E&&e(0,r=E.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&201326593&&r&&(e(26,d=bt(r.list_score)),r.done==!1&&e(6,u=d.slice(p,p+Ee))),l.$$.dirty[0]&4&&S){let E=!1;(S.image_card==!0||S.image_card_fullscreen==!0)&&(E=!0),s("imageCardActive",{active:E})}},[r,n,S,i,a,o,u,m,P,T,U,V,I,s,v,q,y,j,k,H,L,R,K,te,Z,se,d,p,ee,ke,ne,W,_e,ce,ve,Ce,Me,Se,qe,ye,De,we,re,me,He]}class pt extends Te{constructor(t){super(),Le(this,t,$l,Zl,je,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const es="/assets/sample_place_bg-38f3fbd4.jpg";function ol(l,t,e){const s=l.slice();return s[10]=t[e],s}function ts(l){let t,e,s,n,r,i,a,o,u,d,p,g=l[0].people,m=[];for(let h=0;h<g.length;h+=1)m[h]=al(ol(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("div"),r=_("div"),r.textContent="People Album",i=w(),a=_("div"),o=_("input"),u=w();for(let h=0;h<m.length;h+=1)m[h].c();f(r,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search person"),f(a,"class","flex"),f(n,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,n),c(n,r),c(n,i),c(n,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=N(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].people;let b;for(b=0;b<g.length;b+=1){const x=ol(h,g,b);m[b]?m[b].p(x,v):(m[b]=al(x),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:z,o:z,d(h){h&&O(t),xe(m,h),d=!1,p()}}}function ls(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){de(t.$$.fragment)},m(s,n){oe(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function ss(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function al(l){let t,e,s,n,r,i,a,o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[7](l[10],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("img"),i=w(),a=_("div"),u=G(o),d=w(),f(n,"loading","lazy"),Oe(n.src,r="/api/getPreviewPerson/"+l[10])||f(n,"src",r),f(n,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[160px] w-[160px] bg-gray-800"),f(a,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,n),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=N(t,"click",m),p=!0)},p(h,v){l=h,v&1&&!Oe(n.src,r="/api/getPreviewPerson/"+l[10])&&f(n,"src",r),v&1&&o!==(o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&Q(u,o)},d(h){h&&O(t),p=!1,g()}}}function ns(l){let t,e,s,n;const r=[ss,ls,ts],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=r[t](l),{c(){e.c(),s=Ie()},m(o,u){i[t].m(o,u),F(o,s,u),n=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):($e(),Y(i[d],1,1,()=>{i[d]=null}),et(),e=i[t],e?e.p(o,u):(e=i[t]=r[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){n||(J(e),n=!0)},o(o){Y(e),n=!1},d(o){i[t].d(o),o&&O(s)}}}function rs(l,t,e){let s={people:[]},n={list_metaData:[],list_score:[],list_dataHash:[]},r={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;Fe(()=>{e(3,a=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)n.list_dataHash.push(h.data_hash[b]),n.list_score.push(h.score[b]),n.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.people=h.person,s),o=s.people})})}),Ze(()=>{console.log("destroying... people..")});async function u(m){e(2,i=!1),e(1,r={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let h=0;h<n.list_dataHash.length;h++)n.list_metaData[h].person.includes(m)&&(r.list_metaData.push(n.list_metaData[h]),r.list_dataHash.push(n.list_dataHash[h]),r.list_score.push(n.list_score[h]));e(1,r.done=!0,r),e(2,i=!0),o&&e(0,s.people=o,s),Ae.update(h=>structuredClone(r))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.people=o,s);return}h&&a==!0&&o&&(e(0,s.people=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.people.push(v)}))}return[s,r,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class is extends Te{constructor(t){super(),Le(this,t,rs,ns,je,{})}}function cl(l,t,e){const s=l.slice();return s[8]=t[e],s}function os(l){let t,e,s,n=l[0].places,r=[];for(let i=0;i<n.length;i+=1)r[i]=ul(cl(l,n,i));return{c(){t=_("div"),e=w(),s=_("div");for(let i=0;i<r.length;i+=1)r[i].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a);for(let o=0;o<r.length;o+=1)r[o].m(s,null)},p(i,a){if(a&17){n=i[0].places;let o;for(o=0;o<n.length;o+=1){const u=cl(i,n,o);r[o]?r[o].p(u,a):(r[o]=ul(u),r[o].c(),r[o].m(s,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},i:z,o:z,d(i){i&&O(t),i&&O(e),i&&O(s),xe(r,i)}}}function as(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){de(t.$$.fragment)},m(s,n){oe(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function cs(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function ul(l){let t,e,s,n,r,i,a,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[6](l[8],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("img"),i=w(),a=_("div"),u=G(o),d=w(),Oe(n.src,r=es)||f(n,"src",r),f(n,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[150px] w-[200px] bg-gray-800"),f(a,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,n),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=N(t,"click",m),p=!0)},p(h,v){l=h,v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&Q(u,o)},d(h){h&&O(t),p=!1,g()}}}function us(l){let t,e,s,n;const r=[cs,as,os],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=r[t](l),{c(){e.c(),s=Ie()},m(o,u){i[t].m(o,u),F(o,s,u),n=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):($e(),Y(i[d],1,1,()=>{i[d]=null}),et(),e=i[t],e?e.p(o,u):(e=i[t]=r[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){n||(J(e),n=!0)},o(o){Y(e),n=!1},d(o){i[t].d(o),o&&O(s)}}}function fs(l,t,e){let s={places:[]},n={list_metaData:[],list_score:[],list_dataHash:[]},r={list_metaData:[],list_score:[],list_dataHash:[],done:!1},i=!1,a=!0;Fe(()=>{e(3,a=!1),fetch("/api/getGroup/place").then(p=>{p.json().then(g=>{let m=g.meta_data.length;for(let h=0;h<m;h++)n.list_dataHash.push(g.data_hash[h]),n.list_score.push(g.score[h]),n.list_metaData.push(g.meta_data[h]);e(3,a=!0),e(0,s.places=g.place,s)})})}),Ze(()=>{console.log("destroying...")});async function o(p){e(2,i=!1),e(1,r={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ae.update(g=>structuredClone(r));for(let g=0;g<n.list_dataHash.length;g++)n.list_metaData[g].place.toLowerCase()===p.toLowerCase()&&(r.list_metaData.push(n.list_metaData[g]),r.list_dataHash.push(n.list_dataHash[g]),r.list_score.push(n.list_score[g]));e(1,r.done=!0,r),e(2,i=!0),Ae.update(g=>structuredClone(r))}return[s,r,i,a,o,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(p,g)=>{console.log("mine is: ",p),o(p)}]}class ds extends Te{constructor(t){super(),Le(this,t,fs,us,je,{})}}const _s="/assets/folder-regular-1127ab6b.svg";function fl(l,t,e){const s=l.slice();return s[10]=t[e],s}function ps(l){let t,e,s,n,r,i,a,o,u,d,p,g=l[0].local_directories,m=[];for(let h=0;h<g.length;h+=1)m[h]=dl(fl(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("div"),r=_("div"),r.textContent="Local Resources",i=w(),a=_("div"),o=_("input"),u=w();for(let h=0;h<m.length;h+=1)m[h].c();f(r,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search directory"),f(a,"class","flex"),f(n,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,n),c(n,r),c(n,i),c(n,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=N(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].local_directories;let b;for(b=0;b<g.length;b+=1){const x=fl(h,g,b);m[b]?m[b].p(x,v):(m[b]=dl(x),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:z,o:z,d(h){h&&O(t),xe(m,h),d=!1,p()}}}function hs(l){let t,e;return t=new pt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){de(t.$$.fragment)},m(s,n){oe(t,s,n),e=!0},p(s,n){const r={};n&2&&(r.image_data=s[1]),t.$set(r)},i(s){e||(J(t.$$.fragment,s),e=!0)},o(s){Y(t.$$.fragment,s),e=!1},d(s){ae(t,s)}}}function ms(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:z,i:z,o:z,d(e){e&&O(t)}}}function dl(l){let t,e,s,n,r,i,a,o=l[10].slice(0,10)+"..",u,d,p,g,m;function h(...v){return l[7](l[10],...v)}return{c(){t=_("div"),e=_("div"),s=_("div"),n=_("img"),i=w(),a=_("div"),u=G(o),d=w(),Oe(n.src,r=_s)||f(n,"src",r),f(n,"class","object-contain hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[100px] w-[100px] bg-gray-800 p-3"),f(a,"class","flex text-sm text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer p-2"),f(t,"title",p=l[10])},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,n),c(e,i),c(e,a),c(a,u),c(t,d),g||(m=N(t,"click",h),g=!0)},p(v,b){l=v,b&1&&o!==(o=l[10].slice(0,10)+"..")&&Q(u,o),b&1&&p!==(p=l[10])&&f(t,"title",p)},d(v){v&&O(t),g=!1,m()}}}function gs(l){let t,e,s,n;const r=[ms,hs,ps],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=r[t](l),{c(){e.c(),s=Ie()},m(o,u){i[t].m(o,u),F(o,s,u),n=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):($e(),Y(i[d],1,1,()=>{i[d]=null}),et(),e=i[t],e?e.p(o,u):(e=i[t]=r[t](o),e.c()),J(e,1),e.m(s.parentNode,s))},i(o){n||(J(e),n=!0)},o(o){Y(e),n=!1},d(o){i[t].d(o),o&&O(s)}}}function bs(l,t,e){let s={local_directories:[]},n={list_metaData:[],list_score:[],list_dataHash:[]},r={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;Fe(()=>{e(3,a=!1),fetch("/api/getGroup/resource_directory").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)n.list_dataHash.push(h.data_hash[b]),n.list_score.push(h.score[b]),n.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.local_directories=h.resource_directory,s),o=s.local_directories})})}),Ze(()=>{});async function u(m){e(2,i=!1),e(1,r={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0}),console.log("looking for attribute ",m);for(let h=0;h<n.list_dataHash.length;h++)n.list_metaData[h].resource_directory.toLowerCase().includes(m)&&(r.list_metaData.push(n.list_metaData[h]),r.list_dataHash.push(n.list_dataHash[h]),r.list_score.push(n.list_score[h]));e(1,r.done=!0,r),console.log(r),e(2,i=!0),o&&e(0,s.local_directories=o,s),Ae.update(h=>structuredClone(r))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.local_directories=o,s);return}h&&a==!0&&o&&(e(0,s.local_directories=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.local_directories.push(v)}))}return[s,r,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class vs extends Te{constructor(t){super(),Le(this,t,bs,gs,je,{})}}function ks(l){let t,e,s,n,r,i,a,o,u,d;return{c(){t=_("div"),e=_("p"),e.innerHTML=`* Make sure you have created an OAuth credential at google Cloud-Console for this app and have enabled <b>Google Photos Api</b>. For details visit <b>https://developers.google.com/photos/library/guides/get-started</b><br/>
                * <b>App type</b> must be chosen as <b>Web app</b> and One of Redirect URIs must be set as <b>http://localhost:5000/api/OAuthCallback</b> in corresponding credential.<br/>
                * Except <b>You</b> and <b>Google</b> , <b>No-one</b> would have access to your personal data.`,s=w(),n=_("div"),r=_("label"),i=G(l[2]),a=w(),o=_("input"),f(e,"class","p-4"),f(r,"for","file"),f(o,"type","file"),f(o,"accept",".json"),f(n,"class","flex items-center justify-center text-md p-2 bg-blue-300"),f(t,"class","border-2 flex-1 justify-center items-center bg-blue-200")},m(p,g){F(p,t,g),c(t,e),c(t,s),c(t,n),c(n,r),c(r,i),c(n,a),c(n,o),u||(d=N(o,"change",l[4]),u=!0)},p(p,g){g&4&&Q(i,p[2])},d(p){p&&O(t),u=!1,d()}}}function ws(l){let t,e=l[0].client_id+"",s,n,r;function i(u,d){return u[0].is_activated?xs:ys}let a=i(l),o=a(l);return{c(){t=_("p"),s=G(e),n=w(),o.c(),r=Ie(),f(t,"class","bg-gray-100 p-2 border-2 border-black")},m(u,d){F(u,t,d),c(t,s),F(u,n,d),o.m(u,d),F(u,r,d)},p(u,d){d&1&&e!==(e=u[0].client_id+"")&&Q(s,e),a!==(a=i(u))&&(o.d(1),o=a(u),o&&(o.c(),o.m(r.parentNode,r)))},d(u){u&&O(t),u&&O(n),o.d(u),u&&O(r)}}}function ys(l){let t;return{c(){t=_("p"),t.textContent="Inactive",f(t,"class","bg-rose-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function xs(l){let t;return{c(){t=_("p"),t.textContent="Active",f(t,"class","bg-green-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function _l(l){let t,e,s,n;return{c(){t=_("div"),e=_("button"),e.textContent="Activate Google photos",f(e,"class","bg-blue-400 p-2 text-md disabled:bg-blue-200"),f(t,"class","flex justify-center items-center m-3")},m(r,i){F(r,t,i),c(t,e),s||(n=N(e,"click",l[3]),s=!0)},p:z,d(r){r&&O(t),s=!1,n()}}}function Cs(l){let t,e,s;function n(o,u){return o[0]?ws:ks}let r=n(l),i=r(l),a=l[1]&&_l(l);return{c(){t=_("div"),i.c(),e=w(),a&&a.c(),s=Ie(),f(t,"class","flex w-full justify-center items-center")},m(o,u){F(o,t,u),i.m(t,null),F(o,e,u),a&&a.m(o,u),F(o,s,u)},p(o,[u]){r===(r=n(o))&&i?i.p(o,u):(i.d(1),i=r(o),i&&(i.c(),i.m(t,null))),o[1]?a?a.p(o,u):(a=_l(o),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},i:z,o:z,d(o){o&&O(t),i.d(),o&&O(e),a&&a.d(o),o&&O(s)}}}function Ss(l,t,e){let s=null,n=!1,r="Upload Client secret json";function i(){fetch("/api/gClientInfo").then(d=>{d.json().then(p=>{p.client_id_available===!0&&(e(0,s=p),p.is_activated==!1&&e(1,n=!0))})})}Fe(()=>{i()});function a(){fetch("/api/statusGAuthFlow").then(d=>{d.json().then(p=>{p.finished==!1?setTimeout(a,2e3):(e(1,n=!1),alert("Account Activation: "+p.status.toString()),i())})})}function o(d){d.target.disabled=!0,d.target.innerText="activation in progress...",fetch("/api/beginGAuthFlow").then(p=>{p.ok==!1?(alert("Some error occured while starting authorization flow !"),d.target.disabled=!1,d.target.innerText="Activate Google Photos"):setTimeout(a,1e3)})}function u(d){let p="http://localhost:5000/api/OAuthCallback";e(2,r="upload in progress.."),d.preventDefault(),console.log(d.target),d.target.disabled=!0;var g=new FileReader;g.onload=function(){var m=JSON.parse(g.result);let v=Object.keys(m).includes("web"),b=!1;if(v&&Object.keys(m.web).includes("redirect_uris")&&(b=m.web.redirect_uris.includes(p)),v===!0&&b==!0){let x=new FormData;x.append("client_data",g.result),fetch("/api/uploadClientData",{method:"POST",body:x}).then(S=>{S.ok==!1?alert("Some error occured !!"):(e(2,r="Upload Client secret json"),i(),d.target.disabled=!1,e(1,n=!0))})}else{alert("Must be a webapp and redirect_uris must contain: "+p);return}},g.readAsText(d.target.files[0])}return[s,n,r,o,u]}class Ds extends Te{constructor(t){super(),Le(this,t,Ss,Cs,je,{})}}function pl(l){let t,e,s,n,r,i;return{c(){t=_("div"),e=_("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=w(),n=_("div"),n.textContent="X",f(e,"class","flex-1"),f(n,"class","flex text-xl hover:orange-900 cursor-pointer"),f(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),f(t,"role","alert")},m(a,o){F(a,t,o),c(t,e),c(t,s),c(t,n),r||(i=N(n,"click",l[9]),r=!0)},p:z,d(a){a&&O(t),r=!1,i()}}}function js(l){let t,e,s,n,r,i;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[21]),e.$on("sidebarStateChange",l[22]),r=new Ds({}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(r.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(r.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(r)}}}function Os(l){let t,e,s,n,r,i;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[19]),e.$on("sidebarStateChange",l[20]),r=new vs({}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(r.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(r.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(r)}}}function Fs(l){let t,e,s,n,r,i;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),r=new is({}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(r.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(r.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(r)}}}function Ls(l){let t,e,s,n,r,i;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),r=new ds({}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(r.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(r.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(r)}}}function Ts(l){let t,e,s,n,r,i;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),r=new Rl({}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(J(e.$$.fragment,a),J(r.$$.fragment,a),i=!0)},o(a){Y(e.$$.fragment,a),Y(r.$$.fragment,a),i=!1},d(a){a&&O(t),ae(e),ae(r)}}}function qs(l){let t,e,s,n,r,i,a,o;return e=new Ke({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),r=new Nl({props:{query_button_disabled:l[2]}}),r.$on("queryReady",l[12]),a=new pt({props:{image_data:l[1]}}),{c(){t=_("div"),de(e.$$.fragment),s=w(),n=_("div"),de(r.$$.fragment),i=w(),de(a.$$.fragment),f(n,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,d){F(u,t,d),oe(e,t,null),c(t,s),c(t,n),oe(r,n,null),c(n,i),oe(a,n,null),o=!0},p(u,d){const p={};d[0]&64&&(p.sidebarOpen=u[6]),e.$set(p);const g={};d[0]&4&&(g.query_button_disabled=u[2]),r.$set(g);const m={};d[0]&2&&(m.image_data=u[1]),a.$set(m)},i(u){o||(J(e.$$.fragment,u),J(r.$$.fragment,u),J(a.$$.fragment,u),o=!0)},o(u){Y(e.$$.fragment,u),Y(r.$$.fragment,u),Y(a.$$.fragment,u),o=!1},d(u){u&&O(t),ae(e),ae(r),ae(a)}}}function Hs(l){let t,e,s,n,r,i=l[0]&&pl(l);const a=[qs,Ts,Ls,Fs,Os,js],o=[];function u(d,p){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:d[5].local_album.status===!0?4:d[5].google_photos.status===!0?5:-1}return~(e=u(l))&&(s=o[e]=a[e](l)),{c(){i&&i.c(),t=w(),s&&s.c(),n=Ie()},m(d,p){i&&i.m(d,p),F(d,t,p),~e&&o[e].m(d,p),F(d,n,p),r=!0},p(d,p){d[0]?i?i.p(d,p):(i=pl(d),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null);let g=e;e=u(d),e===g?~e&&o[e].p(d,p):(s&&($e(),Y(o[g],1,1,()=>{o[g]=null}),et()),~e?(s=o[e],s?s.p(d,p):(s=o[e]=a[e](d),s.c()),J(s,1),s.m(n.parentNode,n)):s=null)},i(d){r||(J(s),r=!0)},o(d){Y(s),r=!1},d(d){i&&i.d(d),d&&O(t),~e&&o[e].d(d),d&&O(n)}}}let Ns=3;function Es(l,t,e){let s=!1;Fe(()=>{window.onscrollend=function(){}}),Fe(()=>{fetch("/api/getMetaStats").then(L=>{L.ok?L.json().then(R=>{Number(R.image.count)==0&&e(0,s=!0),yt.update(K=>Number(R.image.count)),Ct.update(K=>Number(R.image.unique_place_count)),xt.update(K=>Number(R.image.unique_people_count)),gl.update(K=>Number(R.image.unique_resource_directories_count)),bl.update(K=>R.available_resource_attributes)}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let n=[],r=[],i=[],a,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},u=!1,d="",p={};async function g(L="xxxxxxx",R=!1){console.log("handleClick count",d,R,L),e(2,u=!0);let K=Ns;if(a=new FormData,d.length===0)return;a.append("query",d),a.append("topk",K.toString()),R==!1?(r=[],n=[],i=[],e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),a.append("query_start","true"),Ae.update(W=>o)):(a.append("query_start","false"),a.append("client_id",L));let te=await fetch("/api/query",{method:"POST",body:a});if(!te.ok)throw e(2,u=!1),new Error(te);let Z=await te.json();console.log("data: ",Z);let se=Z.client_id,ee=Z.meta_data,ke=Z.data_hash,ne=Z.score;Number(Z.progress);for(let W=0;W<ee.length;W++){let _e=ke[W],ce=Number(ne[W]),ve=r.indexOf(_e);ve>=0?(n[ve]+=ce,e(1,o.list_score[ve]+=ce,o)):(r.push(_e),n.push(ce),i.push(ee[W]),o.list_dataHash.push(_e),o.list_score.push(ce),o.list_metaData.push(ee[W]))}if(Z.query_completed==!0?(e(1,o.done=!0,o),e(1,o.progress=1e-4,o)):(e(1,o),e(1,o.progress+=.12,o),e(1,o.progress=Math.min(o.progress,.92),o)),Z.query_completed==!0){e(2,u=!1),console.log("hey i am being called!!!"),Ae.update(W=>o);return}await g(se,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}},local_album:{status:!1,context:{}},google_photos:{status:!1,context:{}}};function h(L){m[L].status==!1&&(e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Ae.update(K=>structuredClone(o)));let R=Object.keys(m);for(let K=0;K<R.length;K++)m[R[K]].status&&e(5,m[R[K]].status=!1,m);m[L]&&e(5,m[L].status=!0,m)}let v=!0;function b(L){let R=L.detail.item.name;R.toLowerCase().includes("google")?h("google_photos"):R.toLowerCase().includes("photo")?h("query"):R.toLowerCase().includes("index")?h("indexing"):R.toLowerCase().includes("people")?h("people_album"):R.toLowerCase().includes("place")?h("place_album"):R.toLowerCase().includes("local")&&h("local_album")}return[s,o,u,d,p,m,v,g,b,()=>e(0,s=!1),L=>{b(L)},L=>{e(6,v=L.detail.open)},L=>{e(3,d=L.detail.query),e(4,p=L.detail.attributes),g()},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)},L=>b(L),L=>{e(6,v=L.detail.open)}]}class Ps extends Te{constructor(t){super(),Le(this,t,Es,Hs,je,{},null,[-1,-1])}}new Ps({target:document.getElementById("app")});
