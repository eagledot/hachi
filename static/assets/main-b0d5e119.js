(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}})();function z(){}function $t(l){return l()}function vt(){return Object.create(null)}function ue(l){l.forEach($t)}function el(l){return typeof l=="function"}function ke(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let We;function ve(l,t){return We||(We=document.createElement("a")),We.href=t,l===We.href}function sl(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function L(l,t,e){l.insertBefore(t,e||null)}function O(l){l.parentNode&&l.parentNode.removeChild(l)}function me(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function d(l){return document.createElement(l)}function B(l){return document.createTextNode(l)}function x(){return B(" ")}function qe(){return B("")}function E(l,t,e,n){return l.addEventListener(t,e,n),()=>l.removeEventListener(t,e,n)}function c(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function il(l){return l===""?null:+l}function rl(l){return Array.from(l.childNodes)}function K(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function Le(l,t){l.value=t??""}function ce(l,t,e,n){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,n?"important":"")}function kt(l,t){for(let e=0;e<l.options.length;e+=1){const n=l.options[e];if(n.__value===t){n.selected=!0;return}}l.selectedIndex=-1}function al(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function ol(l,t,{bubbles:e=!1,cancelable:n=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(l,e,n,t),a}let Ne;function Pe(l){Ne=l}function ft(){if(!Ne)throw new Error("Function called outside component initialization");return Ne}function Ue(l){ft().$$.on_mount.push(l)}function $e(l){ft().$$.on_destroy.push(l)}function et(){const l=ft();return(t,e,{cancelable:n=!1}={})=>{const a=l.$$.callbacks[t];if(a){const s=ol(t,e,{cancelable:n});return a.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}const Oe=[],De=[],Je=[],wt=[],cl=Promise.resolve();let ut=!1;function ul(){ut||(ut=!0,cl.then(tl))}function Ze(l){Je.push(l)}const ot=new Set;let Fe=0;function tl(){if(Fe!==0)return;const l=Ne;do{try{for(;Fe<Oe.length;){const t=Oe[Fe];Fe++,Pe(t),fl(t.$$)}}catch(t){throw Oe.length=0,Fe=0,t}for(Pe(null),Oe.length=0,Fe=0;De.length;)De.pop()();for(let t=0;t<Je.length;t+=1){const e=Je[t];ot.has(e)||(ot.add(e),e())}Je.length=0}while(Oe.length);for(;wt.length;)wt.pop()();ut=!1,ot.clear(),Pe(l)}function fl(l){if(l.fragment!==null){l.update(),ue(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(Ze)}}const Ye=new Set;let Se;function tt(){Se={r:0,c:[],p:Se}}function lt(){Se.r||ue(Se.c),Se=Se.p}function Y(l,t){l&&l.i&&(Ye.delete(l),l.i(t))}function $(l,t,e,n){if(l&&l.o){if(Ye.has(l))return;Ye.add(l),Se.c.push(()=>{Ye.delete(l),n&&(e&&l.d(1),n())}),l.o(t)}else n&&n()}function he(l){l&&l.c()}function fe(l,t,e,n){const{fragment:a,after_update:s}=l.$$;a&&a.m(t,e),n||Ze(()=>{const r=l.$$.on_mount.map($t).filter(el);l.$$.on_destroy?l.$$.on_destroy.push(...r):ue(r),l.$$.on_mount=[]}),s.forEach(Ze)}function de(l,t){const e=l.$$;e.fragment!==null&&(ue(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function dl(l,t){l.$$.dirty[0]===-1&&(Oe.push(l),ul(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function we(l,t,e,n,a,s,r,u=[-1]){const i=Ne;Pe(l);const f=l.$$={fragment:null,ctx:[],props:s,update:z,not_equal:a,bound:vt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(i?i.$$.context:[])),callbacks:vt(),dirty:u,skip_bound:!1,root:t.target||i.$$.root};r&&r(f.root);let p=!1;if(f.ctx=e?e(l,t.props||{},(_,b,...m)=>{const h=m.length?m[0]:b;return f.ctx&&a(f.ctx[_],f.ctx[_]=h)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](h),p&&dl(l,_)),b}):[],f.update(),p=!0,ue(f.before_update),f.fragment=n?n(f.ctx):!1,t.target){if(t.hydrate){const _=rl(t.target);f.fragment&&f.fragment.l(_),_.forEach(O)}else f.fragment&&f.fragment.c();t.intro&&Y(l.$$.fragment),fe(l,t.target,t.anchor,t.customElement),tl()}Pe(i)}class ye{$destroy(){de(this,1),this.$destroy=z}$on(t,e){if(!el(e))return z;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const a=n.indexOf(e);a!==-1&&n.splice(a,1)}}$set(t){this.$$set&&!sl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function yt(l,t,e){const n=l.slice();return n[25]=t[e],n}function xt(l,t,e){const n=l.slice();return n[28]=t[e],n}function Ct(l,t,e){const n=l.slice();return n[28]=t[e],n}function St(l,t,e){const n=l.slice();return n[33]=t[e],n}function Dt(l){let t,e,n,a=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",s,r,u,i,f,p,_,b=l[4][l[28]],m=[];for(let w=0;w<b.length;w+=1)m[w]=jt(St(l,b,w));function h(){return l[14](l[28])}function k(...w){return l[15](l[28],...w)}return{c(){t=d("div"),e=d("span"),n=d("span"),s=B(a),r=x();for(let w=0;w<m.length;w+=1)m[w].c();u=x(),i=d("span"),i.textContent="x",f=x(),c(n,"class","text-blue-800 "),c(e,"class","cursor-pointer"),c(i,"class","ml-2 text-red-600 cursor-pointer hover:text-blue-500"),c(t,"class","px-4 py-2 self-center bg-blue-200 rounded-md inline-flex place-self-center items-center mr-2 mb-2 h-10")},m(w,S){L(w,t,S),o(t,e),o(e,n),o(n,s),o(e,r);for(let C=0;C<m.length;C+=1)m[C].m(e,null);o(t,u),o(t,i),o(t,f),p||(_=[E(e,"click",h),E(i,"click",k)],p=!0)},p(w,S){if(l=w,S[0]&16&&a!==(a=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"")&&K(s,a),S[0]&16){b=l[4][l[28]];let C;for(C=0;C<b.length;C+=1){const q=St(l,b,C);m[C]?m[C].p(q,S):(m[C]=jt(q),m[C].c(),m[C].m(e,null))}for(;C<m.length;C+=1)m[C].d(1);m.length=b.length}},d(w){w&&O(t),me(m,w),p=!1,ue(_)}}}function jt(l){let t,e=l[33]+" ",n;return{c(){t=d("span"),n=B(e),c(t,"class","ml-1")},m(a,s){L(a,t,s),o(t,n)},p(a,s){s[0]&16&&e!==(e=a[33]+" ")&&K(n,e)},d(a){a&&O(t)}}}function Ft(l){let t,e=l[4][l[28]].length>=1&&Dt(l);return{c(){e&&e.c(),t=qe()},m(n,a){e&&e.m(n,a),L(n,t,a)},p(n,a){n[4][n[28]].length>=1?e?e.p(n,a):(e=Dt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&O(t)}}}function Ot(l){let t,e=l[28].charAt(0).toUpperCase()+l[28].slice(1)+"",n,a,s;return{c(){t=d("option"),n=B(e),a=x(),t.__value=s=l[28],t.value=t.__value},m(r,u){L(r,t,u),o(t,n),o(t,a)},p(r,u){u[0]&16&&e!==(e=r[28].charAt(0).toUpperCase()+r[28].slice(1)+"")&&K(n,e),u[0]&16&&s!==(s=r[28])&&(t.__value=s,t.value=t.__value)},d(r){r&&O(t)}}}function Lt(l){let t,e,n,a,s,r,u,i,f=l[3],p=[];for(let _=0;_<f.length;_+=1)p[_]=qt(yt(l,f,_));return{c(){t=d("div"),e=d("ul");for(let _=0;_<p.length;_+=1)p[_].c();n=x(),a=d("div"),s=d("button"),s.textContent="Close",c(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),c(s,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),c(a,"class","flex w-full justify-center items-center"),c(t,"class",r=(l[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,b){L(_,t,b),o(t,e);for(let m=0;m<p.length;m+=1)p[m].m(e,null);o(t,n),o(t,a),o(a,s),u||(i=E(s,"click",l[22]),u=!0)},p(_,b){if(b[0]&522){f=_[3];let m;for(m=0;m<f.length;m+=1){const h=yt(_,f,m);p[m]?p[m].p(h,b):(p[m]=qt(h),p[m].c(),p[m].m(e,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=f.length}b[0]&64&&r!==(r=(_[6]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&c(t,"class",r)},d(_){_&&O(t),me(p,_),u=!1,i()}}}function qt(l){let t,e=l[25]+"",n,a,s,r;function u(){return l[21](l[25])}return{c(){t=d("li"),n=B(e),a=x(),c(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(i,f){L(i,t,f),o(t,n),o(t,a),s||(r=E(t,"click",u),s=!0)},p(i,f){l=i,f[0]&8&&e!==(e=l[25]+"")&&K(n,e)},d(i){i&&O(t),s=!1,r()}}}function _l(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S=Object.keys(l[4]),C=[];for(let g=0;g<S.length;g+=1)C[g]=Ft(Ct(l,S,g));let q=Object.keys(l[4]),j=[];for(let g=0;g<q.length;g+=1)j[g]=Ot(xt(l,q,g));let F=l[3].length>0&&Lt(l);return{c(){t=d("div"),e=d("div"),n=d("form"),a=d("div");for(let g=0;g<C.length;g+=1)C[g].c();s=x(),r=d("div"),u=d("select");for(let g=0;g<j.length;g+=1)j[g].c();i=x(),f=d("div"),p=d("input"),_=x(),b=d("div"),m=d("button"),m.textContent="Search",h=x(),F&&F.c(),c(a,"class","flex w-full items-center my-2 flex-wrap"),c(u,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),c(u,"name","select-option"),c(u,"id","select-option"),l[1]===void 0&&Ze(()=>l[17].call(u)),c(p,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),c(p,"type","search"),c(p,"placeholder","Enter value here"),c(f,"class","bg-blue-200 rounded-md flex-grow h-10"),c(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),c(b,"class","flex"),c(r,"class","flex space-x-2"),c(n,"class","w-full"),c(n,"action",""),c(e,"class","w-full relative place-content-center"),c(t,"class","max-w-screen p-4 mx-auto")},m(g,v){L(g,t,v),o(t,e),o(e,n),o(n,a);for(let y=0;y<C.length;y+=1)C[y].m(a,null);o(n,s),o(n,r),o(r,u);for(let y=0;y<j.length;y+=1)j[y].m(u,null);kt(u,l[1]),o(r,i),o(r,f),o(f,p),l[18](p),Le(p,l[5]),o(r,_),o(r,b),o(b,m),l[20](m),o(e,h),F&&F.m(e,null),k||(w=[E(u,"change",l[16]),E(u,"change",l[17]),E(p,"input",l[19]),E(p,"input",l[7]),E(m,"click",l[12]),E(n,"submit",l[11])],k=!0)},p(g,v){if(v[0]&1296){S=Object.keys(g[4]);let y;for(y=0;y<S.length;y+=1){const D=Ct(g,S,y);C[y]?C[y].p(D,v):(C[y]=Ft(D),C[y].c(),C[y].m(a,null))}for(;y<C.length;y+=1)C[y].d(1);C.length=S.length}if(v[0]&16){q=Object.keys(g[4]);let y;for(y=0;y<q.length;y+=1){const D=xt(g,q,y);j[y]?j[y].p(D,v):(j[y]=Ot(D),j[y].c(),j[y].m(u,null))}for(;y<j.length;y+=1)j[y].d(1);j.length=q.length}v[0]&18&&kt(u,g[1]),v[0]&32&&Le(p,g[5]),g[3].length>0?F?F.p(g,v):(F=Lt(g),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:z,o:z,d(g){g&&O(t),me(C,g),me(j,g),l[18](null),l[20](null),F&&F.d(),k=!1,ue(w)}}}async function pl(l,t){let e="/api/getSuggestion",n=new FormData;n.append("attribute",l),n.append("query",t);let a=await fetch(e,{method:"POST",body:n});return a.ok===!0?await a.json():{}}function hl(l,t,e){const n=et();let a="query",s,r,{query_button_disabled:u=!1}=t,i="",f=[],p={person:[],query:[],place:[],filename:[]},_="",b=!1;async function m(I){if(_.length===0)return;let N=await pl(a,_);a in N?(e(3,f=N[a]),e(6,b=!0)):(e(3,f=[]),e(6,b=!1))}function h(I,N){e(4,p[N]=[],p),a==N&&e(3,f=[])}function k(I,N){e(6,b=!1),e(5,_=N),s.focus()}function w(I){e(1,a=I),e(3,f=p[a]),e(6,b=!0),s.focus()}function S(I){I&&I.preventDefault(),e(6,b=!1);let N=p[a].length;_.length>0&&!p[a].includes(_)&&e(4,p[a][N]=_,p),e(5,_="");let U=Object.keys(p);i="";for(let G=0;G<U.length;G++){let W=U[G],R=p[W];i+=W+":";for(let J=0;J<R.length;J++)i+=R[J],J!=R.length-1&&(i+="-");G!=U.length-1&&(i+=",")}console.log("Completed: "+i)}function C(I){S(),n("queryReady",{query:i,attributes:p})}const q=I=>w(I),j=(I,N)=>h(N.currentTarget,I),F=I=>w(I.target.value);function g(){a=al(this),e(1,a),e(4,p)}function v(I){De[I?"unshift":"push"](()=>{s=I,e(2,s)})}function y(){_=this.value,e(5,_)}function D(I){De[I?"unshift":"push"](()=>{r=I,e(0,r),e(13,u)})}const H=I=>k(a,I),M=()=>e(6,b=!1);return l.$$set=I=>{"query_button_disabled"in I&&e(13,u=I.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=u,r)},[r,a,s,f,p,_,b,m,h,k,w,S,C,u,q,j,F,g,v,y,D,H,M]}class ml extends ye{constructor(t){super(),we(this,t,hl,_l,ke,{query_button_disabled:13},null,[-1,-1])}}function Et(l,t,e){const n=l.slice();return n[8]=t[e],n[10]=e,n}function gl(l){let t,e,n;return{c(){t=d("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',c(t,"class","px-4")},m(a,s){L(a,t,s),e||(n=E(t,"click",l[2]),e=!0)},p:z,d(a){a&&O(t),e=!1,n()}}}function bl(l){let t,e,n,a,s;return{c(){t=d("span"),t.textContent="Hachi",e=x(),n=d("span"),n.innerHTML='<i class="fa-solid fa-arrow-left"></i>',c(t,"class","px-4"),c(n,"class","cursor-pointer px-4")},m(r,u){L(r,t,u),L(r,e,u),L(r,n,u),a||(s=E(n,"click",l[3]),a=!0)},p:z,d(r){r&&O(t),r&&O(e),r&&O(n),a=!1,s()}}}function It(l){let t,e,n=l[8].name+"",a,s,r,u=l[8].count+"",i;return{c(){t=d("div"),e=d("div"),a=B(n),s=x(),r=d("div"),i=B(u),c(e,"class","flex"),c(e,"data-ix",l[10]),c(r,"class","px-3 flex text-black text-md text-bold"),c(t,"class","flex w-full justify-between")},m(f,p){L(f,t,p),o(t,e),o(e,a),o(t,s),o(t,r),o(r,i)},p(f,p){p&2&&n!==(n=f[8].name+"")&&K(a,n),p&2&&u!==(u=f[8].count+"")&&K(i,u)},d(f){f&&O(t)}}}function Ht(l){let t,e,n,a,s,r,u,i=l[0].sidebarOpen&&It(l);function f(){return l[6](l[10])}return{c(){t=d("div"),e=d("i"),a=x(),i&&i.c(),s=x(),c(e,"class",n="fa-solid fa-"+l[8].icon),c(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(p,_){L(p,t,_),o(t,e),o(t,a),i&&i.m(t,null),o(t,s),r||(u=E(t,"click",f),r=!0)},p(p,_){l=p,_&2&&n!==(n="fa-solid fa-"+l[8].icon)&&c(e,"class",n),l[0].sidebarOpen?i?i.p(l,_):(i=It(l),i.c(),i.m(t,s)):i&&(i.d(1),i=null)},d(p){p&&O(t),i&&i.d(),r=!1,u()}}}function vl(l){let t,e,n,a,s,r;function u(b,m){return b[0].sidebarOpen?bl:gl}let i=u(l),f=i(l),p=l[1],_=[];for(let b=0;b<p.length;b+=1)_[b]=Ht(Et(l,p,b));return{c(){t=d("div"),e=d("aside"),n=d("div"),f.c(),a=x(),s=d("nav");for(let b=0;b<_.length;b+=1)_[b].c();c(n,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),c(s,"class","mt-6"),c(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),c(t,"class","flex h-screen text-white")},m(b,m){L(b,t,m),o(t,e),o(e,n),f.m(n,null),o(e,a),o(e,s);for(let h=0;h<_.length;h+=1)_[h].m(s,null)},p(b,[m]){if(i===(i=u(b))&&f?f.p(b,m):(f.d(1),f=i(b),f&&(f.c(),f.m(n,null))),m&19){p=b[1];let h;for(h=0;h<p.length;h+=1){const k=Et(b,p,h);_[h]?_[h].p(k,m):(_[h]=Ht(k),_[h].c(),_[h].m(s,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=p.length}m&1&&r!==(r=(b[0].sidebarOpen&&"w-64")+" bg-green-50")&&c(e,"class",r)},i:z,o:z,d(b){b&&O(t),f.d(),me(_,b)}}}function kl(l,t,e){const n=et();let{sidebarOpen:a=!1}=t;const s={sidebarOpen:a},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Ue(()=>{localStorage.getItem("no_images_indexed")?(e(1,r[0].count=Number(localStorage.getItem("no_images_indexed")),r),e(1,r[3].count=Number(localStorage.getItem("unique_people_count")),r),e(1,r[4].count=Number(localStorage.getItem("unique_place_count")),r)):fetch("/api/getMetaStats").then(_=>{_.json().then(b=>{e(1,r[0].count=b.image.count,r),e(1,r[3].count=b.image.unique_people_count,r),e(1,r[4].count=b.image.unique_place_count,r),localStorage.setItem("no_images_indexed",r[0].count.toString()),localStorage.setItem("unique_people_count",r[3].count.toString()),localStorage.setItem("unique_place_count",r[4].count.toString())})})});function u(){e(0,s.sidebarOpen=!0,s)}function i(){e(0,s.sidebarOpen=!1,s)}function f(_){n("menuClick",{item:r[_]})}const p=_=>{f(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,a=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&s&&n("sidebarStateChange",{open:s.sidebarOpen})},[s,r,u,i,f,a,p]}class nt extends ye{constructor(t){super(),we(this,t,kl,vl,ke,{sidebarOpen:5})}}function wl(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S,C,q,j,F,g,v,y,D,H,M,I,N,U,G,W,R,J,Z,re,X,ae,oe,ee,ne;return{c(){t=d("div"),e=d("p"),e.textContent="Press Start button to start indexing",n=x(),a=d("div"),s=d("input"),r=x(),u=d("div"),i=d("div"),f=d("div"),p=x(),_=d("div"),b=B("Current directory: "),m=d("span"),h=B(l[4]),k=x(),w=d("span"),w.textContent="ETA:",S=x(),C=d("span"),q=B(l[5]),j=x(),F=d("div"),g=d("div"),v=d("input"),y=x(),D=d("label"),D.textContent="Complete Rescan",H=x(),M=d("div"),M.textContent="Re-index all originals, including already indexed and unchanged files.",I=x(),N=d("div"),U=d("select"),G=d("option"),G.textContent="Images Only",W=d("option"),W.textContent="Videos Only",R=d("option"),R.textContent="Videos and Images",J=x(),Z=d("div"),Z.textContent="Filter by content type",re=x(),X=d("button"),X.textContent="Cancel",ae=x(),oe=d("button"),oe.textContent="Start",c(e,"class","mb-2 text-sm font-semibold"),c(s,"type","text"),c(s,"class","w-full rounded border p-1 text-sm"),c(s,"placeholder","D://images (Full path to directory to index)"),s.required=!0,c(a,"class","my-2"),c(f,"class","h-2 rounded bg-blue-500"),ce(f,"width",(l[3]*100).toString()+"%"),c(i,"class","h-2 rounded bg-gray-300"),c(m,"class","text-black"),c(w,"class","pl-3 text-right"),c(C,"class","text-black"),c(_,"class","pt-1 text-sm text-blue-600"),c(u,"class","mb-3"),c(v,"type","checkbox"),c(v,"class","h-5 w-5 text-blue-500"),c(D,"class","ml-1"),c(g,"class","mr-2 flex items-center"),c(M,"class","text-sm text-gray-600"),c(F,"class","mt-4 mb-3 flex flex-wrap items-center"),G.__value="Images Only",G.value=G.__value,W.disabled=!0,W.__value="Videos Only",W.value=W.__value,R.disabled=!0,R.__value="Videos and Images",R.value=R.__value,c(U,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),c(Z,"class","ml-2 text-sm text-gray-600"),c(N,"class","mb-3 mt-3 flex flex-wrap items-center"),X.disabled=!0,c(X,"type","button"),c(X,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200"),c(oe,"type","button"),c(oe,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),c(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(se,_e){L(se,t,_e),o(t,e),o(t,n),o(t,a),o(a,s),l[11](s),Le(s,l[6]),o(t,r),o(t,u),o(u,i),o(i,f),o(u,p),o(u,_),o(_,b),o(_,m),o(m,h),o(_,k),o(_,w),o(_,S),o(_,C),o(C,q),o(t,j),o(t,F),o(F,g),o(g,v),v.checked=l[7],o(g,y),o(g,D),o(F,H),o(F,M),o(t,I),o(t,N),o(N,U),o(U,G),o(U,W),o(U,R),o(N,J),o(N,Z),o(t,re),o(t,X),l[15](X),o(t,ae),o(t,oe),l[16](oe),ee||(ne=[E(s,"input",l[12]),E(s,"keydown",l[13]),E(v,"change",l[14]),E(X,"click",l[9]),E(oe,"click",l[8])],ee=!0)},p(se,[_e]){_e&64&&s.value!==se[6]&&Le(s,se[6]),_e&8&&ce(f,"width",(se[3]*100).toString()+"%"),_e&16&&K(h,se[4]),_e&32&&K(q,se[5]),_e&128&&(v.checked=se[7])},i:z,o:z,d(se){se&&O(t),l[11](null),l[15](null),l[16](null),ee=!1,ue(ne)}}}function yl(l,t,e){let n,a,s;Ue(()=>{if(e(10,n=localStorage.getItem("stored_indexing_endpoint")),n!==null){let g="/api/getIndexStatus/"+n;e(0,a.disabled=!1,a),e(1,s.disabled=!0,s),b(g)}}),$e(()=>{_&&clearTimeout(_)});let r,u=.01,i="",f="",p="",_;async function b(g,v=0){v==0&&console.log("starting a new polll...");let D=await(await fetch(g,{method:"GET"})).json();if(D.is_active==!0){if(D.done==!0){let M=new FormData;M.append("ack","true"),(await fetch(g,{method:"POST",body:M})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let N=await fetch("/api/getMetaStats");N=await N.json(),localStorage.setItem("no_images_indexed",N.image.count.toString()),localStorage.setItem("unique_people_count",N.image.unique_people_count.toString()),localStorage.setItem("unique_place_count",N.image.unique_place_count.toString()),e(1,s.disabled=!1,s),e(10,n=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,u=0),e(4,i=""),e(5,f=""),e(6,p=""),e(0,a.disabled=!0,a),e(2,r.disabled=!1,r);return}e(3,u=D.progress),e(5,f=D.eta),e(4,i=D.current_directory),_&&clearTimeout(_),_=setTimeout(function(){b(g,v+1)},1e3)}}let m=!1;async function h(){if(s&&p){e(1,s.disabled=!0,s),e(2,r.disabled=!0,r);let g=new FormData;g.append("image_directory_path",p),g.append("complete_rescan",m.toString());let D=await(await fetch("/api/indexStart",{method:"POST",body:g})).json();if(D.success===!0){e(0,a.disabled=!1,a);let M="/api/getIndexStatus/"+D.statusEndpoint;e(10,n=D.statusEndpoint),b(M)}}else console.log("No index_start_button object found!!!")}async function k(){if(n){e(0,a.disabled=!0,a);let g="/api/indexCancel/"+n,v=await fetch(g,{method:"GET"});if(!v.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(v);return}else return}function w(g){De[g?"unshift":"push"](()=>{r=g,e(2,r)})}function S(){p=this.value,e(6,p)}const C=g=>{g.key==="Enter"&&s.click()};function q(){m=this.checked,e(7,m)}function j(g){De[g?"unshift":"push"](()=>{a=g,e(0,a)})}function F(g){De[g?"unshift":"push"](()=>{s=g,e(1,s)})}return l.$$.update=()=>{l.$$.dirty&1024&&n&&localStorage.setItem("stored_indexing_endpoint",n)},[a,s,r,u,i,f,p,m,h,k,n,w,S,C,q,j,F]}class xl extends ye{constructor(t){super(),we(this,t,yl,wl,ke,{})}}function Tt(l,t,e){const n=l.slice();return n[10]=t[e],n}function Pt(l,t,e){const n=l.slice();return n[13]=t[e],n}function Nt(l){let t;return{c(){t=d("i"),c(t,"class","fa fa-plus text-xs text-black")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Ut(l){let t,e,n=l[1].selectFilters[l[10]].values.includes(l[13]),a,s,r,u=l[13]+"",i,f,p,_=n&&Nt();function b(){return l[7](l[10],l[13])}return{c(){t=d("div"),e=d("div"),_&&_.c(),s=x(),r=d("span"),i=B(u),c(e,"class",a="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),c(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){L(m,t,h),o(t,e),_&&_.m(e,null),o(t,s),o(t,r),o(r,i),f||(p=E(t,"click",b),f=!0)},p(m,h){l=m,h&2&&(n=l[1].selectFilters[l[10]].values.includes(l[13])),n?_||(_=Nt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),h&2&&a!==(a="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&c(e,"class",a),h&2&&u!==(u=l[13]+"")&&K(i,u)},d(m){m&&O(t),_&&_.d(),f=!1,p()}}}function At(l){let t,e,n=l[10]+"",a,s,r,u,i,f,p,_,b;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,k=[];for(let w=0;w<h.length;w+=1)k[w]=Ut(Pt(l,h,w));return{c(){t=d("div"),e=d("div"),a=B(n),s=x(),r=d("i"),i=x(),f=d("div");for(let w=0;w<k.length;w+=1)k[w].c();c(r,"class",u="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),c(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),c(f,"class",p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),c(t,"class","relative")},m(w,S){L(w,t,S),o(t,e),o(e,a),o(e,s),o(e,r),o(t,i),o(t,f);for(let C=0;C<k.length;C+=1)k[C].m(f,null);_||(b=[E(e,"click",m),E(t,"mouseup",Fl)],_=!0)},p(w,S){if(l=w,S&2&&n!==(n=l[10]+"")&&K(a,n),S&2&&u!==(u="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&c(r,"class",u),S&6){h=l[1].selectFilters[l[10]].options;let C;for(C=0;C<h.length;C+=1){const q=Pt(l,h,C);k[C]?k[C].p(q,S):(k[C]=Ut(q),k[C].c(),k[C].m(f,null))}for(;C<k.length;C+=1)k[C].d(1);k.length=h.length}S&2&&p!==(p=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&c(f,"class",p)},d(w){w&&O(t),me(k,w),_=!1,ue(b)}}}function Cl(l){let t,e,n,a,s,r,u,i,f,p,_,b,m=Object.keys(l[1].selectFilters),h=[];for(let k=0;k<m.length;k+=1)h[k]=At(Tt(l,m,k));return{c(){t=d("div"),e=d("div"),n=d("span"),n.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',a=x(),s=d("span"),s.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=x();for(let k=0;k<h.length;k+=1)h[k].c();u=x(),i=d("button"),f=B("Filter"),c(n,"class","flex items-center text-md"),c(s,"class","flex items-center text-md"),i.disabled=l[0],c(i,"class",p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),c(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),c(t,"class","flex container mx-auto max-w-4xl")},m(k,w){L(k,t,w),o(t,e),o(e,n),o(e,a),o(e,s),o(e,r);for(let S=0;S<h.length;S+=1)h[S].m(e,null);o(e,u),o(e,i),o(i,f),_||(b=E(i,"click",l[4]),_=!0)},p(k,[w]){if(w&14){m=Object.keys(k[1].selectFilters);let S;for(S=0;S<m.length;S+=1){const C=Tt(k,m,S);h[S]?h[S].p(C,w):(h[S]=At(C),h[S].c(),h[S].m(e,u))}for(;S<h.length;S+=1)h[S].d(1);h.length=m.length}w&1&&(i.disabled=k[0]),w&1&&p!==(p="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(k[0]===!0?"disabled":""))&&c(i,"class",p)},i:z,o:z,d(k){k&&O(t),me(h,k),_=!1,b()}}}function ll(l,t,e=null,n=(a,s)=>a===s){let a=[];for(let s=0;s<l.length;s++)e?n(l[s].key,t)?a.push(1):a.push(0):n(l[s],t)?a.push(1):a.push(0);return a}function Sl(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let a=ll(l,t[n]);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(a[s]))}return e}function Dl(l,t=[]){let e=[];for(let n=0;n<l.length;n++)e.push(0);for(let n=0;n<t.length;n++){let a=ll(l,t[n],null,(s,r)=>s?s.includes(r):!1);console.log("temp: ",a);for(let s=0;s<e.length;s++)e[s]=Number(Boolean(e[s])||Boolean(a[s]))}return e}function jl(l){let t=l[0].length,e=l[0];return l.forEach((n,a)=>{if(a>0){if(n.length!==t)throw new Error("all mask must be of same length!!");n.forEach((s,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(s))})}}),e}const Fl=l=>l.stopPropagation();function Ol(l,t,e){const n=et();let{filter_button_disabled:a=!0}=t,{image_data:s=null}=t;const r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Ue(()=>{document.addEventListener("mouseup",u)});function u(m){e(1,r.selectFilterActive="",r)}function i(m,h){if(r.selectFilters[m].values.includes(h)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(k=>k!==h),r);return}e(1,r.selectFilters[m].values=[h,...r.selectFilters[m].values],r)}function f(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function p(){if(s){let m=[],h=[];s.list_metaData.map((j,F)=>{m.push(j.place),h.push(j.person)});let k=r.selectFilters.place.values,w=Sl(m,k),S=r.selectFilters.people.values,C=Dl(h,S),q=jl([w,C]);n("filterApplied",{mask:q})}}const _=m=>f(m),b=(m,h)=>i(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,a=m.filter_button_disabled),"image_data"in m&&e(5,s=m.image_data)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.list_metaData.map((S,C)=>{if(S.place)return S.place}),h=[];s.list_metaData.map((S,C)=>{S.person&&S.person.forEach(q=>h.push(q))});let k=[];new Set(m).forEach(S=>k.push(S));let w=[];new Set(h).forEach(S=>w.push(S)),e(1,r.selectFilters.place.values=k,r),e(1,r.selectFilters.place.options=k,r),e(1,r.selectFilters.people.values=w,r),e(1,r.selectFilters.people.options=w,r)}},[a,r,i,f,p,s,_,b]}class Ll extends ye{constructor(t){super(),we(this,t,Ol,Cl,ke,{filter_button_disabled:0,image_data:5})}}function Bt(l,t,e){const n=l.slice();return n[45]=t[e],n[44]=e,n}function Mt(l,t,e){const n=l.slice();return n[42]=t[e],n[44]=e,n}function ql(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S,C,q,j=l[1]&&Rt(l);e=new Ll({props:{filter_button_disabled:l[3],image_data:l[4]}}),e.$on("filterApplied",l[37]);let F=l[7],g=[];for(let v=0;v<F.length;v+=1)g[v]=Vt(Bt(l,F,v));return{c(){j&&j.c(),t=x(),he(e.$$.fragment),n=x(),a=d("div"),s=d("div"),r=d("div"),u=d("div"),i=d("div"),f=d("input"),p=x(),_=d("label"),b=B("Score threshold: "),m=B(l[11]),h=B("."),k=x(),w=d("div");for(let v=0;v<g.length;v+=1)g[v].c();c(f,"type","range"),c(f,"min","0"),c(f,"max","1.0"),c(f,"step","0.01"),c(f,"class","w-full"),c(_,"for","topk"),c(_,"class","dark:text-white"),c(i,"class","my-4"),c(r,"class","flex flex-row place-content-center mb-10 select-none mx-2"),c(w,"class","flex flex-wrap gap-6 p-4 sm:p-12 px-auto justify-center"),c(s,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),c(a,"class","flex")},m(v,y){j&&j.m(v,y),L(v,t,y),fe(e,v,y),L(v,n,y),L(v,a,y),o(a,s),o(s,r),o(r,u),o(u,i),o(i,f),Le(f,l[11]),o(i,p),o(i,_),o(_,b),o(_,m),o(_,h),o(s,k),o(s,w);for(let D=0;D<g.length;D+=1)g[D].m(w,null);S=!0,C||(q=[E(f,"change",l[18]),E(f,"change",l[38]),E(f,"input",l[38])],C=!0)},p(v,y){v[1]?j?j.p(v,y):(j=Rt(v),j.c(),j.m(t.parentNode,t)):j&&(j.d(1),j=null);const D={};if(y[0]&8&&(D.filter_button_disabled=v[3]),y[0]&16&&(D.image_data=v[4]),e.$set(D),y[0]&2048&&Le(f,v[11]),(!S||y[0]&2048)&&K(m,v[11]),y[0]&24705){F=v[7];let H;for(H=0;H<F.length;H+=1){const M=Bt(v,F,H);g[H]?g[H].p(M,y):(g[H]=Vt(M),g[H].c(),g[H].m(w,null))}for(;H<g.length;H+=1)g[H].d(1);g.length=F.length}},i(v){S||(Y(e.$$.fragment,v),S=!0)},o(v){$(e.$$.fragment,v),S=!1},d(v){j&&j.d(v),v&&O(t),de(e,v),v&&O(n),v&&O(a),me(g,v),C=!1,ue(q)}}}function El(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S,C,q,j,F,g=l[2].image_card_edit_interface&&Gt(l),v=l[6]&&Xt(l);return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,a=x(),s=d("div"),s.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=x(),u=d("div"),i=d("div"),i.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',f=x(),p=d("div"),_=d("div"),b=d("img"),h=x(),k=d("div"),k.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',w=x(),g&&g.c(),S=x(),C=d("div"),C.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',q=x(),v&&v.c(),c(n,"class","cursor-pointer hover:underline text-gray-200"),c(s,"title","Fullscreen"),c(s,"class","cursor-pointer"),c(e,"class","flex h-6 items-center justify-between"),c(i,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),c(b,"class","w-auto cursor-pointer h-full"),ve(b.src,m=l[5].url)||c(b,"src",m),c(b,"alt",""),c(k,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),c(_,"class","flex shrink h-full"),c(p,"class","flex h-full items-center justify-center p-2 gap-4"),c(C,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),c(u,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),c(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(y,D){L(y,t,D),o(t,e),o(e,n),o(e,a),o(e,s),o(t,r),o(t,u),o(u,i),o(u,f),o(u,p),o(p,_),o(_,b),o(_,h),o(_,k),o(p,w),g&&g.m(p,null),o(u,S),o(u,C),o(t,q),v&&v.m(t,null),j||(F=[E(n,"click",l[29]),E(s,"click",l[30]),E(i,"click",l[31]),E(b,"click",l[32]),E(k,"click",l[33]),E(C,"click",l[35])],j=!0)},p(y,D){D[0]&32&&!ve(b.src,m=y[5].url)&&c(b,"src",m),y[2].image_card_edit_interface?g?g.p(y,D):(g=Gt(y),g.c(),g.m(p,null)):g&&(g.d(1),g=null),y[6]?v?v.p(y,D):(v=Xt(y),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},i:z,o:z,d(y){y&&O(t),g&&g.d(),v&&v.d(),j=!1,ue(F)}}}function Il(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S,C,q=l[10],j=[];for(let g=0;g<q.length;g+=1)j[g]=Kt(Mt(l,q,g));let F=l[9].active&&Qt(l);return{c(){t=d("div"),e=d("div"),n=d("img"),s=x();for(let g=0;g<j.length;g+=1)j[g].c();r=x(),F&&F.c(),u=x(),i=d("div"),f=d("div"),f.innerHTML='<i class="fa fa-arrow-left"></i>',p=x(),_=d("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',b=x(),m=d("div"),h=d("div"),h.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,k=x(),w=d("div"),w.innerHTML='<i class="fa fa-arrows-alt"></i>',c(n,"class","object-cover h-screen w-auto"),ve(n.src,a=l[5].url)||c(n,"src",a),c(n,"alt",""),c(e,"class","relative flex"),c(f,"class","text-white cursor-pointer"),c(_,"class","text-white cursor-pointer"),c(i,"class","absolute flex mx-auto items-center justify-between w-screen"),c(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),c(h,"class","cursor-pointer hover:underline text-white"),c(w,"title","Fullscreen"),c(w,"class","cursor-pointer text-white"),c(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(g,v){L(g,t,v),o(t,e),o(e,n),o(e,s);for(let y=0;y<j.length;y+=1)j[y].m(e,null);o(e,r),F&&F.m(e,null),o(t,u),o(t,i),o(i,f),o(i,p),o(i,_),L(g,b,v),L(g,m,v),o(m,h),o(m,k),o(m,w),S||(C=[E(n,"load",l[17]),E(f,"click",l[25]),E(_,"click",l[26]),E(h,"click",l[27]),E(w,"click",l[28])],S=!0)},p(g,v){if(v[0]&32&&!ve(n.src,a=g[5].url)&&c(n,"src",a),v[0]&1792){q=g[10];let y;for(y=0;y<q.length;y+=1){const D=Mt(g,q,y);j[y]?j[y].p(D,v):(j[y]=Kt(D),j[y].c(),j[y].m(e,r))}for(;y<j.length;y+=1)j[y].d(1);j.length=q.length}g[9].active?F?F.p(g,v):(F=Qt(g),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:z,o:z,d(g){g&&O(t),me(j,g),F&&F.d(),g&&O(b),g&&O(m),S=!1,ue(C)}}}function Rt(l){let t,e,n,a,s;return{c(){t=d("div"),e=d("div"),n=d("div"),n.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,c(n,"class","cursor-pointer hover:underline text-black"),c(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),c(t,"class","flex")},m(r,u){L(r,t,u),o(t,e),o(e,n),a||(s=E(n,"click",l[36]),a=!0)},p:z,d(r){r&&O(t),a=!1,s()}}}function zt(l){let t,e,n,a,s,r;function u(){return l[39](l[44])}return{c(){t=d("div"),e=d("img"),a=x(),c(e,"class","sm:max-h-48 rounded-lg shadow-xl cursor-pointer"),ve(e.src,n=l[0].list_src[l[45].ix])||c(e,"src",n),c(e,"alt","image"),c(t,"class","relative group")},m(i,f){L(i,t,f),o(t,e),o(t,a),s||(r=E(t,"click",u),s=!0)},p(i,f){l=i,f[0]&129&&!ve(e.src,n=l[0].list_src[l[45].ix])&&c(e,"src",n)},d(i){i&&O(t),s=!1,r()}}}function Vt(l){let t,e=l[45].ix>=0&&zt(l);return{c(){e&&e.c(),t=qe()},m(n,a){e&&e.m(n,a),L(n,t,a)},p(n,a){n[45].ix>=0?e?e.p(n,a):(e=zt(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){e&&e.d(n),n&&O(t)}}}function Gt(l){let t,e,n,a,s,r,u,i,f,p,_,b,m,h,k,w,S,C,q,j,F,g,v,y,D,H,M,I,N,U,G,W,R,J,Z,re,X,ae,oe;return{c(){t=d("div"),e=d("div"),n=d("div"),n.textContent="Info",a=x(),s=d("div"),s.textContent="X",r=x(),u=d("div"),i=d("div"),i.textContent="Description",f=x(),p=d("input"),b=x(),m=d("div"),h=d("div"),h.textContent="place",k=x(),w=d("input"),C=x(),q=d("div"),j=d("div"),j.textContent="Tags",F=x(),g=d("input"),y=x(),D=d("div"),H=d("div"),H.textContent="Taken at:",M=x(),I=d("input"),N=x(),U=d("div"),G=d("div"),G.textContent="device",W=x(),R=d("input"),Z=x(),re=d("div"),X=d("button"),X.textContent="Save",c(n,"class","grow text-xl text-gray-100 font-bold"),c(s,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),c(e,"class","flex items-center"),c(i,"class","mb-1 text-gray-100"),c(p,"name","Description"),c(p,"placeholder",""),p.value=_=l[5].description.toString(),c(p,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(p,"type","text"),c(h,"class","mb-1 text-gray-100"),c(w,"name","place"),w.value=S=l[5].place.toString(),c(w,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(w,"type","text"),c(j,"class","mb-1 text-gray-100"),c(g,"name","tags"),c(g,"placeholder","Car, chair"),g.value=v=l[5].tags.toString(),c(g,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(g,"type","text"),c(H,"class","mb-1 text-gray-100"),c(I,"name","taken_at"),I.value="",c(I,"type","date"),c(I,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(G,"class","mb-1 text-gray-100"),c(R,"name","device"),c(R,"placeholder","Canon"),R.value=J=l[5].device.toString(),c(R,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),c(R,"type","text"),c(X,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400"),c(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(ee,ne){L(ee,t,ne),o(t,e),o(e,n),o(e,a),o(e,s),o(t,r),o(t,u),o(u,i),o(u,f),o(u,p),o(t,b),o(t,m),o(m,h),o(m,k),o(m,w),o(t,C),o(t,q),o(q,j),o(q,F),o(q,g),o(t,y),o(t,D),o(D,H),o(D,M),o(D,I),o(t,N),o(t,U),o(U,G),o(U,W),o(U,R),o(t,Z),o(t,re),o(re,X),ae||(oe=[E(s,"click",l[34]),E(p,"change",l[21]),E(w,"change",l[21]),E(g,"change",l[21]),E(I,"change",l[21]),E(R,"change",l[21]),E(X,"click",l[22])],ae=!0)},p(ee,ne){ne[0]&32&&_!==(_=ee[5].description.toString())&&p.value!==_&&(p.value=_),ne[0]&32&&S!==(S=ee[5].place.toString())&&w.value!==S&&(w.value=S),ne[0]&32&&v!==(v=ee[5].tags.toString())&&g.value!==v&&(g.value=v),ne[0]&32&&J!==(J=ee[5].device.toString())&&R.value!==J&&(R.value=J)},d(ee){ee&&O(t),ae=!1,ue(oe)}}}function Xt(l){let t,e,n,a,s=l[5].filename+"",r,u,i,f,p,_=l[5].data_hash+"",b,m,h,k,w,S=l[5].last_modified+"",C,q,j,F,g,v,y,D,H,M=l[5].description.toString()+"",I,N,U,G,W,R,J=l[5].taken_at.toString()+"",Z,re,X,ae,oe,ee,ne=l[5].tags.toString()+"",se,_e,xe,T,A,V,te=l[5].place.toString()+"",P,be,je,pe,ge,ie,Ee,Ce,Ae=l[5].person_ids.toString()+"",st,_t,Ie,Be,pt,Me,Re=l[5].device.toString()+"",it,ht,He,ze,mt,Ve,Ge=l[5].resolution.toString()+"",rt,gt,Te,Xe,bt,Ke,Qe=l[5].absolute_path.toString()+"",at;return{c(){t=d("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=x(),n=d("div"),a=d("div"),r=B(s),u=x(),i=d("div"),f=B("UID: "),p=d("span"),b=B(_),m=x(),h=d("div"),k=B("Last Modified:  "),w=d("span"),C=B(S),q=x(),j=d("div"),F=d("div"),g=d("div"),v=d("div"),y=d("div"),y.textContent="Description",D=x(),H=d("div"),I=B(M),N=x(),U=d("div"),G=d("div"),G.textContent="Taken at",W=x(),R=d("div"),Z=B(J),re=x(),X=d("div"),ae=d("div"),ae.textContent="Tags",oe=x(),ee=d("div"),se=B(ne),_e=x(),xe=d("div"),T=d("div"),T.textContent="Place",A=x(),V=d("div"),P=B(te),be=x(),je=d("div"),pe=d("div"),ge=d("div"),ie=d("div"),ie.textContent="people",Ee=x(),Ce=d("div"),st=B(Ae),_t=x(),Ie=d("div"),Be=d("div"),Be.textContent="Device",pt=x(),Me=d("div"),it=B(Re),ht=x(),He=d("div"),ze=d("div"),ze.textContent="Resolution",mt=x(),Ve=d("div"),rt=B(Ge),gt=x(),Te=d("div"),Xe=d("div"),Xe.textContent="Path",bt=x(),Ke=d("div"),at=B(Qe),c(a,"class","text-xl text-white"),c(p,"class","text-sm text-gray-400"),c(i,"class","text-white"),c(w,"class","text-sm text-gray-400"),c(h,"class","text-white"),c(n,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),c(y,"class",""),c(H,"class","text-sm text-gray-400"),c(G,"class",""),c(R,"class","text-sm text-gray-400"),c(ae,"class",""),c(ee,"class","text-sm text-gray-400"),c(T,"class",""),c(V,"class","text-sm text-gray-400"),c(g,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),c(F,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),c(ie,"class",""),c(Ce,"class","text-sm text-gray-400"),c(Be,"class",""),c(Me,"class","text-sm text-gray-400"),c(ze,"class",""),c(Ve,"class","text-sm text-gray-400"),c(Xe,"class",""),c(Ke,"class","text-sm text-gray-400"),c(pe,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),c(je,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),c(j,"class","flex w-full justify-center p-4")},m(Q,le){L(Q,t,le),L(Q,e,le),L(Q,n,le),o(n,a),o(a,r),o(n,u),o(n,i),o(i,f),o(i,p),o(p,b),o(n,m),o(n,h),o(h,k),o(h,w),o(w,C),L(Q,q,le),L(Q,j,le),o(j,F),o(F,g),o(g,v),o(v,y),o(v,D),o(v,H),o(H,I),o(g,N),o(g,U),o(U,G),o(U,W),o(U,R),o(R,Z),o(g,re),o(g,X),o(X,ae),o(X,oe),o(X,ee),o(ee,se),o(g,_e),o(g,xe),o(xe,T),o(xe,A),o(xe,V),o(V,P),o(j,be),o(j,je),o(je,pe),o(pe,ge),o(ge,ie),o(ge,Ee),o(ge,Ce),o(Ce,st),o(pe,_t),o(pe,Ie),o(Ie,Be),o(Ie,pt),o(Ie,Me),o(Me,it),o(pe,ht),o(pe,He),o(He,ze),o(He,mt),o(He,Ve),o(Ve,rt),o(pe,gt),o(pe,Te),o(Te,Xe),o(Te,bt),o(Te,Ke),o(Ke,at)},p(Q,le){le[0]&32&&s!==(s=Q[5].filename+"")&&K(r,s),le[0]&32&&_!==(_=Q[5].data_hash+"")&&K(b,_),le[0]&32&&S!==(S=Q[5].last_modified+"")&&K(C,S),le[0]&32&&M!==(M=Q[5].description.toString()+"")&&K(I,M),le[0]&32&&J!==(J=Q[5].taken_at.toString()+"")&&K(Z,J),le[0]&32&&ne!==(ne=Q[5].tags.toString()+"")&&K(se,ne),le[0]&32&&te!==(te=Q[5].place.toString()+"")&&K(P,te),le[0]&32&&Ae!==(Ae=Q[5].person_ids.toString()+"")&&K(st,Ae),le[0]&32&&Re!==(Re=Q[5].device.toString()+"")&&K(it,Re),le[0]&32&&Ge!==(Ge=Q[5].resolution.toString()+"")&&K(rt,Ge),le[0]&32&&Qe!==(Qe=Q[5].absolute_path.toString()+"")&&K(at,Qe)},d(Q){Q&&O(t),Q&&O(e),Q&&O(n),Q&&O(q),Q&&O(j)}}}function Kt(l){let t,e,n;function a(...s){return l[23](l[42],...s)}return{c(){t=d("div"),c(t,"data-ix",l[44]),c(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ce(t,"top",l[42].top+"px "),ce(t,"left",l[42].left+"px"),ce(t,"width",l[42].width+"px"),ce(t,"height",l[42].height+"px")},m(s,r){L(s,t,r),e||(n=E(t,"click",a),e=!0)},p(s,r){l=s,r[0]&1024&&ce(t,"top",l[42].top+"px "),r[0]&1024&&ce(t,"left",l[42].left+"px"),r[0]&1024&&ce(t,"width",l[42].width+"px"),r[0]&1024&&ce(t,"height",l[42].height+"px")},d(s){s&&O(t),e=!1,n()}}}function Qt(l){let t,e,n,a,s,r,u;return{c(){t=d("div"),e=d("input"),a=x(),s=d("div"),s.textContent="X",e.autofocus=!0,e.value=n=l[5].person_ids[l[8]],c(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),c(e,"placeholder","Enter person id"),c(e,"type","text"),c(s,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),c(t,"class","absolute flex h-auto w-240 bg-blue-300"),ce(t,"top",l[9].top+"px "),ce(t,"left",l[9].left+"px")},m(i,f){L(i,t,f),o(t,e),o(t,a),o(t,s),e.focus(),r||(u=[E(e,"keyup",l[20]),E(s,"click",l[24])],r=!0)},p(i,f){f[0]&288&&n!==(n=i[5].person_ids[i[8]])&&e.value!==n&&(e.value=n),f[0]&512&&ce(t,"top",i[9].top+"px "),f[0]&512&&ce(t,"left",i[9].left+"px")},d(i){i&&O(t),r=!1,ue(u)}}}function Hl(l){let t,e,n,a;const s=[Il,El,ql],r=[];function u(i,f){return i[2].image_card_fullscreen===!0?0:i[2].image_card===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=qe()},m(i,f){r[t].m(i,f),L(i,n,f),a=!0},p(i,f){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),$(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Y(e,1),e.m(n.parentNode,n))},i(i){a||(Y(e),a=!0)},o(i){$(e),a=!1},d(i){r[t].d(i),i&&O(n)}}}function ct(l,t=[1],e=null){let n=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let a=0;a<l.length;a++){let s=a;t[a%t.length]!==1&&(s=-1),e?n.push({ix:s,score:l[a][e]}):n.push({ix:s,score:l[a]})}return n.sort((a,s)=>a.score>s.score?-1:a.score<s.score?1:0),n}function Tl(l,t,e){const n=et();let{show_exit_interface_button:a=!1}=t,{image_data:s={list_metaData:[],list_dataHash:[],list_src:[],list_score:[],done:!1}}=t,r=!0,u=null;$e(()=>{e(0,s={list_metaData:[],list_dataHash:[],list_src:[],list_score:[],done:!1})});let i={},f=!1,p=[],_={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function b(T){let A=Object.keys(_);for(let V=0;V<A.length;V++)e(2,_[A[V]]=!1,_);e(2,_[T]=!0,_)}let m,h={active:!1,top:null,left:null};function k(T){let A={sorted_ix:null,image_ix:null};for(let V=T;V<p.length;V++)if(p[V].ix!==-1){A.image_ix=p[V].ix,A.sorted_ix=V;break}return A}function w(T){D={},e(6,f=!1),e(10,q=[]),e(9,h={active:!1,top:null,left:null});let A=T,V=p.length;A<0&&(A=V-1),A>V-1&&(A=0);let te=k(A),P=te.image_ix;A=te.sorted_ix,P===null&&(te=k(0),P=te.image_ix,A=te.sorted_ix),e(5,i.ix=A,i),e(5,i.url=s.list_src[P],i),e(5,i.data_hash=s.list_dataHash[P],i),e(5,i.height=Number(s.list_metaData[P].height),i),e(5,i.width=Number(s.list_metaData[P].width),i),e(5,i.face_bboxes=s.list_metaData[P].face_bboxes,i),e(5,i.person_ids=s.list_metaData[P].person,i),i.person_ids===null&&e(5,i.person_ids=[],i),e(5,i.resolution=i.height.toString()+" X "+i.width.toString(),i),e(5,i.filename=s.list_metaData[P].filename,i),e(5,i.taken_at=s.list_metaData[P].taken_at,i),i.taken_at==null&&e(5,i.taken_at="Unknown",i),e(5,i.last_modified=s.list_metaData[P].modified_at,i),e(5,i.device=s.list_metaData[P].device,i),i.device==null&&e(5,i.device="",i),e(5,i.place=s.list_metaData[P].place,i),e(5,i.absolute_path=s.list_metaData[P].absolute_path,i),e(5,i.description=s.list_metaData[P].description,i),e(5,i.tags=s.list_metaData[P].tags,i),e(6,f=!0)}function S(){w(i.ix+1)}function C(){w(i.ix-1)}let q=[];function j(T){let A=T.target.getClientRects()[0],V=A.width,te=A.height,P=[],be=i.face_bboxes;if(be){let je=i.width,pe=i.height;for(let ge=0;ge<be.length;ge++){let ie=structuredClone(be[ge]),Ee=Number(V)/(Number(je)+1e-4),Ce=Number(te)/(Number(pe)+1e-4);ie.top=ie[1]*Ce,ie.height=(ie[3]-ie[1])*Ce,ie.left=ie[0]*Ee,ie.width=(ie[2]-ie[0])*Ee,P.push(ie)}}console.log(P),e(10,q=P)}let F=0;function g(){let T=p[0].score,A=p[p.length-1].score,te=s.list_score.map(P=>(P-A)/(T-A+1e-5)).map(P=>P>=F?1:0);e(7,p=ct(s.list_score,te))}function v(T){e(3,r=!0),e(7,p=ct(s.list_score,T)),e(3,r=!1)}function y(T){let A=T.target.value,V=i.data_hash,te=i.person_ids[m];if(T.key=="Enter"){let P=new FormData;P.append("new_person_id",A),P.append("old_person_id",te),P.append("data_hash",V),fetch("/api/tagPerson",{method:"POST",body:P}).then(be=>{if(be.ok)alert("Success");else throw new Error("Error occured")})}}let D={};function H(T){D[T.target.name.toLowerCase()]=T.target.value}async function M(T){T.target.disabled=!0;let A=Object.keys(D),V=new FormData;for(let P=0;P<A.length;P++)V.append(A[P],D[A[P]]);V.append("data_hash",i.data_hash);let te=await fetch("/api/editMetaData",{method:"POST",body:V});if(!te.ok)throw new Error("Error while updating meta-data !!");await te.json(),T.target.disabled=!1}const I=(T,A)=>{e(9,h={active:!0,top:T.top-28,left:T.left}),e(8,m=Number(A.target.attributes["data-ix"].value))},N=()=>{e(9,h.active=!1,h)},U=()=>{C()},G=()=>{S()},W=()=>{b("parent")},R=()=>{b("image_card")},J=()=>{b("parent")},Z=()=>{b("image_card_fullscreen")},re=()=>{C()},X=()=>{console.log("hellll"),b("image_card_fullscreen")},ae=()=>{e(2,_.image_card_edit_interface=!0,_)},oe=()=>{e(2,_.image_card_edit_interface=!1,_)},ee=()=>{S()},ne=()=>{n("exitButtonPressed")},se=T=>{v(T.detail.mask)};function _e(){F=il(this.value),e(11,F)}const xe=T=>{w(T),b("image_card")};return l.$$set=T=>{"show_exit_interface_button"in T&&e(1,a=T.show_exit_interface_button),"image_data"in T&&e(0,s=T.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&1&&s&&(e(3,r=!s.done),s.done&&e(4,u=s)),l.$$.dirty[0]&1&&s&&e(7,p=ct(s.list_score)),l.$$.dirty[0]&4&&_){let T=!1;(_.image_card==!0||_.image_card_fullscreen==!0)&&(T=!0),n("imageCardActive",{active:T})}},[s,a,_,r,u,i,f,p,m,h,q,F,n,b,w,S,C,j,g,v,y,H,M,I,N,U,G,W,R,J,Z,re,X,ae,oe,ee,ne,se,_e,xe]}class dt extends ye{constructor(t){super(),we(this,t,Tl,Hl,ke,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const nl="/assets/sample_place_bg-38f3fbd4.jpg";function Wt(l,t,e){const n=l.slice();return n[9]=t[e],n}function Pl(l){let t,e,n,a=l[0].people,s=[];for(let r=0;r<a.length;r+=1)s[r]=Jt(Wt(l,a,r));return{c(){t=d("div"),e=x(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();c(t,"class","flex w-screen h-[80px] bg-blue-100"),c(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,u){L(r,t,u),L(r,e,u),L(r,n,u);for(let i=0;i<s.length;i+=1)s[i].m(n,null)},p(r,u){if(u&17){a=r[0].people;let i;for(i=0;i<a.length;i+=1){const f=Wt(r,a,i);s[i]?s[i].p(f,u):(s[i]=Jt(f),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=a.length}},i:z,o:z,d(r){r&&O(t),r&&O(e),r&&O(n),me(s,r)}}}function Nl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){L(e,t,n)},p:z,i:z,o:z,d(e){e&&O(t)}}}function Ul(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){he(t.$$.fragment)},m(n,a){fe(t,n,a),e=!0},p(n,a){const s={};a&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Y(t.$$.fragment,n),e=!0)},o(n){$(t.$$.fragment,n),e=!1},d(n){de(t,n)}}}function Jt(l){let t,e,n,a,s,r,u,i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"",f,p,_,b;function m(...h){return l[6](l[9],...h)}return{c(){t=d("div"),e=d("div"),n=d("div"),a=d("img"),r=x(),u=d("div"),f=B(i),p=x(),ve(a.src,s=nl)||c(a,"src",s),c(a,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),c(n,"class","h-[150px] w-[200px] bg-gray-800"),c(u,"class","flex text-xl text-white justify-center items-center"),c(t,"class","flex-col cursor-pointer")},m(h,k){L(h,t,k),o(t,e),o(e,n),o(n,a),o(e,r),o(e,u),o(u,f),o(t,p),_||(b=E(t,"click",m),_=!0)},p(h,k){l=h,k&1&&i!==(i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"")&&K(f,i)},d(h){h&&O(t),_=!1,b()}}}function Al(l){let t,e,n,a;const s=[Ul,Nl,Pl],r=[];function u(i,f){return i[3]?0:i[2]===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=qe()},m(i,f){r[t].m(i,f),L(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),$(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Y(e,1),e.m(n.parentNode,n))},i(i){a||(Y(e),a=!0)},o(i){$(e),a=!1},d(i){r[t].d(i),i&&O(n)}}}async function Bl(l){let t="/api/getRawData/"+l,n=await(await fetch(t)).blob();return await URL.createObjectURL(n)}function Ml(l,t,e){let n={people:[]},a={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],list_src:[],done:!1},r=!1,u=!1;Ue(()=>{fetch("/api/getGroup/person").then(_=>{_.json().then(b=>{let m=b.meta_data.length;console.log("data length: ",m);for(let h=0;h<m;h++)a.list_dataHash.push(b.data_hash[h]),a.list_score.push(b.score[h]),a.list_metaData.push(b.meta_data[h]);e(0,n.people=b.person,n)})})}),$e(()=>{console.log("destroying...")});async function i(_){let m=0;e(3,u=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],list_src:[],done:!1}),e(2,r=!0);for(let h=0;h<a.list_dataHash.length;h++){if(r===!1){console.log("stopping...");return}if(a.list_metaData[h].person.includes(_)){s.list_metaData.push(a.list_metaData[h]),s.list_dataHash.push(a.list_dataHash[h]),s.list_score.push(a.list_score[h]);let k=await Bl(a.list_dataHash[h]);s.list_src.push(k),m+=1,m%10==0&&(e(1,s=s),e(3,u=!0))}}e(1,s.done=!0,s),e(3,u=!0),e(2,r=!1)}return[n,s,r,u,i,()=>{console.log("pressed the hell out of it!"),e(3,u=!1),e(2,r=!1)},(_,b)=>{console.log("mine is: ",_),i(_)}]}class Rl extends ye{constructor(t){super(),we(this,t,Ml,Al,ke,{})}}function Yt(l,t,e){const n=l.slice();return n[9]=t[e],n}function zl(l){let t,e,n,a=l[0].places,s=[];for(let r=0;r<a.length;r+=1)s[r]=Zt(Yt(l,a,r));return{c(){t=d("div"),e=x(),n=d("div");for(let r=0;r<s.length;r+=1)s[r].c();c(t,"class","flex w-screen h-[80px] bg-blue-100"),c(n,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,u){L(r,t,u),L(r,e,u),L(r,n,u);for(let i=0;i<s.length;i+=1)s[i].m(n,null)},p(r,u){if(u&17){a=r[0].places;let i;for(i=0;i<a.length;i+=1){const f=Yt(r,a,i);s[i]?s[i].p(f,u):(s[i]=Zt(f),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=a.length}},i:z,o:z,d(r){r&&O(t),r&&O(e),r&&O(n),me(s,r)}}}function Vl(l){let t;return{c(){t=d("p"),t.textContent="Loading, please wait..."},m(e,n){L(e,t,n)},p:z,i:z,o:z,d(e){e&&O(t)}}}function Gl(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){he(t.$$.fragment)},m(n,a){fe(t,n,a),e=!0},p(n,a){const s={};a&2&&(s.image_data=n[1]),t.$set(s)},i(n){e||(Y(t.$$.fragment,n),e=!0)},o(n){$(t.$$.fragment,n),e=!1},d(n){de(t,n)}}}function Zt(l){let t,e,n,a,s,r,u,i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"",f,p,_,b;function m(...h){return l[6](l[9],...h)}return{c(){t=d("div"),e=d("div"),n=d("div"),a=d("img"),r=x(),u=d("div"),f=B(i),p=x(),ve(a.src,s=nl)||c(a,"src",s),c(a,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),c(n,"class","h-[150px] w-[200px] bg-gray-800"),c(u,"class","flex text-xl text-white justify-center items-center"),c(t,"class","flex-col cursor-pointer")},m(h,k){L(h,t,k),o(t,e),o(e,n),o(n,a),o(e,r),o(e,u),o(u,f),o(t,p),_||(b=E(t,"click",m),_=!0)},p(h,k){l=h,k&1&&i!==(i=l[9].slice(0,1).toUpperCase()+l[9].slice(1).toLowerCase()+"")&&K(f,i)},d(h){h&&O(t),_=!1,b()}}}function Xl(l){let t,e,n,a;const s=[Gl,Vl,zl],r=[];function u(i,f){return i[3]?0:i[2]===!0?1:2}return t=u(l),e=r[t]=s[t](l),{c(){e.c(),n=qe()},m(i,f){r[t].m(i,f),L(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?r[t].p(i,f):(tt(),$(r[p],1,1,()=>{r[p]=null}),lt(),e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Y(e,1),e.m(n.parentNode,n))},i(i){a||(Y(e),a=!0)},o(i){$(e),a=!1},d(i){r[t].d(i),i&&O(n)}}}async function Kl(l){let t="/api/getRawData/"+l,n=await(await fetch(t)).blob();return await URL.createObjectURL(n)}function Ql(l,t,e){let n={places:[]},a={list_metaData:[],list_score:[],list_dataHash:[]},s={list_metaData:[],list_score:[],list_dataHash:[],list_src:[],done:!1},r=!1,u=!1;Ue(()=>{fetch("/api/getGroup/place").then(_=>{_.json().then(b=>{let m=b.meta_data.length;console.log("data length: ",m);for(let h=0;h<m;h++)a.list_dataHash.push(b.data_hash[h]),a.list_score.push(b.score[h]),a.list_metaData.push(b.meta_data[h]);e(0,n.places=b.place,n)})})}),$e(()=>{console.log("destroying...")});async function i(_){let m=0;e(3,u=!1),e(1,s={list_metaData:[],list_score:[],list_dataHash:[],list_src:[],done:!1}),e(2,r=!0);for(let h=0;h<a.list_dataHash.length;h++){if(r===!1){console.log("stopping...");return}if(a.list_metaData[h].place.toLowerCase()===_.toLowerCase()){s.list_metaData.push(a.list_metaData[h]),s.list_dataHash.push(a.list_dataHash[h]),s.list_score.push(a.list_score[h]);let k=await Kl(a.list_dataHash[h]);s.list_src.push(k),m+=1,m%10==0&&(e(1,s=s),e(3,u=!0))}}e(1,s.done=!0,s),e(3,u=!0),e(2,r=!1)}return[n,s,r,u,i,()=>{console.log("pressed the hell out of it!"),e(3,u=!1),e(2,r=!1)},(_,b)=>{console.log("mine is: ",_),i(_)}]}class Wl extends ye{constructor(t){super(),we(this,t,Ql,Xl,ke,{})}}function Jl(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),s=new Rl({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),a=d("div"),he(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),c(t,"class","flex")},m(u,i){L(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Y(e.$$.fragment,u),Y(s.$$.fragment,u),r=!0)},o(u){$(e.$$.fragment,u),$(s.$$.fragment,u),r=!1},d(u){u&&O(t),de(e),de(s)}}}function Yl(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),s=new Wl({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),a=d("div"),he(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),c(t,"class","flex")},m(u,i){L(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Y(e.$$.fragment,u),Y(s.$$.fragment,u),r=!0)},o(u){$(e.$$.fragment,u),$(s.$$.fragment,u),r=!1},d(u){u&&O(t),de(e),de(s)}}}function Zl(l){let t,e,n,a,s,r;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[11]),e.$on("sidebarStateChange",l[12]),s=new xl({}),{c(){t=d("div"),he(e.$$.fragment),n=x(),a=d("div"),he(s.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),c(t,"class","flex")},m(u,i){L(u,t,i),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),r=!0},p(u,i){const f={};i&32&&(f.sidebarOpen=u[5]),e.$set(f)},i(u){r||(Y(e.$$.fragment,u),Y(s.$$.fragment,u),r=!0)},o(u){$(e.$$.fragment,u),$(s.$$.fragment,u),r=!1},d(u){u&&O(t),de(e),de(s)}}}function $l(l){let t,e,n,a,s,r,u,i;return e=new nt({props:{sidebarOpen:l[5]}}),e.$on("menuClick",l[8]),e.$on("sidebarStateChange",l[9]),s=new ml({props:{query_button_disabled:l[1]}}),s.$on("queryReady",l[10]),u=new dt({props:{image_data:l[0]}}),{c(){t=d("div"),he(e.$$.fragment),n=x(),a=d("div"),he(s.$$.fragment),r=x(),he(u.$$.fragment),c(a,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),c(t,"class","flex")},m(f,p){L(f,t,p),fe(e,t,null),o(t,n),o(t,a),fe(s,a,null),o(a,r),fe(u,a,null),i=!0},p(f,p){const _={};p&32&&(_.sidebarOpen=f[5]),e.$set(_);const b={};p&2&&(b.query_button_disabled=f[1]),s.$set(b);const m={};p&1&&(m.image_data=f[0]),u.$set(m)},i(f){i||(Y(e.$$.fragment,f),Y(s.$$.fragment,f),Y(u.$$.fragment,f),i=!0)},o(f){$(e.$$.fragment,f),$(s.$$.fragment,f),$(u.$$.fragment,f),i=!1},d(f){f&&O(t),de(e),de(s),de(u)}}}function en(l){let t,e,n,a;const s=[$l,Zl,Yl,Jl],r=[];function u(i,f){return i[4].query.status?0:i[4].indexing.status===!0?1:i[4].place_album.status===!0?2:i[4].people_album.status===!0?3:-1}return~(t=u(l))&&(e=r[t]=s[t](l)),{c(){e&&e.c(),n=qe()},m(i,f){~t&&r[t].m(i,f),L(i,n,f),a=!0},p(i,[f]){let p=t;t=u(i),t===p?~t&&r[t].p(i,f):(e&&(tt(),$(r[p],1,1,()=>{r[p]=null}),lt()),~t?(e=r[t],e?e.p(i,f):(e=r[t]=s[t](i),e.c()),Y(e,1),e.m(n.parentNode,n)):e=null)},i(i){a||(Y(e),a=!0)},o(i){$(e),a=!1},d(i){~t&&r[t].d(i),i&&O(n)}}}let tn=3;async function ln(l){let t="/api/getRawData/"+l,n=await(await fetch(t)).blob();return await URL.createObjectURL(n)}function nn(l,t,e){let n=[],a=[],s=[],r,u={list_metaData:[],list_dataHash:[],list_src:[],list_score:[],done:!1},i=!1,f="",p={};async function _(D="xxxxxxx",H=!1){console.log("handleClick count",f,H,D),e(1,i=!0);let M=tn;if(r=new FormData,f.length===0)return;r.append("query",f),r.append("topk",M.toString()),H==!1?(a=[],n=[],s=[],e(0,u={list_metaData:[],list_dataHash:[],list_src:[],list_score:[],done:!1}),r.append("query_start","true")):(r.append("query_start","false"),r.append("client_id",D));let N=await fetch("/api/query",{method:"POST",body:r});if(!N.ok)throw e(1,i=!1),new Error(N);let U=await N.json();console.log("data: ",U);let G=U.client_id,W=U.meta_data,R=U.data_hash,J=U.score;for(let Z=0;Z<W.length;Z++){let re=R[Z],X=J[Z];a.push(re),n.push(X),s.push(W[Z]);let ae=await ln(re);u.list_dataHash.push(re),u.list_score.push(X),u.list_metaData.push(W[Z]),u.list_src.push(ae)}if(U.query_completed==!0?e(0,u.done=!0,u):e(0,u),U.query_completed==!0){e(1,i=!1);return}await _(G,!0)}const b={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function m(D){let H=Object.keys(b);for(let M=0;M<H.length;M++)b[H[M]].status&&e(4,b[H[M]].status=!1,b);b[D]&&e(4,b[D].status=!0,b)}let h=!0;function k(D){let H=D.detail.item.name;H.toLowerCase().includes("photo")?m("query"):H.toLowerCase().includes("index")?m("indexing"):H.toLowerCase().includes("people")?m("people_album"):H.toLowerCase().includes("place")&&m("place_album")}return[u,i,f,p,b,h,_,k,D=>{k(D)},D=>{e(5,h=D.detail.open)},D=>{e(2,f=D.detail.query),e(3,p=D.detail.attributes),_()},D=>k(D),D=>{e(5,h=D.detail.open)},D=>k(D),D=>{e(5,h=D.detail.open)},D=>k(D),D=>{e(5,h=D.detail.open)}]}class sn extends ye{constructor(t){super(),we(this,t,nn,en,ke,{})}}new sn({target:document.getElementById("app")});
