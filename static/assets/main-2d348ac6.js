(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();function R(){}function _l(l){return l()}function Ft(){return Object.create(null)}function he(l){l.forEach(_l)}function vt(l){return typeof l=="function"}function ye(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let rt;function we(l,t){return rt||(rt=document.createElement("a")),rt.href=t,l===rt.href}function bl(l){return Object.keys(l).length===0}function a(l,t){l.appendChild(t)}function T(l,t,e){l.insertBefore(t,e||null)}function E(l){l.parentNode&&l.parentNode.removeChild(l)}function ve(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function _(l){return document.createElement(l)}function z(l){return document.createTextNode(l)}function k(){return z(" ")}function Ue(){return z("")}function N(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function u(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function vl(l){return l===""?null:+l}function kl(l){return Array.from(l.childNodes)}function X(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ct(l,t){l.value=t??""}function ae(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ot(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function wl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function yl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(l,e,s,t),r}let Xe;function Ke(l){Xe=l}function kt(){if(!Xe)throw new Error("Function called outside component initialization");return Xe}function Fe(l){kt().$$.on_mount.push(l)}function Qe(l){kt().$$.on_destroy.push(l)}function ft(){const l=kt();return(t,e,{cancelable:s=!1}={})=>{const r=l.$$.callbacks[t];if(r){const n=yl(t,e,{cancelable:s});return r.slice().forEach(i=>{i.call(l,n)}),!n.defaultPrevented}return!0}}const ze=[],Me=[],it=[],qt=[],xl=Promise.resolve();let bt=!1;function Cl(){bt||(bt=!0,xl.then(pl))}function ut(l){it.push(l)}const mt=new Set;let Be=0;function pl(){if(Be!==0)return;const l=Xe;do{try{for(;Be<ze.length;){const t=ze[Be];Be++,Ke(t),Sl(t.$$)}}catch(t){throw ze.length=0,Be=0,t}for(Ke(null),ze.length=0,Be=0;Me.length;)Me.pop()();for(let t=0;t<it.length;t+=1){const e=it[t];mt.has(e)||(mt.add(e),e())}it.length=0}while(ze.length);for(;qt.length;)qt.pop()();bt=!1,mt.clear(),Ke(l)}function Sl(l){if(l.fragment!==null){l.update(),he(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(ut)}}const ot=new Set;let Ie;function We(){Ie={r:0,c:[],p:Ie}}function Je(){Ie.r||he(Ie.c),Ie=Ie.p}function W(l,t){l&&l.i&&(ot.delete(l),l.i(t))}function Z(l,t,e,s){if(l&&l.o){if(ot.has(l))return;ot.add(l),Ie.c.push(()=>{ot.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function pe(l){l&&l.c()}function ce(l,t,e,s){const{fragment:r,after_update:n}=l.$$;r&&r.m(t,e),s||ut(()=>{const i=l.$$.on_mount.map(_l).filter(vt);l.$$.on_destroy?l.$$.on_destroy.push(...i):he(i),l.$$.on_mount=[]}),n.forEach(ut)}function ue(l,t){const e=l.$$;e.fragment!==null&&(he(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Dl(l,t){l.$$.dirty[0]===-1&&(ze.push(l),Cl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Oe(l,t,e,s,r,n,i,c=[-1]){const o=Xe;Ke(l);const f=l.$$={fragment:null,ctx:[],props:n,update:R,not_equal:r,bound:Ft(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:Ft(),dirty:c,skip_bound:!1,root:t.target||o.$$.root};i&&i(f.root);let d=!1;if(f.ctx=e?e(l,t.props||{},(h,g,...m)=>{const p=m.length?m[0]:g;return f.ctx&&r(f.ctx[h],f.ctx[h]=p)&&(!f.skip_bound&&f.bound[h]&&f.bound[h](p),d&&Dl(l,h)),g}):[],f.update(),d=!0,he(f.before_update),f.fragment=s?s(f.ctx):!1,t.target){if(t.hydrate){const h=kl(t.target);f.fragment&&f.fragment.l(h),h.forEach(E)}else f.fragment&&f.fragment.c();t.intro&&W(l.$$.fragment),ce(l,t.target,t.anchor,t.customElement),pl()}Ke(o)}class qe{$destroy(){ue(this,1),this.$destroy=R}$on(t,e){if(!vt(e))return R;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const r=s.indexOf(e);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!bl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Re=[];function Ae(l,t=R){let e;const s=new Set;function r(c){if(ye(l,c)&&(l=c,e)){const o=!Re.length;for(const f of s)f[1](),Re.push(f,l);if(o){for(let f=0;f<Re.length;f+=2)Re[f][0](Re[f+1]);Re.length=0}}}function n(c){r(c(l))}function i(c,o=R){const f=[c,o];return s.add(f),s.size===1&&(e=t(r)||R),c(l),()=>{s.delete(f),s.size===0&&(e(),e=null)}}return{set:r,update:n,subscribe:i}}const wt=Ae(0),yt=Ae(0),xt=Ae(0),hl=Ae(0),at=Ae([]);let jl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ee=Ae(jl),ml=Ae([]);function Lt(l,t,e){const s=l.slice();return s[26]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Et(l,t,e){const s=l.slice();return s[29]=t[e],s}function Tt(l,t,e){const s=l.slice();return s[34]=t[e],s}function Pt(l){let t,e=l[4][l[29]],s=[];for(let r=0;r<e.length;r+=1)s[r]=Nt(Tt(l,e,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();t=k()},m(r,n){for(let i=0;i<s.length;i+=1)s[i].m(r,n);T(r,t,n)},p(r,n){if(n[0]&2576){e=r[4][r[29]];let i;for(i=0;i<e.length;i+=1){const c=Tt(r,e,i);s[i]?s[i].p(c,n):(s[i]=Nt(c),s[i].c(),s[i].m(t.parentNode,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=e.length}},d(r){ve(s,r),r&&E(t)}}}function Nt(l){let t,e,s,r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,i,c,o=l[34]+" ",f,d,h,g,m;function p(...v){return l[14](l[29],l[34],...v)}return{c(){t=_("div"),e=_("div"),s=_("span"),n=z(r),i=k(),c=_("span"),f=z(o),d=k(),h=_("span"),h.textContent="x",u(s,"class","text-blue-800 "),u(c,"class","ml-1 text-sm font-semibold"),u(h,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),u(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),u(t,"class","flex items-center justify-center")},m(v,b){T(v,t,b),a(t,e),a(e,s),a(s,n),a(e,i),a(e,c),a(c,f),a(e,d),a(e,h),g||(m=[N(h,"click",p),N(e,"click",function(){vt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(v,b){l=v,b[0]&16&&r!==(r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&X(n,r),b[0]&16&&o!==(o=l[34]+" ")&&X(f,o)},d(v){v&&E(t),g=!1,he(m)}}}function It(l){let t,e=l[4][l[29]].length>=1&&Pt(l);return{c(){e&&e.c(),t=Ue()},m(s,r){e&&e.m(s,r),T(s,t,r)},p(s,r){s[4][s[29]].length>=1?e?e.p(s,r):(e=Pt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&E(t)}}}function Mt(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,r,n;return{c(){t=_("option"),s=z(e),r=k(),t.__value=n=l[29],t.value=t.__value},m(i,c){T(i,t,c),a(t,s),a(t,r)},p(i,c){c[0]&16&&e!==(e=i[29].charAt(0).toUpperCase()+i[29].slice(1)+"")&&X(s,e),c[0]&16&&n!==(n=i[29])&&(t.__value=n,t.value=t.__value)},d(i){i&&E(t)}}}function At(l){let t,e,s,r,n,i,c,o,f=l[3],d=[];for(let h=0;h<f.length;h+=1)d[h]=Bt(Lt(l,f,h));return{c(){t=_("div"),e=_("ul");for(let h=0;h<d.length;h+=1)d[h].c();s=k(),r=_("div"),n=_("button"),n.textContent="Close",u(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),u(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),u(r,"class","flex w-full justify-center items-center"),u(t,"class",i=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(h,g){T(h,t,g),a(t,e);for(let m=0;m<d.length;m+=1)d[m].m(e,null);a(t,s),a(t,r),a(r,n),c||(o=N(n,"click",l[22]),c=!0)},p(h,g){if(g[0]&1034){f=h[3];let m;for(m=0;m<f.length;m+=1){const p=Lt(h,f,m);d[m]?d[m].p(p,g):(d[m]=Bt(p),d[m].c(),d[m].m(e,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=f.length}g[0]&32&&i!==(i=(h[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&u(t,"class",i)},d(h){h&&E(t),ve(d,h),c=!1,o()}}}function Bt(l){let t,e=l[26]+"",s,r,n,i;function c(){return l[21](l[26])}return{c(){t=_("li"),s=z(e),r=k(),u(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(o,f){T(o,t,f),a(t,s),a(t,r),n||(i=N(t,"click",c),n=!0)},p(o,f){l=o,f[0]&8&&e!==(e=l[26]+"")&&X(s,e)},d(o){o&&E(t),n=!1,i()}}}function Rt(l){let t;return{c(){t=_("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,u(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){T(e,t,s)},d(e){e&&E(t)}}}function Fl(l){let t,e,s,r,n,i,c,o,f,d,h,g,m,p,v,b,S,j=Object.keys(l[4]),L=[];for(let w=0;w<j.length;w+=1)L[w]=It(Et(l,j,w));let P=Object.keys(l[4]),O=[];for(let w=0;w<P.length;w+=1)O[w]=Mt(Ht(l,P,w));let x=l[3].length>0&&At(l),y=l[6]==!0&&Rt();return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div");for(let w=0;w<L.length;w+=1)L[w].c();n=k(),i=_("div"),c=_("select");for(let w=0;w<O.length;w+=1)O[w].c();o=k(),f=_("div"),d=_("input"),h=k(),g=_("div"),m=_("button"),m.textContent="Search",p=k(),x&&x.c(),v=k(),y&&y.c(),u(r,"class","flex w-full items-center my-3 flex-wrap text-lg"),u(c,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),u(c,"name","select-option"),u(c,"id","select-option"),l[1]===void 0&&ut(()=>l[16].call(c)),u(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),u(d,"type","search"),u(d,"placeholder","Enter value here"),u(f,"class","bg-blue-200 rounded-md flex-grow h-10"),u(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),u(g,"class","flex"),u(i,"class","flex space-x-2"),u(s,"class","w-full"),u(e,"class","w-full relative place-content-center"),u(t,"class","max-w-screen p-4 mx-auto")},m(w,F){T(w,t,F),a(t,e),a(e,s),a(s,r);for(let D=0;D<L.length;D+=1)L[D].m(r,null);a(s,n),a(s,i),a(i,c);for(let D=0;D<O.length;D+=1)O[D].m(c,null);Ot(c,l[1]),a(i,o),a(i,f),a(f,d),l[17](d),a(i,h),a(i,g),a(g,m),l[20](m),a(e,p),x&&x.m(e,null),a(e,v),y&&y.m(e,null),b||(S=[N(c,"change",l[15]),N(c,"change",l[16]),N(d,"focus",l[18],{once:!0}),N(d,"focusout",l[19]),N(d,"keyup",l[8]),N(d,"keydown",l[7]),N(m,"click",l[12])],b=!0)},p(w,F){if(F[0]&2576){j=Object.keys(w[4]);let D;for(D=0;D<j.length;D+=1){const U=Et(w,j,D);L[D]?L[D].p(U,F):(L[D]=It(U),L[D].c(),L[D].m(r,null))}for(;D<L.length;D+=1)L[D].d(1);L.length=j.length}if(F[0]&16){P=Object.keys(w[4]);let D;for(D=0;D<P.length;D+=1){const U=Ht(w,P,D);O[D]?O[D].p(U,F):(O[D]=Mt(U),O[D].c(),O[D].m(c,null))}for(;D<O.length;D+=1)O[D].d(1);O.length=P.length}F[0]&18&&Ot(c,w[1]),w[3].length>0?x?x.p(w,F):(x=At(w),x.c(),x.m(e,v)):x&&(x.d(1),x=null),w[6]==!0?y||(y=Rt(),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:R,o:R,d(w){w&&E(t),ve(L,w),ve(O,w),l[17](null),l[20](null),x&&x.d(),y&&y.d(),b=!1,he(S)}}}async function Ol(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let r=await fetch(e,{method:"POST",body:s});return r.ok===!0?await r.json():{}}function ql(l,t,e){Fe(()=>{ml.subscribe(C=>{for(let H=0;H<C.length;H++)e(4,d[C[H]]=[],d)})});const s=ft();let r="query",n,i,{query_button_disabled:c=!1}=t,o="",f=[],d={query:[]},h=!1;var g={};function m(C){g[C.keyCode]=C.type=="keydown",g[13]==!0&&C.shiftKey&&(console.log("shift enter combination."),j())}async function p(C){e(6,L=!1),g[C.keyCode]=!1;let H=C.target;if(H.value.length==0){e(3,f=[]);return}if(console.log("current value: ",H.value),C.keyCode==13){let J=d[r].length;H.value.length>0&&!d[r].includes(H.value)&&e(4,d[r][J]=H.value,d),H.value="",e(3,f=[]),e(5,h=!1);return}let B=await Ol(r,H.value);r in B?(e(3,f=B[r]),e(5,h=!0)):(e(3,f=[]),e(5,h=!1))}function v(C,H,B){let J=d[H].indexOf(B);J>=0&&(d[H].splice(J,1),e(4,d)),r==H&&e(3,f=[])}function b(C,H){e(5,h=!1),e(2,n.value=H,n),n.focus()}function S(C){e(1,r=C),e(3,f=d[r]),e(5,h=!0),n.focus()}function j(C){let H="&",B="?",J="=",K=d[r].length;n.value.length>0&&!d[r].includes(n.value)&&e(4,d[r][K]=n.value,d);let G=Object.keys(d);o="";for(let re=0;re<G.length;re++){let se=G[re],te=d[se];o+=se+J;for(let le=0;le<te.length;le++)o+=te[le],le!=te.length-1&&(o+=B);re!=G.length-1&&(o+=H)}console.log("Completed: "+o),e(2,n.value="",n),i.disabled==!1?s("queryReady",{query:o,attributes:d}):console.log("chill dawg!!!")}let L=!1;const P=(C,H,B)=>v(B.currentTarget,C,H),O=C=>S(C.target.value);function x(){r=wl(this),e(1,r),e(4,d)}function y(C){Me[C?"unshift":"push"](()=>{n=C,e(2,n)})}const w=C=>{C.target.value.length==0&&e(6,L=!0)},F=C=>{e(6,L=!1)};function D(C){Me[C?"unshift":"push"](()=>{i=C,e(0,i),e(13,c)})}const U=C=>b(r,C),M=()=>e(5,h=!1);return l.$$set=C=>{"query_button_disabled"in C&&e(13,c=C.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&i&&e(0,i.disabled=c,i)},[i,r,n,f,d,h,L,m,p,v,b,S,j,c,P,O,x,y,w,F,D,U,M]}class Ll extends qe{constructor(t){super(),Oe(this,t,ql,Fl,ye,{query_button_disabled:13},null,[-1,-1])}}function zt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function Hl(l){let t,e,s;return{c(){t=_("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',u(t,"class","px-4")},m(r,n){T(r,t,n),e||(s=N(t,"click",l[2]),e=!0)},p:R,d(r){r&&E(t),e=!1,s()}}}function El(l){let t,e,s,r,n;return{c(){t=_("span"),t.textContent="Hachi",e=k(),s=_("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',u(t,"class","px-4"),u(s,"class","cursor-pointer px-4")},m(i,c){T(i,t,c),T(i,e,c),T(i,s,c),r||(n=N(s,"click",l[3]),r=!0)},p:R,d(i){i&&E(t),i&&E(e),i&&E(s),r=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",r,n,i,c=l[8].count+"",o;return{c(){t=_("div"),e=_("div"),r=z(s),n=k(),i=_("div"),o=z(c),u(e,"class","flex"),u(e,"data-ix",l[10]),u(i,"class","px-3 flex text-black text-md text-bold"),u(t,"class","flex w-full justify-between")},m(f,d){T(f,t,d),a(t,e),a(e,r),a(t,n),a(t,i),a(i,o)},p(f,d){d&2&&s!==(s=f[8].name+"")&&X(r,s),d&2&&c!==(c=f[8].count+"")&&X(o,c)},d(f){f&&E(t)}}}function Gt(l){let t,e,s,r,n,i,c,o=l[0].sidebarOpen&&Ut(l);function f(){return l[6](l[10])}return{c(){t=_("div"),e=_("i"),r=k(),o&&o.c(),n=k(),u(e,"class",s="fa-solid fa-"+l[8].icon),u(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,h){T(d,t,h),a(t,e),a(t,r),o&&o.m(t,null),a(t,n),i||(c=N(t,"click",f),i=!0)},p(d,h){l=d,h&2&&s!==(s="fa-solid fa-"+l[8].icon)&&u(e,"class",s),l[0].sidebarOpen?o?o.p(l,h):(o=Ut(l),o.c(),o.m(t,n)):o&&(o.d(1),o=null)},d(d){d&&E(t),o&&o.d(),i=!1,c()}}}function Tl(l){let t,e,s,r,n,i;function c(g,m){return g[0].sidebarOpen?El:Hl}let o=c(l),f=o(l),d=l[1],h=[];for(let g=0;g<d.length;g+=1)h[g]=Gt(zt(l,d,g));return{c(){t=_("div"),e=_("aside"),s=_("div"),f.c(),r=k(),n=_("nav");for(let g=0;g<h.length;g+=1)h[g].c();u(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),u(n,"class","mt-6"),u(e,"class",i=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),u(t,"class","flex h-100 text-white")},m(g,m){T(g,t,m),a(t,e),a(e,s),f.m(s,null),a(e,r),a(e,n);for(let p=0;p<h.length;p+=1)h[p].m(n,null)},p(g,[m]){if(o===(o=c(g))&&f?f.p(g,m):(f.d(1),f=o(g),f&&(f.c(),f.m(s,null))),m&19){d=g[1];let p;for(p=0;p<d.length;p+=1){const v=zt(g,d,p);h[p]?h[p].p(v,m):(h[p]=Gt(v),h[p].c(),h[p].m(n,null))}for(;p<h.length;p+=1)h[p].d(1);h.length=d.length}m&1&&i!==(i=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&u(e,"class",i)},i:R,o:R,d(g){g&&E(t),f.d(),ve(h,g)}}}function Pl(l,t,e){const s=ft();let{sidebarOpen:r=!1}=t;const n={sidebarOpen:r},i=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0},{icon:"folder",path:"#",name:"Local",count:0}];Fe(()=>{wt.subscribe(h=>{i&&e(1,i[0].count=h,i)}),yt.subscribe(h=>{i&&e(1,i[3].count=h,i)}),xt.subscribe(h=>{i&&e(1,i[4].count=h,i)}),hl.subscribe(h=>{i&&e(1,i[5].count=h,i)})});function c(){e(0,n.sidebarOpen=!0,n)}function o(){e(0,n.sidebarOpen=!1,n)}function f(h){s("menuClick",{item:i[h]})}const d=h=>{f(h)};return l.$$set=h=>{"sidebarOpen"in h&&e(5,r=h.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,i,c,o,f,r,d]}class Ye extends qe{constructor(t){super(),Oe(this,t,Pl,Tl,ye,{sidebarOpen:5})}}function Nl(l){let t,e,s,r,n,i,c,o,f,d,h,g,m=(l[3]*100).toString().slice(0,4)+"",p,v,b,S,j,L,P,O,x,y,w,F,D,U,M,C,H,B,J,K,G,re,se,te,le,ne,Q,Y,oe,ge,fe,xe,Ce,Se,de,Le,be,ke,_e;return{c(){t=_("div"),e=_("p"),e.textContent="Press Start button to start indexing",s=k(),r=_("div"),n=_("input"),i=k(),c=_("div"),o=_("div"),f=_("div"),d=_("div"),h=k(),g=_("div"),p=z(m),v=z("%"),b=k(),S=_("div"),j=z("Current directory: "),L=_("span"),P=z(l[4]),O=k(),x=_("span"),x.textContent="ETA:",y=k(),w=_("span"),F=z(l[6]),D=k(),U=_("div"),M=z("Details: "),C=_("span"),H=z(l[5]),B=k(),J=_("div"),K=_("div"),G=_("input"),re=k(),se=_("label"),se.textContent="Complete Rescan",te=k(),le=_("div"),le.textContent="Re-index all originals, including already indexed and unchanged files.",ne=k(),Q=_("div"),Y=_("select"),oe=_("option"),oe.textContent="Images Only",ge=_("option"),ge.textContent="Videos Only",fe=_("option"),fe.textContent="Videos and Images",xe=k(),Ce=_("div"),Ce.textContent="Filter by content type",Se=k(),de=_("button"),de.textContent="Cancel",Le=k(),be=_("button"),be.textContent="Start",u(e,"class","mb-2 text-sm font-semibold"),u(n,"type","text"),u(n,"class","w-full rounded border p-1 text-sm"),u(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,u(r,"class","my-2"),u(d,"class","h-2rounded bg-blue-500"),ae(d,"width",(l[3]*100).toString()+"%"),u(f,"class","flex h-2 w-11/12 rounded bg-gray-300"),u(g,"class","flex px-2 font-semibold"),u(o,"class","flex items-center"),u(L,"class","text-black"),u(x,"class","pl-3 text-right"),u(w,"class","text-black"),u(S,"class","pt-1 text-sm text-blue-600"),u(C,"class","text-black"),u(U,"class","pt-1 text-sm text-blue-600"),u(c,"class","mb-3"),u(G,"type","checkbox"),u(G,"class","h-5 w-5 text-blue-500"),u(se,"class","ml-1"),u(K,"class","mr-2 flex items-center"),u(le,"class","text-sm text-gray-600"),u(J,"class","mt-4 mb-3 flex flex-wrap items-center"),oe.__value="Images Only",oe.value=oe.__value,ge.disabled=!0,ge.__value="Videos Only",ge.value=ge.__value,fe.disabled=!0,fe.__value="Videos and Images",fe.value=fe.__value,u(Y,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),u(Ce,"class","ml-2 text-sm text-gray-600"),u(Q,"class","mb-3 mt-3 flex flex-wrap items-center"),de.disabled=!0,u(de,"type","button"),u(de,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),u(be,"type","button"),u(be,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),u(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(q,I){T(q,t,I),a(t,e),a(t,s),a(t,r),a(r,n),l[12](n),ct(n,l[7]),a(t,i),a(t,c),a(c,o),a(o,f),a(f,d),a(o,h),a(o,g),a(g,p),a(g,v),a(c,b),a(c,S),a(S,j),a(S,L),a(L,P),a(S,O),a(S,x),a(S,y),a(S,w),a(w,F),a(c,D),a(c,U),a(U,M),a(U,C),a(C,H),a(t,B),a(t,J),a(J,K),a(K,G),G.checked=l[8],a(K,re),a(K,se),a(J,te),a(J,le),a(t,ne),a(t,Q),a(Q,Y),a(Y,oe),a(Y,ge),a(Y,fe),a(Q,xe),a(Q,Ce),a(t,Se),a(t,de),l[16](de),a(t,Le),a(t,be),l[17](be),ke||(_e=[N(n,"input",l[13]),N(n,"keydown",l[14]),N(G,"change",l[15]),N(de,"click",l[10]),N(be,"click",l[9])],ke=!0)},p(q,[I]){I&128&&n.value!==q[7]&&ct(n,q[7]),I&8&&ae(d,"width",(q[3]*100).toString()+"%"),I&8&&m!==(m=(q[3]*100).toString().slice(0,4)+"")&&X(p,m),I&16&&X(P,q[4]),I&64&&X(F,q[6]),I&32&&X(H,q[5]),I&256&&(G.checked=q[8])},i:R,o:R,d(q){q&&E(t),l[12](null),l[16](null),l[17](null),ke=!1,he(_e)}}}function Il(l,t,e){let s,r,n;Fe(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let y="/api/getIndexStatus/"+s;e(0,r.disabled=!1,r),e(1,n.disabled=!0,n),m(y)}}),Qe(()=>{g&&clearTimeout(g)});let i,c=.001,o="",f="",d="",h="",g;async function m(y,w=0){w==0&&console.log("starting a new polll...");let D=await(await fetch(y,{method:"GET"})).json();if(D.is_active==!0){if(D.done==!0){let M=new FormData;M.append("ack","true"),(await fetch(y,{method:"POST",body:M})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let H=await fetch("/api/getMetaStats");H=await H.json(),wt.update(B=>Number(H.image.count)),yt.update(B=>Number(H.image.unique_people_count)),xt.update(B=>Number(H.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,c=0),e(4,o=""),e(6,d=""),e(5,f=""),e(7,h=""),e(0,r.disabled=!0,r),e(0,r.innerText="Cancel",r),e(2,i.disabled=!1,i);return}e(3,c=D.progress),e(6,d=D.eta),e(5,f=D.details),e(4,o=D.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(y,w+1)},1e3)}}let p=!1;async function v(){if(n&&h){e(1,n.disabled=!0,n),e(2,i.disabled=!0,i);let y=new FormData;y.append("image_directory_path",h),y.append("complete_rescan",p.toString());let D=await(await fetch("/api/indexStart",{method:"POST",body:y})).json();if(D.success===!0){e(0,r.disabled=!1,r);let M="/api/getIndexStatus/"+D.statusEndpoint;e(11,s=D.statusEndpoint),m(M)}else alert(D.reason),e(1,n.disabled=!1,n),e(2,i.disabled=!1,i)}else console.log("No index_start_button object found!!!")}async function b(){if(s){e(0,r.disabled=!0,r),e(0,r.innerText="Cancelling... Please wait.",r);let y="/api/indexCancel/"+s,w=await fetch(y,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!w.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(w);return}else return}function S(y){Me[y?"unshift":"push"](()=>{i=y,e(2,i)})}function j(){h=this.value,e(7,h)}const L=y=>{y.key==="Enter"&&n.click()};function P(){p=this.checked,e(8,p)}function O(y){Me[y?"unshift":"push"](()=>{r=y,e(0,r)})}function x(y){Me[y?"unshift":"push"](()=>{n=y,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[r,n,i,c,o,f,d,h,p,v,b,s,S,j,L,P,O,x]}class Ml extends qe{constructor(t){super(),Oe(this,t,Il,Nl,ye,{})}}function Vt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=_("i"),u(t,"class","fa fa-plus text-xs text-black")},m(e,s){T(e,t,s)},d(e){e&&E(t)}}}function Qt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),r,n,i,c=l[13]+"",o,f,d,h=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=_("div"),e=_("div"),h&&h.c(),n=k(),i=_("span"),o=z(c),u(e,"class",r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),u(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,p){T(m,t,p),a(t,e),h&&h.m(e,null),a(t,n),a(t,i),a(i,o),f||(d=N(t,"click",g),f=!0)},p(m,p){l=m,p&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?h||(h=Xt(),h.c(),h.m(e,null)):h&&(h.d(1),h=null),p&2&&r!==(r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&u(e,"class",r),p&2&&c!==(c=l[13]+"")&&X(o,c)},d(m){m&&E(t),h&&h.d(),f=!1,d()}}}function Wt(l){let t,e,s=l[10]+"",r,n,i,c,o,f,d,h,g;function m(){return l[6](l[10])}let p=l[1].selectFilters[l[10]].options,v=[];for(let b=0;b<p.length;b+=1)v[b]=Qt(Kt(l,p,b));return{c(){t=_("div"),e=_("div"),r=z(s),n=k(),i=_("i"),o=k(),f=_("div");for(let b=0;b<v.length;b+=1)v[b].c();u(i,"class",c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),u(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),u(f,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),u(t,"class","relative")},m(b,S){T(b,t,S),a(t,e),a(e,r),a(e,n),a(e,i),a(t,o),a(t,f);for(let j=0;j<v.length;j+=1)v[j].m(f,null);h||(g=[N(e,"click",m),N(t,"mouseup",Ul)],h=!0)},p(b,S){if(l=b,S&2&&s!==(s=l[10]+"")&&X(r,s),S&2&&c!==(c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&u(i,"class",c),S&6){p=l[1].selectFilters[l[10]].options;let j;for(j=0;j<p.length;j+=1){const L=Kt(l,p,j);v[j]?v[j].p(L,S):(v[j]=Qt(L),v[j].c(),v[j].m(f,null))}for(;j<v.length;j+=1)v[j].d(1);v.length=p.length}S&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&u(f,"class",d)},d(b){b&&E(t),ve(v,b),h=!1,he(g)}}}function Al(l){let t,e,s,r,n,i,c,o,f,d,h,g,m=Object.keys(l[1].selectFilters),p=[];for(let v=0;v<m.length;v+=1)p[v]=Wt(Vt(l,m,v));return{c(){t=_("div"),e=_("div"),s=_("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=k(),n=_("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=k();for(let v=0;v<p.length;v+=1)p[v].c();c=k(),o=_("button"),f=z("Filter"),u(s,"class","flex items-center text-md"),u(n,"class","flex items-center text-md"),o.disabled=l[0],u(o,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),u(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),u(t,"class","flex container mx-auto max-w-4xl")},m(v,b){T(v,t,b),a(t,e),a(e,s),a(e,r),a(e,n),a(e,i);for(let S=0;S<p.length;S+=1)p[S].m(e,null);a(e,c),a(e,o),a(o,f),h||(g=N(o,"click",l[4]),h=!0)},p(v,[b]){if(b&14){m=Object.keys(v[1].selectFilters);let S;for(S=0;S<m.length;S+=1){const j=Vt(v,m,S);p[S]?p[S].p(j,b):(p[S]=Wt(j),p[S].c(),p[S].m(e,c))}for(;S<p.length;S+=1)p[S].d(1);p.length=m.length}b&1&&(o.disabled=v[0]),b&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&u(o,"class",d)},i:R,o:R,d(v){v&&E(t),ve(p,v),h=!1,g()}}}function gl(l,t,e=null,s=(r,n)=>r===n){let r=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?r.push(1):r.push(0):s(l[n],t)?r.push(1):r.push(0);return r}function Bl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=gl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function Rl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=gl(l,t[s],null,(n,i)=>n?n.includes(i):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function zl(l){let t=l[0].length,e=l[0];return l.forEach((s,r)=>{if(r>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,i)=>{e[i]=Number(Boolean(e[i])&&Boolean(n))})}}),e}const Ul=l=>l.stopPropagation();function Gl(l,t,e){let s=[],{filter_button_disabled:r=!0}=t;at.subscribe(m=>{e(0,r=!1),e(5,s=m)});const n=ft(),i={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Fe(()=>{document.addEventListener("mouseup",c)});function c(m){e(1,i.selectFilterActive="",i)}function o(m,p){if(i.selectFilters[m].values.includes(p)){e(1,i.selectFilters[m].values=i.selectFilters[m].values.filter(v=>v!==p),i);return}e(1,i.selectFilters[m].values=[p,...i.selectFilters[m].values],i)}function f(m){if(i.selectFilterActive===m){e(1,i.selectFilterActive="",i);return}e(1,i.selectFilterActive=m,i)}function d(){if(s){console.log(s);let m=[],p=[];s.map((P,O)=>{m.push(P.place),p.push(P.person)});let v=i.selectFilters.place.values,b=Bl(m,v),S=i.selectFilters.people.values,j=Rl(p,S),L=zl([b,j]);n("filterApplied",{mask:L})}}const h=m=>f(m),g=(m,p)=>o(m,p);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,r=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((S,j)=>{if(S.place)return S.place}),p=[];s.map((S,j)=>{S.person&&S.person.forEach(L=>p.push(L))});let v=[];new Set(m).forEach(S=>v.push(S));let b=[];new Set(p).forEach(S=>b.push(S)),e(1,i.selectFilters.place.values=v,i),e(1,i.selectFilters.place.options=v,i),e(1,i.selectFilters.people.values=b,i),e(1,i.selectFilters.people.options=b,i)}},[r,i,o,f,d,s,h,g]}class Vl extends qe{constructor(t){super(),Oe(this,t,Gl,Al,ye,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[53]=t[e],s[52]=e,s}function Yt(l,t,e){const s=l.slice();return s[50]=t[e],s[52]=e,s}function Kl(l){let t,e,s,r,n,i,c,o,f,d,h,g,m,p,v,b,S,j,L,P,O=l[1]&&Zt(l);e=new Vl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[41]);let x=l[6],y=[];for(let F=0;F<x.length;F+=1)y[F]=el(Jt(l,x,F));let w=l[6].length>=je&&tl(l);return{c(){O&&O.c(),t=k(),pe(e.$$.fragment),s=k(),r=_("div"),n=_("div"),i=_("div"),c=_("div"),o=_("div"),f=_("input"),d=k(),h=_("label"),g=z("Score threshold: "),m=z(l[11]),p=z("."),v=k(),b=_("div");for(let F=0;F<y.length;F+=1)y[F].c();S=k(),w&&w.c(),u(f,"type","range"),u(f,"min","0"),u(f,"max","1.0"),u(f,"step","0.01"),u(f,"class","w-full"),u(h,"for","topk"),u(h,"class","dark:text-white"),u(o,"class","my-2"),u(i,"class","flex flex-row place-content-center mb-2 select-none mx-2"),u(b,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),u(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),u(r,"class","flex")},m(F,D){O&&O.m(F,D),T(F,t,D),ce(e,F,D),T(F,s,D),T(F,r,D),a(r,n),a(n,i),a(i,c),a(c,o),a(o,f),ct(f,l[11]),a(o,d),a(o,h),a(h,g),a(h,m),a(h,p),a(n,v),a(n,b);for(let U=0;U<y.length;U+=1)y[U].m(b,null);a(n,S),w&&w.m(n,null),j=!0,L||(P=[N(f,"change",l[19]),N(f,"change",l[42]),N(f,"input",l[42])],L=!0)},p(F,D){F[1]?O?O.p(F,D):(O=Zt(F),O.c(),O.m(t.parentNode,t)):O&&(O.d(1),O=null);const U={};if(D[0]&8&&(U.filter_button_disabled=F[3]),e.$set(U),D[0]&2048&&ct(f,F[11]),(!j||D[0]&2048)&&X(m,F[11]),D[0]&16826433){x=F[6];let M;for(M=0;M<x.length;M+=1){const C=Jt(F,x,M);y[M]?y[M].p(C,D):(y[M]=el(C),y[M].c(),y[M].m(b,null))}for(;M<y.length;M+=1)y[M].d(1);y.length=x.length}F[6].length>=je?w?w.p(F,D):(w=tl(F),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i(F){j||(W(e.$$.fragment,F),j=!0)},o(F){Z(e.$$.fragment,F),j=!1},d(F){O&&O.d(F),F&&E(t),ue(e,F),F&&E(s),F&&E(r),ve(y,F),w&&w.d(),L=!1,he(P)}}}function Xl(l){let t,e,s,r,n,i,c,o,f,d,h,g,m,p,v,b,S,j,L,P,O,x=l[2].image_card_edit_interface&&ll(l),y=l[5]&&sl(l);return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,r=k(),n=_("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',i=k(),c=_("div"),o=_("div"),o.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',f=k(),d=_("div"),h=_("div"),g=_("img"),p=k(),v=_("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=k(),x&&x.c(),S=k(),j=_("div"),j.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',L=k(),y&&y.c(),u(s,"class","cursor-pointer hover:underline text-gray-200"),u(n,"title","Fullscreen"),u(n,"class","cursor-pointer"),u(e,"class","flex h-6 items-center justify-between"),u(o,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),u(g,"class","w-auto cursor-pointer h-full"),we(g.src,m="/api/getRawData/"+l[4].data_hash)||u(g,"src",m),u(g,"alt",""),u(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),u(h,"class","flex shrink h-full"),u(d,"class","flex h-full items-center justify-center p-2 gap-4"),u(j,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),u(c,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),u(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(w,F){T(w,t,F),a(t,e),a(e,s),a(e,r),a(e,n),a(t,i),a(t,c),a(c,o),a(c,f),a(c,d),a(d,h),a(h,g),a(h,p),a(h,v),a(d,b),x&&x.m(d,null),a(c,S),a(c,j),a(t,L),y&&y.m(t,null),P||(O=[N(s,"click",l[33]),N(n,"click",l[34]),N(o,"click",l[35]),N(g,"click",l[36]),N(v,"click",l[37]),N(j,"click",l[39])],P=!0)},p(w,F){F[0]&16&&!we(g.src,m="/api/getRawData/"+w[4].data_hash)&&u(g,"src",m),w[2].image_card_edit_interface?x?x.p(w,F):(x=ll(w),x.c(),x.m(d,null)):x&&(x.d(1),x=null),w[5]?y?y.p(w,F):(y=sl(w),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i:R,o:R,d(w){w&&E(t),x&&x.d(),y&&y.d(),P=!1,he(O)}}}function Ql(l){let t,e,s,r,n,i,c,o,f,d,h,g,m,p,v,b,S,j,L=l[10],P=[];for(let x=0;x<L.length;x+=1)P[x]=nl(Yt(l,L,x));let O=l[9].active&&rl(l);return{c(){t=_("div"),e=_("div"),s=_("img"),n=k();for(let x=0;x<P.length;x+=1)P[x].c();i=k(),O&&O.c(),c=k(),o=_("div"),f=_("div"),f.innerHTML='<i class="fa fa-arrow-left"></i>',d=k(),h=_("div"),h.innerHTML='<i class="fa fa-arrow-right"></i>',g=k(),m=_("div"),p=_("div"),p.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,v=k(),b=_("div"),b.innerHTML='<i class="fa fa-arrows-alt"></i>',u(s,"class","object-cover h-screen w-auto"),we(s.src,r="/api/getRawDataFull/"+l[4].data_hash)||u(s,"src",r),u(s,"alt",""),u(e,"class","relative flex"),u(f,"class","text-white cursor-pointer"),u(h,"class","text-white cursor-pointer"),u(o,"class","absolute flex mx-auto items-center justify-between w-screen"),u(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),u(p,"class","cursor-pointer hover:underline text-white"),u(b,"title","Fullscreen"),u(b,"class","cursor-pointer text-white"),u(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(x,y){T(x,t,y),a(t,e),a(e,s),a(e,n);for(let w=0;w<P.length;w+=1)P[w].m(e,null);a(e,i),O&&O.m(e,null),a(t,c),a(t,o),a(o,f),a(o,d),a(o,h),T(x,g,y),T(x,m,y),a(m,p),a(m,v),a(m,b),S||(j=[N(s,"load",l[18]),N(f,"click",l[29]),N(h,"click",l[30]),N(p,"click",l[31]),N(b,"click",l[32])],S=!0)},p(x,y){if(y[0]&16&&!we(s.src,r="/api/getRawDataFull/"+x[4].data_hash)&&u(s,"src",r),y[0]&1792){L=x[10];let w;for(w=0;w<L.length;w+=1){const F=Yt(x,L,w);P[w]?P[w].p(F,y):(P[w]=nl(F),P[w].c(),P[w].m(e,i))}for(;w<P.length;w+=1)P[w].d(1);P.length=L.length}x[9].active?O?O.p(x,y):(O=rl(x),O.c(),O.m(e,null)):O&&(O.d(1),O=null)},i:R,o:R,d(x){x&&E(t),ve(P,x),O&&O.d(),x&&E(g),x&&E(m),S=!1,he(j)}}}function Zt(l){let t,e,s,r,n;return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,u(s,"class","cursor-pointer hover:underline text-black"),u(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),u(t,"class","flex")},m(i,c){T(i,t,c),a(t,e),a(e,s),r||(n=N(s,"click",l[40]),r=!0)},p:R,d(i){i&&E(t),r=!1,n()}}}function $t(l){let t,e,s,r,n,i;function c(){return l[43](l[52])}return{c(){t=_("div"),e=_("img"),r=k(),u(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),we(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])||u(e,"src",s),u(e,"alt","image"),u(t,"class","flex justify-center bg-black")},m(o,f){T(o,t,f),a(t,e),a(t,r),n||(i=[N(e,"load",l[24]),N(t,"click",c)],n=!0)},p(o,f){l=o,f[0]&65&&!we(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])&&u(e,"src",s)},d(o){o&&E(t),n=!1,he(i)}}}function el(l){let t,e=l[53].ix>=0&&$t(l);return{c(){e&&e.c(),t=Ue()},m(s,r){e&&e.m(s,r),T(s,t,r)},p(s,r){s[53].ix>=0?e?e.p(s,r):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&E(t)}}}function tl(l){let t,e,s,r;return{c(){t=_("div"),e=_("button"),e.textContent="More results ..",u(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),u(t,"class","flex items-center justify-center")},m(n,i){T(n,t,i),a(t,e),s||(r=N(e,"click",l[13]),s=!0)},p:R,d(n){n&&E(t),s=!1,r()}}}function ll(l){let t,e,s,r,n,i,c,o,f,d,h,g,m,p,v,b,S,j,L,P,O,x,y,w,F,D,U,M,C,H,B,J,K,G,re,se,te,le,ne;return{c(){t=_("div"),e=_("div"),s=_("div"),s.textContent="Info",r=k(),n=_("div"),n.textContent="X",i=k(),c=_("div"),o=_("div"),o.textContent="Description",f=k(),d=_("input"),g=k(),m=_("div"),p=_("div"),p.textContent="place",v=k(),b=_("input"),j=k(),L=_("div"),P=_("div"),P.textContent="Tags",O=k(),x=_("input"),w=k(),F=_("div"),D=_("div"),D.textContent="Taken at:",U=k(),M=_("input"),C=k(),H=_("div"),B=_("div"),B.textContent="device",J=k(),K=_("input"),re=k(),se=_("div"),te=_("button"),te.textContent="Save",u(s,"class","grow text-xl text-gray-100 font-bold"),u(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),u(e,"class","flex items-center"),u(o,"class","mb-1 text-gray-100"),u(d,"name","Description"),u(d,"placeholder",""),d.value=h=l[4].description.toString(),u(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(d,"type","text"),u(p,"class","mb-1 text-gray-100"),u(b,"name","place"),b.value=S=l[4].place.toString(),u(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(b,"type","text"),u(P,"class","mb-1 text-gray-100"),u(x,"name","tags"),u(x,"placeholder","Car, chair"),x.value=y=l[4].tags.toString(),u(x,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(x,"type","text"),u(D,"class","mb-1 text-gray-100"),u(M,"name","taken_at"),M.value="",u(M,"type","date"),u(M,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(B,"class","mb-1 text-gray-100"),u(K,"name","device"),u(K,"placeholder","Canon"),K.value=G=l[4].device.toString(),u(K,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(K,"type","text"),u(te,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),u(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(Q,Y){T(Q,t,Y),a(t,e),a(e,s),a(e,r),a(e,n),a(t,i),a(t,c),a(c,o),a(c,f),a(c,d),a(t,g),a(t,m),a(m,p),a(m,v),a(m,b),a(t,j),a(t,L),a(L,P),a(L,O),a(L,x),a(t,w),a(t,F),a(F,D),a(F,U),a(F,M),a(t,C),a(t,H),a(H,B),a(H,J),a(H,K),a(t,re),a(t,se),a(se,te),le||(ne=[N(n,"click",l[38]),N(d,"change",l[22]),N(b,"change",l[22]),N(x,"change",l[22]),N(M,"change",l[22]),N(K,"change",l[22]),N(te,"click",l[23])],le=!0)},p(Q,Y){Y[0]&16&&h!==(h=Q[4].description.toString())&&d.value!==h&&(d.value=h),Y[0]&16&&S!==(S=Q[4].place.toString())&&b.value!==S&&(b.value=S),Y[0]&16&&y!==(y=Q[4].tags.toString())&&x.value!==y&&(x.value=y),Y[0]&16&&G!==(G=Q[4].device.toString())&&K.value!==G&&(K.value=G)},d(Q){Q&&E(t),le=!1,he(ne)}}}function sl(l){let t,e,s,r,n=l[4].filename+"",i,c,o,f,d,h=l[4].data_hash+"",g,m,p,v,b,S=l[4].last_modified+"",j,L,P,O,x,y,w,F,D,U=l[4].description.toString()+"",M,C,H,B,J,K,G=l[4].taken_at.toString()+"",re,se,te,le,ne,Q,Y=l[4].tags.toString()+"",oe,ge,fe,xe,Ce,Se,de=l[4].place.toString()+"",Le,be,ke,_e,q,I,V,$,A=l[4].person_ids.toString()+"",De,Ze,Te,He,me,Pe,Ne=l[4].device.toString()+"",_t,Ct,Ge,$e,St,et,tt=l[4].resolution.toString()+"",pt,Dt,Ve,lt,jt,st,nt=l[4].absolute_path.toString()+"",ht;return{c(){t=_("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=k(),s=_("div"),r=_("div"),i=z(n),c=k(),o=_("div"),f=z("UID: "),d=_("span"),g=z(h),m=k(),p=_("div"),v=z("Last Modified:  "),b=_("span"),j=z(S),L=k(),P=_("div"),O=_("div"),x=_("div"),y=_("div"),w=_("div"),w.textContent="Description",F=k(),D=_("div"),M=z(U),C=k(),H=_("div"),B=_("div"),B.textContent="Taken at",J=k(),K=_("div"),re=z(G),se=k(),te=_("div"),le=_("div"),le.textContent="Tags",ne=k(),Q=_("div"),oe=z(Y),ge=k(),fe=_("div"),xe=_("div"),xe.textContent="Place",Ce=k(),Se=_("div"),Le=z(de),be=k(),ke=_("div"),_e=_("div"),q=_("div"),I=_("div"),I.textContent="people",V=k(),$=_("div"),De=z(A),Ze=k(),Te=_("div"),He=_("div"),He.textContent="Device",me=k(),Pe=_("div"),_t=z(Ne),Ct=k(),Ge=_("div"),$e=_("div"),$e.textContent="Resolution",St=k(),et=_("div"),pt=z(tt),Dt=k(),Ve=_("div"),lt=_("div"),lt.textContent="Path",jt=k(),st=_("div"),ht=z(nt),u(r,"class","text-xl text-white"),u(d,"class","text-sm text-gray-400"),u(o,"class","text-white"),u(b,"class","text-sm text-gray-400"),u(p,"class","text-white"),u(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),u(w,"class",""),u(D,"class","text-sm text-gray-400"),u(B,"class",""),u(K,"class","text-sm text-gray-400"),u(le,"class",""),u(Q,"class","text-sm text-gray-400"),u(xe,"class",""),u(Se,"class","text-sm text-gray-400"),u(x,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(O,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),u(I,"class",""),u($,"class","text-sm text-gray-400"),u(He,"class",""),u(Pe,"class","text-sm text-gray-400"),u($e,"class",""),u(et,"class","text-sm text-gray-400"),u(lt,"class",""),u(st,"class","text-sm text-gray-400"),u(_e,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(ke,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),u(P,"class","flex w-full justify-center p-4")},m(ee,ie){T(ee,t,ie),T(ee,e,ie),T(ee,s,ie),a(s,r),a(r,i),a(s,c),a(s,o),a(o,f),a(o,d),a(d,g),a(s,m),a(s,p),a(p,v),a(p,b),a(b,j),T(ee,L,ie),T(ee,P,ie),a(P,O),a(O,x),a(x,y),a(y,w),a(y,F),a(y,D),a(D,M),a(x,C),a(x,H),a(H,B),a(H,J),a(H,K),a(K,re),a(x,se),a(x,te),a(te,le),a(te,ne),a(te,Q),a(Q,oe),a(x,ge),a(x,fe),a(fe,xe),a(fe,Ce),a(fe,Se),a(Se,Le),a(P,be),a(P,ke),a(ke,_e),a(_e,q),a(q,I),a(q,V),a(q,$),a($,De),a(_e,Ze),a(_e,Te),a(Te,He),a(Te,me),a(Te,Pe),a(Pe,_t),a(_e,Ct),a(_e,Ge),a(Ge,$e),a(Ge,St),a(Ge,et),a(et,pt),a(_e,Dt),a(_e,Ve),a(Ve,lt),a(Ve,jt),a(Ve,st),a(st,ht)},p(ee,ie){ie[0]&16&&n!==(n=ee[4].filename+"")&&X(i,n),ie[0]&16&&h!==(h=ee[4].data_hash+"")&&X(g,h),ie[0]&16&&S!==(S=ee[4].last_modified+"")&&X(j,S),ie[0]&16&&U!==(U=ee[4].description.toString()+"")&&X(M,U),ie[0]&16&&G!==(G=ee[4].taken_at.toString()+"")&&X(re,G),ie[0]&16&&Y!==(Y=ee[4].tags.toString()+"")&&X(oe,Y),ie[0]&16&&de!==(de=ee[4].place.toString()+"")&&X(Le,de),ie[0]&16&&A!==(A=ee[4].person_ids.toString()+"")&&X(De,A),ie[0]&16&&Ne!==(Ne=ee[4].device.toString()+"")&&X(_t,Ne),ie[0]&16&&tt!==(tt=ee[4].resolution.toString()+"")&&X(pt,tt),ie[0]&16&&nt!==(nt=ee[4].absolute_path.toString()+"")&&X(ht,nt)},d(ee){ee&&E(t),ee&&E(e),ee&&E(s),ee&&E(L),ee&&E(P)}}}function nl(l){let t,e,s;function r(...n){return l[27](l[50],...n)}return{c(){t=_("div"),u(t,"data-ix",l[52]),u(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ae(t,"top",l[50].top+"px "),ae(t,"left",l[50].left+"px"),ae(t,"width",l[50].width+"px"),ae(t,"height",l[50].height+"px")},m(n,i){T(n,t,i),e||(s=N(t,"click",r),e=!0)},p(n,i){l=n,i[0]&1024&&ae(t,"top",l[50].top+"px "),i[0]&1024&&ae(t,"left",l[50].left+"px"),i[0]&1024&&ae(t,"width",l[50].width+"px"),i[0]&1024&&ae(t,"height",l[50].height+"px")},d(n){n&&E(t),e=!1,s()}}}function rl(l){let t,e,s,r,n,i,c;return{c(){t=_("div"),e=_("input"),r=k(),n=_("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[8]],u(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),u(e,"placeholder","Enter person id"),u(e,"type","text"),u(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),u(t,"class","absolute flex h-auto w-240 bg-blue-300"),ae(t,"top",l[9].top+"px "),ae(t,"left",l[9].left+"px")},m(o,f){T(o,t,f),a(t,e),a(t,r),a(t,n),e.focus(),i||(c=[N(e,"keyup",l[21]),N(n,"click",l[28])],i=!0)},p(o,f){f[0]&272&&s!==(s=o[4].person_ids[o[8]])&&e.value!==s&&(e.value=s),f[0]&512&&ae(t,"top",o[9].top+"px "),f[0]&512&&ae(t,"left",o[9].left+"px")},d(o){o&&E(t),i=!1,he(c)}}}function Wl(l){let t,e,s,r,n,i;const c=[Ql,Xl,Kl],o=[];function f(d,h){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=f(l),e=o[t]=c[t](l),{c(){e.c(),s=k(),r=_("div"),n=_("div"),u(n,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),ae(n,"width",(l[7]*100).toString()+"%"),u(r,"class","flex animate-pulse")},m(d,h){o[t].m(d,h),T(d,s,h),T(d,r,h),a(r,n),i=!0},p(d,h){let g=t;t=f(d),t===g?o[t].p(d,h):(We(),Z(o[g],1,1,()=>{o[g]=null}),Je(),e=o[t],e?e.p(d,h):(e=o[t]=c[t](d),e.c()),W(e,1),e.m(s.parentNode,s)),(!i||h[0]&128)&&ae(n,"width",(d[7]*100).toString()+"%")},i(d){i||(W(e),i=!0)},o(d){Z(e),i=!1},d(d){o[t].d(d),d&&E(s),d&&E(r)}}}let je=18;function gt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let r=0;r<l.length;r++){let n=r;t[r%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[r][e]}):s.push({ix:n,score:l[r]})}return s.sort((r,n)=>r.score>n.score?-1:r.score<n.score?1:0),s}function Jl(l,t,e){const s=ft();let{show_exit_interface_button:r=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,i=!0;Qe(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),at.update(q=>[])});let c={},o=!1,f=[],d=[],h=0,g=0,m=0,p=!1;function v(q){p!=!0&&(p=!0,g=0,e(7,m=0),e(26,h=h+je),e(6,f=d.slice(h,h+je)),at.update(I=>b(f)))}function b(q){let I=[],V=q.length;for(let $=0;$<V;$++){let A=q[$].ix;I.push(n.list_metaData[A])}return I}Ee.subscribe(q=>{e(7,m=q.progress),q.done==!0?(S(q),e(7,m=0)):(e(26,h=0),e(6,f=[]))});function S(q){e(25,d=gt(q.list_score)),e(6,f=d.slice(0,0+je)),at.update(I=>b(f))}let j={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function L(q){let I=Object.keys(j);for(let V=0;V<I.length;V++)e(2,j[I[V]]=!1,j);e(2,j[q]=!0,j)}let P,O={active:!1,top:null,left:null};function x(q){let I={sorted_ix:null,image_ix:null};for(let V=q;V<f.length;V++)if(f[V].ix!==-1){I.image_ix=f[V].ix,I.sorted_ix=V;break}return I}function y(q){J={},e(5,o=!1),e(10,D=[]),e(9,O={active:!1,top:null,left:null});let I=q,V=f.length;I<0&&(I=V-1),I>V-1&&(I=0);let $=x(I),A=$.image_ix;I=$.sorted_ix,A===null&&($=x(0),A=$.image_ix,I=$.sorted_ix),e(4,c.ix=I,c),e(4,c.data_hash=n.list_dataHash[A],c),e(4,c.height=Number(n.list_metaData[A].height),c),e(4,c.width=Number(n.list_metaData[A].width),c),e(4,c.face_bboxes=n.list_metaData[A].face_bboxes,c),e(4,c.person_ids=n.list_metaData[A].person,c),c.person_ids===null&&e(4,c.person_ids=[],c),e(4,c.resolution=c.height.toString()+" X "+c.width.toString(),c),e(4,c.filename=n.list_metaData[A].filename,c),e(4,c.taken_at=n.list_metaData[A].taken_at,c),c.taken_at==null&&e(4,c.taken_at="Unknown",c),e(4,c.last_modified=n.list_metaData[A].modified_at,c),e(4,c.device=n.list_metaData[A].device,c),c.device==null&&e(4,c.device="",c),e(4,c.place=n.list_metaData[A].place,c),e(4,c.absolute_path=n.list_metaData[A].absolute_path,c),e(4,c.description=n.list_metaData[A].description,c),e(4,c.tags=n.list_metaData[A].tags,c),e(5,o=!0)}function w(){y(c.ix+1)}function F(){y(c.ix-1)}let D=[];function U(q){let I=q.target.getClientRects()[0],V=I.width,$=I.height,A=[],De=c.face_bboxes;if(De){let Ze=c.width,Te=c.height;for(let He=0;He<De.length;He++){let me=structuredClone(De[He]),Pe=Number(V)/(Number(Ze)+1e-4),Ne=Number($)/(Number(Te)+1e-4);me.top=me[1]*Ne,me.height=(me[3]-me[1])*Ne,me.left=me[0]*Pe,me.width=(me[2]-me[0])*Pe,A.push(me)}}console.log(A),e(10,D=A)}let M=0;function C(){let q=f[0].score,I=f[f.length-1].score,$=n.list_score.map(A=>(A-I)/(q-I+1e-5)).map(A=>A>=M?1:0);e(6,f=gt(n.list_score,$))}function H(q){e(3,i=!0);let I=d.slice(h,h+je);for(let V=0;V<q.length;V++)q[V]==0?e(6,f[V].ix=-1,f):e(6,f[V].ix=I[V].ix,f);e(3,i=!1)}function B(q){let I=q.target.value,V=c.data_hash,$=c.person_ids[P];if(q.key=="Enter"){let A=new FormData;A.append("new_person_id",I),A.append("old_person_id",$),A.append("data_hash",V),fetch("/api/tagPerson",{method:"POST",body:A}).then(De=>{if(De.ok)alert("Success");else throw new Error("Error occured")})}}let J={};function K(q){J[q.target.name.toLowerCase()]=q.target.value}async function G(q){q.target.disabled=!0,q.target.innerText="Saving...";let I=Object.keys(J),V=new FormData;for(let A=0;A<I.length;A++)V.append(I[A],J[I[A]]);V.append("data_hash",c.data_hash);let $=await fetch("/api/editMetaData",{method:"POST",body:V});$.ok?(alert("Success!"),await $.json(),e(2,j.image_card_edit_interface=!1,j)):alert("Error while saving. Contact Admin"),q.target.innerText="Save",q.target.disabled=!1}function re(q){p&&(g+=1,e(7,m+=1/je),g==Math.min(f.length,je)&&(e(7,m=0),p=!1))}const se=(q,I)=>{e(9,O={active:!0,top:q.top-28,left:q.left}),e(8,P=Number(I.target.attributes["data-ix"].value))},te=()=>{e(9,O.active=!1,O)},le=()=>{F()},ne=()=>{w()},Q=()=>{L("parent")},Y=()=>{L("image_card")},oe=()=>{L("parent")},ge=()=>{L("image_card_fullscreen")},fe=()=>{F()},xe=()=>{console.log("hellll"),L("image_card_fullscreen")},Ce=()=>{e(2,j.image_card_edit_interface=!0,j)},Se=()=>{e(2,j.image_card_edit_interface=!1,j)},de=()=>{w()},Le=()=>{console.log("pressed me!!!"),e(6,f=[]),s("exitButtonPressed")},be=q=>{H(q.detail.mask)};function ke(){M=vl(this.value),e(11,M)}const _e=q=>{y(q),L("image_card")};return l.$$set=q=>{"show_exit_interface_button"in q&&e(1,r=q.show_exit_interface_button),"image_data"in q&&e(0,n=q.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&100663297&&n&&(e(25,d=gt(n.list_score)),n.done==!1&&e(6,f=d.slice(h,h+je))),l.$$.dirty[0]&4&&j){let q=!1;(j.image_card==!0||j.image_card_fullscreen==!0)&&(q=!0),s("imageCardActive",{active:q})}},[n,r,j,i,c,o,f,m,P,O,D,M,s,v,L,y,w,F,U,C,H,B,K,G,re,d,h,se,te,le,ne,Q,Y,oe,ge,fe,xe,Ce,Se,de,Le,be,ke,_e]}class dt extends qe{constructor(t){super(),Oe(this,t,Jl,Wl,ye,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const Yl="/assets/sample_place_bg-38f3fbd4.jpg";function il(l,t,e){const s=l.slice();return s[10]=t[e],s}function Zl(l){let t,e,s,r,n,i,c,o,f,d,h,g=l[0].people,m=[];for(let p=0;p<g.length;p+=1)m[p]=ol(il(l,g,p));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="People Album",i=k(),c=_("div"),o=_("input"),f=k();for(let p=0;p<m.length;p+=1)m[p].c();u(n,"class","flex text-lg font-semibold"),u(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),u(o,"type","text"),u(o,"placeholder","Search person"),u(c,"class","flex"),u(r,"class","flex w-full justify-between items-center"),u(s,"class","flex w-screen h-[80px]"),u(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),u(t,"class","flex w-full justify-center items-center")},m(p,v){T(p,t,v),a(t,e),a(e,s),a(s,r),a(r,n),a(r,i),a(r,c),a(c,o),a(e,f);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(h=N(o,"input",l[5]),d=!0)},p(p,v){if(v&17){g=p[0].people;let b;for(b=0;b<g.length;b+=1){const S=il(p,g,b);m[b]?m[b].p(S,v):(m[b]=ol(S),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:R,o:R,d(p){p&&E(t),ve(m,p),d=!1,h()}}}function $l(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){pe(t.$$.fragment)},m(s,r){ce(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(W(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ue(t,s)}}}function es(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:R,i:R,o:R,d(e){e&&E(t)}}}function ol(l){let t,e,s,r,n,i,c,o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",f,d,h,g;function m(...p){return l[7](l[10],...p)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),c=_("div"),f=z(o),d=k(),u(r,"loading","lazy"),we(r.src,n="/api/getPreviewPerson/"+l[10])||u(r,"src",n),u(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[160px] w-[160px] bg-gray-800"),u(c,"class","flex text-md text-black justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(p,v){T(p,t,v),a(t,e),a(e,s),a(s,r),a(e,i),a(e,c),a(c,f),a(t,d),h||(g=N(t,"click",m),h=!0)},p(p,v){l=p,v&1&&!we(r.src,n="/api/getPreviewPerson/"+l[10])&&u(r,"src",n),v&1&&o!==(o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&X(f,o)},d(p){p&&E(t),h=!1,g()}}}function ts(l){let t,e,s,r;const n=[es,$l,Zl],i=[];function c(o,f){return o[3]===!1?0:o[2]?1:2}return t=c(l),e=i[t]=n[t](l),{c(){e.c(),s=Ue()},m(o,f){i[t].m(o,f),T(o,s,f),r=!0},p(o,[f]){let d=t;t=c(o),t===d?i[t].p(o,f):(We(),Z(i[d],1,1,()=>{i[d]=null}),Je(),e=i[t],e?e.p(o,f):(e=i[t]=n[t](o),e.c()),W(e,1),e.m(s.parentNode,s))},i(o){r||(W(e),r=!0)},o(o){Z(e),r=!1},d(o){i[t].d(o),o&&E(s)}}}function ls(l,t,e){let s={people:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,c=!0,o;Fe(()=>{e(3,c=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(p=>{let v=p.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(p.data_hash[b]),r.list_score.push(p.score[b]),r.list_metaData.push(p.meta_data[b]);e(3,c=!0),e(0,s.people=p.person,s),o=s.people})})}),Qe(()=>{console.log("destroying... people..")});async function f(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let p=0;p<r.list_dataHash.length;p++)r.list_metaData[p].person.includes(m)&&(n.list_metaData.push(r.list_metaData[p]),n.list_dataHash.push(r.list_dataHash[p]),n.list_score.push(r.list_score[p]));e(1,n.done=!0,n),e(2,i=!0),o&&e(0,s.people=o,s),Ee.update(p=>structuredClone(n))}function d(m){let p=m.target.value;if(p=p.toLowerCase(),!p){o&&e(0,s.people=o,s);return}p&&c==!0&&o&&(e(0,s.people=[],s),o.forEach(v=>{v.toLowerCase().includes(p)&&s.people.push(v)}))}return[s,n,i,c,f,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,p)=>{console.log("mine is: ",m),f(m)}]}class ss extends qe{constructor(t){super(),Oe(this,t,ls,ts,ye,{})}}function al(l,t,e){const s=l.slice();return s[8]=t[e],s}function ns(l){let t,e,s,r=l[0].places,n=[];for(let i=0;i<r.length;i+=1)n[i]=cl(al(l,r,i));return{c(){t=_("div"),e=k(),s=_("div");for(let i=0;i<n.length;i+=1)n[i].c();u(t,"class","flex w-screen h-[80px] bg-blue-100"),u(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(i,c){T(i,t,c),T(i,e,c),T(i,s,c);for(let o=0;o<n.length;o+=1)n[o].m(s,null)},p(i,c){if(c&17){r=i[0].places;let o;for(o=0;o<r.length;o+=1){const f=al(i,r,o);n[o]?n[o].p(f,c):(n[o]=cl(f),n[o].c(),n[o].m(s,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},i:R,o:R,d(i){i&&E(t),i&&E(e),i&&E(s),ve(n,i)}}}function rs(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){pe(t.$$.fragment)},m(s,r){ce(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(W(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ue(t,s)}}}function is(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:R,i:R,o:R,d(e){e&&E(t)}}}function cl(l){let t,e,s,r,n,i,c,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",f,d,h,g;function m(...p){return l[6](l[8],...p)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),c=_("div"),f=z(o),d=k(),we(r.src,n=Yl)||u(r,"src",n),u(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[150px] w-[200px] bg-gray-800"),u(c,"class","flex text-xl text-white justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(p,v){T(p,t,v),a(t,e),a(e,s),a(s,r),a(e,i),a(e,c),a(c,f),a(t,d),h||(g=N(t,"click",m),h=!0)},p(p,v){l=p,v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&X(f,o)},d(p){p&&E(t),h=!1,g()}}}function os(l){let t,e,s,r;const n=[is,rs,ns],i=[];function c(o,f){return o[3]===!1?0:o[2]?1:2}return t=c(l),e=i[t]=n[t](l),{c(){e.c(),s=Ue()},m(o,f){i[t].m(o,f),T(o,s,f),r=!0},p(o,[f]){let d=t;t=c(o),t===d?i[t].p(o,f):(We(),Z(i[d],1,1,()=>{i[d]=null}),Je(),e=i[t],e?e.p(o,f):(e=i[t]=n[t](o),e.c()),W(e,1),e.m(s.parentNode,s))},i(o){r||(W(e),r=!0)},o(o){Z(e),r=!1},d(o){i[t].d(o),o&&E(s)}}}function as(l,t,e){let s={places:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},i=!1,c=!0;Fe(()=>{e(3,c=!1),fetch("/api/getGroup/place").then(h=>{h.json().then(g=>{let m=g.meta_data.length;for(let p=0;p<m;p++)r.list_dataHash.push(g.data_hash[p]),r.list_score.push(g.score[p]),r.list_metaData.push(g.meta_data[p]);e(3,c=!0),e(0,s.places=g.place,s)})})}),Qe(()=>{console.log("destroying...")});async function o(h){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ee.update(g=>structuredClone(n));for(let g=0;g<r.list_dataHash.length;g++)r.list_metaData[g].place.toLowerCase()===h.toLowerCase()&&(n.list_metaData.push(r.list_metaData[g]),n.list_dataHash.push(r.list_dataHash[g]),n.list_score.push(r.list_score[g]));e(1,n.done=!0,n),e(2,i=!0),Ee.update(g=>structuredClone(n))}return[s,n,i,c,o,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(h,g)=>{console.log("mine is: ",h),o(h)}]}class cs extends qe{constructor(t){super(),Oe(this,t,as,os,ye,{})}}const us="/assets/folder-regular-1127ab6b.svg";function ul(l,t,e){const s=l.slice();return s[10]=t[e],s}function fs(l){let t,e,s,r,n,i,c,o,f,d,h,g=l[0].local_directories,m=[];for(let p=0;p<g.length;p+=1)m[p]=fl(ul(l,g,p));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="Local Resources",i=k(),c=_("div"),o=_("input"),f=k();for(let p=0;p<m.length;p+=1)m[p].c();u(n,"class","flex text-lg font-semibold"),u(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),u(o,"type","text"),u(o,"placeholder","Search directory"),u(c,"class","flex"),u(r,"class","flex w-full justify-between items-center"),u(s,"class","flex w-screen h-[80px]"),u(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),u(t,"class","flex w-full justify-center items-center")},m(p,v){T(p,t,v),a(t,e),a(e,s),a(s,r),a(r,n),a(r,i),a(r,c),a(c,o),a(e,f);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(h=N(o,"input",l[5]),d=!0)},p(p,v){if(v&17){g=p[0].local_directories;let b;for(b=0;b<g.length;b+=1){const S=ul(p,g,b);m[b]?m[b].p(S,v):(m[b]=fl(S),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:R,o:R,d(p){p&&E(t),ve(m,p),d=!1,h()}}}function ds(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){pe(t.$$.fragment)},m(s,r){ce(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(W(t.$$.fragment,s),e=!0)},o(s){Z(t.$$.fragment,s),e=!1},d(s){ue(t,s)}}}function _s(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:R,i:R,o:R,d(e){e&&E(t)}}}function fl(l){let t,e,s,r,n,i,c,o=l[10].slice(0,10)+"..",f,d,h,g,m;function p(...v){return l[7](l[10],...v)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),c=_("div"),f=z(o),d=k(),we(r.src,n=us)||u(r,"src",n),u(r,"class","object-contain hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[100px] w-[100px] bg-gray-800 p-3"),u(c,"class","flex text-sm text-black justify-center items-center"),u(t,"class","flex-col cursor-pointer p-2"),u(t,"title",h=l[10])},m(v,b){T(v,t,b),a(t,e),a(e,s),a(s,r),a(e,i),a(e,c),a(c,f),a(t,d),g||(m=N(t,"click",p),g=!0)},p(v,b){l=v,b&1&&o!==(o=l[10].slice(0,10)+"..")&&X(f,o),b&1&&h!==(h=l[10])&&u(t,"title",h)},d(v){v&&E(t),g=!1,m()}}}function ps(l){let t,e,s,r;const n=[_s,ds,fs],i=[];function c(o,f){return o[3]===!1?0:o[2]?1:2}return t=c(l),e=i[t]=n[t](l),{c(){e.c(),s=Ue()},m(o,f){i[t].m(o,f),T(o,s,f),r=!0},p(o,[f]){let d=t;t=c(o),t===d?i[t].p(o,f):(We(),Z(i[d],1,1,()=>{i[d]=null}),Je(),e=i[t],e?e.p(o,f):(e=i[t]=n[t](o),e.c()),W(e,1),e.m(s.parentNode,s))},i(o){r||(W(e),r=!0)},o(o){Z(e),r=!1},d(o){i[t].d(o),o&&E(s)}}}function hs(l,t,e){let s={local_directories:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,c=!0,o;Fe(()=>{e(3,c=!1),fetch("/api/getGroup/resource_directory").then(m=>{m.json().then(p=>{let v=p.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(p.data_hash[b]),r.list_score.push(p.score[b]),r.list_metaData.push(p.meta_data[b]);e(3,c=!0),e(0,s.local_directories=p.resource_directory,s),o=s.local_directories})})}),Qe(()=>{});async function f(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0}),console.log("looking for attribute ",m);for(let p=0;p<r.list_dataHash.length;p++)r.list_metaData[p].resource_directory.toLowerCase().includes(m)&&(n.list_metaData.push(r.list_metaData[p]),n.list_dataHash.push(r.list_dataHash[p]),n.list_score.push(r.list_score[p]));e(1,n.done=!0,n),console.log(n),e(2,i=!0),o&&e(0,s.local_directories=o,s),Ee.update(p=>structuredClone(n))}function d(m){let p=m.target.value;if(p=p.toLowerCase(),!p){o&&e(0,s.local_directories=o,s);return}p&&c==!0&&o&&(e(0,s.local_directories=[],s),o.forEach(v=>{v.toLowerCase().includes(p)&&s.local_directories.push(v)}))}return[s,n,i,c,f,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,p)=>{console.log("mine is: ",m),f(m)}]}class ms extends qe{constructor(t){super(),Oe(this,t,hs,ps,ye,{})}}function dl(l){let t,e,s,r,n,i;return{c(){t=_("div"),e=_("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=k(),r=_("div"),r.textContent="X",u(e,"class","flex-1"),u(r,"class","flex text-xl hover:orange-900 cursor-pointer"),u(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),u(t,"role","alert")},m(c,o){T(c,t,o),a(t,e),a(t,s),a(t,r),n||(i=N(r,"click",l[9]),n=!0)},p:R,d(c){c&&E(t),n=!1,i()}}}function gs(l){let t,e,s,r,n,i;return e=new Ye({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[19]),e.$on("sidebarStateChange",l[20]),n=new ms({}),{c(){t=_("div"),pe(e.$$.fragment),s=k(),r=_("div"),pe(n.$$.fragment),u(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,o){T(c,t,o),ce(e,t,null),a(t,s),a(t,r),ce(n,r,null),i=!0},p(c,o){const f={};o[0]&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){i||(W(e.$$.fragment,c),W(n.$$.fragment,c),i=!0)},o(c){Z(e.$$.fragment,c),Z(n.$$.fragment,c),i=!1},d(c){c&&E(t),ue(e),ue(n)}}}function bs(l){let t,e,s,r,n,i;return e=new Ye({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),n=new ss({}),{c(){t=_("div"),pe(e.$$.fragment),s=k(),r=_("div"),pe(n.$$.fragment),u(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,o){T(c,t,o),ce(e,t,null),a(t,s),a(t,r),ce(n,r,null),i=!0},p(c,o){const f={};o[0]&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){i||(W(e.$$.fragment,c),W(n.$$.fragment,c),i=!0)},o(c){Z(e.$$.fragment,c),Z(n.$$.fragment,c),i=!1},d(c){c&&E(t),ue(e),ue(n)}}}function vs(l){let t,e,s,r,n,i;return e=new Ye({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new cs({}),{c(){t=_("div"),pe(e.$$.fragment),s=k(),r=_("div"),pe(n.$$.fragment),u(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,o){T(c,t,o),ce(e,t,null),a(t,s),a(t,r),ce(n,r,null),i=!0},p(c,o){const f={};o[0]&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){i||(W(e.$$.fragment,c),W(n.$$.fragment,c),i=!0)},o(c){Z(e.$$.fragment,c),Z(n.$$.fragment,c),i=!1},d(c){c&&E(t),ue(e),ue(n)}}}function ks(l){let t,e,s,r,n,i;return e=new Ye({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new Ml({}),{c(){t=_("div"),pe(e.$$.fragment),s=k(),r=_("div"),pe(n.$$.fragment),u(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),u(t,"class","flex")},m(c,o){T(c,t,o),ce(e,t,null),a(t,s),a(t,r),ce(n,r,null),i=!0},p(c,o){const f={};o[0]&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){i||(W(e.$$.fragment,c),W(n.$$.fragment,c),i=!0)},o(c){Z(e.$$.fragment,c),Z(n.$$.fragment,c),i=!1},d(c){c&&E(t),ue(e),ue(n)}}}function ws(l){let t,e,s,r,n,i,c,o;return e=new Ye({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),n=new Ll({props:{query_button_disabled:l[2]}}),n.$on("queryReady",l[12]),c=new dt({props:{image_data:l[1]}}),{c(){t=_("div"),pe(e.$$.fragment),s=k(),r=_("div"),pe(n.$$.fragment),i=k(),pe(c.$$.fragment),u(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),u(t,"class","flex")},m(f,d){T(f,t,d),ce(e,t,null),a(t,s),a(t,r),ce(n,r,null),a(r,i),ce(c,r,null),o=!0},p(f,d){const h={};d[0]&64&&(h.sidebarOpen=f[6]),e.$set(h);const g={};d[0]&4&&(g.query_button_disabled=f[2]),n.$set(g);const m={};d[0]&2&&(m.image_data=f[1]),c.$set(m)},i(f){o||(W(e.$$.fragment,f),W(n.$$.fragment,f),W(c.$$.fragment,f),o=!0)},o(f){Z(e.$$.fragment,f),Z(n.$$.fragment,f),Z(c.$$.fragment,f),o=!1},d(f){f&&E(t),ue(e),ue(n),ue(c)}}}function ys(l){let t,e,s,r,n,i=l[0]&&dl(l);const c=[ws,ks,vs,bs,gs],o=[];function f(d,h){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:d[5].local_album.status===!0?4:-1}return~(e=f(l))&&(s=o[e]=c[e](l)),{c(){i&&i.c(),t=k(),s&&s.c(),r=Ue()},m(d,h){i&&i.m(d,h),T(d,t,h),~e&&o[e].m(d,h),T(d,r,h),n=!0},p(d,h){d[0]?i?i.p(d,h):(i=dl(d),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null);let g=e;e=f(d),e===g?~e&&o[e].p(d,h):(s&&(We(),Z(o[g],1,1,()=>{o[g]=null}),Je()),~e?(s=o[e],s?s.p(d,h):(s=o[e]=c[e](d),s.c()),W(s,1),s.m(r.parentNode,r)):s=null)},i(d){n||(W(s),n=!0)},o(d){Z(s),n=!1},d(d){i&&i.d(d),d&&E(t),~e&&o[e].d(d),d&&E(r)}}}let xs=3;function Cs(l,t,e){let s=!1;Fe(()=>{window.onscrollend=function(){}}),Fe(()=>{fetch("/api/getMetaStats").then(C=>{C.ok?C.json().then(H=>{Number(H.image.count)==0&&e(0,s=!0),wt.update(B=>Number(H.image.count)),xt.update(B=>Number(H.image.unique_place_count)),yt.update(B=>Number(H.image.unique_people_count)),hl.update(B=>Number(H.image.unique_resource_directories_count)),ml.update(B=>H.available_resource_attributes)}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let r=[],n=[],i=[],c,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},f=!1,d="",h={};async function g(C="xxxxxxx",H=!1){console.log("handleClick count",d,H,C),e(2,f=!0);let B=xs;if(c=new FormData,d.length===0)return;c.append("query",d),c.append("topk",B.toString()),H==!1?(n=[],r=[],i=[],e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),c.append("query_start","true"),Ee.update(ne=>o)):(c.append("query_start","false"),c.append("client_id",C));let K=await fetch("/api/query",{method:"POST",body:c});if(!K.ok)throw e(2,f=!1),new Error(K);let G=await K.json();console.log("data: ",G);let re=G.client_id,se=G.meta_data,te=G.data_hash,le=G.score;Number(G.progress);for(let ne=0;ne<se.length;ne++){let Q=te[ne],Y=Number(le[ne]),oe=n.indexOf(Q);oe>=0?(r[oe]+=Y,e(1,o.list_score[oe]+=Y,o)):(n.push(Q),r.push(Y),i.push(se[ne]),o.list_dataHash.push(Q),o.list_score.push(Y),o.list_metaData.push(se[ne]))}if(G.query_completed==!0?(e(1,o.done=!0,o),e(1,o.progress=1e-4,o)):(e(1,o),e(1,o.progress+=.12,o),e(1,o.progress=Math.min(o.progress,.92),o)),G.query_completed==!0){e(2,f=!1),console.log("hey i am being called!!!"),Ee.update(ne=>o);return}await g(re,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}},local_album:{status:!1,context:{}}};function p(C){m[C].status==!1&&(e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Ee.update(B=>structuredClone(o)));let H=Object.keys(m);for(let B=0;B<H.length;B++)m[H[B]].status&&e(5,m[H[B]].status=!1,m);m[C]&&e(5,m[C].status=!0,m)}let v=!0;function b(C){let H=C.detail.item.name;H.toLowerCase().includes("photo")?p("query"):H.toLowerCase().includes("index")?p("indexing"):H.toLowerCase().includes("people")?p("people_album"):H.toLowerCase().includes("place")?p("place_album"):H.toLowerCase().includes("local")&&p("local_album")}return[s,o,f,d,h,m,v,g,b,()=>e(0,s=!1),C=>{b(C)},C=>{e(6,v=C.detail.open)},C=>{e(3,d=C.detail.query),e(4,h=C.detail.attributes),g()},C=>b(C),C=>{e(6,v=C.detail.open)},C=>b(C),C=>{e(6,v=C.detail.open)},C=>b(C),C=>{e(6,v=C.detail.open)},C=>b(C),C=>{e(6,v=C.detail.open)}]}class Ss extends qe{constructor(t){super(),Oe(this,t,Cs,ys,ye,{},null,[-1,-1])}}new Ss({target:document.getElementById("app")});
