(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();function B(){}function pl(l){return l()}function Ot(){return Object.create(null)}function he(l){l.forEach(pl)}function vt(l){return typeof l=="function"}function ke(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let rt;function ye(l,t){return rt||(rt=document.createElement("a")),rt.href=t,l===rt.href}function vl(l){return Object.keys(l).length===0}function c(l,t){l.appendChild(t)}function F(l,t,e){l.insertBefore(t,e||null)}function O(l){l.parentNode&&l.parentNode.removeChild(l)}function ve(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function _(l){return document.createElement(l)}function G(l){return document.createTextNode(l)}function k(){return G(" ")}function Ee(){return G("")}function E(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function f(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function kl(l){return l===""?null:+l}function wl(l){return Array.from(l.childNodes)}function W(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function ct(l,t){l.value=t??""}function de(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ft(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function yl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function xl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(l,e,s,t),r}let We;function Xe(l){We=l}function kt(){if(!We)throw new Error("Function called outside component initialization");return We}function xe(l){kt().$$.on_mount.push(l)}function Qe(l){kt().$$.on_destroy.push(l)}function ft(){const l=kt();return(t,e,{cancelable:s=!1}={})=>{const r=l.$$.callbacks[t];if(r){const n=xl(t,e,{cancelable:s});return r.slice().forEach(i=>{i.call(l,n)}),!n.defaultPrevented}return!0}}const Ue=[],Me=[],it=[],Lt=[],Cl=Promise.resolve();let bt=!1;function Sl(){bt||(bt=!0,Cl.then(hl))}function ut(l){it.push(l)}const mt=new Set;let Re=0;function hl(){if(Re!==0)return;const l=We;do{try{for(;Re<Ue.length;){const t=Ue[Re];Re++,Xe(t),Dl(t.$$)}}catch(t){throw Ue.length=0,Re=0,t}for(Xe(null),Ue.length=0,Re=0;Me.length;)Me.pop()();for(let t=0;t<it.length;t+=1){const e=it[t];mt.has(e)||(mt.add(e),e())}it.length=0}while(Ue.length);for(;Lt.length;)Lt.pop()();bt=!1,mt.clear(),Xe(l)}function Dl(l){if(l.fragment!==null){l.update(),he(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(ut)}}const ot=new Set;let Ie;function Je(){Ie={r:0,c:[],p:Ie}}function Ye(){Ie.r||he(Ie.c),Ie=Ie.p}function Q(l,t){l&&l.i&&(ot.delete(l),l.i(t))}function J(l,t,e,s){if(l&&l.o){if(ot.has(l))return;ot.add(l),Ie.c.push(()=>{ot.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function ue(l){l&&l.c()}function ie(l,t,e,s){const{fragment:r,after_update:n}=l.$$;r&&r.m(t,e),s||ut(()=>{const i=l.$$.on_mount.map(pl).filter(vt);l.$$.on_destroy?l.$$.on_destroy.push(...i):he(i),l.$$.on_mount=[]}),n.forEach(ut)}function oe(l,t){const e=l.$$;e.fragment!==null&&(he(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function jl(l,t){l.$$.dirty[0]===-1&&(Ue.push(l),Sl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Ce(l,t,e,s,r,n,i,a=[-1]){const o=We;Xe(l);const u=l.$$={fragment:null,ctx:[],props:n,update:B,not_equal:r,bound:Ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:Ot(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};i&&i(u.root);let d=!1;if(u.ctx=e?e(l,t.props||{},(p,g,...m)=>{const h=m.length?m[0]:g;return u.ctx&&r(u.ctx[p],u.ctx[p]=h)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](h),d&&jl(l,p)),g}):[],u.update(),d=!0,he(u.before_update),u.fragment=s?s(u.ctx):!1,t.target){if(t.hydrate){const p=wl(t.target);u.fragment&&u.fragment.l(p),p.forEach(O)}else u.fragment&&u.fragment.c();t.intro&&Q(l.$$.fragment),ie(l,t.target,t.anchor,t.customElement),hl()}Xe(o)}class Se{$destroy(){oe(this,1),this.$destroy=B}$on(t,e){if(!vt(e))return B;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const r=s.indexOf(e);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!vl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ze=[];function Be(l,t=B){let e;const s=new Set;function r(a){if(ke(l,a)&&(l=a,e)){const o=!ze.length;for(const u of s)u[1](),ze.push(u,l);if(o){for(let u=0;u<ze.length;u+=2)ze[u][0](ze[u+1]);ze.length=0}}}function n(a){r(a(l))}function i(a,o=B){const u=[a,o];return s.add(u),s.size===1&&(e=t(r)||B),a(l),()=>{s.delete(u),s.size===0&&(e(),e=null)}}return{set:r,update:n,subscribe:i}}const wt=Be(0),yt=Be(0),xt=Be(0),ml=Be(0),at=Be([]);let Ol={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Te=Be(Ol),gl=Be([]);function qt(l,t,e){const s=l.slice();return s[26]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Tt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Et(l,t,e){const s=l.slice();return s[34]=t[e],s}function Pt(l){let t,e=l[4][l[29]],s=[];for(let r=0;r<e.length;r+=1)s[r]=At(Et(l,e,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();t=k()},m(r,n){for(let i=0;i<s.length;i+=1)s[i].m(r,n);F(r,t,n)},p(r,n){if(n[0]&2576){e=r[4][r[29]];let i;for(i=0;i<e.length;i+=1){const a=Et(r,e,i);s[i]?s[i].p(a,n):(s[i]=At(a),s[i].c(),s[i].m(t.parentNode,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=e.length}},d(r){ve(s,r),r&&O(t)}}}function At(l){let t,e,s,r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,i,a,o=l[34]+" ",u,d,p,g,m;function h(...v){return l[14](l[29],l[34],...v)}return{c(){t=_("div"),e=_("div"),s=_("span"),n=G(r),i=k(),a=_("span"),u=G(o),d=k(),p=_("span"),p.textContent="x",f(s,"class","text-blue-800 "),f(a,"class","ml-1 text-sm font-semibold"),f(p,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),f(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),f(t,"class","flex items-center justify-center")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,n),c(e,i),c(e,a),c(a,u),c(e,d),c(e,p),g||(m=[E(p,"click",h),E(e,"click",function(){vt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(v,b){l=v,b[0]&16&&r!==(r=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&W(n,r),b[0]&16&&o!==(o=l[34]+" ")&&W(u,o)},d(v){v&&O(t),g=!1,he(m)}}}function Nt(l){let t,e=l[4][l[29]].length>=1&&Pt(l);return{c(){e&&e.c(),t=Ee()},m(s,r){e&&e.m(s,r),F(s,t,r)},p(s,r){s[4][s[29]].length>=1?e?e.p(s,r):(e=Pt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function It(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,r,n;return{c(){t=_("option"),s=G(e),r=k(),t.__value=n=l[29],t.value=t.__value},m(i,a){F(i,t,a),c(t,s),c(t,r)},p(i,a){a[0]&16&&e!==(e=i[29].charAt(0).toUpperCase()+i[29].slice(1)+"")&&W(s,e),a[0]&16&&n!==(n=i[29])&&(t.__value=n,t.value=t.__value)},d(i){i&&O(t)}}}function Mt(l){let t,e,s,r,n,i,a,o,u=l[3],d=[];for(let p=0;p<u.length;p+=1)d[p]=Bt(qt(l,u,p));return{c(){t=_("div"),e=_("ul");for(let p=0;p<d.length;p+=1)d[p].c();s=k(),r=_("div"),n=_("button"),n.textContent="Close",f(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),f(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),f(r,"class","flex w-full justify-center items-center"),f(t,"class",i=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(p,g){F(p,t,g),c(t,e);for(let m=0;m<d.length;m+=1)d[m].m(e,null);c(t,s),c(t,r),c(r,n),a||(o=E(n,"click",l[22]),a=!0)},p(p,g){if(g[0]&1034){u=p[3];let m;for(m=0;m<u.length;m+=1){const h=qt(p,u,m);d[m]?d[m].p(h,g):(d[m]=Bt(h),d[m].c(),d[m].m(e,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=u.length}g[0]&32&&i!==(i=(p[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&f(t,"class",i)},d(p){p&&O(t),ve(d,p),a=!1,o()}}}function Bt(l){let t,e=l[26]+"",s,r,n,i;function a(){return l[21](l[26])}return{c(){t=_("li"),s=G(e),r=k(),f(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(o,u){F(o,t,u),c(t,s),c(t,r),n||(i=E(t,"click",a),n=!0)},p(o,u){l=o,u[0]&8&&e!==(e=l[26]+"")&&W(s,e)},d(o){o&&O(t),n=!1,i()}}}function Rt(l){let t;return{c(){t=_("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,f(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Fl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,D=Object.keys(l[4]),T=[];for(let w=0;w<D.length;w+=1)T[w]=Nt(Tt(l,D,w));let P=Object.keys(l[4]),L=[];for(let w=0;w<P.length;w+=1)L[w]=It(Ht(l,P,w));let x=l[3].length>0&&Mt(l),y=l[6]==!0&&Rt();return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div");for(let w=0;w<T.length;w+=1)T[w].c();n=k(),i=_("div"),a=_("select");for(let w=0;w<L.length;w+=1)L[w].c();o=k(),u=_("div"),d=_("input"),p=k(),g=_("div"),m=_("button"),m.textContent="Search",h=k(),x&&x.c(),v=k(),y&&y.c(),f(r,"class","flex w-full items-center my-3 flex-wrap text-lg"),f(a,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),f(a,"name","select-option"),f(a,"id","select-option"),l[1]===void 0&&ut(()=>l[16].call(a)),f(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),f(d,"type","search"),f(d,"placeholder","Enter value here"),f(u,"class","bg-blue-200 rounded-md flex-grow h-10"),f(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),f(g,"class","flex"),f(i,"class","flex space-x-2"),f(s,"class","w-full"),f(e,"class","w-full relative place-content-center"),f(t,"class","max-w-screen p-4 mx-auto")},m(w,j){F(w,t,j),c(t,e),c(e,s),c(s,r);for(let S=0;S<T.length;S+=1)T[S].m(r,null);c(s,n),c(s,i),c(i,a);for(let S=0;S<L.length;S+=1)L[S].m(a,null);Ft(a,l[1]),c(i,o),c(i,u),c(u,d),l[17](d),c(i,p),c(i,g),c(g,m),l[20](m),c(e,h),x&&x.m(e,null),c(e,v),y&&y.m(e,null),b||(C=[E(a,"change",l[15]),E(a,"change",l[16]),E(d,"focus",l[18],{once:!0}),E(d,"focusout",l[19]),E(d,"keyup",l[8]),E(d,"keydown",l[7]),E(m,"click",l[12])],b=!0)},p(w,j){if(j[0]&2576){D=Object.keys(w[4]);let S;for(S=0;S<D.length;S+=1){const V=Tt(w,D,S);T[S]?T[S].p(V,j):(T[S]=Nt(V),T[S].c(),T[S].m(r,null))}for(;S<T.length;S+=1)T[S].d(1);T.length=D.length}if(j[0]&16){P=Object.keys(w[4]);let S;for(S=0;S<P.length;S+=1){const V=Ht(w,P,S);L[S]?L[S].p(V,j):(L[S]=It(V),L[S].c(),L[S].m(a,null))}for(;S<L.length;S+=1)L[S].d(1);L.length=P.length}j[0]&18&&Ft(a,w[1]),w[3].length>0?x?x.p(w,j):(x=Mt(w),x.c(),x.m(e,v)):x&&(x.d(1),x=null),w[6]==!0?y||(y=Rt(),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:B,o:B,d(w){w&&O(t),ve(T,w),ve(L,w),l[17](null),l[20](null),x&&x.d(),y&&y.d(),b=!1,he(C)}}}async function Ll(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let r=await fetch(e,{method:"POST",body:s});return r.ok===!0?await r.json():{}}function ql(l,t,e){xe(()=>{gl.subscribe(A=>{for(let M=0;M<A.length;M++)e(4,d[A[M]]=[],d)})});const s=ft();let r="query",n,i,{query_button_disabled:a=!1}=t,o="",u=[],d={query:[]},p=!1;var g={};function m(A){g[A.keyCode]=A.type=="keydown",g[13]==!0&&A.shiftKey&&(console.log("shift enter combination."),D())}async function h(A){e(6,T=!1),g[A.keyCode]=!1;let M=A.target;if(M.value.length==0){e(3,u=[]);return}if(console.log("current value: ",M.value),A.keyCode==13){let I=d[r].length;M.value.length>0&&!d[r].includes(M.value)&&e(4,d[r][I]=M.value,d),M.value="",e(3,u=[]),e(5,p=!1);return}let H=await Ll(r,M.value);r in H?(e(3,u=H[r]),e(5,p=!0)):(e(3,u=[]),e(5,p=!1))}function v(A,M,H){let I=d[M].indexOf(H);I>=0&&(d[M].splice(I,1),e(4,d)),r==M&&e(3,u=[])}function b(A,M){e(5,p=!1),e(2,n.value=M,n),n.focus()}function C(A){e(1,r=A),e(3,u=d[r]),e(5,p=!0),n.focus()}function D(A){let M="&",H="?",I="=",U=d[r].length;n.value.length>0&&!d[r].includes(n.value)&&e(4,d[r][U]=n.value,d);let Y=Object.keys(d);o="";for(let ne=0;ne<Y.length;ne++){let Z=Y[ne],se=d[Z];o+=Z+I;for(let $=0;$<se.length;$++)o+=se[$],$!=se.length-1&&(o+=H);ne!=Y.length-1&&(o+=M)}console.log("Completed: "+o),e(2,n.value="",n),i.disabled==!1?s("queryReady",{query:o,attributes:d}):console.log("chill dawg!!!")}let T=!1;const P=(A,M,H)=>v(H.currentTarget,A,M),L=A=>C(A.target.value);function x(){r=yl(this),e(1,r),e(4,d)}function y(A){Me[A?"unshift":"push"](()=>{n=A,e(2,n)})}const w=A=>{A.target.value.length==0&&e(6,T=!0)},j=A=>{e(6,T=!1)};function S(A){Me[A?"unshift":"push"](()=>{i=A,e(0,i),e(13,a)})}const V=A=>b(r,A),z=()=>e(5,p=!1);return l.$$set=A=>{"query_button_disabled"in A&&e(13,a=A.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&i&&e(0,i.disabled=a,i)},[i,r,n,u,d,p,T,m,h,v,b,C,D,a,P,L,x,y,w,j,S,V,z]}class Hl extends Se{constructor(t){super(),Ce(this,t,ql,Fl,ke,{query_button_disabled:13},null,[-1,-1])}}function zt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function Tl(l){let t,e,s;return{c(){t=_("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',f(t,"class","px-4")},m(r,n){F(r,t,n),e||(s=E(t,"click",l[2]),e=!0)},p:B,d(r){r&&O(t),e=!1,s()}}}function El(l){let t,e,s,r,n;return{c(){t=_("span"),t.textContent="Hachi",e=k(),s=_("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',f(t,"class","px-4"),f(s,"class","cursor-pointer px-4")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a),r||(n=E(s,"click",l[3]),r=!0)},p:B,d(i){i&&O(t),i&&O(e),i&&O(s),r=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",r,n,i,a=l[8].count+"",o;return{c(){t=_("div"),e=_("div"),r=G(s),n=k(),i=_("div"),o=G(a),f(e,"class","flex"),f(e,"data-ix",l[10]),f(i,"class","px-3 flex text-black text-md text-bold"),f(t,"class","flex w-full justify-between")},m(u,d){F(u,t,d),c(t,e),c(e,r),c(t,n),c(t,i),c(i,o)},p(u,d){d&2&&s!==(s=u[8].name+"")&&W(r,s),d&2&&a!==(a=u[8].count+"")&&W(o,a)},d(u){u&&O(t)}}}function Gt(l){let t,e,s,r,n,i,a,o=l[0].sidebarOpen&&Ut(l);function u(){return l[6](l[10])}return{c(){t=_("div"),e=_("i"),r=k(),o&&o.c(),n=k(),f(e,"class",s="fa-solid fa-"+l[8].icon),f(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,p){F(d,t,p),c(t,e),c(t,r),o&&o.m(t,null),c(t,n),i||(a=E(t,"click",u),i=!0)},p(d,p){l=d,p&2&&s!==(s="fa-solid fa-"+l[8].icon)&&f(e,"class",s),l[0].sidebarOpen?o?o.p(l,p):(o=Ut(l),o.c(),o.m(t,n)):o&&(o.d(1),o=null)},d(d){d&&O(t),o&&o.d(),i=!1,a()}}}function Pl(l){let t,e,s,r,n,i;function a(g,m){return g[0].sidebarOpen?El:Tl}let o=a(l),u=o(l),d=l[1],p=[];for(let g=0;g<d.length;g+=1)p[g]=Gt(zt(l,d,g));return{c(){t=_("div"),e=_("aside"),s=_("div"),u.c(),r=k(),n=_("nav");for(let g=0;g<p.length;g+=1)p[g].c();f(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),f(n,"class","mt-6"),f(e,"class",i=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),f(t,"class","flex h-100 text-white")},m(g,m){F(g,t,m),c(t,e),c(e,s),u.m(s,null),c(e,r),c(e,n);for(let h=0;h<p.length;h+=1)p[h].m(n,null)},p(g,[m]){if(o===(o=a(g))&&u?u.p(g,m):(u.d(1),u=o(g),u&&(u.c(),u.m(s,null))),m&19){d=g[1];let h;for(h=0;h<d.length;h+=1){const v=zt(g,d,h);p[h]?p[h].p(v,m):(p[h]=Gt(v),p[h].c(),p[h].m(n,null))}for(;h<p.length;h+=1)p[h].d(1);p.length=d.length}m&1&&i!==(i=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&f(e,"class",i)},i:B,o:B,d(g){g&&O(t),u.d(),ve(p,g)}}}function Al(l,t,e){const s=ft();let{sidebarOpen:r=!1}=t;const n={sidebarOpen:r},i=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0},{icon:"folder",path:"#",name:"Local",count:0},{icon:"image",path:"#",name:"Google Photos",count:0}];xe(()=>{wt.subscribe(p=>{i&&e(1,i[0].count=p,i)}),yt.subscribe(p=>{i&&e(1,i[3].count=p,i)}),xt.subscribe(p=>{i&&e(1,i[4].count=p,i)}),ml.subscribe(p=>{i&&e(1,i[5].count=p,i)})});function a(){e(0,n.sidebarOpen=!0,n)}function o(){e(0,n.sidebarOpen=!1,n)}function u(p){s("menuClick",{item:i[p]})}const d=p=>{u(p)};return l.$$set=p=>{"sidebarOpen"in p&&e(5,r=p.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,i,a,o,u,r,d]}class Ge extends Se{constructor(t){super(),Ce(this,t,Al,Pl,ke,{sidebarOpen:5})}}function Nl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m=(l[3]*100).toString().slice(0,4)+"",h,v,b,C,D,T,P,L,x,y,w,j,S,V,z,A,M,H,I,U,Y,ne,Z,se,$,ge,ee,X,fe,ae,re,De,je,Oe,_e,qe,be,we,pe;return{c(){t=_("div"),e=_("p"),e.textContent="Press Start button to start indexing",s=k(),r=_("div"),n=_("input"),i=k(),a=_("div"),o=_("div"),u=_("div"),d=_("div"),p=k(),g=_("div"),h=G(m),v=G("%"),b=k(),C=_("div"),D=G("Current directory: "),T=_("span"),P=G(l[4]),L=k(),x=_("span"),x.textContent="ETA:",y=k(),w=_("span"),j=G(l[6]),S=k(),V=_("div"),z=G("Details: "),A=_("span"),M=G(l[5]),H=k(),I=_("div"),U=_("div"),Y=_("input"),ne=k(),Z=_("label"),Z.textContent="Complete Rescan",se=k(),$=_("div"),$.textContent="Re-index all originals, including already indexed and unchanged files.",ge=k(),ee=_("div"),X=_("select"),fe=_("option"),fe.textContent="Images Only",ae=_("option"),ae.textContent="Videos Only",re=_("option"),re.textContent="Videos and Images",De=k(),je=_("div"),je.textContent="Filter by content type",Oe=k(),_e=_("button"),_e.textContent="Cancel",qe=k(),be=_("button"),be.textContent="Start",f(e,"class","mb-2 text-sm font-semibold"),f(n,"type","text"),f(n,"class","w-full rounded border p-1 text-sm"),f(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,f(r,"class","my-2"),f(d,"class","h-2rounded bg-blue-500"),de(d,"width",(l[3]*100).toString()+"%"),f(u,"class","flex h-2 w-11/12 rounded bg-gray-300"),f(g,"class","flex px-2 font-semibold"),f(o,"class","flex items-center"),f(T,"class","text-black"),f(x,"class","pl-3 text-right"),f(w,"class","text-black"),f(C,"class","pt-1 text-sm text-blue-600"),f(A,"class","text-black"),f(V,"class","pt-1 text-sm text-blue-600"),f(a,"class","mb-3"),f(Y,"type","checkbox"),f(Y,"class","h-5 w-5 text-blue-500"),f(Z,"class","ml-1"),f(U,"class","mr-2 flex items-center"),f($,"class","text-sm text-gray-600"),f(I,"class","mt-4 mb-3 flex flex-wrap items-center"),fe.__value="Images Only",fe.value=fe.__value,ae.disabled=!0,ae.__value="Videos Only",ae.value=ae.__value,re.disabled=!0,re.__value="Videos and Images",re.value=re.__value,f(X,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),f(je,"class","ml-2 text-sm text-gray-600"),f(ee,"class","mb-3 mt-3 flex flex-wrap items-center"),_e.disabled=!0,f(_e,"type","button"),f(_e,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),f(be,"type","button"),f(be,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),f(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(q,N){F(q,t,N),c(t,e),c(t,s),c(t,r),c(r,n),l[12](n),ct(n,l[7]),c(t,i),c(t,a),c(a,o),c(o,u),c(u,d),c(o,p),c(o,g),c(g,h),c(g,v),c(a,b),c(a,C),c(C,D),c(C,T),c(T,P),c(C,L),c(C,x),c(C,y),c(C,w),c(w,j),c(a,S),c(a,V),c(V,z),c(V,A),c(A,M),c(t,H),c(t,I),c(I,U),c(U,Y),Y.checked=l[8],c(U,ne),c(U,Z),c(I,se),c(I,$),c(t,ge),c(t,ee),c(ee,X),c(X,fe),c(X,ae),c(X,re),c(ee,De),c(ee,je),c(t,Oe),c(t,_e),l[16](_e),c(t,qe),c(t,be),l[17](be),we||(pe=[E(n,"input",l[13]),E(n,"keydown",l[14]),E(Y,"change",l[15]),E(_e,"click",l[10]),E(be,"click",l[9])],we=!0)},p(q,[N]){N&128&&n.value!==q[7]&&ct(n,q[7]),N&8&&de(d,"width",(q[3]*100).toString()+"%"),N&8&&m!==(m=(q[3]*100).toString().slice(0,4)+"")&&W(h,m),N&16&&W(P,q[4]),N&64&&W(j,q[6]),N&32&&W(M,q[5]),N&256&&(Y.checked=q[8])},i:B,o:B,d(q){q&&O(t),l[12](null),l[16](null),l[17](null),we=!1,he(pe)}}}function Il(l,t,e){let s,r,n;xe(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let y="/api/getIndexStatus/"+s;e(0,r.disabled=!1,r),e(1,n.disabled=!0,n),m(y)}}),Qe(()=>{g&&clearTimeout(g)});let i,a=.001,o="",u="",d="",p="",g;async function m(y,w=0){w==0&&console.log("starting a new polll...");let S=await(await fetch(y,{method:"GET"})).json();if(S.is_active==!0){if(S.done==!0){let z=S.details,A=new FormData;A.append("ack","true"),(await fetch(y,{method:"POST",body:A})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert(`Indexing Completed.
Final Status: `+z);let H=await fetch("/api/getMetaStats");H=await H.json(),wt.update(I=>Number(H.image.count)),yt.update(I=>Number(H.image.unique_people_count)),xt.update(I=>Number(H.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,a=0),e(4,o=""),e(6,d=""),e(5,u=""),e(7,p=""),e(0,r.disabled=!0,r),e(0,r.innerText="Cancel",r),e(2,i.disabled=!1,i);return}e(3,a=S.progress),e(6,d=S.eta),e(5,u=S.details),e(4,o=S.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(y,w+1)},1e3)}}let h=!1;async function v(){if(n&&p){e(1,n.disabled=!0,n),e(2,i.disabled=!0,i);let y=new FormData;y.append("image_directory_path",p),y.append("complete_rescan",h.toString());let S=await(await fetch("/api/indexStart",{method:"POST",body:y})).json();if(S.success===!0){e(0,r.disabled=!1,r);let z="/api/getIndexStatus/"+S.statusEndpoint;e(11,s=S.statusEndpoint),m(z)}else alert(S.reason),e(1,n.disabled=!1,n),e(2,i.disabled=!1,i)}else console.log("No index_start_button object found!!!")}async function b(){if(s){e(0,r.disabled=!0,r),e(0,r.innerText="Cancelling... Please wait.",r);let y="/api/indexCancel/"+s,w=await fetch(y,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!w.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(w);return}else return}function C(y){Me[y?"unshift":"push"](()=>{i=y,e(2,i)})}function D(){p=this.value,e(7,p)}const T=y=>{y.key==="Enter"&&n.click()};function P(){h=this.checked,e(8,h)}function L(y){Me[y?"unshift":"push"](()=>{r=y,e(0,r)})}function x(y){Me[y?"unshift":"push"](()=>{n=y,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[r,n,i,a,o,u,d,p,h,v,b,s,C,D,T,P,L,x]}class Ml extends Se{constructor(t){super(),Ce(this,t,Il,Nl,ke,{})}}function Vt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=_("i"),f(t,"class","fa fa-plus text-xs text-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function Wt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),r,n,i,a=l[13]+"",o,u,d,p=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=_("div"),e=_("div"),p&&p.c(),n=k(),i=_("span"),o=G(a),f(e,"class",r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),f(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){F(m,t,h),c(t,e),p&&p.m(e,null),c(t,n),c(t,i),c(i,o),u||(d=E(t,"click",g),u=!0)},p(m,h){l=m,h&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?p||(p=Xt(),p.c(),p.m(e,null)):p&&(p.d(1),p=null),h&2&&r!==(r="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&f(e,"class",r),h&2&&a!==(a=l[13]+"")&&W(o,a)},d(m){m&&O(t),p&&p.d(),u=!1,d()}}}function Qt(l){let t,e,s=l[10]+"",r,n,i,a,o,u,d,p,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,v=[];for(let b=0;b<h.length;b+=1)v[b]=Wt(Kt(l,h,b));return{c(){t=_("div"),e=_("div"),r=G(s),n=k(),i=_("i"),o=k(),u=_("div");for(let b=0;b<v.length;b+=1)v[b].c();f(i,"class",a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),f(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),f(u,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),f(t,"class","relative")},m(b,C){F(b,t,C),c(t,e),c(e,r),c(e,n),c(e,i),c(t,o),c(t,u);for(let D=0;D<v.length;D+=1)v[D].m(u,null);p||(g=[E(e,"click",m),E(t,"mouseup",Gl)],p=!0)},p(b,C){if(l=b,C&2&&s!==(s=l[10]+"")&&W(r,s),C&2&&a!==(a="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&f(i,"class",a),C&6){h=l[1].selectFilters[l[10]].options;let D;for(D=0;D<h.length;D+=1){const T=Kt(l,h,D);v[D]?v[D].p(T,C):(v[D]=Wt(T),v[D].c(),v[D].m(u,null))}for(;D<v.length;D+=1)v[D].d(1);v.length=h.length}C&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&f(u,"class",d)},d(b){b&&O(t),ve(v,b),p=!1,he(g)}}}function Bl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m=Object.keys(l[1].selectFilters),h=[];for(let v=0;v<m.length;v+=1)h[v]=Qt(Vt(l,m,v));return{c(){t=_("div"),e=_("div"),s=_("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=k(),n=_("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=k();for(let v=0;v<h.length;v+=1)h[v].c();a=k(),o=_("button"),u=G("Filter"),f(s,"class","flex items-center text-md"),f(n,"class","flex items-center text-md"),o.disabled=l[0],f(o,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),f(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),f(t,"class","flex container mx-auto max-w-4xl")},m(v,b){F(v,t,b),c(t,e),c(e,s),c(e,r),c(e,n),c(e,i);for(let C=0;C<h.length;C+=1)h[C].m(e,null);c(e,a),c(e,o),c(o,u),p||(g=E(o,"click",l[4]),p=!0)},p(v,[b]){if(b&14){m=Object.keys(v[1].selectFilters);let C;for(C=0;C<m.length;C+=1){const D=Vt(v,m,C);h[C]?h[C].p(D,b):(h[C]=Qt(D),h[C].c(),h[C].m(e,a))}for(;C<h.length;C+=1)h[C].d(1);h.length=m.length}b&1&&(o.disabled=v[0]),b&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(v[0]===!0?"disabled":""))&&f(o,"class",d)},i:B,o:B,d(v){v&&O(t),ve(h,v),p=!1,g()}}}function bl(l,t,e=null,s=(r,n)=>r===n){let r=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?r.push(1):r.push(0):s(l[n],t)?r.push(1):r.push(0);return r}function Rl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=bl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function zl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let r=bl(l,t[s],null,(n,i)=>n?n.includes(i):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(r[n]))}return e}function Ul(l){let t=l[0].length,e=l[0];return l.forEach((s,r)=>{if(r>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,i)=>{e[i]=Number(Boolean(e[i])&&Boolean(n))})}}),e}const Gl=l=>l.stopPropagation();function Vl(l,t,e){let s=[],{filter_button_disabled:r=!0}=t;at.subscribe(m=>{e(0,r=!1),e(5,s=m)});const n=ft(),i={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};xe(()=>{document.addEventListener("mouseup",a)});function a(m){e(1,i.selectFilterActive="",i)}function o(m,h){if(i.selectFilters[m].values.includes(h)){e(1,i.selectFilters[m].values=i.selectFilters[m].values.filter(v=>v!==h),i);return}e(1,i.selectFilters[m].values=[h,...i.selectFilters[m].values],i)}function u(m){if(i.selectFilterActive===m){e(1,i.selectFilterActive="",i);return}e(1,i.selectFilterActive=m,i)}function d(){if(s){console.log(s);let m=[],h=[];s.map((P,L)=>{m.push(P.place),h.push(P.person)});let v=i.selectFilters.place.values,b=Rl(m,v),C=i.selectFilters.people.values,D=zl(h,C),T=Ul([b,D]);n("filterApplied",{mask:T})}}const p=m=>u(m),g=(m,h)=>o(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,r=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((C,D)=>{if(C.place)return C.place}),h=[];s.map((C,D)=>{C.person&&C.person.forEach(T=>h.push(T))});let v=[];new Set(m).forEach(C=>v.push(C));let b=[];new Set(h).forEach(C=>b.push(C)),e(1,i.selectFilters.place.values=v,i),e(1,i.selectFilters.place.options=v,i),e(1,i.selectFilters.people.values=b,i),e(1,i.selectFilters.people.options=b,i)}},[r,i,o,u,d,s,p,g]}class Kl extends Se{constructor(t){super(),Ce(this,t,Vl,Bl,ke,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[53]=t[e],s[52]=e,s}function Yt(l,t,e){const s=l.slice();return s[50]=t[e],s[52]=e,s}function Xl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,D,T,P,L=l[1]&&Zt(l);e=new Kl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[41]);let x=l[6],y=[];for(let j=0;j<x.length;j+=1)y[j]=el(Jt(l,x,j));let w=l[6].length>=Le&&tl(l);return{c(){L&&L.c(),t=k(),ue(e.$$.fragment),s=k(),r=_("div"),n=_("div"),i=_("div"),a=_("div"),o=_("div"),u=_("input"),d=k(),p=_("label"),g=G("Score threshold: "),m=G(l[11]),h=G("."),v=k(),b=_("div");for(let j=0;j<y.length;j+=1)y[j].c();C=k(),w&&w.c(),f(u,"type","range"),f(u,"min","0"),f(u,"max","1.0"),f(u,"step","0.01"),f(u,"class","w-full"),f(p,"for","topk"),f(p,"class","dark:text-white"),f(o,"class","my-2"),f(i,"class","flex flex-row place-content-center mb-2 select-none mx-2"),f(b,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),f(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),f(r,"class","flex")},m(j,S){L&&L.m(j,S),F(j,t,S),ie(e,j,S),F(j,s,S),F(j,r,S),c(r,n),c(n,i),c(i,a),c(a,o),c(o,u),ct(u,l[11]),c(o,d),c(o,p),c(p,g),c(p,m),c(p,h),c(n,v),c(n,b);for(let V=0;V<y.length;V+=1)y[V].m(b,null);c(n,C),w&&w.m(n,null),D=!0,T||(P=[E(u,"change",l[19]),E(u,"change",l[42]),E(u,"input",l[42])],T=!0)},p(j,S){j[1]?L?L.p(j,S):(L=Zt(j),L.c(),L.m(t.parentNode,t)):L&&(L.d(1),L=null);const V={};if(S[0]&8&&(V.filter_button_disabled=j[3]),e.$set(V),S[0]&2048&&ct(u,j[11]),(!D||S[0]&2048)&&W(m,j[11]),S[0]&16826433){x=j[6];let z;for(z=0;z<x.length;z+=1){const A=Jt(j,x,z);y[z]?y[z].p(A,S):(y[z]=el(A),y[z].c(),y[z].m(b,null))}for(;z<y.length;z+=1)y[z].d(1);y.length=x.length}j[6].length>=Le?w?w.p(j,S):(w=tl(j),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i(j){D||(Q(e.$$.fragment,j),D=!0)},o(j){J(e.$$.fragment,j),D=!1},d(j){L&&L.d(j),j&&O(t),oe(e,j),j&&O(s),j&&O(r),ve(y,j),w&&w.d(),T=!1,he(P)}}}function Wl(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,D,T,P,L,x=l[2].image_card_edit_interface&&ll(l),y=l[5]&&sl(l);return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,r=k(),n=_("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',i=k(),a=_("div"),o=_("div"),o.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',u=k(),d=_("div"),p=_("div"),g=_("img"),h=k(),v=_("div"),v.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',b=k(),x&&x.c(),C=k(),D=_("div"),D.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',T=k(),y&&y.c(),f(s,"class","cursor-pointer hover:underline text-gray-200"),f(n,"title","Fullscreen"),f(n,"class","cursor-pointer"),f(e,"class","flex h-6 items-center justify-between"),f(o,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),f(g,"class","w-auto cursor-pointer h-full"),ye(g.src,m="/api/getRawData/"+l[4].data_hash)||f(g,"src",m),f(g,"alt",""),f(v,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),f(p,"class","flex shrink h-full"),f(d,"class","flex h-full items-center justify-center p-2 gap-4"),f(D,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),f(a,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),f(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(w,j){F(w,t,j),c(t,e),c(e,s),c(e,r),c(e,n),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(d,p),c(p,g),c(p,h),c(p,v),c(d,b),x&&x.m(d,null),c(a,C),c(a,D),c(t,T),y&&y.m(t,null),P||(L=[E(s,"click",l[33]),E(n,"click",l[34]),E(o,"click",l[35]),E(g,"click",l[36]),E(v,"click",l[37]),E(D,"click",l[39])],P=!0)},p(w,j){j[0]&16&&!ye(g.src,m="/api/getRawData/"+w[4].data_hash)&&f(g,"src",m),w[2].image_card_edit_interface?x?x.p(w,j):(x=ll(w),x.c(),x.m(d,null)):x&&(x.d(1),x=null),w[5]?y?y.p(w,j):(y=sl(w),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i:B,o:B,d(w){w&&O(t),x&&x.d(),y&&y.d(),P=!1,he(L)}}}function Ql(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,D,T=l[10],P=[];for(let x=0;x<T.length;x+=1)P[x]=nl(Yt(l,T,x));let L=l[9].active&&rl(l);return{c(){t=_("div"),e=_("div"),s=_("img"),n=k();for(let x=0;x<P.length;x+=1)P[x].c();i=k(),L&&L.c(),a=k(),o=_("div"),u=_("div"),u.innerHTML='<i class="fa fa-arrow-left"></i>',d=k(),p=_("div"),p.innerHTML='<i class="fa fa-arrow-right"></i>',g=k(),m=_("div"),h=_("div"),h.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,v=k(),b=_("div"),b.innerHTML='<i class="fa fa-arrows-alt"></i>',f(s,"class","object-cover h-screen w-auto"),ye(s.src,r="/api/getRawDataFull/"+l[4].data_hash)||f(s,"src",r),f(s,"alt",""),f(e,"class","relative flex"),f(u,"class","text-white cursor-pointer"),f(p,"class","text-white cursor-pointer"),f(o,"class","absolute flex mx-auto items-center justify-between w-screen"),f(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),f(h,"class","cursor-pointer hover:underline text-white"),f(b,"title","Fullscreen"),f(b,"class","cursor-pointer text-white"),f(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(x,y){F(x,t,y),c(t,e),c(e,s),c(e,n);for(let w=0;w<P.length;w+=1)P[w].m(e,null);c(e,i),L&&L.m(e,null),c(t,a),c(t,o),c(o,u),c(o,d),c(o,p),F(x,g,y),F(x,m,y),c(m,h),c(m,v),c(m,b),C||(D=[E(s,"load",l[18]),E(u,"click",l[29]),E(p,"click",l[30]),E(h,"click",l[31]),E(b,"click",l[32])],C=!0)},p(x,y){if(y[0]&16&&!ye(s.src,r="/api/getRawDataFull/"+x[4].data_hash)&&f(s,"src",r),y[0]&1792){T=x[10];let w;for(w=0;w<T.length;w+=1){const j=Yt(x,T,w);P[w]?P[w].p(j,y):(P[w]=nl(j),P[w].c(),P[w].m(e,i))}for(;w<P.length;w+=1)P[w].d(1);P.length=T.length}x[9].active?L?L.p(x,y):(L=rl(x),L.c(),L.m(e,null)):L&&(L.d(1),L=null)},i:B,o:B,d(x){x&&O(t),ve(P,x),L&&L.d(),x&&O(g),x&&O(m),C=!1,he(D)}}}function Zt(l){let t,e,s,r,n;return{c(){t=_("div"),e=_("div"),s=_("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,f(s,"class","cursor-pointer hover:underline text-black"),f(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),f(t,"class","flex")},m(i,a){F(i,t,a),c(t,e),c(e,s),r||(n=E(s,"click",l[40]),r=!0)},p:B,d(i){i&&O(t),r=!1,n()}}}function $t(l){let t,e,s,r,n,i;function a(){return l[43](l[52])}return{c(){t=_("div"),e=_("img"),r=k(),f(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),ye(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])||f(e,"src",s),f(e,"alt","image"),f(t,"class","flex justify-center bg-black")},m(o,u){F(o,t,u),c(t,e),c(t,r),n||(i=[E(e,"load",l[24]),E(t,"click",a)],n=!0)},p(o,u){l=o,u[0]&65&&!ye(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])&&f(e,"src",s)},d(o){o&&O(t),n=!1,he(i)}}}function el(l){let t,e=l[53].ix>=0&&$t(l);return{c(){e&&e.c(),t=Ee()},m(s,r){e&&e.m(s,r),F(s,t,r)},p(s,r){s[53].ix>=0?e?e.p(s,r):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&O(t)}}}function tl(l){let t,e,s,r;return{c(){t=_("div"),e=_("button"),e.textContent="More results ..",f(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),f(t,"class","flex items-center justify-center")},m(n,i){F(n,t,i),c(t,e),s||(r=E(e,"click",l[13]),s=!0)},p:B,d(n){n&&O(t),s=!1,r()}}}function ll(l){let t,e,s,r,n,i,a,o,u,d,p,g,m,h,v,b,C,D,T,P,L,x,y,w,j,S,V,z,A,M,H,I,U,Y,ne,Z,se,$,ge;return{c(){t=_("div"),e=_("div"),s=_("div"),s.textContent="Info",r=k(),n=_("div"),n.textContent="X",i=k(),a=_("div"),o=_("div"),o.textContent="Description",u=k(),d=_("input"),g=k(),m=_("div"),h=_("div"),h.textContent="place",v=k(),b=_("input"),D=k(),T=_("div"),P=_("div"),P.textContent="Tags",L=k(),x=_("input"),w=k(),j=_("div"),S=_("div"),S.textContent="Taken at:",V=k(),z=_("input"),A=k(),M=_("div"),H=_("div"),H.textContent="device",I=k(),U=_("input"),ne=k(),Z=_("div"),se=_("button"),se.textContent="Save",f(s,"class","grow text-xl text-gray-100 font-bold"),f(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),f(e,"class","flex items-center"),f(o,"class","mb-1 text-gray-100"),f(d,"name","Description"),f(d,"placeholder",""),d.value=p=l[4].description.toString(),f(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(d,"type","text"),f(h,"class","mb-1 text-gray-100"),f(b,"name","place"),b.value=C=l[4].place.toString(),f(b,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(b,"type","text"),f(P,"class","mb-1 text-gray-100"),f(x,"name","tags"),f(x,"placeholder","Car, chair"),x.value=y=l[4].tags.toString(),f(x,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(x,"type","text"),f(S,"class","mb-1 text-gray-100"),f(z,"name","taken_at"),z.value="",f(z,"type","date"),f(z,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(H,"class","mb-1 text-gray-100"),f(U,"name","device"),f(U,"placeholder","Canon"),U.value=Y=l[4].device.toString(),f(U,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),f(U,"type","text"),f(se,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),f(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(ee,X){F(ee,t,X),c(t,e),c(e,s),c(e,r),c(e,n),c(t,i),c(t,a),c(a,o),c(a,u),c(a,d),c(t,g),c(t,m),c(m,h),c(m,v),c(m,b),c(t,D),c(t,T),c(T,P),c(T,L),c(T,x),c(t,w),c(t,j),c(j,S),c(j,V),c(j,z),c(t,A),c(t,M),c(M,H),c(M,I),c(M,U),c(t,ne),c(t,Z),c(Z,se),$||(ge=[E(n,"click",l[38]),E(d,"change",l[22]),E(b,"change",l[22]),E(x,"change",l[22]),E(z,"change",l[22]),E(U,"change",l[22]),E(se,"click",l[23])],$=!0)},p(ee,X){X[0]&16&&p!==(p=ee[4].description.toString())&&d.value!==p&&(d.value=p),X[0]&16&&C!==(C=ee[4].place.toString())&&b.value!==C&&(b.value=C),X[0]&16&&y!==(y=ee[4].tags.toString())&&x.value!==y&&(x.value=y),X[0]&16&&Y!==(Y=ee[4].device.toString())&&U.value!==Y&&(U.value=Y)},d(ee){ee&&O(t),$=!1,he(ge)}}}function sl(l){let t,e,s,r,n=l[4].filename+"",i,a,o,u,d,p=l[4].data_hash+"",g,m,h,v,b,C=l[4].last_modified+"",D,T,P,L,x,y,w,j,S,V=l[4].description.toString()+"",z,A,M,H,I,U,Y=l[4].taken_at.toString()+"",ne,Z,se,$,ge,ee,X=l[4].tags.toString()+"",fe,ae,re,De,je,Oe,_e=l[4].place.toString()+"",qe,be,we,pe,q,N,K,te,R=l[4].person_ids.toString()+"",Fe,Ze,Pe,He,me,Ae,Ne=l[4].device.toString()+"",_t,Ct,Ve,$e,St,et,tt=l[4].resolution.toString()+"",pt,Dt,Ke,lt,jt,st,nt=l[4].absolute_path.toString()+"",ht;return{c(){t=_("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=k(),s=_("div"),r=_("div"),i=G(n),a=k(),o=_("div"),u=G("UID: "),d=_("span"),g=G(p),m=k(),h=_("div"),v=G("Last Modified:  "),b=_("span"),D=G(C),T=k(),P=_("div"),L=_("div"),x=_("div"),y=_("div"),w=_("div"),w.textContent="Description",j=k(),S=_("div"),z=G(V),A=k(),M=_("div"),H=_("div"),H.textContent="Taken at",I=k(),U=_("div"),ne=G(Y),Z=k(),se=_("div"),$=_("div"),$.textContent="Tags",ge=k(),ee=_("div"),fe=G(X),ae=k(),re=_("div"),De=_("div"),De.textContent="Place",je=k(),Oe=_("div"),qe=G(_e),be=k(),we=_("div"),pe=_("div"),q=_("div"),N=_("div"),N.textContent="people",K=k(),te=_("div"),Fe=G(R),Ze=k(),Pe=_("div"),He=_("div"),He.textContent="Device",me=k(),Ae=_("div"),_t=G(Ne),Ct=k(),Ve=_("div"),$e=_("div"),$e.textContent="Resolution",St=k(),et=_("div"),pt=G(tt),Dt=k(),Ke=_("div"),lt=_("div"),lt.textContent="Path",jt=k(),st=_("div"),ht=G(nt),f(r,"class","text-xl text-white"),f(d,"class","text-sm text-gray-400"),f(o,"class","text-white"),f(b,"class","text-sm text-gray-400"),f(h,"class","text-white"),f(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),f(w,"class",""),f(S,"class","text-sm text-gray-400"),f(H,"class",""),f(U,"class","text-sm text-gray-400"),f($,"class",""),f(ee,"class","text-sm text-gray-400"),f(De,"class",""),f(Oe,"class","text-sm text-gray-400"),f(x,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(L,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),f(N,"class",""),f(te,"class","text-sm text-gray-400"),f(He,"class",""),f(Ae,"class","text-sm text-gray-400"),f($e,"class",""),f(et,"class","text-sm text-gray-400"),f(lt,"class",""),f(st,"class","text-sm text-gray-400"),f(pe,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),f(we,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),f(P,"class","flex w-full justify-center p-4")},m(le,ce){F(le,t,ce),F(le,e,ce),F(le,s,ce),c(s,r),c(r,i),c(s,a),c(s,o),c(o,u),c(o,d),c(d,g),c(s,m),c(s,h),c(h,v),c(h,b),c(b,D),F(le,T,ce),F(le,P,ce),c(P,L),c(L,x),c(x,y),c(y,w),c(y,j),c(y,S),c(S,z),c(x,A),c(x,M),c(M,H),c(M,I),c(M,U),c(U,ne),c(x,Z),c(x,se),c(se,$),c(se,ge),c(se,ee),c(ee,fe),c(x,ae),c(x,re),c(re,De),c(re,je),c(re,Oe),c(Oe,qe),c(P,be),c(P,we),c(we,pe),c(pe,q),c(q,N),c(q,K),c(q,te),c(te,Fe),c(pe,Ze),c(pe,Pe),c(Pe,He),c(Pe,me),c(Pe,Ae),c(Ae,_t),c(pe,Ct),c(pe,Ve),c(Ve,$e),c(Ve,St),c(Ve,et),c(et,pt),c(pe,Dt),c(pe,Ke),c(Ke,lt),c(Ke,jt),c(Ke,st),c(st,ht)},p(le,ce){ce[0]&16&&n!==(n=le[4].filename+"")&&W(i,n),ce[0]&16&&p!==(p=le[4].data_hash+"")&&W(g,p),ce[0]&16&&C!==(C=le[4].last_modified+"")&&W(D,C),ce[0]&16&&V!==(V=le[4].description.toString()+"")&&W(z,V),ce[0]&16&&Y!==(Y=le[4].taken_at.toString()+"")&&W(ne,Y),ce[0]&16&&X!==(X=le[4].tags.toString()+"")&&W(fe,X),ce[0]&16&&_e!==(_e=le[4].place.toString()+"")&&W(qe,_e),ce[0]&16&&R!==(R=le[4].person_ids.toString()+"")&&W(Fe,R),ce[0]&16&&Ne!==(Ne=le[4].device.toString()+"")&&W(_t,Ne),ce[0]&16&&tt!==(tt=le[4].resolution.toString()+"")&&W(pt,tt),ce[0]&16&&nt!==(nt=le[4].absolute_path.toString()+"")&&W(ht,nt)},d(le){le&&O(t),le&&O(e),le&&O(s),le&&O(T),le&&O(P)}}}function nl(l){let t,e,s;function r(...n){return l[27](l[50],...n)}return{c(){t=_("div"),f(t,"data-ix",l[52]),f(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),de(t,"top",l[50].top+"px "),de(t,"left",l[50].left+"px"),de(t,"width",l[50].width+"px"),de(t,"height",l[50].height+"px")},m(n,i){F(n,t,i),e||(s=E(t,"click",r),e=!0)},p(n,i){l=n,i[0]&1024&&de(t,"top",l[50].top+"px "),i[0]&1024&&de(t,"left",l[50].left+"px"),i[0]&1024&&de(t,"width",l[50].width+"px"),i[0]&1024&&de(t,"height",l[50].height+"px")},d(n){n&&O(t),e=!1,s()}}}function rl(l){let t,e,s,r,n,i,a;return{c(){t=_("div"),e=_("input"),r=k(),n=_("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[8]],f(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),f(e,"placeholder","Enter person id"),f(e,"type","text"),f(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),f(t,"class","absolute flex h-auto w-240 bg-blue-300"),de(t,"top",l[9].top+"px "),de(t,"left",l[9].left+"px")},m(o,u){F(o,t,u),c(t,e),c(t,r),c(t,n),e.focus(),i||(a=[E(e,"keyup",l[21]),E(n,"click",l[28])],i=!0)},p(o,u){u[0]&272&&s!==(s=o[4].person_ids[o[8]])&&e.value!==s&&(e.value=s),u[0]&512&&de(t,"top",o[9].top+"px "),u[0]&512&&de(t,"left",o[9].left+"px")},d(o){o&&O(t),i=!1,he(a)}}}function Jl(l){let t,e,s,r,n,i;const a=[Ql,Wl,Xl],o=[];function u(d,p){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=u(l),e=o[t]=a[t](l),{c(){e.c(),s=k(),r=_("div"),n=_("div"),f(n,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),de(n,"width",(l[7]*100).toString()+"%"),f(r,"class","flex animate-pulse")},m(d,p){o[t].m(d,p),F(d,s,p),F(d,r,p),c(r,n),i=!0},p(d,p){let g=t;t=u(d),t===g?o[t].p(d,p):(Je(),J(o[g],1,1,()=>{o[g]=null}),Ye(),e=o[t],e?e.p(d,p):(e=o[t]=a[t](d),e.c()),Q(e,1),e.m(s.parentNode,s)),(!i||p[0]&128)&&de(n,"width",(d[7]*100).toString()+"%")},i(d){i||(Q(e),i=!0)},o(d){J(e),i=!1},d(d){o[t].d(d),d&&O(s),d&&O(r)}}}let Le=18;function gt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let r=0;r<l.length;r++){let n=r;t[r%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[r][e]}):s.push({ix:n,score:l[r]})}return s.sort((r,n)=>r.score>n.score?-1:r.score<n.score?1:0),s}function Yl(l,t,e){const s=ft();let{show_exit_interface_button:r=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,i=!0;Qe(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),at.update(q=>[])});let a={},o=!1,u=[],d=[],p=0,g=0,m=0,h=!1;function v(q){h!=!0&&(h=!0,g=0,e(7,m=0),e(26,p=p+Le),e(6,u=d.slice(p,p+Le)),at.update(N=>b(u)))}function b(q){let N=[],K=q.length;for(let te=0;te<K;te++){let R=q[te].ix;N.push(n.list_metaData[R])}return N}Te.subscribe(q=>{e(7,m=q.progress),q.done==!0?(C(q),e(7,m=0)):(e(26,p=0),e(6,u=[]))});function C(q){e(25,d=gt(q.list_score)),e(6,u=d.slice(0,0+Le)),at.update(N=>b(u))}let D={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function T(q){let N=Object.keys(D);for(let K=0;K<N.length;K++)e(2,D[N[K]]=!1,D);e(2,D[q]=!0,D)}let P,L={active:!1,top:null,left:null};function x(q){let N={sorted_ix:null,image_ix:null};for(let K=q;K<u.length;K++)if(u[K].ix!==-1){N.image_ix=u[K].ix,N.sorted_ix=K;break}return N}function y(q){I={},e(5,o=!1),e(10,S=[]),e(9,L={active:!1,top:null,left:null});let N=q,K=u.length;N<0&&(N=K-1),N>K-1&&(N=0);let te=x(N),R=te.image_ix;N=te.sorted_ix,R===null&&(te=x(0),R=te.image_ix,N=te.sorted_ix),e(4,a.ix=N,a),e(4,a.data_hash=n.list_dataHash[R],a),e(4,a.height=Number(n.list_metaData[R].height),a),e(4,a.width=Number(n.list_metaData[R].width),a),e(4,a.face_bboxes=n.list_metaData[R].face_bboxes,a),e(4,a.person_ids=n.list_metaData[R].person,a),a.person_ids===null&&e(4,a.person_ids=[],a),e(4,a.resolution=a.height.toString()+" X "+a.width.toString(),a),e(4,a.filename=n.list_metaData[R].filename,a),e(4,a.taken_at=n.list_metaData[R].taken_at,a),a.taken_at==null&&e(4,a.taken_at="Unknown",a),e(4,a.last_modified=n.list_metaData[R].modified_at,a),e(4,a.device=n.list_metaData[R].device,a),a.device==null&&e(4,a.device="",a),e(4,a.place=n.list_metaData[R].place,a),e(4,a.absolute_path=n.list_metaData[R].absolute_path,a),e(4,a.description=n.list_metaData[R].description,a),e(4,a.tags=n.list_metaData[R].tags,a),e(5,o=!0)}function w(){y(a.ix+1)}function j(){y(a.ix-1)}let S=[];function V(q){let N=q.target.getClientRects()[0],K=N.width,te=N.height,R=[],Fe=a.face_bboxes;if(Fe){let Ze=a.width,Pe=a.height;for(let He=0;He<Fe.length;He++){let me=structuredClone(Fe[He]),Ae=Number(K)/(Number(Ze)+1e-4),Ne=Number(te)/(Number(Pe)+1e-4);me.top=me[1]*Ne,me.height=(me[3]-me[1])*Ne,me.left=me[0]*Ae,me.width=(me[2]-me[0])*Ae,R.push(me)}}console.log(R),e(10,S=R)}let z=0;function A(){let q=u[0].score,N=u[u.length-1].score,te=n.list_score.map(R=>(R-N)/(q-N+1e-5)).map(R=>R>=z?1:0);e(6,u=gt(n.list_score,te))}function M(q){e(3,i=!0);let N=d.slice(p,p+Le);for(let K=0;K<q.length;K++)q[K]==0?e(6,u[K].ix=-1,u):e(6,u[K].ix=N[K].ix,u);e(3,i=!1)}function H(q){let N=q.target.value,K=a.data_hash,te=a.person_ids[P];if(q.key=="Enter"){let R=new FormData;R.append("new_person_id",N),R.append("old_person_id",te),R.append("data_hash",K),fetch("/api/tagPerson",{method:"POST",body:R}).then(Fe=>{if(Fe.ok)alert("Success");else throw new Error("Error occured")})}}let I={};function U(q){I[q.target.name.toLowerCase()]=q.target.value}async function Y(q){q.target.disabled=!0,q.target.innerText="Saving...";let N=Object.keys(I),K=new FormData;for(let R=0;R<N.length;R++)K.append(N[R],I[N[R]]);K.append("data_hash",a.data_hash);let te=await fetch("/api/editMetaData",{method:"POST",body:K});te.ok?(alert("Success!"),await te.json(),e(2,D.image_card_edit_interface=!1,D)):alert("Error while saving. Contact Admin"),q.target.innerText="Save",q.target.disabled=!1}function ne(q){h&&(g+=1,e(7,m+=1/Le),g==Math.min(u.length,Le)&&(e(7,m=0),h=!1))}const Z=(q,N)=>{e(9,L={active:!0,top:q.top-28,left:q.left}),e(8,P=Number(N.target.attributes["data-ix"].value))},se=()=>{e(9,L.active=!1,L)},$=()=>{j()},ge=()=>{w()},ee=()=>{T("parent")},X=()=>{T("image_card")},fe=()=>{T("parent")},ae=()=>{T("image_card_fullscreen")},re=()=>{j()},De=()=>{console.log("hellll"),T("image_card_fullscreen")},je=()=>{e(2,D.image_card_edit_interface=!0,D)},Oe=()=>{e(2,D.image_card_edit_interface=!1,D)},_e=()=>{w()},qe=()=>{console.log("pressed me!!!"),e(6,u=[]),s("exitButtonPressed")},be=q=>{M(q.detail.mask)};function we(){z=kl(this.value),e(11,z)}const pe=q=>{y(q),T("image_card")};return l.$$set=q=>{"show_exit_interface_button"in q&&e(1,r=q.show_exit_interface_button),"image_data"in q&&e(0,n=q.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&100663297&&n&&(e(25,d=gt(n.list_score)),n.done==!1&&e(6,u=d.slice(p,p+Le))),l.$$.dirty[0]&4&&D){let q=!1;(D.image_card==!0||D.image_card_fullscreen==!0)&&(q=!0),s("imageCardActive",{active:q})}},[n,r,D,i,a,o,u,m,P,L,S,z,s,v,T,y,w,j,V,A,M,H,U,Y,ne,d,p,Z,se,$,ge,ee,X,fe,ae,re,De,je,Oe,_e,qe,be,we,pe]}class dt extends Se{constructor(t){super(),Ce(this,t,Yl,Jl,ke,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const Zl="/assets/sample_place_bg-38f3fbd4.jpg";function il(l,t,e){const s=l.slice();return s[10]=t[e],s}function $l(l){let t,e,s,r,n,i,a,o,u,d,p,g=l[0].people,m=[];for(let h=0;h<g.length;h+=1)m[h]=ol(il(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="People Album",i=k(),a=_("div"),o=_("input"),u=k();for(let h=0;h<m.length;h+=1)m[h].c();f(n,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search person"),f(a,"class","flex"),f(r,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(r,n),c(r,i),c(r,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=E(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].people;let b;for(b=0;b<g.length;b+=1){const C=il(h,g,b);m[b]?m[b].p(C,v):(m[b]=ol(C),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:B,o:B,d(h){h&&O(t),ve(m,h),d=!1,p()}}}function es(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){ue(t.$$.fragment)},m(s,r){ie(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(Q(t.$$.fragment,s),e=!0)},o(s){J(t.$$.fragment,s),e=!1},d(s){oe(t,s)}}}function ts(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function ol(l){let t,e,s,r,n,i,a,o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[7](l[10],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),a=_("div"),u=G(o),d=k(),f(r,"loading","lazy"),ye(r.src,n="/api/getPreviewPerson/"+l[10])||f(r,"src",n),f(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[160px] w-[160px] bg-gray-800"),f(a,"class","flex text-md text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=E(t,"click",m),p=!0)},p(h,v){l=h,v&1&&!ye(r.src,n="/api/getPreviewPerson/"+l[10])&&f(r,"src",n),v&1&&o!==(o=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&W(u,o)},d(h){h&&O(t),p=!1,g()}}}function ls(l){let t,e,s,r;const n=[ts,es,$l],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ee()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Je(),J(i[d],1,1,()=>{i[d]=null}),Ye(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),Q(e,1),e.m(s.parentNode,s))},i(o){r||(Q(e),r=!0)},o(o){J(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function ss(l,t,e){let s={people:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;xe(()=>{e(3,a=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(h.data_hash[b]),r.list_score.push(h.score[b]),r.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.people=h.person,s),o=s.people})})}),Qe(()=>{console.log("destroying... people..")});async function u(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let h=0;h<r.list_dataHash.length;h++)r.list_metaData[h].person.includes(m)&&(n.list_metaData.push(r.list_metaData[h]),n.list_dataHash.push(r.list_dataHash[h]),n.list_score.push(r.list_score[h]));e(1,n.done=!0,n),e(2,i=!0),o&&e(0,s.people=o,s),Te.update(h=>structuredClone(n))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.people=o,s);return}h&&a==!0&&o&&(e(0,s.people=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.people.push(v)}))}return[s,n,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class ns extends Se{constructor(t){super(),Ce(this,t,ss,ls,ke,{})}}function al(l,t,e){const s=l.slice();return s[8]=t[e],s}function rs(l){let t,e,s,r=l[0].places,n=[];for(let i=0;i<r.length;i+=1)n[i]=cl(al(l,r,i));return{c(){t=_("div"),e=k(),s=_("div");for(let i=0;i<n.length;i+=1)n[i].c();f(t,"class","flex w-screen h-[80px] bg-blue-100"),f(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(i,a){F(i,t,a),F(i,e,a),F(i,s,a);for(let o=0;o<n.length;o+=1)n[o].m(s,null)},p(i,a){if(a&17){r=i[0].places;let o;for(o=0;o<r.length;o+=1){const u=al(i,r,o);n[o]?n[o].p(u,a):(n[o]=cl(u),n[o].c(),n[o].m(s,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},i:B,o:B,d(i){i&&O(t),i&&O(e),i&&O(s),ve(n,i)}}}function is(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){ue(t.$$.fragment)},m(s,r){ie(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(Q(t.$$.fragment,s),e=!0)},o(s){J(t.$$.fragment,s),e=!1},d(s){oe(t,s)}}}function os(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function cl(l){let t,e,s,r,n,i,a,o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",u,d,p,g;function m(...h){return l[6](l[8],...h)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),a=_("div"),u=G(o),d=k(),ye(r.src,n=Zl)||f(r,"src",n),f(r,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[150px] w-[200px] bg-gray-800"),f(a,"class","flex text-xl text-white justify-center items-center"),f(t,"class","flex-col cursor-pointer")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),p||(g=E(t,"click",m),p=!0)},p(h,v){l=h,v&1&&o!==(o=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&W(u,o)},d(h){h&&O(t),p=!1,g()}}}function as(l){let t,e,s,r;const n=[os,is,rs],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ee()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Je(),J(i[d],1,1,()=>{i[d]=null}),Ye(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),Q(e,1),e.m(s.parentNode,s))},i(o){r||(Q(e),r=!0)},o(o){J(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function cs(l,t,e){let s={places:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},i=!1,a=!0;xe(()=>{e(3,a=!1),fetch("/api/getGroup/place").then(p=>{p.json().then(g=>{let m=g.meta_data.length;for(let h=0;h<m;h++)r.list_dataHash.push(g.data_hash[h]),r.list_score.push(g.score[h]),r.list_metaData.push(g.meta_data[h]);e(3,a=!0),e(0,s.places=g.place,s)})})}),Qe(()=>{console.log("destroying...")});async function o(p){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Te.update(g=>structuredClone(n));for(let g=0;g<r.list_dataHash.length;g++)r.list_metaData[g].place.toLowerCase()===p.toLowerCase()&&(n.list_metaData.push(r.list_metaData[g]),n.list_dataHash.push(r.list_dataHash[g]),n.list_score.push(r.list_score[g]));e(1,n.done=!0,n),e(2,i=!0),Te.update(g=>structuredClone(n))}return[s,n,i,a,o,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(p,g)=>{console.log("mine is: ",p),o(p)}]}class us extends Se{constructor(t){super(),Ce(this,t,cs,as,ke,{})}}const fs="/assets/folder-regular-1127ab6b.svg";function ul(l,t,e){const s=l.slice();return s[10]=t[e],s}function ds(l){let t,e,s,r,n,i,a,o,u,d,p,g=l[0].local_directories,m=[];for(let h=0;h<g.length;h+=1)m[h]=fl(ul(l,g,h));return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("div"),n=_("div"),n.textContent="Local Resources",i=k(),a=_("div"),o=_("input"),u=k();for(let h=0;h<m.length;h+=1)m[h].c();f(n,"class","flex text-lg font-semibold"),f(o,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),f(o,"type","text"),f(o,"placeholder","Search directory"),f(a,"class","flex"),f(r,"class","flex w-full justify-between items-center"),f(s,"class","flex w-screen h-[80px]"),f(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),f(t,"class","flex w-full justify-center items-center")},m(h,v){F(h,t,v),c(t,e),c(e,s),c(s,r),c(r,n),c(r,i),c(r,a),c(a,o),c(e,u);for(let b=0;b<m.length;b+=1)m[b].m(e,null);d||(p=E(o,"input",l[5]),d=!0)},p(h,v){if(v&17){g=h[0].local_directories;let b;for(b=0;b<g.length;b+=1){const C=ul(h,g,b);m[b]?m[b].p(C,v):(m[b]=fl(C),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=g.length}},i:B,o:B,d(h){h&&O(t),ve(m,h),d=!1,p()}}}function _s(l){let t,e;return t=new dt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){ue(t.$$.fragment)},m(s,r){ie(t,s,r),e=!0},p(s,r){const n={};r&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||(Q(t.$$.fragment,s),e=!0)},o(s){J(t.$$.fragment,s),e=!1},d(s){oe(t,s)}}}function ps(l){let t;return{c(){t=_("p"),t.textContent="Loading, please wait..."},m(e,s){F(e,t,s)},p:B,i:B,o:B,d(e){e&&O(t)}}}function fl(l){let t,e,s,r,n,i,a,o=l[10].slice(0,10)+"..",u,d,p,g,m;function h(...v){return l[7](l[10],...v)}return{c(){t=_("div"),e=_("div"),s=_("div"),r=_("img"),i=k(),a=_("div"),u=G(o),d=k(),ye(r.src,n=fs)||f(r,"src",n),f(r,"class","object-contain hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),f(s,"class","h-[100px] w-[100px] bg-gray-800 p-3"),f(a,"class","flex text-sm text-black justify-center items-center"),f(t,"class","flex-col cursor-pointer p-2"),f(t,"title",p=l[10])},m(v,b){F(v,t,b),c(t,e),c(e,s),c(s,r),c(e,i),c(e,a),c(a,u),c(t,d),g||(m=E(t,"click",h),g=!0)},p(v,b){l=v,b&1&&o!==(o=l[10].slice(0,10)+"..")&&W(u,o),b&1&&p!==(p=l[10])&&f(t,"title",p)},d(v){v&&O(t),g=!1,m()}}}function hs(l){let t,e,s,r;const n=[ps,_s,ds],i=[];function a(o,u){return o[3]===!1?0:o[2]?1:2}return t=a(l),e=i[t]=n[t](l),{c(){e.c(),s=Ee()},m(o,u){i[t].m(o,u),F(o,s,u),r=!0},p(o,[u]){let d=t;t=a(o),t===d?i[t].p(o,u):(Je(),J(i[d],1,1,()=>{i[d]=null}),Ye(),e=i[t],e?e.p(o,u):(e=i[t]=n[t](o),e.c()),Q(e,1),e.m(s.parentNode,s))},i(o){r||(Q(e),r=!0)},o(o){J(e),r=!1},d(o){i[t].d(o),o&&O(s)}}}function ms(l,t,e){let s={local_directories:[]},r={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},i=!1,a=!0,o;xe(()=>{e(3,a=!1),fetch("/api/getGroup/resource_directory").then(m=>{m.json().then(h=>{let v=h.meta_data.length;for(let b=0;b<v;b++)r.list_dataHash.push(h.data_hash[b]),r.list_score.push(h.score[b]),r.list_metaData.push(h.meta_data[b]);e(3,a=!0),e(0,s.local_directories=h.resource_directory,s),o=s.local_directories})})}),Qe(()=>{});async function u(m){e(2,i=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0}),console.log("looking for attribute ",m);for(let h=0;h<r.list_dataHash.length;h++)r.list_metaData[h].resource_directory.toLowerCase().includes(m)&&(n.list_metaData.push(r.list_metaData[h]),n.list_dataHash.push(r.list_dataHash[h]),n.list_score.push(r.list_score[h]));e(1,n.done=!0,n),console.log(n),e(2,i=!0),o&&e(0,s.local_directories=o,s),Te.update(h=>structuredClone(n))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){o&&e(0,s.local_directories=o,s);return}h&&a==!0&&o&&(e(0,s.local_directories=[],s),o.forEach(v=>{v.toLowerCase().includes(h)&&s.local_directories.push(v)}))}return[s,n,i,a,u,d,()=>{console.log("pressed the hell out of it!"),e(2,i=!1)},(m,h)=>{console.log("mine is: ",m),u(m)}]}class gs extends Se{constructor(t){super(),Ce(this,t,ms,hs,ke,{})}}function bs(l){let t,e,s,r,n,i,a,o,u,d;return{c(){t=_("div"),e=_("p"),e.innerHTML=`* Make sure you have created an OAuth credential at google Cloud-Console for this app and have enabled <b>Google Photos Api</b>. For details visit <b>https://developers.google.com/photos/library/guides/get-started</b><br/>
                * <b>App type</b> must be chosen as <b>Web app</b> and One of Redirect URIs must be set as <b>http://localhost:5000/api/OAuthCallback</b> in corresponding credential.<br/>
                * Except <b>You</b> and <b>Google</b> , <b>No-one</b> would have access to your personal data.`,s=k(),r=_("div"),n=_("label"),i=G(l[2]),a=k(),o=_("input"),f(e,"class","p-4"),f(n,"for","file"),f(o,"type","file"),f(o,"accept",".json"),f(r,"class","flex items-center justify-center text-md p-2 bg-blue-300"),f(t,"class","border-2 flex-1 justify-center items-center bg-blue-200")},m(p,g){F(p,t,g),c(t,e),c(t,s),c(t,r),c(r,n),c(n,i),c(r,a),c(r,o),u||(d=E(o,"change",l[4]),u=!0)},p(p,g){g&4&&W(i,p[2])},d(p){p&&O(t),u=!1,d()}}}function vs(l){let t,e=l[0].client_id+"",s,r,n;function i(u,d){return u[0].is_activated?ws:ks}let a=i(l),o=a(l);return{c(){t=_("p"),s=G(e),r=k(),o.c(),n=Ee(),f(t,"class","bg-gray-100 p-2 border-2 border-black")},m(u,d){F(u,t,d),c(t,s),F(u,r,d),o.m(u,d),F(u,n,d)},p(u,d){d&1&&e!==(e=u[0].client_id+"")&&W(s,e),a!==(a=i(u))&&(o.d(1),o=a(u),o&&(o.c(),o.m(n.parentNode,n)))},d(u){u&&O(t),u&&O(r),o.d(u),u&&O(n)}}}function ks(l){let t;return{c(){t=_("p"),t.textContent="Inactive",f(t,"class","bg-rose-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function ws(l){let t;return{c(){t=_("p"),t.textContent="Active",f(t,"class","bg-green-300 p-2 border-2 border-black")},m(e,s){F(e,t,s)},d(e){e&&O(t)}}}function dl(l){let t,e,s,r;return{c(){t=_("div"),e=_("button"),e.textContent="Activate Google photos",f(e,"class","bg-blue-400 p-2 text-md disabled:bg-blue-200"),f(t,"class","flex justify-center items-center m-3")},m(n,i){F(n,t,i),c(t,e),s||(r=E(e,"click",l[3]),s=!0)},p:B,d(n){n&&O(t),s=!1,r()}}}function ys(l){let t,e,s;function r(o,u){return o[0]?vs:bs}let n=r(l),i=n(l),a=l[1]&&dl(l);return{c(){t=_("div"),i.c(),e=k(),a&&a.c(),s=Ee(),f(t,"class","flex w-full justify-center items-center")},m(o,u){F(o,t,u),i.m(t,null),F(o,e,u),a&&a.m(o,u),F(o,s,u)},p(o,[u]){n===(n=r(o))&&i?i.p(o,u):(i.d(1),i=n(o),i&&(i.c(),i.m(t,null))),o[1]?a?a.p(o,u):(a=dl(o),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},i:B,o:B,d(o){o&&O(t),i.d(),o&&O(e),a&&a.d(o),o&&O(s)}}}function xs(l,t,e){let s=null,r=!1,n="Upload Client secret json";function i(){fetch("/api/gClientInfo").then(d=>{d.json().then(p=>{p.client_id_available===!0&&(e(0,s=p),p.is_activated==!1&&e(1,r=!0))})})}xe(()=>{i()});function a(){fetch("/api/statusGAuthFlow").then(d=>{d.json().then(p=>{p.finished==!1?setTimeout(a,2e3):(e(1,r=!1),alert("Account Activation: "+p.status.toString()),i())})})}function o(d){d.target.disabled=!0,d.target.innerText="activation in progress...",fetch("/api/beginGAuthFlow").then(p=>{p.ok==!1?(alert("Some error occured while starting authorization flow !"),d.target.disabled=!1,d.target.innerText="Activate Google Photos"):setTimeout(a,1e3)})}function u(d){let p="http://localhost:5000/api/OAuthCallback";e(2,n="upload in progress.."),d.preventDefault(),console.log(d.target),d.target.disabled=!0;var g=new FileReader;g.onload=function(){var m=JSON.parse(g.result);let v=Object.keys(m).includes("web"),b=!1;if(v&&Object.keys(m.web).includes("redirect_uris")&&(b=m.web.redirect_uris.includes(p)),v===!0&&b==!0){let C=new FormData;C.append("client_data",g.result),fetch("/api/uploadClientData",{method:"POST",body:C}).then(D=>{D.ok==!1?alert("Some error occured !!"):(e(2,n="Upload Client secret json"),i(),d.target.disabled=!1,e(1,r=!0))})}else{alert("Must be a webapp and redirect_uris must contain: "+p);return}},g.readAsText(d.target.files[0])}return[s,r,n,o,u]}class Cs extends Se{constructor(t){super(),Ce(this,t,xs,ys,ke,{})}}function _l(l){let t,e,s,r,n,i;return{c(){t=_("div"),e=_("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=k(),r=_("div"),r.textContent="X",f(e,"class","flex-1"),f(r,"class","flex text-xl hover:orange-900 cursor-pointer"),f(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),f(t,"role","alert")},m(a,o){F(a,t,o),c(t,e),c(t,s),c(t,r),n||(i=E(r,"click",l[9]),n=!0)},p:B,d(a){a&&O(t),n=!1,i()}}}function Ss(l){let t,e,s,r,n,i;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[21]),e.$on("sidebarStateChange",l[22]),n=new Cs({}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(Q(e.$$.fragment,a),Q(n.$$.fragment,a),i=!0)},o(a){J(e.$$.fragment,a),J(n.$$.fragment,a),i=!1},d(a){a&&O(t),oe(e),oe(n)}}}function Ds(l){let t,e,s,r,n,i;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[19]),e.$on("sidebarStateChange",l[20]),n=new gs({}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(Q(e.$$.fragment,a),Q(n.$$.fragment,a),i=!0)},o(a){J(e.$$.fragment,a),J(n.$$.fragment,a),i=!1},d(a){a&&O(t),oe(e),oe(n)}}}function js(l){let t,e,s,r,n,i;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),n=new ns({}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(Q(e.$$.fragment,a),Q(n.$$.fragment,a),i=!0)},o(a){J(e.$$.fragment,a),J(n.$$.fragment,a),i=!1},d(a){a&&O(t),oe(e),oe(n)}}}function Os(l){let t,e,s,r,n,i;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new us({}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(Q(e.$$.fragment,a),Q(n.$$.fragment,a),i=!0)},o(a){J(e.$$.fragment,a),J(n.$$.fragment,a),i=!1},d(a){a&&O(t),oe(e),oe(n)}}}function Fs(l){let t,e,s,r,n,i;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new Ml({}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),f(t,"class","flex")},m(a,o){F(a,t,o),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),i=!0},p(a,o){const u={};o[0]&64&&(u.sidebarOpen=a[6]),e.$set(u)},i(a){i||(Q(e.$$.fragment,a),Q(n.$$.fragment,a),i=!0)},o(a){J(e.$$.fragment,a),J(n.$$.fragment,a),i=!1},d(a){a&&O(t),oe(e),oe(n)}}}function Ls(l){let t,e,s,r,n,i,a,o;return e=new Ge({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),n=new Hl({props:{query_button_disabled:l[2]}}),n.$on("queryReady",l[12]),a=new dt({props:{image_data:l[1]}}),{c(){t=_("div"),ue(e.$$.fragment),s=k(),r=_("div"),ue(n.$$.fragment),i=k(),ue(a.$$.fragment),f(r,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),f(t,"class","flex")},m(u,d){F(u,t,d),ie(e,t,null),c(t,s),c(t,r),ie(n,r,null),c(r,i),ie(a,r,null),o=!0},p(u,d){const p={};d[0]&64&&(p.sidebarOpen=u[6]),e.$set(p);const g={};d[0]&4&&(g.query_button_disabled=u[2]),n.$set(g);const m={};d[0]&2&&(m.image_data=u[1]),a.$set(m)},i(u){o||(Q(e.$$.fragment,u),Q(n.$$.fragment,u),Q(a.$$.fragment,u),o=!0)},o(u){J(e.$$.fragment,u),J(n.$$.fragment,u),J(a.$$.fragment,u),o=!1},d(u){u&&O(t),oe(e),oe(n),oe(a)}}}function qs(l){let t,e,s,r,n,i=l[0]&&_l(l);const a=[Ls,Fs,Os,js,Ds,Ss],o=[];function u(d,p){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:d[5].local_album.status===!0?4:d[5].google_photos.status===!0?5:-1}return~(e=u(l))&&(s=o[e]=a[e](l)),{c(){i&&i.c(),t=k(),s&&s.c(),r=Ee()},m(d,p){i&&i.m(d,p),F(d,t,p),~e&&o[e].m(d,p),F(d,r,p),n=!0},p(d,p){d[0]?i?i.p(d,p):(i=_l(d),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null);let g=e;e=u(d),e===g?~e&&o[e].p(d,p):(s&&(Je(),J(o[g],1,1,()=>{o[g]=null}),Ye()),~e?(s=o[e],s?s.p(d,p):(s=o[e]=a[e](d),s.c()),Q(s,1),s.m(r.parentNode,r)):s=null)},i(d){n||(Q(s),n=!0)},o(d){J(s),n=!1},d(d){i&&i.d(d),d&&O(t),~e&&o[e].d(d),d&&O(r)}}}let Hs=3;function Ts(l,t,e){let s=!1;xe(()=>{window.onscrollend=function(){}}),xe(()=>{fetch("/api/getMetaStats").then(H=>{H.ok?H.json().then(I=>{Number(I.image.count)==0&&e(0,s=!0),wt.update(U=>Number(I.image.count)),xt.update(U=>Number(I.image.unique_place_count)),yt.update(U=>Number(I.image.unique_people_count)),ml.update(U=>Number(I.image.unique_resource_directories_count)),gl.update(U=>I.available_resource_attributes)}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let r=[],n=[],i=[],a,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},u=!1,d="",p={};async function g(H="xxxxxxx",I=!1){console.log("handleClick count",d,I,H),e(2,u=!0);let U=Hs;if(a=new FormData,d.length===0)return;a.append("query",d),a.append("topk",U.toString()),I==!1?(n=[],r=[],i=[],e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),a.append("query_start","true"),Te.update(X=>o)):(a.append("query_start","false"),a.append("client_id",H));let ne=await fetch("/api/query",{method:"POST",body:a});if(!ne.ok)throw e(2,u=!1),new Error(ne);let Z=await ne.json();console.log("data: ",Z);let se=Z.client_id,$=Z.meta_data,ge=Z.data_hash,ee=Z.score;Number(Z.progress);for(let X=0;X<$.length;X++){let fe=ge[X],ae=Number(ee[X]),re=n.indexOf(fe);re>=0?(r[re]+=ae,e(1,o.list_score[re]+=ae,o)):(n.push(fe),r.push(ae),i.push($[X]),o.list_dataHash.push(fe),o.list_score.push(ae),o.list_metaData.push($[X]))}if(Z.query_completed==!0?(e(1,o.done=!0,o),e(1,o.progress=1e-4,o)):(e(1,o),e(1,o.progress+=.12,o),e(1,o.progress=Math.min(o.progress,.92),o)),Z.query_completed==!0){e(2,u=!1),console.log("hey i am being called!!!"),Te.update(X=>o);return}await g(se,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}},local_album:{status:!1,context:{}},google_photos:{status:!1,context:{}}};function h(H){m[H].status==!1&&(e(1,o={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Te.update(U=>structuredClone(o)));let I=Object.keys(m);for(let U=0;U<I.length;U++)m[I[U]].status&&e(5,m[I[U]].status=!1,m);m[H]&&e(5,m[H].status=!0,m)}let v=!0;function b(H){let I=H.detail.item.name;I.toLowerCase().includes("google")?h("google_photos"):I.toLowerCase().includes("photo")?h("query"):I.toLowerCase().includes("index")?h("indexing"):I.toLowerCase().includes("people")?h("people_album"):I.toLowerCase().includes("place")?h("place_album"):I.toLowerCase().includes("local")&&h("local_album")}return[s,o,u,d,p,m,v,g,b,()=>e(0,s=!1),H=>{b(H)},H=>{e(6,v=H.detail.open)},H=>{e(3,d=H.detail.query),e(4,p=H.detail.attributes),g()},H=>b(H),H=>{e(6,v=H.detail.open)},H=>b(H),H=>{e(6,v=H.detail.open)},H=>b(H),H=>{e(6,v=H.detail.open)},H=>b(H),H=>{e(6,v=H.detail.open)},H=>b(H),H=>{e(6,v=H.detail.open)}]}class Es extends Se{constructor(t){super(),Ce(this,t,Ts,qs,ke,{},null,[-1,-1])}}new Es({target:document.getElementById("app")});
