(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();function V(){}function fl(l){return l()}function jt(){return Object.create(null)}function fe(l){l.forEach(fl)}function bt(l){return typeof l=="function"}function Fe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}let tt;function De(l,t){return tt||(tt=document.createElement("a")),tt.href=t,l===tt.href}function _l(l){return Object.keys(l).length===0}function o(l,t){l.appendChild(t)}function T(l,t,e){l.insertBefore(t,e||null)}function H(l){l.parentNode&&l.parentNode.removeChild(l)}function ve(l,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].d(t)}function p(l){return document.createElement(l)}function R(l){return document.createTextNode(l)}function w(){return R(" ")}function Ke(){return R("")}function I(l,t,e,s){return l.addEventListener(t,e,s),()=>l.removeEventListener(t,e,s)}function u(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function hl(l){return l===""?null:+l}function ml(l){return Array.from(l.childNodes)}function W(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function it(l,t){l.value=t??""}function ie(l,t,e,s){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,s?"important":"")}function Ot(l,t){for(let e=0;e<l.options.length;e+=1){const s=l.options[e];if(s.__value===t){s.selected=!0;return}}l.selectedIndex=-1}function gl(l){const t=l.querySelector(":checked")||l.options[0];return t&&t.__value}function bl(l,t,{bubbles:e=!1,cancelable:s=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(l,e,s,t),i}let Ge;function Ve(l){Ge=l}function vt(){if(!Ge)throw new Error("Function called outside component initialization");return Ge}function Me(l){vt().$$.on_mount.push(l)}function ot(l){vt().$$.on_destroy.push(l)}function at(){const l=vt();return(t,e,{cancelable:s=!1}={})=>{const i=l.$$.callbacks[t];if(i){const n=bl(t,e,{cancelable:s});return i.slice().forEach(r=>{r.call(l,n)}),!n.defaultPrevented}return!0}}const ze=[],Pe=[],lt=[],qt=[],vl=Promise.resolve();let gt=!1;function kl(){gt||(gt=!0,vl.then(dl))}function rt(l){lt.push(l)}const ht=new Set;let Ae=0;function dl(){if(Ae!==0)return;const l=Ge;do{try{for(;Ae<ze.length;){const t=ze[Ae];Ae++,Ve(t),wl(t.$$)}}catch(t){throw ze.length=0,Ae=0,t}for(Ve(null),ze.length=0,Ae=0;Pe.length;)Pe.pop()();for(let t=0;t<lt.length;t+=1){const e=lt[t];ht.has(e)||(ht.add(e),e())}lt.length=0}while(ze.length);for(;qt.length;)qt.pop()();gt=!1,ht.clear(),Ve(l)}function wl(l){if(l.fragment!==null){l.update(),fe(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(rt)}}const st=new Set;let Ne;function ct(){Ne={r:0,c:[],p:Ne}}function ut(){Ne.r||fe(Ne.c),Ne=Ne.p}function $(l,t){l&&l.i&&(st.delete(l),l.i(t))}function te(l,t,e,s){if(l&&l.o){if(st.has(l))return;st.add(l),Ne.c.push(()=>{st.delete(l),s&&(e&&l.d(1),s())}),l.o(t)}else s&&s()}function be(l){l&&l.c()}function pe(l,t,e,s){const{fragment:i,after_update:n}=l.$$;i&&i.m(t,e),s||rt(()=>{const r=l.$$.on_mount.map(fl).filter(bt);l.$$.on_destroy?l.$$.on_destroy.push(...r):fe(r),l.$$.on_mount=[]}),n.forEach(rt)}function _e(l,t){const e=l.$$;e.fragment!==null&&(fe(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function yl(l,t){l.$$.dirty[0]===-1&&(ze.push(l),kl(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function qe(l,t,e,s,i,n,r,c=[-1]){const a=Ge;Ve(l);const f=l.$$={fragment:null,ctx:[],props:n,update:V,not_equal:i,bound:jt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:jt(),dirty:c,skip_bound:!1,root:t.target||a.$$.root};r&&r(f.root);let d=!1;if(f.ctx=e?e(l,t.props||{},(_,g,...m)=>{const h=m.length?m[0]:g;return f.ctx&&i(f.ctx[_],f.ctx[_]=h)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](h),d&&yl(l,_)),g}):[],f.update(),d=!0,fe(f.before_update),f.fragment=s?s(f.ctx):!1,t.target){if(t.hydrate){const _=ml(t.target);f.fragment&&f.fragment.l(_),_.forEach(H)}else f.fragment&&f.fragment.c();t.intro&&$(l.$$.fragment),pe(l,t.target,t.anchor,t.customElement),dl()}Ve(a)}class Ee{$destroy(){_e(this,1),this.$destroy=V}$on(t,e){if(!bt(e))return V;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const i=s.indexOf(e);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!_l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Et(l,t,e){const s=l.slice();return s[26]=t[e],s}function Ht(l,t,e){const s=l.slice();return s[29]=t[e],s}function Lt(l,t,e){const s=l.slice();return s[29]=t[e],s}function Tt(l,t,e){const s=l.slice();return s[34]=t[e],s}function Nt(l){let t,e=l[4][l[29]],s=[];for(let i=0;i<e.length;i+=1)s[i]=Pt(Tt(l,e,i));return{c(){for(let i=0;i<s.length;i+=1)s[i].c();t=w()},m(i,n){for(let r=0;r<s.length;r+=1)s[r].m(i,n);T(i,t,n)},p(i,n){if(n[0]&2576){e=i[4][i[29]];let r;for(r=0;r<e.length;r+=1){const c=Tt(i,e,r);s[r]?s[r].p(c,n):(s[r]=Pt(c),s[r].c(),s[r].m(t.parentNode,t))}for(;r<s.length;r+=1)s[r].d(1);s.length=e.length}},d(i){ve(s,i),i&&H(t)}}}function Pt(l){let t,e,s,i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",n,r,c,a=l[34]+" ",f,d,_,g,m;function h(...b){return l[14](l[29],l[34],...b)}return{c(){t=p("div"),e=p("div"),s=p("span"),n=R(i),r=w(),c=p("span"),f=R(a),d=w(),_=p("span"),_.textContent="x",u(s,"class","text-blue-800 "),u(c,"class","ml-1 text-sm font-semibold"),u(_,"class","ml-1 text-red-600 cursor-pointer hover:text-blue-500"),u(e,"class","mx-1 px-2 bg-blue-200 rounded-md min-h-10"),u(t,"class","flex items-center justify-center")},m(b,v){T(b,t,v),o(t,e),o(e,s),o(s,n),o(e,r),o(e,c),o(c,f),o(e,d),o(e,_),g||(m=[I(_,"click",h),I(e,"click",function(){bt(l[11](l[29]))&&l[11](l[29]).apply(this,arguments)})],g=!0)},p(b,v){l=b,v[0]&16&&i!==(i=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"")&&W(n,i),v[0]&16&&a!==(a=l[34]+" ")&&W(f,a)},d(b){b&&H(t),g=!1,fe(m)}}}function It(l){let t,e=l[4][l[29]].length>=1&&Nt(l);return{c(){e&&e.c(),t=Ke()},m(s,i){e&&e.m(s,i),T(s,t,i)},p(s,i){s[4][s[29]].length>=1?e?e.p(s,i):(e=Nt(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&H(t)}}}function Mt(l){let t,e=l[29].charAt(0).toUpperCase()+l[29].slice(1)+"",s,i,n;return{c(){t=p("option"),s=R(e),i=w(),t.__value=n=l[29],t.value=t.__value},m(r,c){T(r,t,c),o(t,s),o(t,i)},p(r,c){c[0]&16&&e!==(e=r[29].charAt(0).toUpperCase()+r[29].slice(1)+"")&&W(s,e),c[0]&16&&n!==(n=r[29])&&(t.__value=n,t.value=t.__value)},d(r){r&&H(t)}}}function At(l){let t,e,s,i,n,r,c,a,f=l[3],d=[];for(let _=0;_<f.length;_+=1)d[_]=Bt(Et(l,f,_));return{c(){t=p("div"),e=p("ul");for(let _=0;_<d.length;_+=1)d[_].c();s=w(),i=p("div"),n=p("button"),n.textContent="Close",u(e,"class","divide-y max-h-36 overflow-y-auto divide-gray-200"),u(n,"class","w-full bg-gray-300 border text-gray-900 hover:bg-gray-500 hover:text-gray-100 py-1 px-4 shadow-md"),u(i,"class","flex w-full justify-center items-center"),u(t,"class",r=(l[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")},m(_,g){T(_,t,g),o(t,e);for(let m=0;m<d.length;m+=1)d[m].m(e,null);o(t,s),o(t,i),o(i,n),c||(a=I(n,"click",l[22]),c=!0)},p(_,g){if(g[0]&1034){f=_[3];let m;for(m=0;m<f.length;m+=1){const h=Et(_,f,m);d[m]?d[m].p(h,g):(d[m]=Bt(h),d[m].c(),d[m].m(e,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=f.length}g[0]&32&&r!==(r=(_[5]?"":"hidden")+" w-full bg-white border rounded-md shadow-md mt-1")&&u(t,"class",r)},d(_){_&&H(t),ve(d,_),c=!1,a()}}}function Bt(l){let t,e=l[26]+"",s,i,n,r;function c(){return l[21](l[26])}return{c(){t=p("li"),s=R(e),i=w(),u(t,"class","px-4 py-2 hover:bg-gray-100 cursor-pointer")},m(a,f){T(a,t,f),o(t,s),o(t,i),n||(r=I(t,"click",c),n=!0)},p(a,f){l=a,f[0]&8&&e!==(e=l[26]+"")&&W(s,e)},d(a){a&&H(t),n=!1,r()}}}function zt(l){let t;return{c(){t=p("div"),t.innerHTML=`<p>Search interface allows combining multiple attributes in a single query. An attribute can be selected multiple times from left-side menu.</p> 
            <p class="pt-1 pb-1">For example if you have tagged a person as <b>sam</b>, select attribute <b>person</b> and enter <b>sam</b>, then select <b>query</b> and enter <b>playing in the park</b>.
                And press <span class="bg-blue-200 p-1 rounded-sm border-1">shift + enter</span> or click <span class="bg-blue-200 p-1">Search</span> button.</p>`,u(t,"class","flex-1 w-full min-h-40 p-3 bg-gray-300 text-sm")},m(e,s){T(e,t,s)},d(e){e&&H(t)}}}function xl(l){let t,e,s,i,n,r,c,a,f,d,_,g,m,h,b,v,C,D=Object.keys(l[4]),q=[];for(let k=0;k<D.length;k+=1)q[k]=It(Lt(l,D,k));let N=Object.keys(l[4]),j=[];for(let k=0;k<N.length;k+=1)j[k]=Mt(Ht(l,N,k));let x=l[3].length>0&&At(l),y=l[6]==!0&&zt();return{c(){t=p("div"),e=p("div"),s=p("div"),i=p("div");for(let k=0;k<q.length;k+=1)q[k].c();n=w(),r=p("div"),c=p("select");for(let k=0;k<j.length;k+=1)j[k].c();a=w(),f=p("div"),d=p("input"),_=w(),g=p("div"),m=p("button"),m.textContent="Search",h=w(),x&&x.c(),b=w(),y&&y.c(),u(i,"class","flex w-full items-center my-3 flex-wrap text-lg"),u(c,"class","px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"),u(c,"name","select-option"),u(c,"id","select-option"),l[1]===void 0&&rt(()=>l[16].call(c)),u(d,"class","px-4 py-4 rounded-md focus:outline-none bg-blue-200 h-full w-full"),u(d,"type","search"),u(d,"placeholder","Enter value here"),u(f,"class","bg-blue-200 rounded-md flex-grow h-10"),u(m,"class","bg-blue-600 hover:bg-blue-800 disabled:bg-blue-400 text-white font-semibold px-4 rounded"),u(g,"class","flex"),u(r,"class","flex space-x-2"),u(s,"class","w-full"),u(e,"class","w-full relative place-content-center"),u(t,"class","max-w-screen p-4 mx-auto")},m(k,F){T(k,t,F),o(t,e),o(e,s),o(s,i);for(let S=0;S<q.length;S+=1)q[S].m(i,null);o(s,n),o(s,r),o(r,c);for(let S=0;S<j.length;S+=1)j[S].m(c,null);Ot(c,l[1]),o(r,a),o(r,f),o(f,d),l[17](d),o(r,_),o(r,g),o(g,m),l[20](m),o(e,h),x&&x.m(e,null),o(e,b),y&&y.m(e,null),v||(C=[I(c,"change",l[15]),I(c,"change",l[16]),I(d,"focus",l[18],{once:!0}),I(d,"focusout",l[19]),I(d,"keyup",l[8]),I(d,"keydown",l[7]),I(m,"click",l[12])],v=!0)},p(k,F){if(F[0]&2576){D=Object.keys(k[4]);let S;for(S=0;S<D.length;S+=1){const E=Lt(k,D,S);q[S]?q[S].p(E,F):(q[S]=It(E),q[S].c(),q[S].m(i,null))}for(;S<q.length;S+=1)q[S].d(1);q.length=D.length}if(F[0]&16){N=Object.keys(k[4]);let S;for(S=0;S<N.length;S+=1){const E=Ht(k,N,S);j[S]?j[S].p(E,F):(j[S]=Mt(E),j[S].c(),j[S].m(c,null))}for(;S<j.length;S+=1)j[S].d(1);j.length=N.length}F[0]&18&&Ot(c,k[1]),k[3].length>0?x?x.p(k,F):(x=At(k),x.c(),x.m(e,b)):x&&(x.d(1),x=null),k[6]==!0?y||(y=zt(),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:V,o:V,d(k){k&&H(t),ve(q,k),ve(j,k),l[17](null),l[20](null),x&&x.d(),y&&y.d(),v=!1,fe(C)}}}async function Cl(l,t){let e="/api/getSuggestion",s=new FormData;s.append("attribute",l),s.append("query",t);let i=await fetch(e,{method:"POST",body:s});return i.ok===!0?await i.json():{}}function Sl(l,t,e){const s=at();let i="query",n,r,{query_button_disabled:c=!1}=t,a="",f=[],d={person:[],query:[],place:[],filename:[]},_=!1;var g={};function m(L){g[L.keyCode]=L.type=="keydown",g[13]==!0&&L.shiftKey&&(console.log("shift enter combination."),D())}async function h(L){e(6,q=!1),g[L.keyCode]=!1;let A=L.target;if(A.value.length==0){e(3,f=[]);return}if(console.log("current value: ",A.value),L.keyCode==13){let z=d[i].length;A.value.length>0&&!d[i].includes(A.value)&&e(4,d[i][z]=A.value,d),A.value="",e(3,f=[]),e(5,_=!1);return}let G=await Cl(i,A.value);i in G?(e(3,f=G[i]),e(5,_=!0)):(e(3,f=[]),e(5,_=!1))}function b(L,A,G){let z=d[A].indexOf(G);z>=0&&(d[A].splice(z,1),e(4,d)),i==A&&e(3,f=[])}function v(L,A){e(5,_=!1),e(2,n.value=A,n),n.focus()}function C(L){e(1,i=L),e(3,f=d[i]),e(5,_=!0),n.focus()}function D(L){let A=d[i].length;n.value.length>0&&!d[i].includes(n.value)&&e(4,d[i][A]=n.value,d);let G=Object.keys(d);a="";for(let z=0;z<G.length;z++){let K=G[z],X=d[K];a+=K+":";for(let se=0;se<X.length;se++)a+=X[se],se!=X.length-1&&(a+="-");z!=G.length-1&&(a+=",")}console.log("Completed: "+a),e(2,n.value="",n),r.disabled==!1?s("queryReady",{query:a,attributes:d}):console.log("chill dawg!!!")}let q=!1;const N=(L,A,G)=>b(G.currentTarget,L,A),j=L=>C(L.target.value);function x(){i=gl(this),e(1,i),e(4,d)}function y(L){Pe[L?"unshift":"push"](()=>{n=L,e(2,n)})}const k=L=>{L.target.value.length==0&&e(6,q=!0)},F=L=>{e(6,q=!1)};function S(L){Pe[L?"unshift":"push"](()=>{r=L,e(0,r),e(13,c)})}const E=L=>v(i,L),P=()=>e(5,_=!1);return l.$$set=L=>{"query_button_disabled"in L&&e(13,c=L.query_button_disabled)},l.$$.update=()=>{l.$$.dirty[0]&8193&&r&&e(0,r.disabled=c,r)},[r,i,n,f,d,_,q,m,h,b,v,C,D,c,N,j,x,y,k,F,S,E,P]}class Dl extends Ee{constructor(t){super(),qe(this,t,Sl,xl,Fe,{query_button_disabled:13},null,[-1,-1])}}const Be=[];function Xe(l,t=V){let e;const s=new Set;function i(c){if(Fe(l,c)&&(l=c,e)){const a=!Be.length;for(const f of s)f[1](),Be.push(f,l);if(a){for(let f=0;f<Be.length;f+=2)Be[f][0](Be[f+1]);Be.length=0}}}function n(c){i(c(l))}function r(c,a=V){const f=[c,a];return s.add(f),s.size===1&&(e=t(i)||V),c(l),()=>{s.delete(f),s.size===0&&(e(),e=null)}}return{set:i,update:n,subscribe:r}}const kt=Xe(0),wt=Xe(0),yt=Xe(0),nt=Xe([]);let Fl={list_metaData:[],list_dataHash:[],list_score:[],done:!1};const Ie=Xe(Fl);function Rt(l,t,e){const s=l.slice();return s[8]=t[e],s[10]=e,s}function jl(l){let t,e,s;return{c(){t=p("span"),t.innerHTML='<i class="fa-solid fa-bars cursor-pointer"></i>',u(t,"class","px-4")},m(i,n){T(i,t,n),e||(s=I(t,"click",l[2]),e=!0)},p:V,d(i){i&&H(t),e=!1,s()}}}function Ol(l){let t,e,s,i,n;return{c(){t=p("span"),t.textContent="Hachi",e=w(),s=p("span"),s.innerHTML='<i class="fa-solid fa-arrow-left"></i>',u(t,"class","px-4"),u(s,"class","cursor-pointer px-4")},m(r,c){T(r,t,c),T(r,e,c),T(r,s,c),i||(n=I(s,"click",l[3]),i=!0)},p:V,d(r){r&&H(t),r&&H(e),r&&H(s),i=!1,n()}}}function Ut(l){let t,e,s=l[8].name+"",i,n,r,c=l[8].count+"",a;return{c(){t=p("div"),e=p("div"),i=R(s),n=w(),r=p("div"),a=R(c),u(e,"class","flex"),u(e,"data-ix",l[10]),u(r,"class","px-3 flex text-black text-md text-bold"),u(t,"class","flex w-full justify-between")},m(f,d){T(f,t,d),o(t,e),o(e,i),o(t,n),o(t,r),o(r,a)},p(f,d){d&2&&s!==(s=f[8].name+"")&&W(i,s),d&2&&c!==(c=f[8].count+"")&&W(a,c)},d(f){f&&H(t)}}}function Vt(l){let t,e,s,i,n,r,c,a=l[0].sidebarOpen&&Ut(l);function f(){return l[6](l[10])}return{c(){t=p("div"),e=p("i"),i=w(),a&&a.c(),n=w(),u(e,"class",s="fa-solid fa-"+l[8].icon),u(t,"class","flex items-center space-x-2 px-4 py-3 text-black hover:bg-green-100 hover:text-black")},m(d,_){T(d,t,_),o(t,e),o(t,i),a&&a.m(t,null),o(t,n),r||(c=I(t,"click",f),r=!0)},p(d,_){l=d,_&2&&s!==(s="fa-solid fa-"+l[8].icon)&&u(e,"class",s),l[0].sidebarOpen?a?a.p(l,_):(a=Ut(l),a.c(),a.m(t,n)):a&&(a.d(1),a=null)},d(d){d&&H(t),a&&a.d(),r=!1,c()}}}function ql(l){let t,e,s,i,n,r;function c(g,m){return g[0].sidebarOpen?Ol:jl}let a=c(l),f=a(l),d=l[1],_=[];for(let g=0;g<d.length;g+=1)_[g]=Vt(Rt(l,d,g));return{c(){t=p("div"),e=p("aside"),s=p("div"),f.c(),i=w(),n=p("nav");for(let g=0;g<_.length;g+=1)_[g].c();u(s,"class","flex h-16 items-center justify-between bg-green-100 font-semibold text-black"),u(n,"class","mt-6"),u(e,"class",r=(l[0].sidebarOpen&&"w-64")+" bg-green-50"),u(t,"class","flex h-100 text-white")},m(g,m){T(g,t,m),o(t,e),o(e,s),f.m(s,null),o(e,i),o(e,n);for(let h=0;h<_.length;h+=1)_[h].m(n,null)},p(g,[m]){if(a===(a=c(g))&&f?f.p(g,m):(f.d(1),f=a(g),f&&(f.c(),f.m(s,null))),m&19){d=g[1];let h;for(h=0;h<d.length;h+=1){const b=Rt(g,d,h);_[h]?_[h].p(b,m):(_[h]=Vt(b),_[h].c(),_[h].m(n,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=d.length}m&1&&r!==(r=(g[0].sidebarOpen&&"w-64")+" bg-green-50")&&u(e,"class",r)},i:V,o:V,d(g){g&&H(t),f.d(),ve(_,g)}}}function El(l,t,e){const s=at();let{sidebarOpen:i=!1}=t;const n={sidebarOpen:i},r=[{icon:"image",path:"#",name:"Photos",count:0},{icon:"video",path:"#",name:"Videos",count:0},{icon:"book-atlas",path:"#",name:"Index Library",count:0},{icon:"user-tag",path:"#",name:"People",count:0},{icon:"location-dot",path:"#",name:"Places",count:0}];Me(()=>{kt.subscribe(_=>{r&&e(1,r[0].count=_,r)}),wt.subscribe(_=>{r&&e(1,r[3].count=_,r)}),yt.subscribe(_=>{r&&e(1,r[4].count=_,r)})});function c(){e(0,n.sidebarOpen=!0,n)}function a(){e(0,n.sidebarOpen=!1,n)}function f(_){s("menuClick",{item:r[_]})}const d=_=>{f(_)};return l.$$set=_=>{"sidebarOpen"in _&&e(5,i=_.sidebarOpen)},l.$$.update=()=>{l.$$.dirty&1&&n&&s("sidebarStateChange",{open:n.sidebarOpen})},[n,r,c,a,f,i,d]}class ft extends Ee{constructor(t){super(),qe(this,t,El,ql,Fe,{sidebarOpen:5})}}function Hl(l){let t,e,s,i,n,r,c,a,f,d,_,g,m=(l[3]*100).toString().slice(0,4)+"",h,b,v,C,D,q,N,j,x,y,k,F,S,E,P,L,A,G,z,K,X,se,re,J,le,oe,Q,ee,he,me,ae,we,ye,xe,ce,je,ge,ke,ue;return{c(){t=p("div"),e=p("p"),e.textContent="Press Start button to start indexing",s=w(),i=p("div"),n=p("input"),r=w(),c=p("div"),a=p("div"),f=p("div"),d=p("div"),_=w(),g=p("div"),h=R(m),b=R("%"),v=w(),C=p("div"),D=R("Current directory: "),q=p("span"),N=R(l[4]),j=w(),x=p("span"),x.textContent="ETA:",y=w(),k=p("span"),F=R(l[6]),S=w(),E=p("div"),P=R("Details: "),L=p("span"),A=R(l[5]),G=w(),z=p("div"),K=p("div"),X=p("input"),se=w(),re=p("label"),re.textContent="Complete Rescan",J=w(),le=p("div"),le.textContent="Re-index all originals, including already indexed and unchanged files.",oe=w(),Q=p("div"),ee=p("select"),he=p("option"),he.textContent="Images Only",me=p("option"),me.textContent="Videos Only",ae=p("option"),ae.textContent="Videos and Images",we=w(),ye=p("div"),ye.textContent="Filter by content type",xe=w(),ce=p("button"),ce.textContent="Cancel",je=w(),ge=p("button"),ge.textContent="Start",u(e,"class","mb-2 text-sm font-semibold"),u(n,"type","text"),u(n,"class","w-full rounded border p-1 text-sm"),u(n,"placeholder","D://images (Full path to directory to index)"),n.required=!0,u(i,"class","my-2"),u(d,"class","h-2rounded bg-blue-500"),ie(d,"width",(l[3]*100).toString()+"%"),u(f,"class","flex h-2 w-11/12 rounded bg-gray-300"),u(g,"class","flex px-2 font-semibold"),u(a,"class","flex items-center"),u(q,"class","text-black"),u(x,"class","pl-3 text-right"),u(k,"class","text-black"),u(C,"class","pt-1 text-sm text-blue-600"),u(L,"class","text-black"),u(E,"class","pt-1 text-sm text-blue-600"),u(c,"class","mb-3"),u(X,"type","checkbox"),u(X,"class","h-5 w-5 text-blue-500"),u(re,"class","ml-1"),u(K,"class","mr-2 flex items-center"),u(le,"class","text-sm text-gray-600"),u(z,"class","mt-4 mb-3 flex flex-wrap items-center"),he.__value="Images Only",he.value=he.__value,me.disabled=!0,me.__value="Videos Only",me.value=me.__value,ae.disabled=!0,ae.__value="Videos and Images",ae.value=ae.__value,u(ee,"class","h-8 rounded border border-blue-500 p-1 text-sm text-blue-700 focus:outline-none"),u(ye,"class","ml-2 text-sm text-gray-600"),u(Q,"class","mb-3 mt-3 flex flex-wrap items-center"),ce.disabled=!0,u(ce,"type","button"),u(ce,"class","mr-2 mt-2 rounded bg-orange-500 px-4 py-2 text-white disabled:bg-orange-200 disabled:opacity-75"),u(ge,"type","button"),u(ge,"class","rounded bg-blue-500 px-4 py-2 text-white disabled:bg-blue-200"),u(t,"class","container mx-auto max-w-lg bg-green-50 p-4")},m(O,M){T(O,t,M),o(t,e),o(t,s),o(t,i),o(i,n),l[12](n),it(n,l[7]),o(t,r),o(t,c),o(c,a),o(a,f),o(f,d),o(a,_),o(a,g),o(g,h),o(g,b),o(c,v),o(c,C),o(C,D),o(C,q),o(q,N),o(C,j),o(C,x),o(C,y),o(C,k),o(k,F),o(c,S),o(c,E),o(E,P),o(E,L),o(L,A),o(t,G),o(t,z),o(z,K),o(K,X),X.checked=l[8],o(K,se),o(K,re),o(z,J),o(z,le),o(t,oe),o(t,Q),o(Q,ee),o(ee,he),o(ee,me),o(ee,ae),o(Q,we),o(Q,ye),o(t,xe),o(t,ce),l[16](ce),o(t,je),o(t,ge),l[17](ge),ke||(ue=[I(n,"input",l[13]),I(n,"keydown",l[14]),I(X,"change",l[15]),I(ce,"click",l[10]),I(ge,"click",l[9])],ke=!0)},p(O,[M]){M&128&&n.value!==O[7]&&it(n,O[7]),M&8&&ie(d,"width",(O[3]*100).toString()+"%"),M&8&&m!==(m=(O[3]*100).toString().slice(0,4)+"")&&W(h,m),M&16&&W(N,O[4]),M&64&&W(F,O[6]),M&32&&W(A,O[5]),M&256&&(X.checked=O[8])},i:V,o:V,d(O){O&&H(t),l[12](null),l[16](null),l[17](null),ke=!1,fe(ue)}}}function Ll(l,t,e){let s,i,n;Me(()=>{if(e(11,s=localStorage.getItem("stored_indexing_endpoint")),s!==null){let y="/api/getIndexStatus/"+s;e(0,i.disabled=!1,i),e(1,n.disabled=!0,n),m(y)}}),ot(()=>{g&&clearTimeout(g)});let r,c=.001,a="",f="",d="",_="",g;async function m(y,k=0){k==0&&console.log("starting a new polll...");let S=await(await fetch(y,{method:"GET"})).json();if(S.is_active==!0){if(S.done==!0){let P=new FormData;P.append("ack","true"),(await fetch(y,{method:"POST",body:P})).ok===!1?alert("Some error on server side, after indexing is Completed. Contact administrator.."):alert("Indexing Completed Successfully");let A=await fetch("/api/getMetaStats");A=await A.json(),kt.update(G=>Number(A.image.count)),wt.update(G=>Number(A.image.unique_people_count)),yt.update(G=>Number(A.image.unique_place_count)),e(1,n.disabled=!1,n),e(11,s=null),localStorage.removeItem("stored_indexing_endpoint"),e(3,c=0),e(4,a=""),e(6,d=""),e(5,f=""),e(7,_=""),e(0,i.disabled=!0,i),e(0,i.innerText="Cancel",i),e(2,r.disabled=!1,r);return}e(3,c=S.progress),e(6,d=S.eta),e(5,f=S.details),e(4,a=S.current_directory),g&&clearTimeout(g),g=setTimeout(function(){m(y,k+1)},1e3)}}let h=!1;async function b(){if(n&&_){e(1,n.disabled=!0,n),e(2,r.disabled=!0,r);let y=new FormData;y.append("image_directory_path",_),y.append("complete_rescan",h.toString());let S=await(await fetch("/api/indexStart",{method:"POST",body:y})).json();if(S.success===!0){e(0,i.disabled=!1,i);let P="/api/getIndexStatus/"+S.statusEndpoint;e(11,s=S.statusEndpoint),m(P)}else alert(S.reason),e(1,n.disabled=!1,n),e(2,r.disabled=!1,r)}else console.log("No index_start_button object found!!!")}async function v(){if(s){e(0,i.disabled=!0,i),e(0,i.innerText="Cancelling... Please wait.",i);let y="/api/indexCancel/"+s,k=await fetch(y,{method:"GET"});if(localStorage.removeItem("stored_indexing_endpoint"),e(11,s=null),!k.ok)throw alert("Error occured while cancelling index. Contact administrator."),new Error(k);return}else return}function C(y){Pe[y?"unshift":"push"](()=>{r=y,e(2,r)})}function D(){_=this.value,e(7,_)}const q=y=>{y.key==="Enter"&&n.click()};function N(){h=this.checked,e(8,h)}function j(y){Pe[y?"unshift":"push"](()=>{i=y,e(0,i)})}function x(y){Pe[y?"unshift":"push"](()=>{n=y,e(1,n)})}return l.$$.update=()=>{l.$$.dirty&2048&&s&&localStorage.setItem("stored_indexing_endpoint",s)},[i,n,r,c,a,f,d,_,h,b,v,s,C,D,q,N,j,x]}class Tl extends Ee{constructor(t){super(),qe(this,t,Ll,Hl,Fe,{})}}function Gt(l,t,e){const s=l.slice();return s[10]=t[e],s}function Kt(l,t,e){const s=l.slice();return s[13]=t[e],s}function Xt(l){let t;return{c(){t=p("i"),u(t,"class","fa fa-plus text-xs text-black")},m(e,s){T(e,t,s)},d(e){e&&H(t)}}}function Qt(l){let t,e,s=l[1].selectFilters[l[10]].values.includes(l[13]),i,n,r,c=l[13]+"",a,f,d,_=s&&Xt();function g(){return l[7](l[10],l[13])}return{c(){t=p("div"),e=p("div"),_&&_.c(),n=w(),r=p("span"),a=R(c),u(e,"class",i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none")),u(t,"class","my-2 flex gap-2 items-center cursor-pointer")},m(m,h){T(m,t,h),o(t,e),_&&_.m(e,null),o(t,n),o(t,r),o(r,a),f||(d=I(t,"click",g),f=!0)},p(m,h){l=m,h&2&&(s=l[1].selectFilters[l[10]].values.includes(l[13])),s?_||(_=Xt(),_.c(),_.m(e,null)):_&&(_.d(1),_=null),h&2&&i!==(i="flex justify-center items-center w-4 h-4 min-w-4 min-h-4 border "+(l[1].selectFilters[l[10]].values.includes(l[13])&&"bg-green-400 border-none"))&&u(e,"class",i),h&2&&c!==(c=l[13]+"")&&W(a,c)},d(m){m&&H(t),_&&_.d(),f=!1,d()}}}function Wt(l){let t,e,s=l[10]+"",i,n,r,c,a,f,d,_,g;function m(){return l[6](l[10])}let h=l[1].selectFilters[l[10]].options,b=[];for(let v=0;v<h.length;v+=1)b[v]=Qt(Kt(l,h,v));return{c(){t=p("div"),e=p("div"),i=R(s),n=w(),r=p("i"),a=w(),f=p("div");for(let v=0;v<b.length;v+=1)b[v].c();u(r,"class",c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down")),u(e,"class","px-4 py-1 flex items-center gap-2 text-gray-600 cursor-pointer border rounded bg-blue-300 hover:bg-blue-400"),u(f,"class",d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto"),u(t,"class","relative")},m(v,C){T(v,t,C),o(t,e),o(e,i),o(e,n),o(e,r),o(t,a),o(t,f);for(let D=0;D<b.length;D+=1)b[D].m(f,null);_||(g=[I(e,"click",m),I(t,"mouseup",Al)],_=!0)},p(v,C){if(l=v,C&2&&s!==(s=l[10]+"")&&W(i,s),C&2&&c!==(c="fa "+(l[1].selectFilterActive===l[10]?"fa-caret-up":"fa-caret-down"))&&u(r,"class",c),C&6){h=l[1].selectFilters[l[10]].options;let D;for(D=0;D<h.length;D+=1){const q=Kt(l,h,D);b[D]?b[D].p(q,C):(b[D]=Qt(q),b[D].c(),b[D].m(f,null))}for(;D<b.length;D+=1)b[D].d(1);b.length=h.length}C&2&&d!==(d=(l[1].selectFilterActive!==l[10]&&"hidden")+" absolute flex flex-col z-10 max-w-50 p-4 rounded bg-gray-700 text-gray-300 left-0 top-10 max-h-60 overflow-auto")&&u(f,"class",d)},d(v){v&&H(t),ve(b,v),_=!1,fe(g)}}}function Nl(l){let t,e,s,i,n,r,c,a,f,d,_,g,m=Object.keys(l[1].selectFilters),h=[];for(let b=0;b<m.length;b+=1)h[b]=Wt(Gt(l,m,b));return{c(){t=p("div"),e=p("div"),s=p("span"),s.innerHTML='From: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',i=w(),n=p("span"),n.innerHTML='To: <input class="mx-2 px-2 py-1 cursor-pointer border rounded hover:bg-blue-400 bg-blue-300 text-gray-600" type="date"/>',r=w();for(let b=0;b<h.length;b+=1)h[b].c();c=w(),a=p("button"),f=R("Filter"),u(s,"class","flex items-center text-md"),u(n,"class","flex items-center text-md"),a.disabled=l[0],u(a,"class",d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(l[0]===!0?"disabled":"")),u(e,"class","flex justify-center items-center gap-8 p-4 flex-wrap"),u(t,"class","flex container mx-auto max-w-4xl")},m(b,v){T(b,t,v),o(t,e),o(e,s),o(e,i),o(e,n),o(e,r);for(let C=0;C<h.length;C+=1)h[C].m(e,null);o(e,c),o(e,a),o(a,f),_||(g=I(a,"click",l[4]),_=!0)},p(b,[v]){if(v&14){m=Object.keys(b[1].selectFilters);let C;for(C=0;C<m.length;C+=1){const D=Gt(b,m,C);h[C]?h[C].p(D,v):(h[C]=Wt(D),h[C].c(),h[C].m(e,c))}for(;C<h.length;C+=1)h[C].d(1);h.length=m.length}v&1&&(a.disabled=b[0]),v&1&&d!==(d="px-4 py-1 text-white rounded bg-blue-600 disabled:bg-blue-200 "+(b[0]===!0?"disabled":""))&&u(a,"class",d)},i:V,o:V,d(b){b&&H(t),ve(h,b),_=!1,g()}}}function pl(l,t,e=null,s=(i,n)=>i===n){let i=[];for(let n=0;n<l.length;n++)e?s(l[n].key,t)?i.push(1):i.push(0):s(l[n],t)?i.push(1):i.push(0);return i}function Pl(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=pl(l,t[s]);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Il(l,t=[]){let e=[];for(let s=0;s<l.length;s++)e.push(0);for(let s=0;s<t.length;s++){let i=pl(l,t[s],null,(n,r)=>n?n.includes(r):!1);for(let n=0;n<e.length;n++)e[n]=Number(Boolean(e[n])||Boolean(i[n]))}return e}function Ml(l){let t=l[0].length,e=l[0];return l.forEach((s,i)=>{if(i>0){if(s.length!==t)throw new Error("all mask must be of same length!!");s.forEach((n,r)=>{e[r]=Number(Boolean(e[r])&&Boolean(n))})}}),e}const Al=l=>l.stopPropagation();function Bl(l,t,e){let s=[],{filter_button_disabled:i=!0}=t;nt.subscribe(m=>{e(0,i=!1),e(5,s=m)});const n=at(),r={selectFilterActive:"",date:"",selectFilters:{place:{name:"place",values:[],options:[]},people:{name:"people",values:[],options:[]}}};Me(()=>{document.addEventListener("mouseup",c)});function c(m){e(1,r.selectFilterActive="",r)}function a(m,h){if(r.selectFilters[m].values.includes(h)){e(1,r.selectFilters[m].values=r.selectFilters[m].values.filter(b=>b!==h),r);return}e(1,r.selectFilters[m].values=[h,...r.selectFilters[m].values],r)}function f(m){if(r.selectFilterActive===m){e(1,r.selectFilterActive="",r);return}e(1,r.selectFilterActive=m,r)}function d(){if(s){console.log(s);let m=[],h=[];s.map((N,j)=>{m.push(N.place),h.push(N.person)});let b=r.selectFilters.place.values,v=Pl(m,b),C=r.selectFilters.people.values,D=Il(h,C),q=Ml([v,D]);n("filterApplied",{mask:q})}}const _=m=>f(m),g=(m,h)=>a(m,h);return l.$$set=m=>{"filter_button_disabled"in m&&e(0,i=m.filter_button_disabled)},l.$$.update=()=>{if(l.$$.dirty&32&&s){let m=s.map((C,D)=>{if(C.place)return C.place}),h=[];s.map((C,D)=>{C.person&&C.person.forEach(q=>h.push(q))});let b=[];new Set(m).forEach(C=>b.push(C));let v=[];new Set(h).forEach(C=>v.push(C)),e(1,r.selectFilters.place.values=b,r),e(1,r.selectFilters.place.options=b,r),e(1,r.selectFilters.people.values=v,r),e(1,r.selectFilters.people.options=v,r)}},[i,r,a,f,d,s,_,g]}class zl extends Ee{constructor(t){super(),qe(this,t,Bl,Nl,Fe,{filter_button_disabled:0})}}function Jt(l,t,e){const s=l.slice();return s[53]=t[e],s[52]=e,s}function Yt(l,t,e){const s=l.slice();return s[50]=t[e],s[52]=e,s}function Rl(l){let t,e,s,i,n,r,c,a,f,d,_,g,m,h,b,v,C,D,q,N,j=l[1]&&Zt(l);e=new zl({props:{filter_button_disabled:l[3]}}),e.$on("filterApplied",l[41]);let x=l[6],y=[];for(let F=0;F<x.length;F+=1)y[F]=el(Jt(l,x,F));let k=l[6].length>=Se&&tl(l);return{c(){j&&j.c(),t=w(),be(e.$$.fragment),s=w(),i=p("div"),n=p("div"),r=p("div"),c=p("div"),a=p("div"),f=p("input"),d=w(),_=p("label"),g=R("Score threshold: "),m=R(l[11]),h=R("."),b=w(),v=p("div");for(let F=0;F<y.length;F+=1)y[F].c();C=w(),k&&k.c(),u(f,"type","range"),u(f,"min","0"),u(f,"max","1.0"),u(f,"step","0.01"),u(f,"class","w-full"),u(_,"for","topk"),u(_,"class","dark:text-white"),u(a,"class","my-2"),u(r,"class","flex flex-row place-content-center mb-2 select-none mx-2"),u(v,"class","grid grid-cols-6 2xl:grid-cols-6 gap-2 p-1 sm:p-8 px-auto justify-center"),u(n,"class","flex-1 overflow-y-auto min-h-full bg-blue-200 p-2 relative"),u(i,"class","flex")},m(F,S){j&&j.m(F,S),T(F,t,S),pe(e,F,S),T(F,s,S),T(F,i,S),o(i,n),o(n,r),o(r,c),o(c,a),o(a,f),it(f,l[11]),o(a,d),o(a,_),o(_,g),o(_,m),o(_,h),o(n,b),o(n,v);for(let E=0;E<y.length;E+=1)y[E].m(v,null);o(n,C),k&&k.m(n,null),D=!0,q||(N=[I(f,"change",l[19]),I(f,"change",l[42]),I(f,"input",l[42])],q=!0)},p(F,S){F[1]?j?j.p(F,S):(j=Zt(F),j.c(),j.m(t.parentNode,t)):j&&(j.d(1),j=null);const E={};if(S[0]&8&&(E.filter_button_disabled=F[3]),e.$set(E),S[0]&2048&&it(f,F[11]),(!D||S[0]&2048)&&W(m,F[11]),S[0]&16826433){x=F[6];let P;for(P=0;P<x.length;P+=1){const L=Jt(F,x,P);y[P]?y[P].p(L,S):(y[P]=el(L),y[P].c(),y[P].m(v,null))}for(;P<y.length;P+=1)y[P].d(1);y.length=x.length}F[6].length>=Se?k?k.p(F,S):(k=tl(F),k.c(),k.m(n,null)):k&&(k.d(1),k=null)},i(F){D||($(e.$$.fragment,F),D=!0)},o(F){te(e.$$.fragment,F),D=!1},d(F){j&&j.d(F),F&&H(t),_e(e,F),F&&H(s),F&&H(i),ve(y,F),k&&k.d(),q=!1,fe(N)}}}function Ul(l){let t,e,s,i,n,r,c,a,f,d,_,g,m,h,b,v,C,D,q,N,j,x=l[2].image_card_edit_interface&&ll(l),y=l[5]&&sl(l);return{c(){t=p("div"),e=p("div"),s=p("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-gray-200"></i>
                    Back to Search`,i=w(),n=p("div"),n.innerHTML='<i class="fa fa-arrows-alt text-gray-200"></i>',r=w(),c=p("div"),a=p("div"),a.innerHTML='<i class="fa fa-arrow-left text-gray-200"></i>',f=w(),d=p("div"),_=p("div"),g=p("img"),h=w(),b=p("div"),b.innerHTML='<i class="fa-solid fa-pen text-gray-200"></i>',v=w(),x&&x.c(),C=w(),D=p("div"),D.innerHTML='<i class="fa fa-arrow-right text-gray-200"></i>',q=w(),y&&y.c(),u(s,"class","cursor-pointer hover:underline text-gray-200"),u(n,"title","Fullscreen"),u(n,"class","cursor-pointer"),u(e,"class","flex h-6 items-center justify-between"),u(a,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 left-10 text-white z-100"),u(g,"class","w-auto cursor-pointer h-full"),De(g.src,m="/api/getRawData/"+l[4].data_hash)||u(g,"src",m),u(g,"alt",""),u(b,"class","absolute text-xl cursor-pointer right-4 top-4 text-gray-200 z-100"),u(_,"class","flex shrink h-full"),u(d,"class","flex h-full items-center justify-center p-2 gap-4"),u(D,"class","absolute text-xl cursor-pointer text-red -translate-y-2/4 top-2/4 right-10 text-white z-100"),u(c,"class","flex relative bg-black justify-center mx-auto h-[70vh] mt-2 gap-2"),u(t,"class","fixed w-screen h-screen overflow-auto left-0 top-0 bg-gray-700")},m(k,F){T(k,t,F),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,c),o(c,a),o(c,f),o(c,d),o(d,_),o(_,g),o(_,h),o(_,b),o(d,v),x&&x.m(d,null),o(c,C),o(c,D),o(t,q),y&&y.m(t,null),N||(j=[I(s,"click",l[33]),I(n,"click",l[34]),I(a,"click",l[35]),I(g,"click",l[36]),I(b,"click",l[37]),I(D,"click",l[39])],N=!0)},p(k,F){F[0]&16&&!De(g.src,m="/api/getRawData/"+k[4].data_hash)&&u(g,"src",m),k[2].image_card_edit_interface?x?x.p(k,F):(x=ll(k),x.c(),x.m(d,null)):x&&(x.d(1),x=null),k[5]?y?y.p(k,F):(y=sl(k),y.c(),y.m(t,null)):y&&(y.d(1),y=null)},i:V,o:V,d(k){k&&H(t),x&&x.d(),y&&y.d(),N=!1,fe(j)}}}function Vl(l){let t,e,s,i,n,r,c,a,f,d,_,g,m,h,b,v,C,D,q=l[10],N=[];for(let x=0;x<q.length;x+=1)N[x]=nl(Yt(l,q,x));let j=l[9].active&&il(l);return{c(){t=p("div"),e=p("div"),s=p("img"),n=w();for(let x=0;x<N.length;x+=1)N[x].c();r=w(),j&&j.c(),c=w(),a=p("div"),f=p("div"),f.innerHTML='<i class="fa fa-arrow-left"></i>',d=w(),_=p("div"),_.innerHTML='<i class="fa fa-arrow-right"></i>',g=w(),m=p("div"),h=p("div"),h.innerHTML=`<i class="fa fa-arrow-left mr-1 text-white"></i>
                Back to Search`,b=w(),v=p("div"),v.innerHTML='<i class="fa fa-arrows-alt"></i>',u(s,"class","object-cover h-screen w-auto"),De(s.src,i="/api/getRawDataFull/"+l[4].data_hash)||u(s,"src",i),u(s,"alt",""),u(e,"class","relative flex"),u(f,"class","text-white cursor-pointer"),u(_,"class","text-white cursor-pointer"),u(a,"class","absolute flex mx-auto items-center justify-between w-screen"),u(t,"class","fixed top-0 left-0 bg-black h-screen w-screen flex justify-center items-center"),u(h,"class","cursor-pointer hover:underline text-white"),u(v,"title","Fullscreen"),u(v,"class","cursor-pointer text-white"),u(m,"class","fixed top-0 left-0 flex h-12 items-center justify-between w-screen")},m(x,y){T(x,t,y),o(t,e),o(e,s),o(e,n);for(let k=0;k<N.length;k+=1)N[k].m(e,null);o(e,r),j&&j.m(e,null),o(t,c),o(t,a),o(a,f),o(a,d),o(a,_),T(x,g,y),T(x,m,y),o(m,h),o(m,b),o(m,v),C||(D=[I(s,"load",l[18]),I(f,"click",l[29]),I(_,"click",l[30]),I(h,"click",l[31]),I(v,"click",l[32])],C=!0)},p(x,y){if(y[0]&16&&!De(s.src,i="/api/getRawDataFull/"+x[4].data_hash)&&u(s,"src",i),y[0]&1792){q=x[10];let k;for(k=0;k<q.length;k+=1){const F=Yt(x,q,k);N[k]?N[k].p(F,y):(N[k]=nl(F),N[k].c(),N[k].m(e,r))}for(;k<N.length;k+=1)N[k].d(1);N.length=q.length}x[9].active?j?j.p(x,y):(j=il(x),j.c(),j.m(e,null)):j&&(j.d(1),j=null)},i:V,o:V,d(x){x&&H(t),ve(N,x),j&&j.d(),x&&H(g),x&&H(m),C=!1,fe(D)}}}function Zt(l){let t,e,s,i,n;return{c(){t=p("div"),e=p("div"),s=p("div"),s.innerHTML=`<i class="fa fa-arrow-left mr-1 text-black"></i>
            Back`,u(s,"class","cursor-pointer hover:underline text-black"),u(e,"class","top-0 left-0 flex h-12 items-center justify-between w-screen"),u(t,"class","flex")},m(r,c){T(r,t,c),o(t,e),o(e,s),i||(n=I(s,"click",l[40]),i=!0)},p:V,d(r){r&&H(t),i=!1,n()}}}function $t(l){let t,e,s,i,n,r;function c(){return l[43](l[52])}return{c(){t=p("div"),e=p("img"),i=w(),u(e,"class","sm:max-h-48 shadow-xl cursor-pointer"),De(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])||u(e,"src",s),u(e,"alt","image"),u(t,"class","flex justify-center bg-black")},m(a,f){T(a,t,f),o(t,e),o(t,i),n||(r=[I(e,"load",l[24]),I(t,"click",c)],n=!0)},p(a,f){l=a,f[0]&65&&!De(e.src,s="api/getRawData/"+l[0].list_dataHash[l[53].ix])&&u(e,"src",s)},d(a){a&&H(t),n=!1,fe(r)}}}function el(l){let t,e=l[53].ix>=0&&$t(l);return{c(){e&&e.c(),t=Ke()},m(s,i){e&&e.m(s,i),T(s,t,i)},p(s,i){s[53].ix>=0?e?e.p(s,i):(e=$t(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(s){e&&e.d(s),s&&H(t)}}}function tl(l){let t,e,s,i;return{c(){t=p("div"),e=p("button"),e.textContent="More results ..",u(e,"class","px-4 py-1 text-white rounded bg-blue-400 disabled:bg-blue-200 hover:bg-blue-600"),u(t,"class","flex items-center justify-center")},m(n,r){T(n,t,r),o(t,e),s||(i=I(e,"click",l[13]),s=!0)},p:V,d(n){n&&H(t),s=!1,i()}}}function ll(l){let t,e,s,i,n,r,c,a,f,d,_,g,m,h,b,v,C,D,q,N,j,x,y,k,F,S,E,P,L,A,G,z,K,X,se,re,J,le,oe;return{c(){t=p("div"),e=p("div"),s=p("div"),s.textContent="Info",i=w(),n=p("div"),n.textContent="X",r=w(),c=p("div"),a=p("div"),a.textContent="Description",f=w(),d=p("input"),g=w(),m=p("div"),h=p("div"),h.textContent="place",b=w(),v=p("input"),D=w(),q=p("div"),N=p("div"),N.textContent="Tags",j=w(),x=p("input"),k=w(),F=p("div"),S=p("div"),S.textContent="Taken at:",E=w(),P=p("input"),L=w(),A=p("div"),G=p("div"),G.textContent="device",z=w(),K=p("input"),se=w(),re=p("div"),J=p("button"),J.textContent="Save",u(s,"class","grow text-xl text-gray-100 font-bold"),u(n,"class","text-gray-100 hover:bg-gray-400 px-2 py-1"),u(e,"class","flex items-center"),u(a,"class","mb-1 text-gray-100"),u(d,"name","Description"),u(d,"placeholder",""),d.value=_=l[4].description.toString(),u(d,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(d,"type","text"),u(h,"class","mb-1 text-gray-100"),u(v,"name","place"),v.value=C=l[4].place.toString(),u(v,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(v,"type","text"),u(N,"class","mb-1 text-gray-100"),u(x,"name","tags"),u(x,"placeholder","Car, chair"),x.value=y=l[4].tags.toString(),u(x,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(x,"type","text"),u(S,"class","mb-1 text-gray-100"),u(P,"name","taken_at"),P.value="",u(P,"type","date"),u(P,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(G,"class","mb-1 text-gray-100"),u(K,"name","device"),u(K,"placeholder","Canon"),K.value=X=l[4].device.toString(),u(K,"class","w-full rounded border-none bg-gray-800 px-2 py-2 text-sm text-white focus:outline-none"),u(K,"type","text"),u(J,"class","px-4 bg-gray-200 py-2 rounded w-full cursor-pointer hover:bg-gray-400 disabled:bg-gray-600"),u(t,"class","flex flex-col py-4 px-4 gap-4 h-full shrink-0 overflow-y-auto w-80 rounded bg-gray-700")},m(Q,ee){T(Q,t,ee),o(t,e),o(e,s),o(e,i),o(e,n),o(t,r),o(t,c),o(c,a),o(c,f),o(c,d),o(t,g),o(t,m),o(m,h),o(m,b),o(m,v),o(t,D),o(t,q),o(q,N),o(q,j),o(q,x),o(t,k),o(t,F),o(F,S),o(F,E),o(F,P),o(t,L),o(t,A),o(A,G),o(A,z),o(A,K),o(t,se),o(t,re),o(re,J),le||(oe=[I(n,"click",l[38]),I(d,"change",l[22]),I(v,"change",l[22]),I(x,"change",l[22]),I(P,"change",l[22]),I(K,"change",l[22]),I(J,"click",l[23])],le=!0)},p(Q,ee){ee[0]&16&&_!==(_=Q[4].description.toString())&&d.value!==_&&(d.value=_),ee[0]&16&&C!==(C=Q[4].place.toString())&&v.value!==C&&(v.value=C),ee[0]&16&&y!==(y=Q[4].tags.toString())&&x.value!==y&&(x.value=y),ee[0]&16&&X!==(X=Q[4].device.toString())&&K.value!==X&&(K.value=X)},d(Q){Q&&H(t),le=!1,fe(oe)}}}function sl(l){let t,e,s,i,n=l[4].filename+"",r,c,a,f,d,_=l[4].data_hash+"",g,m,h,b,v,C=l[4].last_modified+"",D,q,N,j,x,y,k,F,S,E=l[4].description.toString()+"",P,L,A,G,z,K,X=l[4].taken_at.toString()+"",se,re,J,le,oe,Q,ee=l[4].tags.toString()+"",he,me,ae,we,ye,xe,ce=l[4].place.toString()+"",je,ge,ke,ue,O,M,U,Y,B=l[4].person_ids.toString()+"",Ce,Qe,He,Oe,de,Le,Te=l[4].device.toString()+"",dt,Ct,Re,We,St,Je,Ye=l[4].resolution.toString()+"",pt,Dt,Ue,Ze,Ft,$e,et=l[4].absolute_path.toString()+"",_t;return{c(){t=p("style"),t.textContent=`/* Define the scrollbar track */\r
                ::-webkit-scrollbar {\r
                  width: 8px; /* Width of the scrollbar */\r
                }\r
                \r
                /* Define the scrollbar track */\r
                ::-webkit-scrollbar-track {\r
                  background-color: rgb(17 24 39) /* Dark gray background color for the track */\r
                }\r
                \r
                /* Define the scrollbar thumb */\r
                ::-webkit-scrollbar-thumb {\r
                  background-color: #64748b; /* Dark gray color for the thumb */\r
                  border-radius: 2px; /* Rounded corners for the thumb */\r
                }`,e=w(),s=p("div"),i=p("div"),r=R(n),c=w(),a=p("div"),f=R("UID: "),d=p("span"),g=R(_),m=w(),h=p("div"),b=R("Last Modified:  "),v=p("span"),D=R(C),q=w(),N=p("div"),j=p("div"),x=p("div"),y=p("div"),k=p("div"),k.textContent="Description",F=w(),S=p("div"),P=R(E),L=w(),A=p("div"),G=p("div"),G.textContent="Taken at",z=w(),K=p("div"),se=R(X),re=w(),J=p("div"),le=p("div"),le.textContent="Tags",oe=w(),Q=p("div"),he=R(ee),me=w(),ae=p("div"),we=p("div"),we.textContent="Place",ye=w(),xe=p("div"),je=R(ce),ge=w(),ke=p("div"),ue=p("div"),O=p("div"),M=p("div"),M.textContent="people",U=w(),Y=p("div"),Ce=R(B),Qe=w(),He=p("div"),Oe=p("div"),Oe.textContent="Device",de=w(),Le=p("div"),dt=R(Te),Ct=w(),Re=p("div"),We=p("div"),We.textContent="Resolution",St=w(),Je=p("div"),pt=R(Ye),Dt=w(),Ue=p("div"),Ze=p("div"),Ze.textContent="Path",Ft=w(),$e=p("div"),_t=R(et),u(i,"class","text-xl text-white"),u(d,"class","text-sm text-gray-400"),u(a,"class","text-white"),u(v,"class","text-sm text-gray-400"),u(h,"class","text-white"),u(s,"class","flex flex-col w-100 justify-center items-center bg-gray-700 py-2"),u(k,"class",""),u(S,"class","text-sm text-gray-400"),u(G,"class",""),u(K,"class","text-sm text-gray-400"),u(le,"class",""),u(Q,"class","text-sm text-gray-400"),u(we,"class",""),u(xe,"class","text-sm text-gray-400"),u(x,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(j,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded text-white"),u(M,"class",""),u(Y,"class","text-sm text-gray-400"),u(Oe,"class",""),u(Le,"class","text-sm text-gray-400"),u(We,"class",""),u(Je,"class","text-sm text-gray-400"),u(Ze,"class",""),u($e,"class","text-sm text-gray-400"),u(ue,"class","flex flex-col py-4 px-4 gap-1 overflow-y-auto"),u(ke,"class","flex h-full w-96 shrink-0 flex-col gap-4 rounded bg-gray-700 text-white"),u(N,"class","flex w-full justify-center p-4")},m(Z,ne){T(Z,t,ne),T(Z,e,ne),T(Z,s,ne),o(s,i),o(i,r),o(s,c),o(s,a),o(a,f),o(a,d),o(d,g),o(s,m),o(s,h),o(h,b),o(h,v),o(v,D),T(Z,q,ne),T(Z,N,ne),o(N,j),o(j,x),o(x,y),o(y,k),o(y,F),o(y,S),o(S,P),o(x,L),o(x,A),o(A,G),o(A,z),o(A,K),o(K,se),o(x,re),o(x,J),o(J,le),o(J,oe),o(J,Q),o(Q,he),o(x,me),o(x,ae),o(ae,we),o(ae,ye),o(ae,xe),o(xe,je),o(N,ge),o(N,ke),o(ke,ue),o(ue,O),o(O,M),o(O,U),o(O,Y),o(Y,Ce),o(ue,Qe),o(ue,He),o(He,Oe),o(He,de),o(He,Le),o(Le,dt),o(ue,Ct),o(ue,Re),o(Re,We),o(Re,St),o(Re,Je),o(Je,pt),o(ue,Dt),o(ue,Ue),o(Ue,Ze),o(Ue,Ft),o(Ue,$e),o($e,_t)},p(Z,ne){ne[0]&16&&n!==(n=Z[4].filename+"")&&W(r,n),ne[0]&16&&_!==(_=Z[4].data_hash+"")&&W(g,_),ne[0]&16&&C!==(C=Z[4].last_modified+"")&&W(D,C),ne[0]&16&&E!==(E=Z[4].description.toString()+"")&&W(P,E),ne[0]&16&&X!==(X=Z[4].taken_at.toString()+"")&&W(se,X),ne[0]&16&&ee!==(ee=Z[4].tags.toString()+"")&&W(he,ee),ne[0]&16&&ce!==(ce=Z[4].place.toString()+"")&&W(je,ce),ne[0]&16&&B!==(B=Z[4].person_ids.toString()+"")&&W(Ce,B),ne[0]&16&&Te!==(Te=Z[4].device.toString()+"")&&W(dt,Te),ne[0]&16&&Ye!==(Ye=Z[4].resolution.toString()+"")&&W(pt,Ye),ne[0]&16&&et!==(et=Z[4].absolute_path.toString()+"")&&W(_t,et)},d(Z){Z&&H(t),Z&&H(e),Z&&H(s),Z&&H(q),Z&&H(N)}}}function nl(l){let t,e,s;function i(...n){return l[27](l[50],...n)}return{c(){t=p("div"),u(t,"data-ix",l[52]),u(t,"class","absolute text-white cursor-pointer border-solid border-2 border-green-300 hover:opacity-40 hover:bg-green-300 bg-transparent"),ie(t,"top",l[50].top+"px "),ie(t,"left",l[50].left+"px"),ie(t,"width",l[50].width+"px"),ie(t,"height",l[50].height+"px")},m(n,r){T(n,t,r),e||(s=I(t,"click",i),e=!0)},p(n,r){l=n,r[0]&1024&&ie(t,"top",l[50].top+"px "),r[0]&1024&&ie(t,"left",l[50].left+"px"),r[0]&1024&&ie(t,"width",l[50].width+"px"),r[0]&1024&&ie(t,"height",l[50].height+"px")},d(n){n&&H(t),e=!1,s()}}}function il(l){let t,e,s,i,n,r,c;return{c(){t=p("div"),e=p("input"),i=w(),n=p("div"),n.textContent="X",e.autofocus=!0,e.value=s=l[4].person_ids[l[8]],u(e,"class","flex-none placeholder-gray-800 w-200 text-xl text-black py-2 bg-blue-300 bg-blue-300 border-none"),u(e,"placeholder","Enter person id"),u(e,"type","text"),u(n,"class","grow text-black hover:bg-blue-500 cursor-pointer text-xl px-2"),u(t,"class","absolute flex h-auto w-240 bg-blue-300"),ie(t,"top",l[9].top+"px "),ie(t,"left",l[9].left+"px")},m(a,f){T(a,t,f),o(t,e),o(t,i),o(t,n),e.focus(),r||(c=[I(e,"keyup",l[21]),I(n,"click",l[28])],r=!0)},p(a,f){f[0]&272&&s!==(s=a[4].person_ids[a[8]])&&e.value!==s&&(e.value=s),f[0]&512&&ie(t,"top",a[9].top+"px "),f[0]&512&&ie(t,"left",a[9].left+"px")},d(a){a&&H(t),r=!1,fe(c)}}}function Gl(l){let t,e,s,i,n,r;const c=[Vl,Ul,Rl],a=[];function f(d,_){return d[2].image_card_fullscreen===!0?0:d[2].image_card===!0?1:2}return t=f(l),e=a[t]=c[t](l),{c(){e.c(),s=w(),i=p("div"),n=p("div"),u(n,"class","h-1 rounded top-0 left-0 bg-rose-600 fixed"),ie(n,"width",(l[7]*100).toString()+"%"),u(i,"class","flex animate-pulse")},m(d,_){a[t].m(d,_),T(d,s,_),T(d,i,_),o(i,n),r=!0},p(d,_){let g=t;t=f(d),t===g?a[t].p(d,_):(ct(),te(a[g],1,1,()=>{a[g]=null}),ut(),e=a[t],e?e.p(d,_):(e=a[t]=c[t](d),e.c()),$(e,1),e.m(s.parentNode,s)),(!r||_[0]&128)&&ie(n,"width",(d[7]*100).toString()+"%")},i(d){r||($(e),r=!0)},o(d){te(e),r=!1},d(d){a[t].d(d),d&&H(s),d&&H(i)}}}let Se=18;function mt(l,t=[1],e=null){let s=[];if(t.length!=1&&t.length!=l.length)throw new Error("Assertion failed");for(let i=0;i<l.length;i++){let n=i;t[i%t.length]!==1&&(n=-1),e?s.push({ix:n,score:l[i][e]}):s.push({ix:n,score:l[i]})}return s.sort((i,n)=>i.score>n.score?-1:i.score<n.score?1:0),s}function Kl(l,t,e){const s=at();let{show_exit_interface_button:i=!1}=t,{image_data:n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}}=t,r=!0;ot(()=>{e(0,n={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),nt.update(O=>[])});let c={},a=!1,f=[],d=[],_=0,g=0,m=0,h=!1;function b(O){h!=!0&&(h=!0,g=0,e(7,m=0),e(26,_=_+Se),e(6,f=d.slice(_,_+Se)),nt.update(M=>v(f)))}function v(O){let M=[],U=O.length;for(let Y=0;Y<U;Y++){let B=O[Y].ix;M.push(n.list_metaData[B])}return M}Ie.subscribe(O=>{e(7,m=O.progress),O.done==!0?(C(O),e(7,m=0)):(e(26,_=0),e(6,f=[]))});function C(O){e(25,d=mt(O.list_score)),e(6,f=d.slice(0,0+Se)),nt.update(M=>v(f))}let D={parent:!0,image_card:!1,image_card_edit_interface:!1,image_card_fullscreen:!1};function q(O){let M=Object.keys(D);for(let U=0;U<M.length;U++)e(2,D[M[U]]=!1,D);e(2,D[O]=!0,D)}let N,j={active:!1,top:null,left:null};function x(O){let M={sorted_ix:null,image_ix:null};for(let U=O;U<f.length;U++)if(f[U].ix!==-1){M.image_ix=f[U].ix,M.sorted_ix=U;break}return M}function y(O){z={},e(5,a=!1),e(10,S=[]),e(9,j={active:!1,top:null,left:null});let M=O,U=f.length;M<0&&(M=U-1),M>U-1&&(M=0);let Y=x(M),B=Y.image_ix;M=Y.sorted_ix,B===null&&(Y=x(0),B=Y.image_ix,M=Y.sorted_ix),e(4,c.ix=M,c),e(4,c.data_hash=n.list_dataHash[B],c),e(4,c.height=Number(n.list_metaData[B].height),c),e(4,c.width=Number(n.list_metaData[B].width),c),e(4,c.face_bboxes=n.list_metaData[B].face_bboxes,c),e(4,c.person_ids=n.list_metaData[B].person,c),c.person_ids===null&&e(4,c.person_ids=[],c),e(4,c.resolution=c.height.toString()+" X "+c.width.toString(),c),e(4,c.filename=n.list_metaData[B].filename,c),e(4,c.taken_at=n.list_metaData[B].taken_at,c),c.taken_at==null&&e(4,c.taken_at="Unknown",c),e(4,c.last_modified=n.list_metaData[B].modified_at,c),e(4,c.device=n.list_metaData[B].device,c),c.device==null&&e(4,c.device="",c),e(4,c.place=n.list_metaData[B].place,c),e(4,c.absolute_path=n.list_metaData[B].absolute_path,c),e(4,c.description=n.list_metaData[B].description,c),e(4,c.tags=n.list_metaData[B].tags,c),e(5,a=!0)}function k(){y(c.ix+1)}function F(){y(c.ix-1)}let S=[];function E(O){let M=O.target.getClientRects()[0],U=M.width,Y=M.height,B=[],Ce=c.face_bboxes;if(Ce){let Qe=c.width,He=c.height;for(let Oe=0;Oe<Ce.length;Oe++){let de=structuredClone(Ce[Oe]),Le=Number(U)/(Number(Qe)+1e-4),Te=Number(Y)/(Number(He)+1e-4);de.top=de[1]*Te,de.height=(de[3]-de[1])*Te,de.left=de[0]*Le,de.width=(de[2]-de[0])*Le,B.push(de)}}console.log(B),e(10,S=B)}let P=0;function L(){let O=f[0].score,M=f[f.length-1].score,Y=n.list_score.map(B=>(B-M)/(O-M+1e-5)).map(B=>B>=P?1:0);e(6,f=mt(n.list_score,Y))}function A(O){e(3,r=!0);let M=d.slice(_,_+Se);for(let U=0;U<O.length;U++)O[U]==0?e(6,f[U].ix=-1,f):e(6,f[U].ix=M[U].ix,f);e(3,r=!1)}function G(O){let M=O.target.value,U=c.data_hash,Y=c.person_ids[N];if(O.key=="Enter"){let B=new FormData;B.append("new_person_id",M),B.append("old_person_id",Y),B.append("data_hash",U),fetch("/api/tagPerson",{method:"POST",body:B}).then(Ce=>{if(Ce.ok)alert("Success");else throw new Error("Error occured")})}}let z={};function K(O){z[O.target.name.toLowerCase()]=O.target.value}async function X(O){O.target.disabled=!0,O.target.innerText="Saving...";let M=Object.keys(z),U=new FormData;for(let B=0;B<M.length;B++)U.append(M[B],z[M[B]]);U.append("data_hash",c.data_hash);let Y=await fetch("/api/editMetaData",{method:"POST",body:U});Y.ok?(alert("Success!"),await Y.json(),e(2,D.image_card_edit_interface=!1,D)):alert("Error while saving. Contact Admin"),O.target.innerText="Save",O.target.disabled=!1}function se(O){h&&(g+=1,e(7,m+=1/Se),g==Math.min(f.length,Se)&&(e(7,m=0),h=!1))}const re=(O,M)=>{e(9,j={active:!0,top:O.top-28,left:O.left}),e(8,N=Number(M.target.attributes["data-ix"].value))},J=()=>{e(9,j.active=!1,j)},le=()=>{F()},oe=()=>{k()},Q=()=>{q("parent")},ee=()=>{q("image_card")},he=()=>{q("parent")},me=()=>{q("image_card_fullscreen")},ae=()=>{F()},we=()=>{console.log("hellll"),q("image_card_fullscreen")},ye=()=>{e(2,D.image_card_edit_interface=!0,D)},xe=()=>{e(2,D.image_card_edit_interface=!1,D)},ce=()=>{k()},je=()=>{console.log("pressed me!!!"),e(6,f=[]),s("exitButtonPressed")},ge=O=>{A(O.detail.mask)};function ke(){P=hl(this.value),e(11,P)}const ue=O=>{y(O),q("image_card")};return l.$$set=O=>{"show_exit_interface_button"in O&&e(1,i=O.show_exit_interface_button),"image_data"in O&&e(0,n=O.image_data)},l.$$.update=()=>{if(l.$$.dirty[0]&100663297&&n&&(e(25,d=mt(n.list_score)),n.done==!1&&e(6,f=d.slice(_,_+Se))),l.$$.dirty[0]&4&&D){let O=!1;(D.image_card==!0||D.image_card_fullscreen==!0)&&(O=!0),s("imageCardActive",{active:O})}},[n,i,D,r,c,a,f,m,N,j,S,P,s,b,q,y,k,F,E,L,A,G,K,X,se,d,_,re,J,le,oe,Q,ee,he,me,ae,we,ye,xe,ce,je,ge,ke,ue]}class xt extends Ee{constructor(t){super(),qe(this,t,Kl,Gl,Fe,{show_exit_interface_button:1,image_data:0},null,[-1,-1])}}const Xl="/assets/sample_place_bg-38f3fbd4.jpg";function rl(l,t,e){const s=l.slice();return s[10]=t[e],s}function Ql(l){let t,e,s,i,n,r,c,a,f,d,_,g=l[0].people,m=[];for(let h=0;h<g.length;h+=1)m[h]=ol(rl(l,g,h));return{c(){t=p("div"),e=p("div"),s=p("div"),i=p("div"),n=p("div"),n.textContent="People Album",r=w(),c=p("div"),a=p("input"),f=w();for(let h=0;h<m.length;h+=1)m[h].c();u(n,"class","flex text-lg font-semibold"),u(a,"class","text-md py-2 px-3 border-2 border-blue-600 text-slate-500 rounded-lg shadow-sm focus:outline-none focus:ring focus:ring-blue-200 focus:border-blue-500 dark:text-slate-400 dark:placeholder:text-slate-600 dark:bg-slate-900 dark:border-blue-500 dark:focus:ring-blue-900 dark:focus:border-blue-600"),u(a,"type","text"),u(a,"placeholder","Search person"),u(c,"class","flex"),u(i,"class","flex w-full justify-between items-center"),u(s,"class","flex w-screen h-[80px]"),u(e,"class","flex justify-center gap-10 items-center px-3 bg-gray-100 flex-wrap max-w-6xl"),u(t,"class","flex w-full justify-center items-center")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(i,n),o(i,r),o(i,c),o(c,a),o(e,f);for(let v=0;v<m.length;v+=1)m[v].m(e,null);d||(_=I(a,"input",l[5]),d=!0)},p(h,b){if(b&17){g=h[0].people;let v;for(v=0;v<g.length;v+=1){const C=rl(h,g,v);m[v]?m[v].p(C,b):(m[v]=ol(C),m[v].c(),m[v].m(e,null))}for(;v<m.length;v+=1)m[v].d(1);m.length=g.length}},i:V,o:V,d(h){h&&H(t),ve(m,h),d=!1,_()}}}function Wl(l){let t,e;return t=new xt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[6]),{c(){be(t.$$.fragment)},m(s,i){pe(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||($(t.$$.fragment,s),e=!0)},o(s){te(t.$$.fragment,s),e=!1},d(s){_e(t,s)}}}function Jl(l){let t;return{c(){t=p("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:V,i:V,o:V,d(e){e&&H(t)}}}function ol(l){let t,e,s,i,n,r,c,a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"",f,d,_,g;function m(...h){return l[7](l[10],...h)}return{c(){t=p("div"),e=p("div"),s=p("div"),i=p("img"),r=w(),c=p("div"),f=R(a),d=w(),u(i,"loading","lazy"),De(i.src,n="/api/getPreviewPerson/"+l[10])||u(i,"src",n),u(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[160px] w-[160px] bg-gray-800"),u(c,"class","flex text-md text-black justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,c),o(c,f),o(t,d),_||(g=I(t,"click",m),_=!0)},p(h,b){l=h,b&1&&!De(i.src,n="/api/getPreviewPerson/"+l[10])&&u(i,"src",n),b&1&&a!==(a=l[10].slice(0,1).toUpperCase()+l[10].slice(1).toLowerCase()+"")&&W(f,a)},d(h){h&&H(t),_=!1,g()}}}function Yl(l){let t,e,s,i;const n=[Jl,Wl,Ql],r=[];function c(a,f){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=n[t](l),{c(){e.c(),s=Ke()},m(a,f){r[t].m(a,f),T(a,s,f),i=!0},p(a,[f]){let d=t;t=c(a),t===d?r[t].p(a,f):(ct(),te(r[d],1,1,()=>{r[d]=null}),ut(),e=r[t],e?e.p(a,f):(e=r[t]=n[t](a),e.c()),$(e,1),e.m(s.parentNode,s))},i(a){i||($(e),i=!0)},o(a){te(e),i=!1},d(a){r[t].d(a),a&&H(s)}}}function Zl(l,t,e){let s={people:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0},r=!1,c=!0,a;Me(()=>{e(3,c=!1),fetch("/api/getGroup/person").then(m=>{m.json().then(h=>{let b=h.meta_data.length;for(let v=0;v<b;v++)i.list_dataHash.push(h.data_hash[v]),i.list_score.push(h.score[v]),i.list_metaData.push(h.meta_data[v]);e(3,c=!0),e(0,s.people=h.person,s),a=s.people})})}),ot(()=>{console.log("destroying... people..")});async function f(m){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1,progress:0});for(let h=0;h<i.list_dataHash.length;h++)i.list_metaData[h].person.includes(m)&&(n.list_metaData.push(i.list_metaData[h]),n.list_dataHash.push(i.list_dataHash[h]),n.list_score.push(i.list_score[h]));e(1,n.done=!0,n),e(2,r=!0),a&&e(0,s.people=a,s),Ie.update(h=>structuredClone(n))}function d(m){let h=m.target.value;if(h=h.toLowerCase(),!h){a&&e(0,s.people=a,s);return}h&&c==!0&&a&&(e(0,s.people=[],s),a.forEach(b=>{b.toLowerCase().includes(h)&&s.people.push(b)}))}return[s,n,r,c,f,d,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(m,h)=>{console.log("mine is: ",m),f(m)}]}class $l extends Ee{constructor(t){super(),qe(this,t,Zl,Yl,Fe,{})}}function al(l,t,e){const s=l.slice();return s[8]=t[e],s}function es(l){let t,e,s,i=l[0].places,n=[];for(let r=0;r<i.length;r+=1)n[r]=cl(al(l,i,r));return{c(){t=p("div"),e=w(),s=p("div");for(let r=0;r<n.length;r+=1)n[r].c();u(t,"class","flex w-screen h-[80px] bg-blue-100"),u(s,"class","flex justify-center gap-6 items-center my-2 py-2 w-100 h-100 bg-blue-200 flex-wrap")},m(r,c){T(r,t,c),T(r,e,c),T(r,s,c);for(let a=0;a<n.length;a+=1)n[a].m(s,null)},p(r,c){if(c&17){i=r[0].places;let a;for(a=0;a<i.length;a+=1){const f=al(r,i,a);n[a]?n[a].p(f,c):(n[a]=cl(f),n[a].c(),n[a].m(s,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=i.length}},i:V,o:V,d(r){r&&H(t),r&&H(e),r&&H(s),ve(n,r)}}}function ts(l){let t,e;return t=new xt({props:{image_data:l[1],show_exit_interface_button:!0}}),t.$on("exitButtonPressed",l[5]),{c(){be(t.$$.fragment)},m(s,i){pe(t,s,i),e=!0},p(s,i){const n={};i&2&&(n.image_data=s[1]),t.$set(n)},i(s){e||($(t.$$.fragment,s),e=!0)},o(s){te(t.$$.fragment,s),e=!1},d(s){_e(t,s)}}}function ls(l){let t;return{c(){t=p("p"),t.textContent="Loading, please wait..."},m(e,s){T(e,t,s)},p:V,i:V,o:V,d(e){e&&H(t)}}}function cl(l){let t,e,s,i,n,r,c,a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"",f,d,_,g;function m(...h){return l[6](l[8],...h)}return{c(){t=p("div"),e=p("div"),s=p("div"),i=p("img"),r=w(),c=p("div"),f=R(a),d=w(),De(i.src,n=Xl)||u(i,"src",n),u(i,"class","object-strech hover:opacity-50 w-full h-full border-gray-100 shadow-smr"),u(s,"class","h-[150px] w-[200px] bg-gray-800"),u(c,"class","flex text-xl text-white justify-center items-center"),u(t,"class","flex-col cursor-pointer")},m(h,b){T(h,t,b),o(t,e),o(e,s),o(s,i),o(e,r),o(e,c),o(c,f),o(t,d),_||(g=I(t,"click",m),_=!0)},p(h,b){l=h,b&1&&a!==(a=l[8].slice(0,1).toUpperCase()+l[8].slice(1).toLowerCase()+"")&&W(f,a)},d(h){h&&H(t),_=!1,g()}}}function ss(l){let t,e,s,i;const n=[ls,ts,es],r=[];function c(a,f){return a[3]===!1?0:a[2]?1:2}return t=c(l),e=r[t]=n[t](l),{c(){e.c(),s=Ke()},m(a,f){r[t].m(a,f),T(a,s,f),i=!0},p(a,[f]){let d=t;t=c(a),t===d?r[t].p(a,f):(ct(),te(r[d],1,1,()=>{r[d]=null}),ut(),e=r[t],e?e.p(a,f):(e=r[t]=n[t](a),e.c()),$(e,1),e.m(s.parentNode,s))},i(a){i||($(e),i=!0)},o(a){te(e),i=!1},d(a){r[t].d(a),a&&H(s)}}}function ns(l,t,e){let s={places:[]},i={list_metaData:[],list_score:[],list_dataHash:[]},n={list_metaData:[],list_score:[],list_dataHash:[],done:!1},r=!1,c=!0;Me(()=>{e(3,c=!1),fetch("/api/getGroup/place").then(_=>{_.json().then(g=>{let m=g.meta_data.length;for(let h=0;h<m;h++)i.list_dataHash.push(g.data_hash[h]),i.list_score.push(g.score[h]),i.list_metaData.push(g.meta_data[h]);e(3,c=!0),e(0,s.places=g.place,s)})})}),ot(()=>{console.log("destroying...")});async function a(_){e(2,r=!1),e(1,n={list_metaData:[],list_score:[],list_dataHash:[],done:!1}),Ie.update(g=>structuredClone(n));for(let g=0;g<i.list_dataHash.length;g++)i.list_metaData[g].place.toLowerCase()===_.toLowerCase()&&(n.list_metaData.push(i.list_metaData[g]),n.list_dataHash.push(i.list_dataHash[g]),n.list_score.push(i.list_score[g]));e(1,n.done=!0,n),e(2,r=!0),Ie.update(g=>structuredClone(n))}return[s,n,r,c,a,()=>{console.log("pressed the hell out of it!"),e(2,r=!1)},(_,g)=>{console.log("mine is: ",_),a(_)}]}class is extends Ee{constructor(t){super(),qe(this,t,ns,ss,Fe,{})}}function ul(l){let t,e,s,i,n,r;return{c(){t=p("div"),e=p("div"),e.innerHTML=`<p class="font-bold">Warning:</p> 
      <p>No Indexed Images found. Please index some images by visting Indexing library from left-sidebar.</p>`,s=w(),i=p("div"),i.textContent="X",u(e,"class","flex-1"),u(i,"class","flex text-xl hover:orange-900 cursor-pointer"),u(t,"class","flex bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 justify-center items-center ml-4 mr-4"),u(t,"role","alert")},m(c,a){T(c,t,a),o(t,e),o(t,s),o(t,i),n||(r=I(i,"click",l[9]),n=!0)},p:V,d(c){c&&H(t),n=!1,r()}}}function rs(l){let t,e,s,i,n,r;return e=new ft({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[17]),e.$on("sidebarStateChange",l[18]),n=new $l({}),{c(){t=p("div"),be(e.$$.fragment),s=w(),i=p("div"),be(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),pe(e,t,null),o(t,s),o(t,i),pe(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){te(e.$$.fragment,c),te(n.$$.fragment,c),r=!1},d(c){c&&H(t),_e(e),_e(n)}}}function os(l){let t,e,s,i,n,r;return e=new ft({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[15]),e.$on("sidebarStateChange",l[16]),n=new is({}),{c(){t=p("div"),be(e.$$.fragment),s=w(),i=p("div"),be(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),pe(e,t,null),o(t,s),o(t,i),pe(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){te(e.$$.fragment,c),te(n.$$.fragment,c),r=!1},d(c){c&&H(t),_e(e),_e(n)}}}function as(l){let t,e,s,i,n,r;return e=new ft({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[13]),e.$on("sidebarStateChange",l[14]),n=new Tl({}),{c(){t=p("div"),be(e.$$.fragment),s=w(),i=p("div"),be(n.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-200 p-2 relative"),u(t,"class","flex")},m(c,a){T(c,t,a),pe(e,t,null),o(t,s),o(t,i),pe(n,i,null),r=!0},p(c,a){const f={};a&64&&(f.sidebarOpen=c[6]),e.$set(f)},i(c){r||($(e.$$.fragment,c),$(n.$$.fragment,c),r=!0)},o(c){te(e.$$.fragment,c),te(n.$$.fragment,c),r=!1},d(c){c&&H(t),_e(e),_e(n)}}}function cs(l){let t,e,s,i,n,r,c,a;return e=new ft({props:{sidebarOpen:l[6]}}),e.$on("menuClick",l[10]),e.$on("sidebarStateChange",l[11]),n=new Dl({props:{query_button_disabled:l[2]}}),n.$on("queryReady",l[12]),c=new xt({props:{image_data:l[1]}}),{c(){t=p("div"),be(e.$$.fragment),s=w(),i=p("div"),be(n.$$.fragment),r=w(),be(c.$$.fragment),u(i,"class","flex-1 overflow-y-auto min-h-screen bg-blue-100 p-2"),u(t,"class","flex")},m(f,d){T(f,t,d),pe(e,t,null),o(t,s),o(t,i),pe(n,i,null),o(i,r),pe(c,i,null),a=!0},p(f,d){const _={};d&64&&(_.sidebarOpen=f[6]),e.$set(_);const g={};d&4&&(g.query_button_disabled=f[2]),n.$set(g);const m={};d&2&&(m.image_data=f[1]),c.$set(m)},i(f){a||($(e.$$.fragment,f),$(n.$$.fragment,f),$(c.$$.fragment,f),a=!0)},o(f){te(e.$$.fragment,f),te(n.$$.fragment,f),te(c.$$.fragment,f),a=!1},d(f){f&&H(t),_e(e),_e(n),_e(c)}}}function us(l){let t,e,s,i,n,r=l[0]&&ul(l);const c=[cs,as,os,rs],a=[];function f(d,_){return d[5].query.status?0:d[5].indexing.status===!0?1:d[5].place_album.status===!0?2:d[5].people_album.status===!0?3:-1}return~(e=f(l))&&(s=a[e]=c[e](l)),{c(){r&&r.c(),t=w(),s&&s.c(),i=Ke()},m(d,_){r&&r.m(d,_),T(d,t,_),~e&&a[e].m(d,_),T(d,i,_),n=!0},p(d,[_]){d[0]?r?r.p(d,_):(r=ul(d),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null);let g=e;e=f(d),e===g?~e&&a[e].p(d,_):(s&&(ct(),te(a[g],1,1,()=>{a[g]=null}),ut()),~e?(s=a[e],s?s.p(d,_):(s=a[e]=c[e](d),s.c()),$(s,1),s.m(i.parentNode,i)):s=null)},i(d){n||($(s),n=!0)},o(d){te(s),n=!1},d(d){r&&r.d(d),d&&H(t),~e&&a[e].d(d),d&&H(i)}}}let fs=3;function ds(l,t,e){let s=!1;Me(()=>{window.onscrollend=function(){}}),Me(()=>{fetch("/api/getMetaStats").then(E=>{E.ok?E.json().then(P=>{Number(P.image.count)==0&&e(0,s=!0),kt.update(L=>Number(P.image.count)),yt.update(L=>Number(P.image.unique_place_count)),wt.update(L=>Number(P.image.unique_people_count))}):alert("Error ocurred while fetching indexing stats. Contact admin!!")})});let i=[],n=[],r=[],c,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:1e-4},f=!1,d="",_={};async function g(E="xxxxxxx",P=!1){console.log("handleClick count",d,P,E),e(2,f=!0);let L=fs;if(c=new FormData,d.length===0)return;c.append("query",d),c.append("topk",L.toString()),P==!1?(n=[],i=[],r=[],e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:.1}),c.append("query_start","true"),Ie.update(J=>a)):(c.append("query_start","false"),c.append("client_id",E));let G=await fetch("/api/query",{method:"POST",body:c});if(!G.ok)throw e(2,f=!1),new Error(G);let z=await G.json();console.log("data: ",z);let K=z.client_id,X=z.meta_data,se=z.data_hash,re=z.score;Number(z.progress);for(let J=0;J<X.length;J++){let le=se[J],oe=Number(re[J]),Q=n.indexOf(le);Q>=0?(i[Q]+=oe,e(1,a.list_score[Q]+=oe,a)):(n.push(le),i.push(oe),r.push(X[J]),a.list_dataHash.push(le),a.list_score.push(oe),a.list_metaData.push(X[J]))}if(z.query_completed==!0?(e(1,a.done=!0,a),e(1,a.progress=1e-4,a)):(e(1,a),e(1,a.progress+=.12,a),e(1,a.progress=Math.min(a.progress,.92),a)),z.query_completed==!0){e(2,f=!1),console.log("hey i am being called!!!"),Ie.update(J=>a);return}await g(K,!0)}const m={query:{status:!0,context:{}},indexing:{status:!1,context:{}},place_album:{status:!1,context:{}},people_album:{status:!1,context:{}}};function h(E){m[E].status==!1&&(e(1,a={list_metaData:[],list_dataHash:[],list_score:[],done:!1,progress:0}),Ie.update(L=>structuredClone(a)));let P=Object.keys(m);for(let L=0;L<P.length;L++)m[P[L]].status&&e(5,m[P[L]].status=!1,m);m[E]&&e(5,m[E].status=!0,m)}let b=!0;function v(E){let P=E.detail.item.name;P.toLowerCase().includes("photo")?h("query"):P.toLowerCase().includes("index")?h("indexing"):P.toLowerCase().includes("people")?h("people_album"):P.toLowerCase().includes("place")&&h("place_album")}return[s,a,f,d,_,m,b,g,v,()=>e(0,s=!1),E=>{v(E)},E=>{e(6,b=E.detail.open)},E=>{e(3,d=E.detail.query),e(4,_=E.detail.attributes),g()},E=>v(E),E=>{e(6,b=E.detail.open)},E=>v(E),E=>{e(6,b=E.detail.open)},E=>v(E),E=>{e(6,b=E.detail.open)}]}class ps extends Ee{constructor(t){super(),qe(this,t,ds,us,Fe,{})}}new ps({target:document.getElementById("app")});
